import{U as Ae,W as ze,c as Ye,ae as Ze,af as He,M as Ge,ag as Je,Z as De,Y as $e,C as ea,X as aa,aa as ta,P as ra}from"./icons.js";import{Z as Ee,d as Ie,q as g,Y as Te,V as c,k as L,a2 as y,g as r,h as n,v as t,m as e,b as i,c as qe,A as oe,u as ne,e as Ve,ak as na,W as U,_ as ye,y as Le,X as te,j as fe,p as ie,a4 as Fe,a9 as xe,aA as sa,a1 as Ue,aL as ia,aa as Pe,C as Be,a8 as la}from"./appwrite.js";import{C as Oe}from"./ConfirmModal.js";import{M as Ke,a as Se,b as je,c as Ne}from"./index.js";import"./InfoCollapse.js";var oa=c('<div class="py-8 text-center opacity-50"><!> <p class="text-sm">Aucun membre</p></div>'),da=c('<span class="text-xs opacity-50">(vous)</span>'),va=(h,a)=>t(a,!0),ca=c(`<button class="btn btn-error btn-sm" title="Quitter l'équipe"><!></button>`),ua=(h,a,s)=>a(e(s).$id,e(s).name),ma=c('<button class="btn btn-error btn-sm" title="Retirer ce membre"><!></button>'),fa=c('<div class="card bg-base-100 border-base-200 border p-4 transition-shadow hover:shadow-md"><div class="flex items-center justify-between gap-4"><div class="flex flex-1 items-center gap-3"><div class="avatar avatar-placeholder"><div><span class="text-lg"> </span></div></div> <div class="flex-1"><div class="font-medium"> <!></div> <div class="text-sm opacity-70"> </div></div></div> <div><!> </div> <div class="flex gap-2"><!></div></div></div>'),_a=c(`<div class="alert"><!> Seul les admins peuvent modifier les parametre
      de l'équipe</div> <div class="space-y-2"></div>`,1),ba=c('<div class="space-y-4"><!></div> <!> <!>',1);function ga(h,a){Ie(a,!0);let s=g(Te({isOpen:!1,memberId:null,memberName:null})),d=g(!1),m=g(!1);const _=ne(()=>Le.userId),M=ne(()=>()=>e(_)&&a.team.members.find(k=>k.id===e(_))?.roles?.[0]||null),p=ne(()=>e(M)()==="owner");function E(u){return new Date(u).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"})}function v(u,k){t(s,{isOpen:!0,memberId:u,memberName:k},!0)}async function re(){if(e(s).memberId){t(m,!0);try{await oe.removeMember(a.team.$id,e(s).memberId),t(s,{isOpen:!1,memberId:null,memberName:null},!0),a.onMemberRemoved?.()}catch(u){console.error("[TeamMembersList] Erreur suppression:",u),alert("Erreur lors de la suppression du membre")}finally{t(m,!1)}}}async function W(){if(!e(_))return;const u=a.team.members.find(k=>k.id===e(_));if(u){t(m,!0);try{await oe.removeMember(a.team.$id,u.$id),t(d,!1),a.onMemberRemoved?.()}catch(k){console.error("[TeamMembersList] Erreur désinscription:",k),alert("Erreur lors de la désinscription")}finally{t(m,!1)}}}function V(u){return u==="owner"?Ze:Ae}function X(u){return u==="owner"?"badge-primary badge-soft":"badge-ghost"}function Y(u){return u==="owner"?"Admin":"Membre"}var B=ba(),q=L(B),ve=r(q);{var S=u=>{var k=oa(),K=r(k);Ae(K,{class:"mx-auto mb-2 h-8 w-8"}),i(u,k)},se=u=>{var k=_a(),K=L(k),T=r(K);ze(T,{class:"size-4 shrink-0"});var H=n(K,2);Ve(H,21,()=>a.team.members.filter(R=>R.confirmed),R=>R.id,(R,C)=>{const j=ne(()=>e(C).roles[0]),J=ne(()=>V(e(j))),A=ne(()=>e(C).id===e(_)),G=ne(()=>e(p)&&!e(A));var l=fa(),w=r(l),o=r(w),x=r(o),f=r(x),N=r(f),$=r(N),z=n(x,2),I=r(z),D=r(I),Q=n(D);{var P=O=>{var ae=da();i(O,ae)};y(Q,O=>{e(A)&&O(P)})}var ee=n(I,2),b=r(ee),F=n(o,2),ce=r(F);na(ce,()=>e(J),(O,ae)=>{ae(O,{class:"h-3 w-3"})});var _e=n(ce),we=n(F,2),le=r(we);{var be=O=>{var ae=ca();ae.__click=[va,d];var pe=r(ae);Ye(pe,{class:"h-4 w-4"}),U(()=>ae.disabled=e(m)),i(O,ae)},ge=O=>{var ae=fe(),pe=L(ae);{var Me=ue=>{var me=ma();me.__click=[ua,v,C];var ke=r(me);He(ke,{class:"h-4 w-4"}),U(()=>me.disabled=e(m)),i(ue,me)};y(pe,ue=>{e(G)&&ue(Me)},!0)}i(O,ae)};y(le,O=>{e(A)&&e(C).roles?.[0]!=="owner"?O(be):O(ge,!1)})}U((O,ae,pe,Me)=>{ye(f,1,`${e(C).name===Le.userName?"bg-accent":"bg-neutral"} text-neutral-content w-12 rounded-full`),te($,O),te(D,`${e(C).name??""} `),te(b,`Membre depuis ${ae??""}`),ye(F,1,`badge ${pe??""} gap-1`),te(_e,` ${Me??""}`)},[()=>e(C).name.split(" ").map(O=>O[0]).join("").toUpperCase().slice(0,2),()=>E(e(C).joinedAt),()=>X(e(j)),()=>Y(e(j))]),i(R,l)}),i(u,k)};y(ve,u=>{a.team.members.length===0?u(S):u(se,!1)})}var Z=n(q,2);Oe(Z,{get isOpen(){return e(s).isOpen},title:"Retirer un membre",get message(){return`Êtes-vous sûr de vouloir retirer ${e(s).memberName??""} de l'équipe ? Cette action est irréversible.`},variant:"warning",confirmLabel:"Retirer",cancelLabel:"Annuler",onConfirm:re,onCancel:()=>t(s,{isOpen:!1,memberId:null,memberName:null},!0)});var de=n(Z,2);Oe(de,{get isOpen(){return e(d)},title:"Quitter l'équipe",message:"Êtes-vous sûr de vouloir quitter cette équipe ? Vous devrez être réinvité pour y revenir.",variant:"warning",confirmLabel:"Quitter",cancelLabel:"Annuler",onConfirm:W,onCancel:()=>t(d,!1)}),i(h,B),qe()}Ee(["click"]);var pa=c(`<div class="alert"><!> Seul·es les admins peuvent modifier les paramètres
      de l'équipe.</div>`),ha=(h,a)=>a.onNameKeydown?.(h),xa=c('<div class="grid grid-cols-2 gap-4"><fieldset class="fieldset"><legend class="fieldset-legend flex items-center gap-1"><!> Département</legend> <label class="input"><input type="text" placeholder="Ex: Île-de-France" maxlength="50"/></label></fieldset> <fieldset class="fieldset"><legend class="fieldset-legend flex items-center gap-1"><!> Ville</legend> <label class="input"><input type="text" placeholder="Ex: Paris" maxlength="50"/></label></fieldset></div>'),ya=c(`<div class="space-y-4"><!> <fieldset class="fieldset"><legend class="fieldset-legend">Nom de l'équipe *</legend> <label class="input"><input type="text" placeholder="Ex: Équipe Marketing"/></label> <span class="fieldset-label text-xs"> </span></fieldset> <fieldset class="fieldset"><legend class="fieldset-legend">Description</legend> <textarea class="textarea w-full" rows="3"></textarea> <span class="fieldset-label text-xs"> </span></fieldset> <!></div>`);function Qe(h,a){Ie(a,!0);let s=ie(a,"name",15),d=ie(a,"description",15),m=ie(a,"location",15,""),_=ie(a,"city",15,""),M=ie(a,"showLocation",3,!1),p=ie(a,"disabled",3,!1),E=ie(a,"nameMaxLength",3,50),v=ie(a,"descriptionMaxLength",3,350),re=s()!=="";var W=ya(),V=r(W);{var X=T=>{var H=pa(),R=r(H);ze(R,{class:"size-4 shrink-0"}),i(T,H)};y(V,T=>{re&&T(X)})}var Y=n(V,2),B=n(r(Y),2),q=r(B);q.__keydown=[ha,a];var ve=n(B,2),S=r(ve),se=n(Y,2),Z=n(r(se),2),de=n(Z,2),u=r(de),k=n(se,2);{var K=T=>{var H=xa(),R=r(H),C=r(R),j=r(C);Ge(j,{class:"h-4 w-4"});var J=n(C,2),A=r(J),G=n(R,2),l=r(G),w=r(l);Je(w,{class:"h-4 w-4"});var o=n(l,2),x=r(o);U(()=>{A.disabled=p(),x.disabled=p()}),xe(A,m),xe(x,_),i(T,H)};y(k,T=>{M()&&T(K)})}U(()=>{Fe(q,"maxlength",E()),q.disabled=p(),te(S,`${s().length??""}/${E()??""} caractères`),Fe(Z,"maxlength",v()),Z.disabled=p(),te(u,`${d().length??""}/${v()??""} caractères`)}),xe(q,s),xe(Z,d),i(h,W),qe()}Ee(["keydown"]);function wa(h){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(h)}function Ma(h,a){h.key==="Enter"&&(h.preventDefault(),a())}var ka=c('<div class="alert alert-error"><!> <span> </span></div>'),Ca=c('<label for="" class="select"><span class="label">Rôle</span> <select class="select"><option class="flex" selected>Membre</option><option>Administrateur</option></select></label>'),Ta=(h,a,s)=>a(s),La=c('<div class="badge badge-primary badge-lg gap-2"><!> <button class="btn btn-circle btn-ghost btn-xs" title="Retirer"><!></button></div>'),Ea=c('<div><div class="mb-2 text-sm font-medium opacity-70"> </div> <div class="flex flex-wrap gap-2"></div></div>'),Ia=c(`<div class="space-y-4"><div class="alert alert-soft alert-info max-md:alert-vertical"><!> <div><p>Envoyez des invitations aux personnes qui font partie de votre cantine.
        Si elles possèdent déjà un compte enka-cookbook, elles pourront
        directement acceder aux événements de l'équipe, sinon, elles recevrons
        un lien pour créer leur compte.</p> <p>Il est aussi possible d'inviter des personnes individuellement à
        participer aux évenements (depuis les pages d'évenements), même si elles
        ne font pas partie de vos équipes.</p></div></div> <!> <!> <div class="rounded-box bg-base-200 flex flex-col gap-2 p-4"><div class="flex flex-wrap gap-2"><label class="input min-w-56 flex-1 gap-2"><!> <input type="email" placeholder="email@example.com"/></label> <!></div> <div>Les administrateur·ices sont seul·es autorisé·es à modifier les
      informations concernant l'équipe et à supprimer des membres.</div> <button class="btn btn-primary btn-sm ml-auto w-fit" title="Ajouter à la liste"><!> Ajouter</button></div> <!> <div><label class="label" for="invite-message"><span class="label-text">Message personnalisé (optionnel)</span></label> <textarea id="invite-message" class="textarea textarea-bordered w-full" placeholder="Ajoutez un message pour les personnes invitées..." rows="3" maxlength="200"></textarea> <span class="label label-text-alt opacity-50"> </span></div></div>`);function We(h,a){Ie(a,!0);let s=ie(a,"invitedEmails",31,()=>Te([])),d=ie(a,"customMessage",15,""),m=ie(a,"loading",3,!1),_=ie(a,"role",15,"member"),M=g(""),p=g(null);const E=ne(()=>Le.isTeamOwner(a.team.$id));function v(){const l=e(M).trim().toLowerCase();if(!l){t(p,"Veuillez entrer une adresse email");return}if(!wa(l)){t(p,"Adresse email invalide");return}if(s().includes(l)){t(p,"Cet email est déjà dans la liste");return}if(a.team.members.some(o=>o.name.toLowerCase()===l||o.userEmail.toLowerCase()===l)){t(p,"Cette personne est déjà membre ou invitée dans l'équipe");return}s().push(l),t(M,""),t(p,null)}function re(l){s(s().filter(w=>w!==l))}var W=Ia(),V=r(W),X=r(V);ze(X,{class:"h-6 w-6 shrink-0"});var Y=n(V,2);y(Y,l=>{});var B=n(Y,2);{var q=l=>{var w=ka(),o=r(w);ea(o,{class:"h-6 w-6 shrink-0"});var x=n(o,2),f=r(x);U(()=>te(f,e(p))),i(l,w)};y(B,l=>{e(p)&&l(q)})}var ve=n(B,2),S=r(ve),se=r(S),Z=r(se);De(Z,{class:"h-4 w-4 opacity-50"});var de=n(Z,2);de.__keydown=[Ma,v];var u=n(se,2);{var k=l=>{var w=Ca(),o=n(r(w),2),x=r(o);x.value=x.__value="member";var f=n(x);f.value=f.__value="owner",sa(o,_),i(l,w)};y(u,l=>{e(E)&&l(k)})}var K=n(S,2),T=n(K,2);T.__click=v;var H=r(T);$e(H,{class:" h-5 w-5"});var R=n(ve,2);{var C=l=>{var w=Ea(),o=r(w),x=r(o),f=n(o,2);Ve(f,20,s,N=>N,(N,$)=>{var z=La(),I=r(z);De(I,{class:"h-3 w-3"});var D=n(I),Q=n(D);Q.__click=[Ta,re,$];var P=r(Q);aa(P,{class:"h-3 w-3"}),U(()=>{te(D,` ${$??""} `),Q.disabled=m()}),i(N,z)}),U(()=>te(x,`Personnes à inviter (${s().length??""})`)),i(l,w)};y(R,l=>{s().length>0&&l(C)})}var j=n(R,2),J=n(r(j),2),A=n(J,2),G=r(A);U(l=>{de.disabled=m(),ye(K,1,`fieldset-label text-xs ${!e(E)&&"hidden"}`),T.disabled=l,J.disabled=m(),te(G,`${d().length??""}/200 caractères`)},[()=>m()||!e(M).trim()]),xe(de,()=>e(M),l=>t(M,l)),xe(J,d),i(h,W),qe()}Ee(["keydown","click"]);async function qa(h,a,s,d,m,_,M,p){if(!(!e(a)||!e(s))){t(d,!0);try{await oe.updateTeam(e(a).$id,e(m).trim()||void 0,{description:e(_).trim()||void 0,location:e(M).trim()||void 0,city:e(p).trim()||void 0}),t(s,!1)}catch(E){console.error("[TeamDetailModal] Erreur sauvegarde:",E),alert("Erreur lors de la sauvegarde")}finally{t(d,!1)}}}async function Ra(h,a,s,d,m,_){if(!(!e(a)||e(s).length===0)){t(d,!0);try{await Be.track(oe.inviteTeamMember(e(a).$id,e(s),e(m)||void 0),{loading:"Envoi des invitations en cours...",success:`${e(s).length} invitation${e(s).length>1?"s":""} envoyée${e(s).length>1?"s":""} avec succès`,error:"Erreur lors de l'envoi des invitations"}),t(s,[],!0),t(m,""),_.teamId&&await oe.fetchTeam(_.teamId)}catch(M){console.error("[TeamDetailModal] Erreur envoi invitations:",M)}finally{t(d,!1)}}}var Aa=(h,a)=>t(a,"members"),Da=(h,a)=>t(a,"invitations"),Pa=(h,a)=>t(a,"settings"),Oa=c('<div class="bg-warning ml-1 h-2 w-2 rounded-full"></div>'),Sa=c('<div><h4 class=" text-sm font-medium opacity-70">Inviter de nouveaux membres</h4> <!></div>'),ja=c('<div class="tabs tabs-border mb-6 flex-none" role="tablist"><button role="tab"><!> Membres <span class="badge badge-sm badge-secondary ml-1"> </span></button> <button role="tab"><!> Invitations</button> <button role="tab"><!> Paramètres <!></button></div> <!>',1),Na=c('<span class="loading loading-spinner loading-sm"></span>'),za=c('<button class="btn btn-ghost">Annuler</button> <button class="btn btn-primary"><!></button>',1),Fa=c('<span class="loading loading-spinner loading-sm"></span>'),Ua=c('<button class="btn btn-ghost">Fermer</button> <button class="btn btn-primary"><!></button>',1),Va=c('<button class="btn btn-ghost">Fermer</button>'),Ba=c("<!> <!> <!>",1),Ka=c("<!> <!>",1);function lt(h,a){Ie(a,!0);let s=ie(a,"initialTab",3,"members"),d=g(Te(s())),m=g(!1),_=g(!1),M=g(Te([])),p=g(""),E=g(!1);const v=ne(()=>a.teamId?oe.getTeamById(a.teamId):null),re=ne(()=>!e(v)||!Le.userId?null:e(v).members.find(k=>k.id===Le.userId)?.roles?.[0]||null),W=ne(()=>e(re)==="owner");let V=g(""),X=g(""),Y=g(""),B=g(""),q=g(!1);Ue(()=>{e(v)&&(t(V,e(v).name,!0),t(X,e(v).prefs?.description||"",!0),t(Y,e(v).prefs?.location||"",!0),t(B,e(v).prefs?.city||"",!0),t(q,!1))}),Ue(()=>{e(v)&&t(q,e(V)!==e(v).name||e(X)!==(e(v).prefs?.description||"")||e(Y)!==(e(v).prefs?.location||"")||e(B)!==(e(v).prefs?.city||""),!0)});async function ve(){if(e(v)){t(_,!0);try{await oe.deleteTeam(e(v).$id),t(m,!1),a.onClose()}catch(u){console.error("[TeamDetailModal] Erreur suppression:",u),alert("Erreur lors de la suppression de l'équipe")}finally{t(_,!1)}}}async function S(){a.teamId&&await oe.fetchTeam(a.teamId)}var se=Ka(),Z=L(se);{let u=ne(()=>a.teamId!==null);Ke(Z,{get isOpen(){return e(u)},get onClose(){return a.onClose},children:(k,K)=>{var T=fe(),H=L(T);{var R=C=>{var j=Ba(),J=L(j);Se(J,{get title(){return e(v).name},get subtitle(){return e(v).description},get onClose(){return a.onClose}});var A=n(J,2);je(A,{children:(l,w)=>{var o=ja(),x=L(o),f=r(x);f.__click=[Aa,d];var N=r(f);Ae(N,{class:"mr-1 h-5 w-5"});var $=n(N,2),z=r($),I=n(f,2);I.__click=[Da,d];var D=r(I);De(D,{class:"mr-1 h-5 w-5"});var Q=n(I,2);Q.__click=[Pa,d];var P=r(Q);ta(P,{class:"mr-1 h-5 w-5"});var ee=n(P,2);{var b=ce=>{var _e=Oa();i(ce,_e)};y(ee,ce=>{e(q)&&ce(b)})}var F=n(x,2);ia(F,()=>e(d),ce=>{var _e=fe(),we=L(_e);{var le=ge=>{ga(ge,{get team(){return e(v)},onMemberRemoved:S})},be=ge=>{var O=fe(),ae=L(O);{var pe=ue=>{var me=Sa(),ke=n(r(me),2);We(ke,{get team(){return e(v)},get loading(){return e(E)},get invitedEmails(){return e(M)},set invitedEmails(Ce){t(M,Ce,!0)},get customMessage(){return e(p)},set customMessage(Ce){t(p,Ce,!0)}}),i(ue,me)},Me=ue=>{var me=fe(),ke=L(me);{var Ce=Re=>{{let Xe=ne(()=>e(_)||!e(W));Qe(Re,{showLocation:!0,get disabled(){return e(Xe)},get name(){return e(V)},set name(he){t(V,he,!0)},get description(){return e(X)},set description(he){t(X,he,!0)},get location(){return e(Y)},set location(he){t(Y,he,!0)},get city(){return e(B)},set city(he){t(B,he,!0)}})}};y(ke,Re=>{e(d)==="settings"&&Re(Ce)},!0)}i(ue,me)};y(ae,ue=>{e(d)==="invitations"?ue(pe):ue(Me,!1)},!0)}i(ge,O)};y(we,ge=>{e(d)==="members"?ge(le):ge(be,!1)})}i(ce,_e)}),U(()=>{ye(f,1,`tab ${e(d)==="members"?"tab-active":""}`),te(z,e(v).members.length),ye(I,1,`tab ${e(d)==="invitations"?"tab-active":""}`),ye(Q,1,`tab ${e(d)==="settings"?"tab-active":""}`)}),i(l,o)}});var G=n(A,2);Ne(G,{children:(l,w)=>{var o=fe(),x=L(o);{var f=$=>{var z=za(),I=L(z);I.__click=function(...b){a.onClose?.apply(this,b)};var D=n(I,2);D.__click=[qa,v,q,_,V,X,Y,B];var Q=r(D);{var P=b=>{var F=Na();i(b,F)},ee=b=>{var F=Pe("Enregistrer");i(b,F)};y(Q,b=>{e(_)?b(P):b(ee,!1)})}U(()=>D.disabled=e(_)||!e(q)),i($,z)},N=$=>{var z=fe(),I=L(z);{var D=P=>{var ee=Ua(),b=L(ee);b.__click=function(...le){a.onClose?.apply(this,le)};var F=n(b,2);F.__click=[Ra,v,M,E,p,a];var ce=r(F);{var _e=le=>{var be=Fa();i(le,be)},we=le=>{var be=Pe();U(()=>te(be,`Envoyer ${e(M).length??""} invitation${e(M).length>1?"s":""}`)),i(le,be)};y(ce,le=>{e(E)?le(_e):le(we,!1)})}U(()=>F.disabled=e(E)||e(M).length===0),i(P,ee)},Q=P=>{var ee=Va();ee.__click=function(...b){a.onClose?.apply(this,b)},i(P,ee)};y(I,P=>{e(d)==="invitations"?P(D):P(Q,!1)},!0)}i($,z)};y(x,$=>{e(d)==="settings"?$(f):$(N,!1)})}i(l,o)}}),i(C,j)};y(H,C=>{e(v)&&C(R)})}i(k,T)},$$slots:{default:!0}})}var de=n(Z,2);Oe(de,{get isOpen(){return e(m)},title:"Supprimer l'équipe",message:"Êtes-vous sûr de vouloir supprimer définitivement cette équipe ? Tous les membres seront retirés et cette action est irréversible.",variant:"danger",confirmLabel:"Supprimer définitivement",cancelLabel:"Annuler",onConfirm:ve,onCancel:()=>t(m,!1)}),i(h,se),qe()}Ee(["click"]);async function Qa(h,a,s,d,m){if(!(!e(a)||e(s).length===0)){t(d,!0);try{await Be.track(oe.inviteTeamMember(e(a),e(s),e(m)||void 0),{loading:"Envoi des invitations en cours...",success:`${e(s).length} invitation${e(s).length>1?"s":""} envoyée${e(s).length>1?"s":""} avec succès`,error:"Erreur lors de l'envoi des invitations"}),t(s,[],!0),t(m,""),e(a)&&await oe.fetchTeam(e(a))}catch(_){console.error("[TeamDetailModal] Erreur envoi invitations:",_)}finally{t(d,!1)}}}function Wa(h,a,s,d){e(a)&&s.onSuccess?.(e(a)),d(),s.onClose()}var Xa=c('<div class="alert alert-error"><span class="text-sm"> </span></div>'),Ya=c('<form class="space-y-4"><!> <!></form>'),Za=c('<span class="loading loading-spinner loading-sm"></span>'),Ha=c(`<button class="btn btn-ghost">Annuler</button> <button class="btn btn-primary"><!> Créer l'équipe</button>`,1),Ga=c("<!> <!> <!>",1),Ja=c('<div class="mb-4"><div class="alert alert-success alert-soft flex flex-col"><p> </p> <p>Ajoutez les email des personnes que vous souhaitez inviter</p></div></div> <!>',1),$a=c('<span class="loading loading-spinner loading-sm"></span>'),et=c('<button class="btn btn-ghost">Passer cette étape</button> <button class="btn btn-primary"><!></button>',1),at=c("<!> <!> <!>",1);function ot(h,a){Ie(a,!0);let s=g(""),d=g(""),m=g(""),_=g(""),M=g(!1),p=g(!1),E=g(null),v=g("create"),re=g(null),W=g(Te([])),V=g(""),X=g(!1);function Y(){t(s,""),t(d,""),t(m,""),t(_,""),t(M,!1),t(E,null),t(v,"create"),t(re,null)}async function B(){if(!e(s).trim()){t(E,"Le nom de l'équipe est requis");return}t(p,!0),t(E,null);try{const S={description:e(d).trim()||void 0,location:e(m).trim()||void 0,city:e(_).trim()||void 0,isPublic:e(M)},se=await oe.createTeam(e(s).trim(),S);t(re,se.$id,!0),t(v,"invite")}catch(S){t(E,S.message||"Erreur lors de la création de l'équipe",!0),console.error("[CreateTeamModal] Erreur:",S)}finally{t(p,!1)}}function q(){Y(),a.onClose()}function ve(S){S.key==="Enter"&&e(v)==="create"&&(S.preventDefault(),B())}Ke(h,{get isOpen(){return a.isOpen},onClose:q,children:(S,se)=>{var Z=fe(),de=L(Z);{var u=K=>{var T=Ga(),H=L(T);Se(H,{title:"Créer une équipe",onClose:q});var R=n(H,2);je(R,{children:(j,J)=>{var A=Ya(),G=r(A);Qe(G,{showLocation:!0,get disabled(){return e(p)},onNameKeydown:ve,get name(){return e(s)},set name(o){t(s,o,!0)},get description(){return e(d)},set description(o){t(d,o,!0)},get location(){return e(m)},set location(o){t(m,o,!0)},get city(){return e(_)},set city(o){t(_,o,!0)}});var l=n(G,2);{var w=o=>{var x=Xa(),f=r(x),N=r(f);U(()=>te(N,e(E))),i(o,x)};y(l,o=>{e(E)&&o(w)})}la("submit",A,o=>o.preventDefault()),i(j,A)}});var C=n(R,2);Ne(C,{children:(j,J)=>{var A=Ha(),G=L(A);G.__click=q;var l=n(G,2);l.__click=B;var w=r(l);{var o=f=>{var N=Za();i(f,N)},x=f=>{ra(f,{class:"h-5 w-5"})};y(w,f=>{e(p)?f(o):f(x,!1)})}U(f=>{G.disabled=e(p),l.disabled=f},[()=>e(p)||!e(s).trim()]),i(j,A)}}),i(K,T)},k=K=>{var T=fe(),H=L(T);{var R=C=>{const j=ne(()=>oe.getTeamById(e(re)));var J=fe(),A=L(J);{var G=l=>{var w=at(),o=L(w);Se(o,{title:"Inviter des membres",onClose:q});var x=n(o,2);je(x,{children:(N,$)=>{var z=Ja(),I=L(z),D=r(I),Q=r(D),P=r(Q),ee=n(I,2);We(ee,{get team(){return e(j)},get loading(){return e(X)},get invitedEmails(){return e(W)},set invitedEmails(b){t(W,b,!0)},get customMessage(){return e(V)},set customMessage(b){t(V,b,!0)}}),U(()=>te(P,`Équipe "${e(j).name??""}" créée avec succès !`)),i(N,z)}});var f=n(x,2);Ne(f,{children:(N,$)=>{var z=et(),I=L(z);I.__click=[Wa,re,a,Y];var D=n(I,2);D.__click=[Qa,re,W,X,V];var Q=r(D);{var P=b=>{var F=$a();i(b,F)},ee=b=>{var F=Pe();U(()=>te(F,`Envoyer ${e(W).length??""} invitation${e(W).length>1?"s":""}`)),i(b,F)};y(Q,b=>{e(X)?b(P):b(ee,!1)})}U(()=>D.disabled=e(X)||e(W).length===0),i(N,z)}}),i(l,w)};y(A,l=>{e(j)&&l(G)})}i(C,J)};y(H,C=>{e(v)==="invite"&&e(re)&&C(R)},!0)}i(K,T)};y(de,K=>{e(v)==="create"?K(u):K(k,!1)})}i(S,Z)},$$slots:{default:!0}}),qe()}Ee(["click"]);export{ot as C,lt as T};
