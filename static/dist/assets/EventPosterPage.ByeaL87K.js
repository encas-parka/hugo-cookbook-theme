import{Z as qe,x as Ce,j as Ae,W as p,E as re,B as o,A as n,ak as ve,v as l,$ as A,a1 as Se,C as Re,D as pe,g as t,aw as st,s as Y,o as me,a as _,X as J,_ as $,Y as ne,z as Ie,u as q,w as ze,ax as lt,aj as ct,p as ge,ao as ft,ag as Ge,a0 as We,av as be,a2 as dt,a3 as ut,S as Pe,b as Xe,a9 as vt,aa as gt,ab as it,c as $e}from"./vendor.B7h_mkEd.js";import{z as Ve,e as ke,y as bt,a as se}from"./appwrite.5W8SCupm.js";import{E as _t}from"./EventInvitationAlert.CCrCOxXJ.js";import{F as Ee}from"./Fieldset.Dv39p1Lh.js";import{C as mt}from"./ConfirmModal.DRp-kO_g.js";import{P as pt,a2 as ht,K as yt,T as xt,r as et,G as kt,I as wt,D as tt,aN as at,aO as rt,aP as Dt,as as Rt,Z as Et,Q as St}from"./icons.DKN5kzXq.js";import{n as nt}from"./index.BUL8Pmq2.js";import{L as It}from"./LeftPanel.CojHg0lY.js";import"./editor.L4rklAfR.js";import"./markdown.BkFahWn2.js";function Ct(h,e,a){_(e,!1),a.onSave?.()}function zt(h,e,a,d){if(e().length>=3){_(a,!0);return}d.onCreateVersion?.()}var Bt=p('<div class="flex flex-wrap gap-x-4 gap-y-1"><label class="label cursor-pointer justify-start gap-3"><input type="checkbox" class="checkbox checkbox-primary"/> <span class="label-text">Date</span></label> <label class="label cursor-pointer justify-start gap-3"><input type="checkbox" class="checkbox checkbox-primary"/> <span class="label-text">Horaire</span></label> <label class="label cursor-pointer justify-start gap-3"><input type="checkbox" class="checkbox checkbox-primary"/> <span class="label-text">Description</span></label> <label class="label cursor-pointer justify-start gap-3"><input type="checkbox" class="checkbox checkbox-primary"/> <span class="label-text">Catégories</span></label></div> <fieldset class="fieldset my-2"><div class="flex flex-wrap gap-x-4 gap-y-1"><label class="label cursor-pointer justify-start gap-3"><input type="checkbox" class="checkbox checkbox-primary"/> <span class="label-text">Régimes</span></label> <label class="label cursor-pointer justify-start gap-3"><input type="checkbox" class="checkbox checkbox-primary"/> <span class="label-text">Allergènes</span></label> <label class="label cursor-pointer justify-start gap-3"><input type="checkbox" class="checkbox checkbox-primary"/> <span class="label-text">Liste Ingrédients</span></label></div></fieldset>',1),Tt=p('<div><label class="label cursor-pointer justify-start gap-3"><input type="checkbox" class="checkbox checkbox-primary"/> <span class="label-text">Date en haut de chaque page</span></label></div>'),At=p('<div class="mb-4"><label class="label cursor-pointer justify-start gap-3"><input type="checkbox" class="checkbox checkbox-primary"/> <span class="label-text text-wrap">Nouvelle page par catégorie (entrée/plat/dessert)</span></label></div> <!> <div><label class="label cursor-pointer justify-start gap-3"><input type="checkbox" class="checkbox checkbox-primary"/> <span class="label-text">Centrer le contenu sur la page</span></label></div>',1),Pt=p('<fieldset class="fieldset w-full"><legend class="fieldset-legend text-xs opacity-60">Message en haut de chaque fiche</legend> <label class="input input-sm w-full"><input type="text" class="grow" placeholder="Ajouter un message en haut..."/></label></fieldset> <fieldset class="fieldset w-full"><legend class="fieldset-legend text-xs opacity-60">Message en bas de chaque fiche</legend> <label class="input input-sm w-full"><input type="text" class="grow" placeholder="Ajouter un message en bas..."/></label></fieldset>',1),Vt=(h,e,a)=>e(e()[a()]=!e()[a()],!0),qt=(h,e,a)=>e(e()[a()]=!e()[a()],!0),jt=(h,e,a)=>e(e()[a()]=Math.max(0,e()[a()]-1),!0),Ht=p("<div></div>"),Ut=(h,e,a)=>e(e()[a()]=Math.min(3,e()[a()]+1),!0),Mt=p('<div class="border-base-content/5 bg-base-200/30 rounded-xl border p-3"><div class="mb-2 flex items-center justify-between"><span class="text-xs font-bold uppercase opacity-60"> </span> <div class="flex items-center gap-1"><div class="mr-2 flex gap-0.5"><button title="Gras"><!></button> <button title="Italique"><!></button></div> <button class="btn btn-ghost btn-xs btn-square font-bold">A-</button> <div class="flex gap-0.5"></div> <button class="btn btn-ghost btn-xs btn-square font-bold">A+</button></div></div> <select class="select select-sm select-bordered w-full"><option>Montserrat (Standard)</option><option>Playfair (Élégant)</option><option>Oswald (Bistro/Impact)</option><option>Quicksand (Moderne)</option><option>Fira Sans (Clean)</option><option>Dancing Script (Cursive)</option><option>Pacifico (Script)</option><option>Caveat (Manuscrit)</option><option>Gluten (Funky)</option></select></div>'),Ft=p('<div class="space-y-4"><!> <!> <!> <!> <!> <!> <!> <!> <!> <!></div>'),Lt=p('<div class="text-base-content/50 py-2 text-center text-sm italic">Aucune version archivée</div>'),Nt=(h,e,a)=>e.onLoadVersion?.(t(a)),Ot=(h,e,a)=>_(e,t(a).id,!0),Kt=p('<div><div class="flex flex-col"><span class="text-sm font-medium"> </span> <span class="text-base-content/50 flex items-center gap-1 text-xs"><!> </span></div> <div class="flex gap-2"><button class="btn btn-ghost btn-xs btn-square" title="Charger cette version"><!></button> <button class="btn btn-ghost text-error btn-xs btn-square" title="Supprimer"><!></button></div></div>'),Qt=p('<div class="space-y-4"><div class="max-h-60 space-y-2 overflow-y-auto pr-1"><!></div> <button class="btn btn-outline btn-block gap-2 border-dashed"><!> Créer une nouvelle version</button> <p class="text-center text-[10px] opacity-40">Maximum 3 versions sauvegardées</p></div>'),Zt=(h,e)=>_(e,!0),Gt=(h,e)=>_(e,!1),Wt=(h,e)=>_(e,!1),Xt=p(`<div class="modal modal-open"><div class="modal-box"><h3 class="text-warning flex items-center gap-2 text-lg font-bold"><!> Limite atteinte</h3> <p class="py-4">Vous avez atteint la limite de <strong>3 versions sauvegardées</strong>.</p> <p class="mb-4 text-sm opacity-80">Veuillez supprimer une version existante avant d'en créer une nouvelle.</p> <div class="modal-action"><button class="btn">Fermer</button></div></div> <button class="modal-backdrop">close</button></div>`),Yt=(h,e)=>_(e,!1),Jt=(h,e)=>_(e,!1),$t=p(`<div class="modal modal-open"><div class="modal-box border-warning/20 border"><div class="text-warning mb-4 flex items-center gap-3"><!> <h3 class="text-lg font-bold">Sauvegarde locale</h3></div> <p class="py-4">Cette configuration sera enregistrée <strong>uniquement sur ce navigateur</strong>.</p> <div class="bg-warning/5 border-warning/10 space-y-2 rounded-lg border p-4 text-sm"><p>⚠️ <strong>Attention :</strong></p> <ul class="list-disc pl-5 opacity-80"><li>Elle ne sera pas visible sur vos autres appareils.</li> <li>Elle sera perdue si vous videz le cache ou les données du site dans
            votre navigateur.</li></ul></div> <div class="modal-action"><button class="btn btn-ghost">Annuler</button> <button class="btn btn-warning gap-2"><!> Confirmer la sauvegarde</button></div></div> <button class="modal-backdrop" aria-label="Fermer">close</button></div>`),ea=p(`<div class="bg-base-200 h-full w-full space-y-6 pt-10 sm:pt-16"><!> <!> <!> <!> <!> <div class="px-4 pb-10"><button class="btn btn-primary btn-block gap-2 shadow-lg"><!> Sauvegarder l'état actuel</button> <p class="mt-2 text-center text-[10px] opacity-40">Mémoire locale uniquement</p></div></div> <!> <!> <!>`,1);function ta(h,e){Ce(e,!0);let a=Ae(e,"config",15),d=Ae(e,"versions",19,()=>[]),K=Ae(e,"activeVersionId",3,null);Ae(e,"disabled",3,!1);let H=Y(!1),I=Y(!1),C=Y(null);var j=ea(),Q=re(j),oe=n(Q);Ee(oe,{legend:"Éléments à afficher",children:(y,z)=>{var w=Bt(),B=re(w),F=n(B),U=n(F),P=o(F,2),M=n(P),L=o(P,2),V=n(L),O=o(L,2),T=n(O),N=o(B,2),R=n(N),i=n(R),r=n(i),u=o(i,2),s=n(u),m=o(u,2),v=n(m);ve(U,()=>a().showDate,c=>a(a().showDate=c,!0)),ve(M,()=>a().showHoraire,c=>a(a().showHoraire=c,!0)),ve(V,()=>a().showDescription,c=>a(a().showDescription=c,!0)),ve(T,()=>a().showCategories,c=>a(a().showCategories=c,!0)),ve(r,()=>a().showRegimes,c=>a(a().showRegimes=c,!0)),ve(s,()=>a().showAllergens,c=>a(a().showAllergens=c,!0)),ve(v,()=>a().showIngredients,c=>a(a().showIngredients=c,!0)),l(y,w)},$$slots:{default:!0}});var Z=o(oe,2);Ee(Z,{legend:"Options d'impression",children:(y,z)=>{var w=At(),B=re(w),F=n(B),U=n(F),P=o(B,2);{var M=T=>{var N=Tt(),R=n(N),i=n(R);ve(i,()=>a().dateByPageBreak,r=>a(a().dateByPageBreak=r,!0)),l(T,N)};A(P,T=>{a().catPageBreak&&T(M)})}var L=o(P,2),V=n(L),O=n(V);ve(U,()=>a().catPageBreak,T=>a(a().catPageBreak=T,!0)),ve(O,()=>a().centerVertical,T=>a(a().centerVertical=T,!0)),l(y,w)},$$slots:{default:!0}});var de=o(Z,2);Ee(de,{legend:"Messages personnalisés",children:(y,z)=>{var w=Pt(),B=re(w),F=o(n(B),2),U=n(F),P=o(B,2),M=o(n(P),2),L=n(M);Se(U,()=>a().messageTop,V=>a(a().messageTop=V,!0)),Se(L,()=>a().messageBottom,V=>a(a().messageBottom=V,!0)),l(y,w)},$$slots:{default:!0}});var le=o(de,2);Ee(le,{legend:"Personnalisation des textes",children:(y,z)=>{var w=Ft();{const R=(i,r=Re,u=Re,s=Re,m=Re,v=Re,c)=>{let k=st(()=>lt(c?.(),!0));var g=pe(),b=re(g);{var f=x=>{var W=Mt(),ee=n(W),te=n(ee),_e=n(te),ye=o(te,2),X=n(ye),ae=n(X);ae.__click=[Vt,a,m];var we=n(ae);kt(we,{class:"size-3"});var xe=o(ae,2);xe.__click=[qt,a,v];var je=n(xe);wt(je,{class:"size-3"});var De=o(X,2);De.__click=[jt,a,s];var He=o(De,2);me(He,20,()=>[0,1,2,3],Ie,(Ze,ot)=>{var Je=Ht();J(()=>$(Je,1,`h-1 w-2 rounded-full transition-colors ${a()[s()]>=ot?"bg-secondary":"bg-base-content/10"}`)),l(Ze,Je)});var Be=o(He,2);Be.__click=[Ut,a,s];var Te=o(ee,2),Ue=n(Te);Ue.value=Ue.__value="montserrat-font";var Me=o(Ue);Me.value=Me.__value="playfair-display";var Fe=o(Me);Fe.value=Fe.__value="oswald-font";var Le=o(Fe);Le.value=Le.__value="quicksand-font";var Ne=o(Le);Ne.value=Ne.__value="fira-sans";var Oe=o(Ne);Oe.value=Oe.__value="dancing-script";var Ke=o(Oe);Ke.value=Ke.__value="pacifico-regular";var Qe=o(Ke);Qe.value=Qe.__value="caveat-font";var Ye=o(Qe);Ye.value=Ye.__value="gluten-font",J(()=>{ne(_e,r()),$(ae,1,`btn btn-xs btn-square ${(a()[m()]&&"btn-secondary")??""}`),$(xe,1,`btn btn-xs btn-square ${(a()[v()]&&"btn-secondary")??""}`),De.disabled=a()[s()]===0,Be.disabled=a()[s()]===3}),ct(Te,()=>a()[u()],Ze=>a(a()[u()]=Ze,!0)),l(x,W)};A(b,x=>{t(k)&&x(f)})}l(i,g)};var B=n(w);R(B,()=>"Date",()=>"fontDate",()=>"fontSizeDate",()=>"boldDate",()=>"italicDate",()=>a().showDate);var F=o(B,2);R(F,()=>"Horaire",()=>"fontHoraire",()=>"fontSizeHoraire",()=>"boldHoraire",()=>"italicHoraire",()=>a().showHoraire);var U=o(F,2);R(U,()=>"Catégories",()=>"fontCat",()=>"fontSizeCat",()=>"boldCat",()=>"italicCat",()=>a().showCategories);var P=o(U,2);R(P,()=>"Titre Recettes",()=>"fontRecettes",()=>"fontSizeRecettes",()=>"boldRecettes",()=>"italicRecettes",()=>!0);var M=o(P,2);R(M,()=>"Description",()=>"fontDesc",()=>"fontSizeDesc",()=>"boldDesc",()=>"italicDesc",()=>a().showDescription);var L=o(M,2);R(L,()=>"Régimes",()=>"fontRegimes",()=>"fontSizeRegimes",()=>"boldRegimes",()=>"italicRegimes",()=>a().showRegimes);var V=o(L,2);R(V,()=>"Ingrédients",()=>"fontIng",()=>"fontSizeIng",()=>"boldIng",()=>"italicIng",()=>a().showIngredients);var O=o(V,2);R(O,()=>"Allergènes",()=>"fontAlert",()=>"fontSizeAlert",()=>"boldAlert",()=>"italicAlert",()=>a().showAllergens);var T=o(O,2);R(T,()=>"Message Haut",()=>"fontTop",()=>"fontSizeTop",()=>"boldTop",()=>"italicTop",()=>!!a().messageTop);var N=o(T,2);R(N,()=>"Message Bas",()=>"fontBottom",()=>"fontSizeBottom",()=>"boldBottom",()=>"italicBottom",()=>!!a().messageBottom)}l(y,w)},$$slots:{default:!0}});var ie=o(le,2);Ee(ie,{legend:"Mes Versions",children:(y,z)=>{var w=Qt(),B=n(w),F=n(B);{var U=V=>{var O=Lt();l(V,O)},P=V=>{var O=pe(),T=re(O);me(T,17,d,Ie,(N,R)=>{var i=Kt(),r=n(i),u=n(r),s=n(u),m=o(u,2),v=n(m);ht(v,{class:"size-3"});var c=o(v),k=o(r,2),g=n(k);g.__click=[Nt,e,R];var b=n(g);yt(b,{class:"size-4"});var f=o(g,2);f.__click=[Ot,C,R];var x=n(f);xt(x,{class:"size-4"}),J(W=>{$(i,1,`flex items-center justify-between rounded-lg border p-3 transition-all ${K()===t(R).id?"bg-secondary/30 border-secondary/30":"bg-base-100/50 hover:bg-base-100 hover:border-base-300 border-transparent"}`),ne(s,t(R).name),ne(c,` ${W??""}`)},[()=>new Date(t(R).createdAt).toLocaleDateString()]),l(N,i)}),l(V,O)};A(F,V=>{d().length===0?V(U):V(P,!1)})}var M=o(B,2);M.__click=[zt,d,I,e];var L=n(M);pt(L,{class:"size-4"}),l(y,w)},$$slots:{default:!0}});var ue=o(ie,2),ce=n(ue);ce.__click=[Zt,H];var he=n(ce);et(he,{class:"size-5"});var fe=o(Q,2);{var E=y=>{var z=Xt(),w=n(z),B=n(w),F=n(B);tt(F,{class:"size-6"});var U=o(B,6),P=n(U);P.__click=[Gt,I];var M=o(w,2);M.__click=[Wt,I],l(y,z)};A(fe,y=>{t(I)&&y(E)})}var S=o(fe,2);{let y=q(()=>!!t(C));mt(S,{title:"Supprimer la version",message:"Êtes-vous sûr de vouloir supprimer cette version ? Cette action est irréversible.",variant:"danger",confirmLabel:"Supprimer",get isOpen(){return t(y)},onConfirm:()=>{t(C)&&(e.onDeleteVersion?.(t(C)),_(C,null))},onCancel:()=>_(C,null)})}var G=o(S,2);{var D=y=>{var z=$t(),w=n(z),B=n(w),F=n(B);tt(F,{class:"size-8"});var U=o(B,6),P=n(U);P.__click=[Yt,H];var M=o(P,2);M.__click=[Ct,H,e];var L=n(M);et(L,{class:"size-4"});var V=o(w,2);V.__click=[Jt,H],l(y,z)};A(G,y=>{t(H)&&y(D)})}l(h,j),ze()}qe(["click"]);function aa(h,e,a,d){_(e,a.name,!0),a.onStartEdit(a.recipeKey),setTimeout(()=>{t(d)?.focus(),t(d)?.select()},0)}function na(h,e,a,d){h.key==="Enter"?e():h.key==="Escape"&&(_(a,d.name,!0),d.onFinishEdit())}function ia(h,e,a,d,K){_(e,t(a).join(", "),!0),_(d,!0),setTimeout(()=>{t(K)?.focus()},0)}function ra(h,e,a){h.key==="Enter"&&!h.shiftKey?(h.preventDefault(),e()):h.key==="Escape"&&_(a,!1)}function oa(h,e,a,d,K){_(e,t(a),!0),_(d,!0),setTimeout(()=>{t(K)?.focus()},0)}function sa(h,e,a){h.key==="Enter"&&!h.shiftKey?(h.preventDefault(),e()):h.key==="Escape"&&_(a,!1)}var la=(h,e)=>e.onToggle(e.recipeKey),ca=p('<div class="mx-auto mb-2 max-w-sm"><label class="input input-sm w-full"><input type="text" class="grow text-center"/></label></div>'),fa=p('<button type="button"> </button>'),da=p('<div class="mx-auto mt-2 max-w-sm"><textarea class="textarea textarea-bordered textarea-xs w-full text-center" rows="2" placeholder="Ajouter une description..."></textarea></div>'),ua=p('<span class="no-print opacity-50">(Cliquez pour ajouter une description)</span>'),va=(h,e)=>e.onToggleDescription(e.recipeKey),ga=p('<div class="flex items-center justify-center gap-2 px-4"><button type="button"><!></button> <button class="no-print btn btn-ghost btn-circle btn-xs hover:bg-error/10 hover:text-error opacity-0 transition-opacity group-hover/desc:opacity-100" title="Masquer la description"><!></button></div>'),ba=p('<div class="description-container group/desc relative mx-auto max-w-xl text-center"><!></div>'),_a=p("<span> </span>"),ma=p('<div class="mt-3 flex flex-wrap justify-center gap-2"></div>'),pa=p('<div class="text-xs"><span class="text-[0.6rem] font-bold tracking-widest uppercase">Attention:</span> <span> </span></div>'),ha=p(`<div class="mx-auto mt-1 max-w-sm"><textarea class="textarea textarea-bordered textarea-xs w-full text-center" rows="3" placeholder="Liste d'ingrédients séparés par des virgules..."></textarea> <p class="mt-1 text-[0.5rem] tracking-tighter uppercase opacity-50">Entrée pour valider · Maj+Entrée pour nouvelle ligne</p></div>`),ya=p('<button type="button"> </button>'),xa=p('<div class="text-xs"><span class="text-[0.6rem] font-bold tracking-widest uppercase">Ingrédients:</span> <!></div>'),ka=p('<div class="recipe-container mb-6 svelte-ryaxea"><div class="recipe-actions no-print flex gap-1 svelte-ryaxea"><button class="btn btn-ghost btn-circle hover:bg-error/10 hover:text-error transition-colors" title="Masquer la recette"><!></button></div> <div class="recipe-content bg-transparent p-0 text-center"><!> <!> <!> <div class="mt-3 space-y-1 text-black"><!> <!></div></div></div>');function wa(h,e){Ce(e,!0);let a=Y(void 0),d=Y(void 0),K=Y(void 0),H=Y(ge(e.name)),I=Y(!1),C=Y(!1),j=Y(""),Q=Y("");function oe(){e.onUpdateName(e.recipeKey,t(H)),e.onFinishEdit()}function Z(){if(!t(I))return;const D=t(j).split(/[,;\n]/),y=Array.from(new Set(D.map(z=>z.trim()).filter(z=>z.length>0).map(z=>z.toLowerCase().replace(/\b\w/g,w=>w.toUpperCase()))));e.onUpdateIngredients(e.recipeKey,y),_(I,!1)}function de(){t(C)&&(e.onUpdateDescription(e.recipeKey,t(Q).trim()),_(C,!1))}let le=q(()=>e.customDescription??e.recipeData?.description??""),ie=q(()=>e.customIngredients?e.customIngredients:e.recipeData?.ingredients?e.recipeData.ingredients.map(D=>D.name):[]),ue=q(()=>{if(!e.recipeData?.ingredients)return[];const D=new ft;return e.recipeData.ingredients.forEach(y=>{y.allergens?.forEach(z=>D.add(z))}),Array.from(D)}),ce=q(()=>e.recipeData?.regime?e.recipeData.regime:[]);function he(D){return`font-size: ${["1.5rem","2rem","2.5rem","3.2rem"][D]||"2.5rem"}`}function fe(D){return`font-size: ${["0.7rem","0.85rem","1rem","1.2rem"][D]||"1rem"}`}var E=pe(),S=re(E);{var G=D=>{var y=ka(),z=n(y),w=n(z);w.__click=[la,e];var B=n(w);at(B,{});var F=o(z,2),U=n(F);{var P=s=>{var m=ca(),v=n(m),c=n(v);c.__keydown=[na,oe,H,e],Ge(c,k=>_(a,k),()=>t(a)),We("blur",c,oe),Se(c,()=>t(H),k=>_(H,k)),l(s,m)},M=s=>{var m=fa();let v;m.__click=[aa,H,e,a];var c=n(m);J((k,g)=>{v=$(m,1,"recipe-title mb-2 block w-full border-none bg-transparent p-0 text-center text-lg text-black transition-colors hover:bg-black/5 svelte-ryaxea",null,v,k),be(m,g),ne(c,e.name)},[()=>({"cursor-pointer":!e.isEditing,"montserrat-font":e.config.fontRecettes==="montserrat-font","playfair-display":e.config.fontRecettes==="playfair-display","oswald-font":e.config.fontRecettes==="oswald-font","quicksand-font":e.config.fontRecettes==="quicksand-font","fira-sans":e.config.fontRecettes==="fira-sans","dancing-script":e.config.fontRecettes==="dancing-script","pacifico-regular":e.config.fontRecettes==="pacifico-regular","caveat-font":e.config.fontRecettes==="caveat-font","gluten-font":e.config.fontRecettes==="gluten-font","font-bold":e.config.boldRecettes,italic:e.config.italicRecettes}),()=>he(e.config.fontSizeRecettes)]),l(s,m)};A(U,s=>{e.isEditing?s(P):s(M,!1)})}var L=o(U,2);{var V=s=>{var m=ba(),v=n(m);{var c=g=>{var b=da(),f=n(b);f.__keydown=[sa,de,C],Ge(f,x=>_(K,x),()=>t(K)),We("blur",f,de),Se(f,()=>t(Q),x=>_(Q,x)),l(g,b)},k=g=>{var b=ga(),f=n(b);let x;f.__click=[oa,Q,le,C,K];var W=n(f);{var ee=X=>{var ae=dt();J(()=>ne(ae,t(le))),l(X,ae)},te=X=>{var ae=ua();l(X,ae)};A(W,X=>{t(le)?X(ee):X(te,!1)})}var _e=o(f,2);_e.__click=[va,e];var ye=n(_e);at(ye,{class:"h-3 w-3 opacity-50"}),J((X,ae)=>{x=$(f,1,"recipe-description block border-none bg-transparent p-0 text-sm text-black opacity-90 transition-colors hover:bg-black/5 svelte-ryaxea",null,x,X),be(f,ae)},[()=>({"cursor-pointer":!t(C),"montserrat-font":e.config.fontDesc==="montserrat-font","playfair-display":e.config.fontDesc==="playfair-display","oswald-font":e.config.fontDesc==="oswald-font","quicksand-font":e.config.fontDesc==="quicksand-font","fira-sans":e.config.fontDesc==="fira-sans","dancing-script":e.config.fontDesc==="dancing-script","pacifico-regular":e.config.fontDesc==="pacifico-regular","caveat-font":e.config.fontDesc==="caveat-font","gluten-font":e.config.fontDesc==="gluten-font","font-bold":e.config.boldDesc,italic:e.config.italicDesc}),()=>fe(e.config.fontSizeDesc)]),l(g,b)};A(v,g=>{t(C)?g(c):g(k,!1)})}l(s,m)};A(L,s=>{(e.config.showDescription||t(C))&&(e.descriptionVisible||t(C))&&s(V)})}var O=o(L,2);{var T=s=>{var m=ma();me(m,20,()=>t(ce),v=>v,(v,c)=>{var k=_a();let g;var b=n(k);J((f,x)=>{g=$(k,1,`border-black
              bg-transparent
              font-medium
              text-black`,null,g,f),be(k,x),ne(b,c)},[()=>({"montserrat-font":e.config.fontRegimes==="montserrat-font","playfair-display":e.config.fontRegimes==="playfair-display","oswald-font":e.config.fontRegimes==="oswald-font","quicksand-font":e.config.fontRegimes==="quicksand-font","fira-sans":e.config.fontRegimes==="fira-sans","dancing-script":e.config.fontRegimes==="dancing-script","pacifico-regular":e.config.fontRegimes==="pacifico-regular","caveat-font":e.config.fontRegimes==="caveat-font","gluten-font":e.config.fontRegimes==="gluten-font","font-bold":e.config.boldRegimes,italic:e.config.italicRegimes}),()=>fe(e.config.fontSizeRegimes)]),l(v,k)}),l(s,m)};A(O,s=>{e.config.showRegimes&&t(ce).length>0&&s(T)})}var N=o(O,2),R=n(N);{var i=s=>{var m=pa(),v=o(n(m),2);let c;var k=n(v);J((g,b,f)=>{be(v,g),c=$(v,1,"opacity-80",null,c,b),ne(k,f)},[()=>fe(e.config.fontSizeAlert),()=>({"montserrat-font":e.config.fontAlert==="montserrat-font","playfair-display":e.config.fontAlert==="playfair-display","oswald-font":e.config.fontAlert==="oswald-font","quicksand-font":e.config.fontAlert==="quicksand-font","fira-sans":e.config.fontAlert==="fira-sans","dancing-script":e.config.fontAlert==="dancing-script","pacifico-regular":e.config.fontAlert==="pacifico-regular","caveat-font":e.config.fontAlert==="caveat-font","gluten-font":e.config.fontAlert==="gluten-font","font-bold":e.config.boldAlert,italic:e.config.italicAlert}),()=>t(ue).join(", ")]),l(s,m)};A(R,s=>{e.config.showAllergens&&t(ue).length>0&&s(i)})}var r=o(R,2);{var u=s=>{var m=xa(),v=o(n(m),2);{var c=g=>{var b=ha(),f=n(b);f.__keydown=[ra,Z,I],Ge(f,x=>_(d,x),()=>t(d)),We("blur",f,Z),Se(f,()=>t(j),x=>_(j,x)),l(g,b)},k=g=>{var b=ya();let f;b.__click=[ia,j,ie,I,d];var x=n(b);J((W,ee,te)=>{f=$(b,1,"mx-auto block border-none bg-transparent p-0 text-xs font-normal capitalize decoration-dotted opacity-80 transition-colors hover:bg-black/5 hover:underline",null,f,W),be(b,ee),ne(x,te)},[()=>({"cursor-pointer":!t(I),"montserrat-font":e.config.fontIng==="montserrat-font","playfair-display":e.config.fontIng==="playfair-display","oswald-font":e.config.fontIng==="oswald-font","quicksand-font":e.config.fontIng==="quicksand-font","fira-sans":e.config.fontIng==="fira-sans","dancing-script":e.config.fontIng==="dancing-script","pacifico-regular":e.config.fontIng==="pacifico-regular","caveat-font":e.config.fontIng==="caveat-font","gluten-font":e.config.fontIng==="gluten-font","font-bold":e.config.boldIng,italic:e.config.italicIng}),()=>fe(e.config.fontSizeIng),()=>t(ie).join(", ")]),l(g,b)};A(v,g=>{t(I)?g(c):g(k,!1)})}l(s,m)};A(r,s=>{e.config.showIngredients&&(t(ie).length>0||t(I))&&s(u)})}l(D,y)};A(S,D=>{e.visible&&D(G)})}l(h,E),ze()}qe(["click","keydown"]);var Da=p("<div> </div>"),Ra=p("<p> </p>"),Ea=p("<p> </p>"),Sa=p('<div class="separator mx-auto my-6 w-48 border-t border-black opacity-20 svelte-dikxtg"></div>'),Ia=p('<div class="mb-8 text-center"><!> <!> <!></div>'),Ca=p("<h3> </h3>"),za=p('<div class="category-block mb-10 svelte-dikxtg"><!> <div class="recipes-grid avoid-break-inside"></div></div>'),Ba=p("<div> </div>"),Ta=p('<div><div class="group absolute top-4 right-4 print:hidden"><button class="btn btn-circle btn-ghost opacity-20 transition-opacity hover:opacity-100" title="Imprimer cette page"><!></button></div> <div><!> <!> <!> <div><!></div></div></div>'),Aa=(h,e,a)=>e.onToggleRecipe(t(a)),Pa=p('<button class="btn btn-secondary btn-outline flex h-auto max-w-20 flex-col py-3" title="Afficher la recette"><!> <span> </span></button>'),Va=(h,e,a)=>e(t(a)),qa=p('<button class="btn btn-secondary btn-outline flex h-auto flex-col py-3" title="Afficher la description"><!> <span><span class="font-bold italic">Desc:</span> </span></button>'),ja=p("<!> <!>",1),Ha=p('<div class="grid grid-cols-[1fr_auto] items-start gap-4 p-2"><div class="flex flex-col items-end gap-8"></div> <div class="m-auto flex flex-col gap-4 print:hidden"></div></div>');function Ua(h,e){Ce(e,!0);let a=ge({}),d=ge({}),K=ge({});function H(E,S){a[E]=S}function I(E,S){d[E]=S}function C(E){const S=K[E]??!0;K[E]=!S}let j=q(()=>e.date.toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long",year:"numeric"})),Q=q(()=>{const E=new Pe;return e.meals.forEach(S=>{S.recipes.forEach(G=>{const D=G.typeR||"autre";E.has(D)||E.set(D,[]),E.get(D).push({...G,mealId:S.id,guests:S.guests})})}),E}),oe=["entree","plat","dessert"],Z=q(()=>Array.from(t(Q).keys()).sort((S,G)=>{const D=oe.indexOf(S),y=oe.indexOf(G);return D!==-1&&y!==-1?D-y:D!==-1?-1:y!==-1?1:S.localeCompare(G)}));function de(E){return{entree:"Entrée",plat:"Plat",dessert:"Dessert",autre:"Autre"}[E]||E}function le(E){return`font-size: ${["1.5rem","2rem","2.5rem","3.2rem"][E]||"2.5rem"}`}function ie(E){return`font-size: ${["0.7rem","0.85rem","1rem","1.2rem"][E]||"1rem"}`}let ue=q(()=>e.config.catPageBreak?t(Z).map((E,S)=>({categories:[E],isFirst:S===0,isLast:S===t(Z).length-1})):[{categories:t(Z),isFirst:!0,isLast:!0}]);var ce=Ha(),he=n(ce);me(he,21,()=>t(ue),Ie,(E,S,G)=>{var D=Ta();let y;var z=n(D),w=n(z);w.__click=()=>e.onPrintThis(G===0?e.sectionId:`${e.sectionId}-page-${G}`);var B=n(w);rt(B,{class:"h-4 w-4"});var F=o(z,2);let U;var P=n(F);{var M=r=>{var u=Da();let s;var m=n(u);J((v,c)=>{s=$(u,1,"mb-8 text-center",null,s,v),be(u,c),ne(m,e.config.messageTop)},[()=>({"montserrat-font":e.config.fontTop==="montserrat-font","playfair-display":e.config.fontTop==="playfair-display","oswald-font":e.config.fontTop==="oswald-font","quicksand-font":e.config.fontTop==="quicksand-font","fira-sans":e.config.fontTop==="fira-sans","dancing-script":e.config.fontTop==="dancing-script","pacifico-regular":e.config.fontTop==="pacifico-regular","caveat-font":e.config.fontTop==="caveat-font","gluten-font":e.config.fontTop==="gluten-font","font-bold":e.config.boldTop,italic:e.config.italicTop}),()=>ie(e.config.fontSizeTop)]),l(r,u)};A(P,r=>{e.config.messageTop&&(t(S).isFirst||e.config.dateByPageBreak)&&r(M)})}var L=o(P,2);{var V=r=>{var u=Ia(),s=n(u);{var m=b=>{var f=Ra();let x;var W=n(f);J((ee,te)=>{x=$(f,1,"m-0 text-center text-3xl",null,x,ee),be(f,te),ne(W,t(j))},[()=>({"montserrat-font":e.config.fontDate==="montserrat-font","gluten-font":e.config.fontDate==="gluten-font","pacifico-regular":e.config.fontDate==="pacifico-regular","fira-sans":e.config.fontDate==="fira-sans","font-bold":e.config.boldDate,italic:e.config.italicDate}),()=>le(e.config.fontSizeDate)]),l(b,f)};A(s,b=>{e.config.showDate&&b(m)})}var v=o(s,2);{var c=b=>{var f=Ea();let x;var W=n(f);J((ee,te)=>{x=$(f,1,"m-0 text-center text-3xl",null,x,ee),be(f,te),ne(W,e.horaire)},[()=>({"montserrat-font":e.config.fontHoraire==="montserrat-font","playfair-display":e.config.fontHoraire==="playfair-display","oswald-font":e.config.fontHoraire==="oswald-font","quicksand-font":e.config.fontHoraire==="quicksand-font","fira-sans":e.config.fontHoraire==="fira-sans","dancing-script":e.config.fontHoraire==="dancing-script","pacifico-regular":e.config.fontHoraire==="pacifico-regular","caveat-font":e.config.fontHoraire==="caveat-font","gluten-font":e.config.fontHoraire==="gluten-font","font-bold":e.config.boldHoraire,italic:e.config.italicHoraire}),()=>le(e.config.fontSizeHoraire)]),l(b,f)};A(v,b=>{e.config.showHoraire&&b(c)})}var k=o(v,2);{var g=b=>{var f=Sa();l(b,f)};A(k,b=>{(e.config.showHoraire||e.config.showDate)&&b(g)})}l(r,u)};A(L,r=>{(t(S).isFirst||e.config.dateByPageBreak)&&r(V)})}var O=o(L,2);me(O,16,()=>t(S).categories,r=>r,(r,u)=>{var s=za(),m=n(s);{var v=k=>{var g=Ca();let b;var f=n(g);J((x,W,ee)=>{b=$(g,1,"mb-6 text-center text-xl tracking-widest uppercase opacity-60",null,b,x),be(g,W),ne(f,ee)},[()=>({"montserrat-font":e.config.fontCat==="montserrat-font","playfair-display":e.config.fontCat==="playfair-display","oswald-font":e.config.fontCat==="oswald-font","quicksand-font":e.config.fontCat==="quicksand-font","fira-sans":e.config.fontCat==="fira-sans","dancing-script":e.config.fontCat==="dancing-script","pacifico-regular":e.config.fontCat==="pacifico-regular","caveat-font":e.config.fontCat==="caveat-font","gluten-font":e.config.fontCat==="gluten-font","font-bold":e.config.boldCat,italic:e.config.italicCat}),()=>le(e.config.fontSizeCat),()=>de(u)]),l(k,g)};A(m,k=>{e.config.showCategories&&k(v)})}var c=o(m,2);me(c,21,()=>t(Q).get(u)??[],k=>k.recipeUuid,(k,g)=>{const b=q(()=>`${e.dateKey}${e.horaire}_${t(g).recipeUuid}`),f=q(()=>e.recipeVisibility[t(b)]??!0),x=q(()=>e.recipeNames[t(b)]||Ve.getRecipeIndexByUuid(t(g).recipeUuid)?.title||t(g).recipeUuid),W=q(()=>e.recipesDetails.find(X=>X.$id===t(g).recipeUuid)||null),ee=q(()=>K[t(b)]??!0);var te=pe(),_e=re(te);{var ye=X=>{{let ae=q(()=>a[t(b)]||null),we=q(()=>d[t(b)]||null),xe=q(()=>e.editingRecipe===t(b));wa(X,{get recipeKey(){return t(b)},get recipeUuid(){return t(g).recipeUuid},get plates(){return t(g).plates},get typeR(){return t(g).typeR},get category(){return u},get config(){return e.config},get visible(){return t(f)},get name(){return t(x)},get recipeData(){return t(W)},get customIngredients(){return t(ae)},get customDescription(){return t(we)},get descriptionVisible(){return t(ee)},get isEditing(){return t(xe)},get onToggle(){return e.onToggleRecipe},get onStartEdit(){return e.onStartEditRecipe},get onFinishEdit(){return e.onFinishEditRecipe},get onUpdateName(){return e.onUpdateRecipeName},onUpdateIngredients:H,onUpdateDescription:I,onToggleDescription:C})}};A(_e,X=>{t(f)&&X(ye)})}l(k,te)}),l(r,s)});var T=o(O,2);let N;var R=n(T);{var i=r=>{var u=Ba();let s;var m=n(u);J((v,c)=>{s=$(u,1,"text-center opacity-60",null,s,v),be(u,c),ne(m,e.config.messageBottom)},[()=>({"montserrat-font":e.config.fontBottom==="montserrat-font","playfair-display":e.config.fontBottom==="playfair-display","oswald-font":e.config.fontBottom==="oswald-font","quicksand-font":e.config.fontBottom==="quicksand-font","fira-sans":e.config.fontBottom==="fira-sans","dancing-script":e.config.fontBottom==="dancing-script","pacifico-regular":e.config.fontBottom==="pacifico-regular","caveat-font":e.config.fontBottom==="caveat-font","gluten-font":e.config.fontBottom==="gluten-font","font-bold":e.config.boldBottom,italic:e.config.italicBottom}),()=>ie(e.config.fontSizeBottom)]),l(r,u)};A(R,r=>{e.config.messageBottom&&r(i)})}J((r,u,s)=>{ut(D,"id",G===0?e.sectionId:`${e.sectionId}-page-${G}`),y=$(D,1,"meal-poster-section relative bg-white shadow-2xl transition-shadow svelte-dikxtg",null,y,r),U=$(F,1,"poster-content text-black svelte-dikxtg",null,U,u),N=$(T,1,"pt-8",null,N,s)},[()=>({"is-printing-target":e.sectionsToPrint[G===0?e.sectionId:`${e.sectionId}-page-${G}`],"page-break-after":!t(S).isLast}),()=>({"centered-content":e.config.centerVertical}),()=>({"mt-auto":!e.config.centerVertical})]),l(E,D)});var fe=o(he,2);me(fe,21,()=>t(Z),Ie,(E,S)=>{var G=pe(),D=re(G);me(D,17,()=>t(Q).get(t(S))??[],Ie,(y,z)=>{const w=q(()=>`${e.dateKey}${e.horaire}_${t(z).recipeUuid}`),B=q(()=>e.recipeVisibility[t(w)]??!0),F=q(()=>K[t(w)]??!0),U=q(()=>e.getRecipeName(t(w),Ve.getRecipeIndexByUuid(t(z).recipeUuid)?.title||"Recette"));var P=ja(),M=re(P);{var L=T=>{var N=Pa();N.__click=[Aa,e,w];var R=n(N);Dt(R,{class:"size-5"});var i=o(R,2),r=n(i);J(()=>ne(r,t(U))),l(T,N)};A(M,T=>{t(B)||T(L)})}var V=o(M,2);{var O=T=>{var N=qa();N.__click=[Va,C,w];var R=n(N);Rt(R,{class:"size-5"});var i=o(R,2),r=o(n(i));J(()=>ne(r,` ${t(U)??""}`)),l(T,N)};A(V,T=>{t(B)&&!t(F)&&T(O)})}l(y,P)}),l(E,G)}),l(h,ce),ze()}qe(["click"]);var Ma=p('<div class="space-y-4 print:m-0 print:space-y-0 print:p-0"><!></div>'),Fa=p('<div class="bg-base-200 flex-1 overflow-auto p-4 print:m-0 print:overflow-visible print:p-0"><div class="mx-auto max-w-5xl space-y-8 print:m-0 print:w-full print:max-w-none print:space-y-0"></div></div>');function La(h,e){Ce(e,!0);let a=q(()=>{const H=[];return e.groupedMeals.forEach((I,C)=>{I.forEach((j,Q)=>{H.push({dateKey:C,date:new Date(C),horaire:Q,meals:j})})}),H.sort((I,C)=>I.date.getTime()-C.date.getTime())});var d=Fa(),K=n(d);me(K,21,()=>t(a),H=>H.dateKey+H.horaire,(H,I)=>{const C=q(()=>`affiche${t(I).dateKey}${t(I).horaire}`);var j=Ma(),Q=n(j);Ua(Q,{get sectionId(){return t(C)},get dateKey(){return t(I).dateKey},get date(){return t(I).date},get horaire(){return t(I).horaire},get meals(){return t(I).meals},get config(){return e.config},get sectionsToPrint(){return e.sectionsToPrint},get recipesDetails(){return e.recipesDetails},get recipeVisibility(){return e.recipeVisibility},get recipeNames(){return e.recipeNames},get editingRecipe(){return e.editingRecipe},get onPrintThis(){return e.printThis},get onToggleRecipe(){return e.toggleRecipeVisibility},get onStartEditRecipe(){return e.startEditingRecipe},get onFinishEditRecipe(){return e.finishEditingRecipe},get onUpdateRecipeName(){return e.updateRecipeName},get getRecipeName(){return e.getRecipeName}}),l(H,j)}),l(h,d),ze()}async function Na(h,e){Object.keys(e).forEach(a=>{e[a]=!0}),await it(),setTimeout(()=>{window.print()},500)}var Oa=p('<button class="btn btn-primary gap-2"><!> Imprimer tout</button>'),Ka=p('<div class="flex min-h-[60vh] items-center justify-center"><div class="loading loading-spinner loading-lg text-primary"></div></div>'),Qa=p('<div class="container mx-auto p-4"><div class="alert alert-error"><!> <span> </span></div></div>'),Za=p('<div class="flex min-h-[60vh] items-center justify-center"><div class="alert alert-info alert-vertical"><!> <p class="text-lg">Aucune recette pour le moment</p></div></div>'),Ga=p('<!> <div><div class="mx-auto px-4 py-4"><!></div> <div><!></div></div>',1);function on(h,e){Ce(e,!0);const a=i=>{var r=Oa();r.__click=[Na,Z];var u=n(r);rt(u,{class:"h-5 w-5"}),l(i,r)};let d=q(()=>ke.getEventById(e.params.id)),K=Y(!1),H=Y(null),I=Y(ge([])),C=Y(!1),j=Y(ge({showDate:!0,showHoraire:!0,showDescription:!1,showCategories:!0,showRecipes:!0,showRegimes:!1,showAllergens:!1,showIngredients:!1,catPageBreak:!1,dateByPageBreak:!1,messageTop:"",fontTop:"montserrat-font",fontSizeTop:1,boldTop:!1,italicTop:!1,messageBottom:"",fontBottom:"montserrat-font",fontSizeBottom:1,boldBottom:!1,italicBottom:!1,fontDate:"montserrat-font",fontSizeDate:1,boldDate:!1,italicDate:!1,fontHoraire:"montserrat-font",fontSizeHoraire:1,boldHoraire:!1,italicHoraire:!1,fontCat:"montserrat-font",fontSizeCat:1,boldCat:!1,italicCat:!1,fontRecettes:"pacifico-regular",fontSizeRecettes:2,boldRecettes:!1,italicRecettes:!1,fontDesc:"montserrat-font",fontSizeDesc:1,boldDesc:!1,italicDesc:!1,fontRegimes:"montserrat-font",fontSizeRegimes:1,boldRegimes:!1,italicRegimes:!1,fontAlert:"montserrat-font",fontSizeAlert:1,boldAlert:!1,italicAlert:!1,fontIng:"montserrat-font",fontSizeIng:1,boldIng:!1,italicIng:!1,centerVertical:!0})),Q=Y(ge([])),oe=Y(null),Z=ge({}),de=Y(!1);const le=q(()=>{if(!t(d))return!1;const i=se.userId||"";return t(d).createdBy===i?!0:t(d).contributors?.find(u=>u.id===i)?.status==="accepted"});let ie=ge({}),ue=ge({}),ce=Y(null),he=q(()=>{if(!t(d)?.meals)return new Pe;const i=new Pe;return t(d).meals.forEach(r=>{const u=new Date(r.date),s=u.toISOString().split("T")[0],m=u.getHours(),v=m<12?"Petit-déjeuner":m<14?"Déjeuner":m<18?"Goûter":"Dîner";i.has(s)||i.set(s,new Pe);const c=i.get(s);c.has(v)||c.set(v,[]),c.get(v).push(r)}),i});Xe(()=>{t(d)?.meals&&t(d).meals.forEach(i=>{const r=new Date(i.date),u=r.toISOString().split("T")[0],s=r.getHours(),m=s<12?"Petit-déjeuner":s<14?"Déjeuner":s<18?"Goûter":"Dîner",v=`affiche${u}${m}`;v in Z||(Z[v]=!0)})}),vt(()=>{(async()=>{if(!t(d)){_(K,!0);try{await ke.fetchEvent(e.params.id)}catch(i){_(H,i instanceof Error?i.message:"Erreur de chargement",!0)}finally{_(K,!1)}}await fe()})()});async function fe(){try{const i=await ke.loadPosterConfig(e.params.id);i&&(console.log("[EventPoster] Configuration chargée depuis le cache"),i.current?(_(j,{...t(j),...i.current},!0),_(Q,i.versions||[],!0)):(_(j,{...t(j),...i},!0),_(Q,[],!0)))}catch(i){console.error("[EventPoster] Erreur chargement config cache:",i)}}async function E(){try{await ke.savePosterConfig(e.params.id,$e(t(j))),se.toast.success("Configuration sauvegardée",{details:"Les réglages courants sont enregistrés localement."})}catch(i){console.error("[EventPoster] Erreur sauvegarde config cache:",i),se.toast.error("Erreur de sauvegarde",{details:"Impossible d'enregistrer la configuration localement."})}}async function S(){try{const i=new Date,u=`Version du ${new Intl.DateTimeFormat("fr-FR",{dateStyle:"short",timeStyle:"short"}).format(i)}`,s=await ke.createPosterVersion(e.params.id,$e(t(j)),u);await fe(),s&&_(oe,s.id,!0),se.toast.success("Version créée",{details:"Une nouvelle version de la configuration a été archivée."})}catch(i){console.error("[EventPoster] Erreur création version:",i),se.toast.error("Erreur de création",{details:i.message||"Impossible de créer une nouvelle version."})}}async function G(i){try{await ke.deletePosterVersion(e.params.id,i),_(Q,t(Q).filter(r=>r.id!==i),!0),t(oe)===i&&_(oe,null),se.toast.success("Version supprimée",{details:"La version archivée a été supprimée."})}catch(r){console.error("[EventPoster] Erreur suppression version:",r),se.toast.error("Erreur de suppression",{details:"Impossible de supprimer la version."})}}function D(i){_(j,{...t(j),...i.config},!0),_(oe,i.id,!0),se.toast.info("Version chargée",{details:`La configuration "${i.name}" a été appliquée.`})}Xe(()=>{if(!t(d)||t(K))return;if(!(t(d).meals&&t(d).meals.some(r=>r.recipes&&r.recipes.length>0))){_(C,!1);return}t(I).length===0&&!t(C)&&y().then(()=>{z()})});async function y(){if(!t(d)?.meals)return;const i=t(d).meals.flatMap(r=>r.recipes.map(u=>u.recipeUuid));if(i.length===0){_(C,!1);return}_(C,!0);try{console.log(`[EventPoster] Loading ${i.length} recipes (bulk mode)...`);const r=await Ve.getRecipesByUuidsBulk(i);_(I,Array.from(r.values()).filter(u=>u!==null),!0),console.log(`[EventPoster] Loaded ${t(I).length}/${i.length} recipes in bulk`),console.log("[EventPoster] Recipe IDs:",t(I).map(u=>u.$id))}catch(r){console.error("Erreur lors du chargement des recettes:",r)}finally{_(C,!1)}}function z(){t(d)?.meals&&t(d).meals.forEach(i=>{const r=new Date(i.date),u=r.toISOString().split("T")[0],s=r.getHours(),m=s<12?"Petit-déjeuner":s<14?"Déjeuner":s<18?"Goûter":"Dîner",v=`${u}${m}`;i.recipes.forEach(c=>{const k=`${v}_${c.recipeUuid}`;ie[k]=!0;const g=Ve.getRecipeIndexByUuid(c.recipeUuid);ue[k]=g?.title||c.recipeUuid})})}async function w(i){i in Z||(Z[i]=!0),Object.keys(Z).forEach(r=>{Z[r]=r===i}),await it(),setTimeout(()=>{window.print(),Object.keys(Z).forEach(r=>{Z[r]=!0})},900)}function B(i){ie[i]=!ie[i],ie[i]||console.log("to-implement")}function F(i){_(ce,i,!0)}function U(){_(ce,null)}function P(i,r){ue[i]=r}function M(i,r){return ue[i]||r}function L(){bt(`/dashboard/eventEdit/${e.params.id}`)}async function V(i){if(!(!e.params.id||!se.userId))try{_(de,!0);const r=i?"accepted":"declined";await ke.updateContributorStatus(e.params.id,se.userId,r),se.toast.success(i?"Invitation acceptée":"Invitation déclinée")}catch(r){console.error("Erreur réponse invitation:",r),se.toast.error("Erreur lors de la réponse")}finally{_(de,!1)}}Xe(()=>{t(d)&&nt.setConfig({eventId:e.params.id,title:`Affiches : ${t(d).name}`,backAction:L,actions:a})}),gt(()=>{nt.reset()});var O=pe(),T=re(O);{var N=i=>{var r=Ka();l(i,r)},R=i=>{var r=pe(),u=re(r);{var s=v=>{var c=Qa(),k=n(c),g=n(k);Et(g,{class:"h-6 w-6 shrink-0"});var b=o(g,2),f=n(b);J(()=>ne(f,t(H))),l(v,c)},m=v=>{var c=pe(),k=re(c);{var g=f=>{var x=Za(),W=n(x),ee=n(W);St(ee,{}),l(f,x)},b=f=>{var x=pe(),W=re(x);{var ee=te=>{var _e=Ga(),ye=re(_e);It(ye,{bgClass:"bg-base-200",width:"120",children:(De,He)=>{{let Be=q(()=>!t(le));ta(De,{get versions(){return t(Q)},get activeVersionId(){return t(oe)},onSave:E,onCreateVersion:S,onDeleteVersion:G,onLoadVersion:D,get disabled(){return t(Be)},get config(){return t(j)},set config(Te){_(j,Te,!0)}})}},$$slots:{default:!0}});var X=o(ye,2),ae=n(X),we=n(ae);_t(we,{get currentEvent(){return t(d)},get isBusy(){return t(de)},onRespond:V});var xe=o(ae,2),je=n(xe);La(je,{get event(){return t(d)},get groupedMeals(){return t(he)},get config(){return t(j)},get sectionsToPrint(){return Z},get recipesDetails(){return t(I)},get recipeVisibility(){return ie},get recipeNames(){return ue},get editingRecipe(){return t(ce)},printThis:w,toggleRecipeVisibility:B,startEditingRecipe:F,finishEditingRecipe:U,updateRecipeName:P,getRecipeName:M}),J(()=>{$(X,1,`bg-base-200 min-h-screen print:hidden ${se.isDesktop?"ml-80":""}`),$(xe,1,`print:m-0 print:block print:p-0 ${se.isDesktop?"ml-80":""}`)}),l(te,_e)};A(W,te=>{t(d)&&te(ee)},!0)}l(f,x)};A(k,f=>{!t(d)||t(d).meals&&t(d).meals.length>0&&t(d).meals.every(x=>!x.recipes||x.recipes.length===0)?f(g):f(b,!1)},!0)}l(v,c)};A(u,v=>{t(H)?v(s):v(m,!1)},!0)}l(i,r)};A(T,i=>{t(K)?i(N):i(R,!1)})}l(h,O),ze()}qe(["click"]);export{on as default};
