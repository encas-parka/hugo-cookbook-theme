import{Z as Le,x as Ie,s as g,p as Te,W as c,E,$ as y,A as r,B as n,a,g as e,v as i,w as qe,u as ne,o as Be,ac as He,X as U,_ as ye,Y as ae,D as fe,j as ie,a3 as Fe,a1 as xe,aj as Ye,b as Ue,ap as Ze,a2 as De,a0 as Ge}from"./vendor.B7h_mkEd.js";import{n as oe,a as Ee,t as Ve}from"./appwrite.5W8SCupm.js";import{C as Ae}from"./ConfirmModal.DRp-kO_g.js";import{U as Pe,Q as ze,c as Je,ac as $e,ad as et,M as tt,ae as at,W as Oe,V as rt,af as nt,X as st,a8 as it,P as lt}from"./icons.DKN5kzXq.js";import{M as Ke,a as Se,b as je,c as Ne}from"./index.BUL8Pmq2.js";import"./InfoCollapse.CWSikkxb.js";var ot=c('<div class="py-8 text-center opacity-50"><!> <p class="text-sm">Aucun membre</p></div>'),dt=c('<span class="text-xs opacity-50">(vous)</span>'),vt=(h,t)=>a(t,!0),ct=c(`<button class="btn btn-error btn-sm" title="Quitter l'équipe"><!></button>`),ut=(h,t,s)=>t(e(s).$id,e(s).name),mt=c('<button class="btn btn-error btn-sm" title="Retirer ce membre"><!></button>'),ft=c('<div class="card bg-base-100 border-base-200 border p-4 transition-shadow hover:shadow-md"><div class="flex items-center justify-between gap-4"><div class="flex flex-1 items-center gap-3"><div class="avatar avatar-placeholder"><div><span class="text-lg"> </span></div></div> <div class="flex-1"><div class="font-medium"> <!></div> <div class="text-sm opacity-70"> </div></div></div> <div><!> </div> <div class="flex gap-2"><!></div></div></div>'),_t=c(`<div class="alert"><!> Seul les admins peuvent modifier les parametre
      de l'équipe</div> <div class="space-y-2"></div>`,1),bt=c('<div class="space-y-4"><!></div> <!> <!>',1);function gt(h,t){Ie(t,!0);let s=g(Te({isOpen:!1,memberId:null,memberName:null})),d=g(!1),m=g(!1);const _=ne(()=>Ee.userId),M=ne(()=>()=>e(_)&&t.team.members.find(k=>k.id===e(_))?.roles?.[0]||null),p=ne(()=>e(M)()==="owner");function L(u){return new Date(u).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"})}function v(u,k){a(s,{isOpen:!0,memberId:u,memberName:k},!0)}async function re(){if(e(s).memberId){a(m,!0);try{await oe.removeMember(t.team.$id,e(s).memberId),a(s,{isOpen:!1,memberId:null,memberName:null},!0),t.onMemberRemoved?.()}catch(u){console.error("[TeamMembersList] Erreur suppression:",u),alert("Erreur lors de la suppression du membre")}finally{a(m,!1)}}}async function W(){if(!e(_))return;const u=t.team.members.find(k=>k.id===e(_));if(u){a(m,!0);try{await oe.removeMember(t.team.$id,u.$id),a(d,!1),t.onMemberRemoved?.()}catch(k){console.error("[TeamMembersList] Erreur désinscription:",k),alert("Erreur lors de la désinscription")}finally{a(m,!1)}}}function B(u){return u==="owner"?$e:Pe}function X(u){return u==="owner"?"badge-primary badge-soft":"badge-ghost"}function H(u){return u==="owner"?"Admin":"Membre"}var V=bt(),q=E(V),ve=r(q);{var S=u=>{var k=ot(),K=r(k);Pe(K,{class:"mx-auto mb-2 h-8 w-8"}),i(u,k)},se=u=>{var k=_t(),K=E(k),T=r(K);ze(T,{class:"size-4 shrink-0"});var Z=n(K,2);Be(Z,21,()=>t.team.members.filter(R=>R.confirmed),R=>R.id,(R,C)=>{const j=ne(()=>e(C).roles[0]),J=ne(()=>B(e(j))),D=ne(()=>e(C).id===e(_)),G=ne(()=>e(p)&&!e(D));var l=ft(),w=r(l),o=r(w),x=r(o),f=r(x),N=r(f),$=r(N),z=n(x,2),I=r(z),A=r(I),Q=n(A);{var P=O=>{var te=dt();i(O,te)};y(Q,O=>{e(D)&&O(P)})}var ee=n(I,2),b=r(ee),F=n(o,2),ce=r(F);He(ce,()=>e(J),(O,te)=>{te(O,{class:"h-3 w-3"})});var _e=n(ce),we=n(F,2),le=r(we);{var be=O=>{var te=ct();te.__click=[vt,d];var pe=r(te);Je(pe,{class:"h-4 w-4"}),U(()=>te.disabled=e(m)),i(O,te)},ge=O=>{var te=fe(),pe=E(te);{var Me=ue=>{var me=mt();me.__click=[ut,v,C];var ke=r(me);et(ke,{class:"h-4 w-4"}),U(()=>me.disabled=e(m)),i(ue,me)};y(pe,ue=>{e(G)&&ue(Me)},!0)}i(O,te)};y(le,O=>{e(D)&&e(C).roles?.[0]!=="owner"?O(be):O(ge,!1)})}U((O,te,pe,Me)=>{ye(f,1,`${e(C).name===Ee.userName?"bg-accent":"bg-neutral"} text-neutral-content w-12 rounded-full`),ae($,O),ae(A,`${e(C).name??""} `),ae(b,`Membre depuis ${te??""}`),ye(F,1,`badge ${pe??""} gap-1`),ae(_e,` ${Me??""}`)},[()=>e(C).name.split(" ").map(O=>O[0]).join("").toUpperCase().slice(0,2),()=>L(e(C).joinedAt),()=>X(e(j)),()=>H(e(j))]),i(R,l)}),i(u,k)};y(ve,u=>{t.team.members.length===0?u(S):u(se,!1)})}var Y=n(q,2);Ae(Y,{get isOpen(){return e(s).isOpen},title:"Retirer un membre",get message(){return`Êtes-vous sûr de vouloir retirer ${e(s).memberName??""} de l'équipe ? Cette action est irréversible.`},variant:"warning",confirmLabel:"Retirer",cancelLabel:"Annuler",onConfirm:re,onCancel:()=>a(s,{isOpen:!1,memberId:null,memberName:null},!0)});var de=n(Y,2);Ae(de,{get isOpen(){return e(d)},title:"Quitter l'équipe",message:"Êtes-vous sûr de vouloir quitter cette équipe ? Vous devrez être réinvité pour y revenir.",variant:"warning",confirmLabel:"Quitter",cancelLabel:"Annuler",onConfirm:W,onCancel:()=>a(d,!1)}),i(h,V),qe()}Le(["click"]);var pt=c(`<div class="alert"><!> Seul·es les admins peuvent modifier les paramètres
      de l'équipe.</div>`),ht=(h,t)=>t.onNameKeydown?.(h),xt=c('<div class="grid grid-cols-2 gap-4"><fieldset class="fieldset"><legend class="fieldset-legend flex items-center gap-1"><!> Département</legend> <label class="input"><input type="text" placeholder="Ex: Île-de-France" maxlength="50"/></label></fieldset> <fieldset class="fieldset"><legend class="fieldset-legend flex items-center gap-1"><!> Ville</legend> <label class="input"><input type="text" placeholder="Ex: Paris" maxlength="50"/></label></fieldset></div>'),yt=c(`<div class="space-y-4"><!> <fieldset class="fieldset"><legend class="fieldset-legend">Nom de l'équipe *</legend> <label class="input"><input type="text" placeholder="Ex: Équipe Marketing"/></label> <span class="fieldset-label text-xs"> </span></fieldset> <fieldset class="fieldset"><legend class="fieldset-legend">Description</legend> <textarea class="textarea w-full" rows="3"></textarea> <span class="fieldset-label text-xs"> </span></fieldset> <!></div>`);function Qe(h,t){Ie(t,!0);let s=ie(t,"name",15),d=ie(t,"description",15),m=ie(t,"location",15,""),_=ie(t,"city",15,""),M=ie(t,"showLocation",3,!1),p=ie(t,"disabled",3,!1),L=ie(t,"nameMaxLength",3,50),v=ie(t,"descriptionMaxLength",3,350),re=s()!=="";var W=yt(),B=r(W);{var X=T=>{var Z=pt(),R=r(Z);ze(R,{class:"size-4 shrink-0"}),i(T,Z)};y(B,T=>{re&&T(X)})}var H=n(B,2),V=n(r(H),2),q=r(V);q.__keydown=[ht,t];var ve=n(V,2),S=r(ve),se=n(H,2),Y=n(r(se),2),de=n(Y,2),u=r(de),k=n(se,2);{var K=T=>{var Z=xt(),R=r(Z),C=r(R),j=r(C);tt(j,{class:"h-4 w-4"});var J=n(C,2),D=r(J),G=n(R,2),l=r(G),w=r(l);at(w,{class:"h-4 w-4"});var o=n(l,2),x=r(o);U(()=>{D.disabled=p(),x.disabled=p()}),xe(D,m),xe(x,_),i(T,Z)};y(k,T=>{M()&&T(K)})}U(()=>{Fe(q,"maxlength",L()),q.disabled=p(),ae(S,`${s().length??""}/${L()??""} caractères`),Fe(Y,"maxlength",v()),Y.disabled=p(),ae(u,`${d().length??""}/${v()??""} caractères`)}),xe(q,s),xe(Y,d),i(h,W),qe()}Le(["keydown"]);function wt(h){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(h)}function Mt(h,t){h.key==="Enter"&&(h.preventDefault(),t())}var kt=c('<div class="alert alert-error"><!> <span> </span></div>'),Ct=c('<label for="" class="select"><span class="label">Rôle</span> <select class="select"><option class="flex" selected>Membre</option><option>Administrateur</option></select></label>'),Tt=(h,t,s)=>t(s),Et=c('<div class="badge badge-primary badge-lg gap-2"><!> <button class="btn btn-circle btn-ghost btn-xs" title="Retirer"><!></button></div>'),Lt=c('<div><div class="mb-2 text-sm font-medium opacity-70"> </div> <div class="flex flex-wrap gap-2"></div></div>'),It=c(`<div class="space-y-4"><div class="alert alert-soft alert-info"><!> <div><p>Envoyez des invitations aux personnes qui font partie de votre cantine.
        Si elles possèdent déjà un compte enka-cookbook, elles pourront
        directement acceder aux événements de l'équipe, sinon, elles recevrons
        un lien pour créer leur compte.</p> <p>Il est aussi possible d'inviter des personnes individuellement à
        participer aux évenements (depuis les pages d'évenements), même si elles
        ne font pas partie de vos équipes.</p></div></div> <!> <!> <div class="rounded-box bg-base-200 flex flex-col gap-2 p-4"><div class="flex flex-wrap gap-2"><label class="input min-w-56 flex-1 gap-2"><!> <input type="email" placeholder="email@example.com"/></label> <!></div> <div>Les administrateur·ices sont seul·es autorisé·es à modifier les
      informations concernant l'équipe et à supprimer des membres.</div> <button class="btn btn-primary btn-sm ml-auto w-fit" title="Ajouter à la liste"><!> Ajouter</button></div> <!> <div><label class="label" for="invite-message"><span class="label-text">Message personnalisé (optionnel)</span></label> <textarea id="invite-message" class="textarea textarea-bordered w-full" placeholder="Ajoutez un message pour les personnes invitées..." rows="3" maxlength="200"></textarea> <span class="label label-text-alt opacity-50"> </span></div></div>`);function We(h,t){Ie(t,!0);let s=ie(t,"invitedEmails",31,()=>Te([])),d=ie(t,"customMessage",15,""),m=ie(t,"loading",3,!1),_=ie(t,"role",15,"member"),M=g(""),p=g(null);const L=ne(()=>Ee.isTeamOwner(t.team.$id));function v(){const l=e(M).trim().toLowerCase();if(!l){a(p,"Veuillez entrer une adresse email");return}if(!wt(l)){a(p,"Adresse email invalide");return}if(s().includes(l)){a(p,"Cet email est déjà dans la liste");return}if(t.team.members.some(o=>o.name.toLowerCase()===l||o.userEmail.toLowerCase()===l)){a(p,"Cette personne est déjà membre ou invitée dans l'équipe");return}s().push(l),a(M,""),a(p,null)}function re(l){s(s().filter(w=>w!==l))}var W=It(),B=r(W),X=r(B);ze(X,{class:"h-6 w-6 shrink-0"});var H=n(B,2);y(H,l=>{});var V=n(H,2);{var q=l=>{var w=kt(),o=r(w);nt(o,{class:"h-6 w-6 shrink-0"});var x=n(o,2),f=r(x);U(()=>ae(f,e(p))),i(l,w)};y(V,l=>{e(p)&&l(q)})}var ve=n(V,2),S=r(ve),se=r(S),Y=r(se);Oe(Y,{class:"h-4 w-4 opacity-50"});var de=n(Y,2);de.__keydown=[Mt,v];var u=n(se,2);{var k=l=>{var w=Ct(),o=n(r(w),2),x=r(o);x.value=x.__value="member";var f=n(x);f.value=f.__value="owner",Ye(o,_),i(l,w)};y(u,l=>{e(L)&&l(k)})}var K=n(S,2),T=n(K,2);T.__click=v;var Z=r(T);rt(Z,{class:" h-5 w-5"});var R=n(ve,2);{var C=l=>{var w=Lt(),o=r(w),x=r(o),f=n(o,2);Be(f,20,s,N=>N,(N,$)=>{var z=Et(),I=r(z);Oe(I,{class:"h-3 w-3"});var A=n(I),Q=n(A);Q.__click=[Tt,re,$];var P=r(Q);st(P,{class:"h-3 w-3"}),U(()=>{ae(A,` ${$??""} `),Q.disabled=m()}),i(N,z)}),U(()=>ae(x,`Personnes à inviter (${s().length??""})`)),i(l,w)};y(R,l=>{s().length>0&&l(C)})}var j=n(R,2),J=n(r(j),2),D=n(J,2),G=r(D);U(l=>{de.disabled=m(),ye(K,1,`fieldset-label text-xs ${!e(L)&&"hidden"}`),T.disabled=l,J.disabled=m(),ae(G,`${d().length??""}/200 caractères`)},[()=>m()||!e(M).trim()]),xe(de,()=>e(M),l=>a(M,l)),xe(J,d),i(h,W),qe()}Le(["keydown","click"]);async function qt(h,t,s,d,m,_,M,p){if(!(!e(t)||!e(s))){a(d,!0);try{await oe.updateTeam(e(t).$id,e(m).trim()||void 0,{description:e(_).trim()||void 0,location:e(M).trim()||void 0,city:e(p).trim()||void 0}),a(s,!1)}catch(L){console.error("[TeamDetailModal] Erreur sauvegarde:",L),alert("Erreur lors de la sauvegarde")}finally{a(d,!1)}}}async function Rt(h,t,s,d,m,_){if(!(!e(t)||e(s).length===0)){a(d,!0);try{await Ve.track(oe.inviteTeamMember(e(t).$id,e(s),e(m)||void 0),{loading:"Envoi des invitations en cours...",success:`${e(s).length} invitation${e(s).length>1?"s":""} envoyée${e(s).length>1?"s":""} avec succès`,error:"Erreur lors de l'envoi des invitations"}),a(s,[],!0),a(m,""),_.teamId&&await oe.fetchTeam(_.teamId)}catch(M){console.error("[TeamDetailModal] Erreur envoi invitations:",M)}finally{a(d,!1)}}}var Dt=(h,t)=>a(t,"members"),At=(h,t)=>a(t,"invitations"),Pt=(h,t)=>a(t,"settings"),Ot=c('<div class="bg-warning ml-1 h-2 w-2 rounded-full"></div>'),St=c('<div><h4 class=" text-sm font-medium opacity-70">Inviter de nouveaux membres</h4> <!></div>'),jt=c('<div class="tabs tabs-border mb-6 flex-none" role="tablist"><button role="tab"><!> Membres <span class="badge badge-sm badge-secondary ml-1"> </span></button> <button role="tab"><!> Invitations</button> <button role="tab"><!> Paramètres <!></button></div> <!>',1),Nt=c('<span class="loading loading-spinner loading-sm"></span>'),zt=c('<button class="btn btn-ghost">Annuler</button> <button class="btn btn-primary"><!></button>',1),Ft=c('<span class="loading loading-spinner loading-sm"></span>'),Ut=c('<button class="btn btn-ghost">Fermer</button> <button class="btn btn-primary"><!></button>',1),Bt=c('<button class="btn btn-ghost">Fermer</button>'),Vt=c("<!> <!> <!>",1),Kt=c("<!> <!>",1);function oa(h,t){Ie(t,!0);let s=ie(t,"initialTab",3,"members"),d=g(Te(s())),m=g(!1),_=g(!1),M=g(Te([])),p=g(""),L=g(!1);const v=ne(()=>t.teamId?oe.getTeamById(t.teamId):null),re=ne(()=>!e(v)||!Ee.userId?null:e(v).members.find(k=>k.id===Ee.userId)?.roles?.[0]||null),W=ne(()=>e(re)==="owner");let B=g(""),X=g(""),H=g(""),V=g(""),q=g(!1);Ue(()=>{e(v)&&(a(B,e(v).name,!0),a(X,e(v).prefs?.description||"",!0),a(H,e(v).prefs?.location||"",!0),a(V,e(v).prefs?.city||"",!0),a(q,!1))}),Ue(()=>{e(v)&&a(q,e(B)!==e(v).name||e(X)!==(e(v).prefs?.description||"")||e(H)!==(e(v).prefs?.location||"")||e(V)!==(e(v).prefs?.city||""),!0)});async function ve(){if(e(v)){a(_,!0);try{await oe.deleteTeam(e(v).$id),a(m,!1),t.onClose()}catch(u){console.error("[TeamDetailModal] Erreur suppression:",u),alert("Erreur lors de la suppression de l'équipe")}finally{a(_,!1)}}}async function S(){t.teamId&&await oe.fetchTeam(t.teamId)}var se=Kt(),Y=E(se);{let u=ne(()=>t.teamId!==null);Ke(Y,{get isOpen(){return e(u)},get onClose(){return t.onClose},children:(k,K)=>{var T=fe(),Z=E(T);{var R=C=>{var j=Vt(),J=E(j);Se(J,{get title(){return e(v).name},get subtitle(){return e(v).description},get onClose(){return t.onClose}});var D=n(J,2);je(D,{children:(l,w)=>{var o=jt(),x=E(o),f=r(x);f.__click=[Dt,d];var N=r(f);Pe(N,{class:"mr-1 h-5 w-5"});var $=n(N,2),z=r($),I=n(f,2);I.__click=[At,d];var A=r(I);Oe(A,{class:"mr-1 h-5 w-5"});var Q=n(I,2);Q.__click=[Pt,d];var P=r(Q);it(P,{class:"mr-1 h-5 w-5"});var ee=n(P,2);{var b=ce=>{var _e=Ot();i(ce,_e)};y(ee,ce=>{e(q)&&ce(b)})}var F=n(x,2);Ze(F,()=>e(d),ce=>{var _e=fe(),we=E(_e);{var le=ge=>{gt(ge,{get team(){return e(v)},onMemberRemoved:S})},be=ge=>{var O=fe(),te=E(O);{var pe=ue=>{var me=St(),ke=n(r(me),2);We(ke,{get team(){return e(v)},get loading(){return e(L)},get invitedEmails(){return e(M)},set invitedEmails(Ce){a(M,Ce,!0)},get customMessage(){return e(p)},set customMessage(Ce){a(p,Ce,!0)}}),i(ue,me)},Me=ue=>{var me=fe(),ke=E(me);{var Ce=Re=>{{let Xe=ne(()=>e(_)||!e(W));Qe(Re,{showLocation:!0,get disabled(){return e(Xe)},get name(){return e(B)},set name(he){a(B,he,!0)},get description(){return e(X)},set description(he){a(X,he,!0)},get location(){return e(H)},set location(he){a(H,he,!0)},get city(){return e(V)},set city(he){a(V,he,!0)}})}};y(ke,Re=>{e(d)==="settings"&&Re(Ce)},!0)}i(ue,me)};y(te,ue=>{e(d)==="invitations"?ue(pe):ue(Me,!1)},!0)}i(ge,O)};y(we,ge=>{e(d)==="members"?ge(le):ge(be,!1)})}i(ce,_e)}),U(()=>{ye(f,1,`tab ${e(d)==="members"?"tab-active":""}`),ae(z,e(v).members.length),ye(I,1,`tab ${e(d)==="invitations"?"tab-active":""}`),ye(Q,1,`tab ${e(d)==="settings"?"tab-active":""}`)}),i(l,o)}});var G=n(D,2);Ne(G,{children:(l,w)=>{var o=fe(),x=E(o);{var f=$=>{var z=zt(),I=E(z);I.__click=function(...b){t.onClose?.apply(this,b)};var A=n(I,2);A.__click=[qt,v,q,_,B,X,H,V];var Q=r(A);{var P=b=>{var F=Nt();i(b,F)},ee=b=>{var F=De("Enregistrer");i(b,F)};y(Q,b=>{e(_)?b(P):b(ee,!1)})}U(()=>A.disabled=e(_)||!e(q)),i($,z)},N=$=>{var z=fe(),I=E(z);{var A=P=>{var ee=Ut(),b=E(ee);b.__click=function(...le){t.onClose?.apply(this,le)};var F=n(b,2);F.__click=[Rt,v,M,L,p,t];var ce=r(F);{var _e=le=>{var be=Ft();i(le,be)},we=le=>{var be=De();U(()=>ae(be,`Envoyer ${e(M).length??""} invitation${e(M).length>1?"s":""}`)),i(le,be)};y(ce,le=>{e(L)?le(_e):le(we,!1)})}U(()=>F.disabled=e(L)||e(M).length===0),i(P,ee)},Q=P=>{var ee=Bt();ee.__click=function(...b){t.onClose?.apply(this,b)},i(P,ee)};y(I,P=>{e(d)==="invitations"?P(A):P(Q,!1)},!0)}i($,z)};y(x,$=>{e(d)==="settings"?$(f):$(N,!1)})}i(l,o)}}),i(C,j)};y(Z,C=>{e(v)&&C(R)})}i(k,T)},$$slots:{default:!0}})}var de=n(Y,2);Ae(de,{get isOpen(){return e(m)},title:"Supprimer l'équipe",message:"Êtes-vous sûr de vouloir supprimer définitivement cette équipe ? Tous les membres seront retirés et cette action est irréversible.",variant:"danger",confirmLabel:"Supprimer définitivement",cancelLabel:"Annuler",onConfirm:ve,onCancel:()=>a(m,!1)}),i(h,se),qe()}Le(["click"]);async function Qt(h,t,s,d,m){if(!(!e(t)||e(s).length===0)){a(d,!0);try{await Ve.track(oe.inviteTeamMember(e(t),e(s),e(m)||void 0),{loading:"Envoi des invitations en cours...",success:`${e(s).length} invitation${e(s).length>1?"s":""} envoyée${e(s).length>1?"s":""} avec succès`,error:"Erreur lors de l'envoi des invitations"}),a(s,[],!0),a(m,""),e(t)&&await oe.fetchTeam(e(t))}catch(_){console.error("[TeamDetailModal] Erreur envoi invitations:",_)}finally{a(d,!1)}}}function Wt(h,t,s,d){e(t)&&s.onSuccess?.(e(t)),d(),s.onClose()}var Xt=c('<div class="alert alert-error"><span class="text-sm"> </span></div>'),Ht=c('<form class="space-y-4"><!> <!></form>'),Yt=c('<span class="loading loading-spinner loading-sm"></span>'),Zt=c(`<button class="btn btn-ghost">Annuler</button> <button class="btn btn-primary"><!> Créer l'équipe</button>`,1),Gt=c("<!> <!> <!>",1),Jt=c('<div class="mb-4"><div class="alert alert-success alert-soft flex flex-col"><p> </p> <p>Ajoutez les email des personnes que vous souhaitez inviter</p></div></div> <!>',1),$t=c('<span class="loading loading-spinner loading-sm"></span>'),ea=c('<button class="btn btn-ghost">Passer cette étape</button> <button class="btn btn-primary"><!></button>',1),ta=c("<!> <!> <!>",1);function da(h,t){Ie(t,!0);let s=g(""),d=g(""),m=g(""),_=g(""),M=g(!1),p=g(!1),L=g(null),v=g("create"),re=g(null),W=g(Te([])),B=g(""),X=g(!1);function H(){a(s,""),a(d,""),a(m,""),a(_,""),a(M,!1),a(L,null),a(v,"create"),a(re,null)}async function V(){if(!e(s).trim()){a(L,"Le nom de l'équipe est requis");return}a(p,!0),a(L,null);try{const S={description:e(d).trim()||void 0,location:e(m).trim()||void 0,city:e(_).trim()||void 0,isPublic:e(M)},se=await oe.createTeam(e(s).trim(),S);a(re,se.$id,!0),a(v,"invite")}catch(S){a(L,S.message||"Erreur lors de la création de l'équipe",!0),console.error("[CreateTeamModal] Erreur:",S)}finally{a(p,!1)}}function q(){H(),t.onClose()}function ve(S){S.key==="Enter"&&e(v)==="create"&&(S.preventDefault(),V())}Ke(h,{get isOpen(){return t.isOpen},onClose:q,children:(S,se)=>{var Y=fe(),de=E(Y);{var u=K=>{var T=Gt(),Z=E(T);Se(Z,{title:"Créer une équipe",onClose:q});var R=n(Z,2);je(R,{children:(j,J)=>{var D=Ht(),G=r(D);Qe(G,{showLocation:!0,get disabled(){return e(p)},onNameKeydown:ve,get name(){return e(s)},set name(o){a(s,o,!0)},get description(){return e(d)},set description(o){a(d,o,!0)},get location(){return e(m)},set location(o){a(m,o,!0)},get city(){return e(_)},set city(o){a(_,o,!0)}});var l=n(G,2);{var w=o=>{var x=Xt(),f=r(x),N=r(f);U(()=>ae(N,e(L))),i(o,x)};y(l,o=>{e(L)&&o(w)})}Ge("submit",D,o=>o.preventDefault()),i(j,D)}});var C=n(R,2);Ne(C,{children:(j,J)=>{var D=Zt(),G=E(D);G.__click=q;var l=n(G,2);l.__click=V;var w=r(l);{var o=f=>{var N=Yt();i(f,N)},x=f=>{lt(f,{class:"h-5 w-5"})};y(w,f=>{e(p)?f(o):f(x,!1)})}U(f=>{G.disabled=e(p),l.disabled=f},[()=>e(p)||!e(s).trim()]),i(j,D)}}),i(K,T)},k=K=>{var T=fe(),Z=E(T);{var R=C=>{const j=ne(()=>oe.getTeamById(e(re)));var J=fe(),D=E(J);{var G=l=>{var w=ta(),o=E(w);Se(o,{title:"Inviter des membres",onClose:q});var x=n(o,2);je(x,{children:(N,$)=>{var z=Jt(),I=E(z),A=r(I),Q=r(A),P=r(Q),ee=n(I,2);We(ee,{get team(){return e(j)},get loading(){return e(X)},get invitedEmails(){return e(W)},set invitedEmails(b){a(W,b,!0)},get customMessage(){return e(B)},set customMessage(b){a(B,b,!0)}}),U(()=>ae(P,`Équipe "${e(j).name??""}" créée avec succès !`)),i(N,z)}});var f=n(x,2);Ne(f,{children:(N,$)=>{var z=ea(),I=E(z);I.__click=[Wt,re,t,H];var A=n(I,2);A.__click=[Qt,re,W,X,B];var Q=r(A);{var P=b=>{var F=$t();i(b,F)},ee=b=>{var F=De();U(()=>ae(F,`Envoyer ${e(W).length??""} invitation${e(W).length>1?"s":""}`)),i(b,F)};y(Q,b=>{e(X)?b(P):b(ee,!1)})}U(()=>A.disabled=e(X)||e(W).length===0),i(N,z)}}),i(l,w)};y(D,l=>{e(j)&&l(G)})}i(C,J)};y(Z,C=>{e(v)==="invite"&&e(re)&&C(R)},!0)}i(K,T)};y(de,K=>{e(v)==="create"?K(u):K(k,!1)})}i(S,Y)},$$slots:{default:!0}}),qe()}Le(["click"]);export{da as C,oa as T};
