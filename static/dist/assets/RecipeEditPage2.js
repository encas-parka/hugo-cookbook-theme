import{f as Gt,X as Wt,t as ka,B as Mt,u as Kt,v as Xt,g as Ea,w as Aa,l as La,M as Sa,x as qa,y as Ia,z as Ra,D as Yt,P as bt,T as Zt,S as Ca,G as za,I as Pa,H as Ta,J as ja,K as Da,N as Fa,O as Ba,Q as Na,b as Ua,U as Ht,V as Ma,W as Ha,Y as Oa}from"./icons.js";import{Z as Ze,d as Je,p as qe,Y as gt,a1 as Qe,m as e,u as he,q as $,v as g,V as c,a2 as h,g as a,h as s,ao as vt,W as w,_ as B,a7 as Se,a3 as Ye,a4 as De,b as o,c as $e,X as L,e as Oe,i as ut,an as st,j as Ve,k as fe,aw as Qa,ax as Ke,ay as mt,az as ct,aA as Va,aB as Ga,C as Ge,aj as Wa,aa as Jt,aC as Ka,t as Xa,aD as $t,af as Ya,ag as Za,y as it,A as Lt,a5 as Ja,ae as $a,aE as er,a6 as tr,aF as ar,aG as rr,au as sr}from"./appwrite.js";import{r as He}from"./RecipeDataStore.svelte.js";import{g as Ot}from"./products-display.js";import{M as ea,a as ta,b as aa,c as ra,s as ir,f as lr}from"./index.js";import{E as nr,i as or,M as dr}from"./tiptap-markdown.es.js";import{F as cr}from"./Fieldset.js";import{B as vr}from"./BtnGroupCheck.js";function ur(r,t,l,i){e(t)?l():i()}function pr(r,t,l,i,n,v,b,x,y,U,ee,V){if(!t())switch(r.key){case"ArrowDown":r.preventDefault(),e(l)?e(n)<e(v).length-1&&st(n):i();break;case"ArrowUp":r.preventDefault(),e(l)&&e(n)>0&&st(n,-1);break;case"Enter":r.preventDefault(),e(l)&&e(v).length>0?b(e(v)[e(n)]):e(l)||i();break;case"Escape":r.preventDefault(),x(),e(y)?.blur();break;case"Backspace":e(U)===""&&ee().length>0&&(r.preventDefault(),V());break;case"Tab":e(l)&&x();break}}var _r=c('<legend class="fieldset-legend"> </legend>'),fr=(r,t,l)=>t(e(l)),br=c('<button type="button" role="option"><span> </span> <!></button>'),gr=c('<div class="text-base-content/50 px-4 py-2 text-sm">Aucune option disponible</div>'),mr=c('<div id="options-list" class="border-base-300 bg-base-100 absolute z-50 mt-1 max-h-60 w-full overflow-auto rounded-lg border shadow-lg" role="listbox"><!></div>'),hr=(r,t,l)=>t(e(l)),xr=c('<div class="badge badge-lg badge-primary gap-2"><span> </span> <button type="button" class="btn btn-ghost btn-sm hover:bg-primary-focus h-4 min-h-0 w-4 p-0"><!></button></div>'),yr=c('<div class="mt-2 flex flex-wrap gap-2"></div>'),wr=c('<div class="fieldset-label"><span class="fieldset-label-text-alt opacity-70"> </span></div>'),kr=c('<fieldset class="fieldset w-full"><!> <div class="relative"><div id="multi-select"><input type="text" class="w-full bg-transparent outline-none" autocomplete="off" role="combobox" aria-controls="options-list"/></div> <button type="button" class="btn btn-ghost btn-sm absolute top-1/2 right-1 -translate-y-1/2"><!></button> <!></div> <!> <!></fieldset>');function Qt(r,t){Je(t,!0);let l=qe(t,"options",19,()=>[]),i=qe(t,"selected",31,()=>gt([])),n=qe(t,"placeholder",3,"Sélectionnez des options..."),v=qe(t,"disabled",3,!1),b=qe(t,"closeOnSelect",3,!1),x=$(""),y=$(!1),U=$(0),ee=$(void 0),V=$(void 0),se=he(()=>e(x).length>0?l().filter(p=>p.toLowerCase().includes(e(x).toLowerCase())):l());Qe(()=>{e(se).length>0&&e(U)>=e(se).length&&g(U,0)});function ve(p){return i().includes(p)}function oe(p){ve(p)?q(p):pe(p)}function pe(p){i().includes(p)||(i([...i(),p]),t.onChange?.(i())),g(x,""),g(U,0),b()?P():e(V)?.focus()}function q(p){i(i().filter(z=>z!==p)),t.onChange?.(i())}function _(){if(i().length>0&&e(x)===""){const p=i()[i().length-1];q(p)}}function S(){v()||(g(y,!0),g(U,0))}function P(){g(y,!1),g(x,""),g(U,0)}function G(p){e(ee)&&!e(ee).contains(p.target)&&P()}Qe(()=>{if(e(y))return document.addEventListener("mousedown",G),()=>{document.removeEventListener("mousedown",G)}});var ie=kr(),Z=a(ie);{var le=p=>{var z=_r(),F=a(z);w(()=>L(F,t.label)),o(p,z)};h(Z,p=>{t.label&&p(le)})}var te=s(Z,2),W=a(te),D=a(W);D.__keydown=[pr,v,y,S,U,se,oe,P,V,x,i,_],vt(D,p=>g(V,p),()=>e(V));var C=s(W,2);C.__click=[ur,y,P,S];var N=a(C);{let p=he(()=>e(y)?"rotate-180":"");Gt(N,{get class(){return`h-4 w-4 transition-transform ${e(p)??""}`}})}var u=s(C,2);{var m=p=>{var z=mr(),F=a(z);{var K=E=>{var T=Ve(),H=fe(T);Oe(H,17,()=>e(se),ut,(X,O,Y,ge)=>{const xe=he(()=>ve(e(O)));var I=br();Se(I,"id",`option-${Y}`),I.__click=[fr,oe,O];var Fe=a(I),ye=a(Fe),we=s(Fe,2);{var Te=ue=>{ka(ue,{class:"text-success h-4 w-4"})};h(we,ue=>{e(xe)&&ue(Te)})}w(()=>{B(I,1,`hover:bg-base-200 flex w-full items-center justify-between gap-2 px-4 py-2 text-left hover:cursor-pointer ${Y===e(U)?"bg-base-200":""} ${e(xe)?"bg-success/20":""}`),Se(I,"aria-selected",e(xe)),L(ye,e(O))}),Ye("mouseenter",I,()=>g(U,Y,!0)),o(X,I)}),o(E,T)},re=E=>{var T=gr();o(E,T)};h(F,E=>{e(se).length>0?E(K):E(re,!1)})}o(p,z)};h(u,p=>{e(y)&&p(m)})}var k=s(te,2);{var M=p=>{var z=yr();Oe(z,21,i,ut,(F,K)=>{var re=xr(),E=a(re),T=a(E),H=s(E,2);H.__click=[hr,q,K];var X=a(H);Wt(X,{class:"h-3 w-3"}),w(()=>{L(T,e(K)),H.disabled=v(),Se(H,"aria-label",`Supprimer ${e(K)??""}`)}),o(F,re)}),o(p,z)};h(k,p=>{i().length>0&&p(M)})}var ae=s(k,2);{var J=p=>{var z=wr(),F=a(z),K=a(F);w(()=>L(K,t.helpText)),o(p,z)};h(ae,p=>{t.helpText&&p(J)})}vt(ie,p=>g(ee,p),()=>e(ee)),w(()=>{B(W,1,`input flex w-full items-center gap-2 pr-10 ${v()?"input-disabled":""}`),Se(D,"placeholder",n()),D.disabled=v(),Se(D,"aria-expanded",e(y)),Se(D,"aria-activedescendant",e(y)?`option-${e(U)}`:void 0),C.disabled=v(),Se(C,"aria-label",e(y)?"Fermer le menu":"Ouvrir le menu")}),Ye("focus",D,S),De(D,()=>e(x),p=>g(x,p)),o(r,ie),$e()}Ze(["keydown","click"]);var Er=c('<span class="text-error"> </span>'),Ar=(r,t,l)=>{let n=r.target.value.toLowerCase().trim();t(t().versionLabel=`v${e(l)} - ${n}`,!0)},Lr=c('<span class="text-error text-wrap"> </span>'),Sr=c('<fieldset class="fieldset min-w-1/5"><legend class="fieldset-legend">Version</legend> <label class="input input-lg w-full"><span class="badge badge-ghost font-mono"> </span> <span class="px-1 opacity-40">-</span> <input type="text" placeholder="username" maxlength="20" class="grow font-mono text-sm"/></label> <p class="fieldset-label truncate" title="ex: &quot;économique&quot;, &quot;sans fromages&quot;, &quot;plus rapide&quot;...">ex: "économique", "sans fromages", "plus rapide"...</p> <!></fieldset>'),qr=c('<span class="badge badge-secondary badge-lg h-full"> </span>'),Ir=c('<span class="text-error"> </span>'),Rr=c('<span class="text-error"> </span>'),Cr=c('<span class="text-error"> </span>'),zr=c('<div class="fieldset-label"><span class="text-error"> </span></div>'),Pr=c('<div class="fieldset-label"><span class="text-error"> </span></div>'),Tr=c('<div class="fieldset-label"><span class="text-error"> </span></div>'),jr=c('<label class="flex cursor-pointer items-center gap-1"><input type="checkbox" class="checkbox checkbox-sm"/> <span class="text-sm"> </span></label>'),Dr=c('<div class="fieldset-label"><span class="text-error"> </span></div>'),Fr=c('<div class="lg:col-span-1"><!></div>'),Br=(r,t)=>t()&&t(t().check=!0,!0),Nr=(r,t)=>t()&&t(t().check=!1,!0),Ur=c('<div class="fieldset-label"><span class="text-error"> </span></div>'),Mr=c('<p class="text-warning/70">Une recette non testée est forcément conservée en brouillon.</p>'),Hr=c(`<div class="card bg-base-100 shadow-xl"><div class="card-body"><h2 class="card-title mb-4"><!> Informations générales</h2> <div class="flex flex-col gap-4"><div class="flex flex-col gap-x-10 gap-y-2"><div class="flex flex-wrap items-start gap-x-10"><fieldset class="fieldset min-w-3/5 flex-1"><legend class="fieldset-legend">Titre de la recette</legend> <label><!> <input id="recipe-title" type="text" placeholder="Ex: Houmous maison" maxlength="80" aria-describedby="title-help" aria-required="true"/></label> <div class="fieldset-label" id="title-help"><!> <span class="fieldset-label ms-auto italic"> </span></div></fieldset> <!></div> <fieldset class="fieldset flex-1"><legend class="fieldset-legend">Description</legend> <input type="text" name="description" id="description" maxlength="200" placeholder="Brève description de la recette"/> <span class="fieldset-label"><span class="ms-auto italic"> </span> <!></span></fieldset></div> <div class="flex flex-wrap justify-between gap-10"><div class="flex flex-wrap gap-x-10 gap-y-2"><fieldset class="fieldset"><legend class="fieldset-legend">Nombre de couverts</legend> <label><!> <input id="recipe-plate" type="number" min="1" max="80000" aria-describedby="plate-help" aria-required="true"/></label> <div class="fieldset-label" id="plate-help"><span class="italic">Quantités indiquées pour combien ?</span> <!></div></fieldset> <fieldset class="fieldset flex-1"><legend class="fieldset-legend">Description des quantités</legend> <label><!> <input id="recipe-quantite-desc" type="text" placeholder="Ex: '24 parts par gastro'; '2 beignets/personne' ..." maxlength="100"/></label> <div class="fieldset-label"><!> <span class="ms-auto italic"> </span></div></fieldset></div></div> <div class="flex flex-col gap-x-10 gap-y-2 sm:flex-row sm:items-start"><fieldset class="fieldset sm:w-auto"><legend class="fieldset-legend">Type de recette</legend> <label><!> <select id="recipe-type" aria-describedby="type-help"><option disabled selected>Sélectionner un type</option><option>Entrée</option><option>Plat</option><option>Dessert</option><option>Autre</option></select></label> <!></fieldset> <div class="flex-1 sm:max-w-md"><!></div></div> <div class="flex flex-col gap-x-10 gap-y-2 sm:flex-row sm:items-start"><fieldset class="fieldset flex-1 sm:max-w-xs"><legend class="fieldset-legend pe-4"><!> <span>Température de service</span></legend> <label><select id="recipe-servehot"><option disabled selected>--</option><option>Chaud</option><option>Froid</option></select></label> <!></fieldset> <fieldset class="fieldset flex-1 sm:max-w-xs"><legend class="fieldset-legend pe-4"><!> <span>Nécessite une cuisson</span></legend> <label><select id="recipe-cuisson"><option disabled selected>--</option><option>Oui</option><option>Non</option></select></label> <!></fieldset></div> <div class="grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3"><fieldset class="fieldset"><legend class="fieldset-legend">Saisons</legend> <div class="flex flex-wrap gap-2"></div> <div class="fieldset-label italic">Si certains ingrédients ne se trouvent qu'à certaines saisons...</div></fieldset> <fieldset class="fieldset flex-1"><legend class="fieldset-legend">Spécialité</legend> <label><!> <input id="recipe-region" type="text" placeholder="Ex: Basque, Italien" maxlength="50"/></label> <!></fieldset> <!></div> <div id="recipe-check-fieldset"><div class="flex w-full flex-wrap gap-x-6 gap-y-2"><div>Avez-vous testé la recette pour le nombre de couverts indiqué ?</div> <div class="flex gap-4"><label class="flex cursor-pointer items-center gap-2"><input type="radio" name="check" class="radio radio-primary radio-sm"/> <span class="text-sm">Oui</span></label> <label class="flex cursor-pointer items-center gap-2"><input type="radio" name="check" class="radio radio-primary radio-sm"/> <span class="text-sm">Non</span></label></div></div> <!> <label class="flex w-full cursor-pointer gap-3"><input type="checkbox" class="checkbox checkbox-primary checkbox-sm mt-1"/> <div class="flex flex-col"><p class="text-sm font-medium">Brouillon</p> <p class="opacity-70">Les brouillons sont visibles uniquement pour les utilisateur·ices
              inscrite, mais peuvent tout de même être ajoutés à vos événements.
              Le status "brouillon" vous permettra de retrouver facilement les
              recettes que vous n'avez pas finalisé.</p> <!></div></label></div></div></div></div>`);function ki(r,t){Je(t,!0);const l=[];let i=qe(t,"recipe",15);var n=Hr(),v=a(n),b=a(v),x=a(b);Mt(x,{class:"h-5 w-5"});var y=s(b,2),U=a(y),ee=a(U),V=a(ee),se=s(a(V),2),ve=a(se);Mt(ve,{class:"h-4 w-4 opacity-50"});var oe=s(ve,2),pe=s(se,2),q=a(pe);{var _=d=>{var A=Er(),Q=a(A);w(()=>L(Q,t.validationErrors.title)),o(d,A)};h(q,d=>{t.validationErrors.title&&d(_)})}var S=s(q,2),P=a(S),G=s(V,2);{var ie=d=>{var A=Ve(),Q=fe(A);{var ne=je=>{const We=he(()=>i().versionLabel.match(/^v(\d+)/)?parseInt(i().versionLabel.match(/^v(\d+)/)[1]):null);var rt=Ve(),Et=fe(rt);{var ma=At=>{var Dt=Sr(),Ft=s(a(Dt),2),Bt=a(Ft),ha=a(Bt),Nt=s(Bt,4);Nt.__input=[Ar,i,We];var xa=s(Ft,4);{var ya=dt=>{var Ut=Lr(),wa=a(Ut);w(()=>L(wa,t.validationErrors.versionLabel)),o(dt,Ut)};h(xa,dt=>{t.validationErrors.versionLabel&&dt(ya)})}w(dt=>{L(ha,`v${e(We)??""}`),Ga(Nt,dt)},[()=>i().versionLabel.replace(/^v\d+\s*-\s*/,"")]),o(At,Dt)};h(Et,At=>{e(We)&&At(ma)})}o(je,rt)};h(Q,je=>{i().versionLabel&&je(ne)})}o(d,A)},Z=d=>{var A=Ve(),Q=fe(A);{var ne=je=>{var We=qr(),rt=a(We);w(()=>L(rt,i().versionLabel)),o(je,We)};h(Q,je=>{i().versionLabel&&je(ne)},!0)}o(d,A)};h(G,d=>{t.canEdit?d(ie):d(Z,!1)})}var le=s(ee,2),te=s(a(le),2),W=s(te,2),D=a(W),C=a(D),N=s(D,2);{var u=d=>{var A=Ir(),Q=a(A);w(()=>L(Q,t.validationErrors.description)),o(d,A)};h(N,d=>{t.validationErrors.description&&d(u)})}var m=s(U,2),k=a(m),M=a(k),ae=s(a(M),2),J=a(ae);Kt(J,{class:"h-4 w-4 opacity-50"});var p=s(J,2),z=s(ae,2),F=s(a(z),2);{var K=d=>{var A=Rr(),Q=a(A);w(()=>L(Q,t.validationErrors.plate)),o(d,A)};h(F,d=>{t.validationErrors.plate&&d(K)})}var re=s(M,2),E=s(a(re),2),T=a(E);Xt(T,{class:"h-4 w-4 opacity-50"});var H=s(T,2),X=s(E,2),O=a(X);{var Y=d=>{var A=Cr(),Q=a(A);w(()=>L(Q,t.validationErrors.quantite_desc)),o(d,A)};h(O,d=>{t.validationErrors.quantite_desc&&d(Y)})}var ge=s(O,2),xe=a(ge),I=s(m,2),Fe=a(I),ye=s(a(Fe),2),we=a(ye);Ea(we,{class:"h-4 w-4 opacity-50"});var Te=s(we,2),ue=a(Te);ue.value=ue.__value="";var Ie=s(ue),Be={},Re=s(Ie),Ce={},_e=s(Re),de={},be=s(_e),ke={},Ee=s(ye,2);{var me=d=>{var A=zr(),Q=a(A),ne=a(Q);w(()=>L(ne,t.validationErrors.typeR)),o(d,A)};h(Ee,d=>{t.validationErrors.typeR&&d(me)})}var ze=s(Fe,2),Ae=a(ze);{var f=d=>{{let A=he(()=>!t.canEdit);Qt(d,{get options(){return t.recipeInfo.categories},label:"Sous-Catégories",placeholder:"Rechercher une catégorie...",get disabled(){return e(A)},closeOnSelect:!0,get selected(){return i().categories},set selected(Q){i(i().categories=Q,!0)}})}};h(Ae,d=>{t.recipeInfo&&t.recipeInfo.categories&&i().categories&&d(f)})}var R=s(I,2),j=a(R),ce=a(j),Le=a(ce);Aa(Le,{class:"h-4 w-4"});var Ne=s(ce,2),Ue=a(Ne),Me=a(Ue);Me.value=Me.__value="";var Xe=s(Me);Xe.value=Xe.__value=!0;var et=s(Xe);et.value=et.__value=!1;var lt=s(Ne,2);{var nt=d=>{var A=Pr(),Q=a(A),ne=a(Q);w(()=>L(ne,t.validationErrors.serveHot)),o(d,A)};h(lt,d=>{t.validationErrors.serveHot&&d(nt)})}var pt=s(j,2),_t=a(pt),ht=a(_t);La(ht,{class:"h-4 w-4"});var ot=s(_t,2),tt=a(ot),Pe=a(tt);Pe.value=Pe.__value="";var at=s(Pe);at.value=at.__value=!0;var ft=s(at);ft.value=ft.__value=!1;var sa=s(ot,2);{var ia=d=>{var A=Tr(),Q=a(A),ne=a(Q);w(()=>L(ne,t.validationErrors.cuisson)),o(d,A)};h(sa,d=>{t.validationErrors.cuisson&&d(ia)})}var St=s(R,2),qt=a(St),la=s(a(qt),2);Oe(la,20,()=>[{value:"printemps",label:"Printemps"},{value:"ete",label:"Été"},{value:"automne",label:"Automne"},{value:"hiver",label:"Hiver"}],d=>d.value,(d,A)=>{var Q=jr(),ne=a(Q),je,We=s(ne,2),rt=a(We);w(()=>{ne.disabled=!t.canEdit,je!==(je=A.value)&&(ne.value=(ne.__value=A.value)??""),L(rt,A.label)}),Qa(l,[],ne,()=>(A.value,i().saison),Et=>i(i().saison=Et,!0)),o(d,Q)});var It=s(qt,2),xt=s(a(It),2),Rt=a(xt);Sa(Rt,{class:"h-4 w-4 opacity-50"});var Ct=s(Rt,2),na=s(xt,2);{var oa=d=>{var A=Dr(),Q=a(A),ne=a(Q);w(()=>L(ne,t.validationErrors.region)),o(d,A)};h(na,d=>{t.validationErrors.region&&d(oa)})}var da=s(It,2);{var ca=d=>{var A=Fr(),Q=a(A);{let ne=he(()=>!t.canEdit);Qt(Q,{get options(){return t.recipeInfo.materiel},label:"Matériel nécessaire",placeholder:"Rechercher du matériel...",get disabled(){return e(ne)},closeOnSelect:!0,get selected(){return i().materiel},set selected(je){i(i().materiel=je,!0)}})}o(d,A)};h(da,d=>{i().materiel&&t.recipeInfo&&t.recipeInfo.materiel&&d(ca)})}var zt=s(St,2),Pt=a(zt),va=s(a(Pt),2),Tt=a(va),yt=a(Tt);yt.__change=[Br,i];var ua=s(Tt,2),wt=a(ua);wt.__change=[Nr,i];var jt=s(Pt,2);{var pa=d=>{var A=Ur(),Q=a(A),ne=a(Q);w(()=>L(ne,t.validationErrors.check)),o(d,A)};h(jt,d=>{t.validationErrors.check&&d(pa)})}var _a=s(jt,2),kt=a(_a),fa=s(kt,2),ba=s(a(fa),4);{var ga=d=>{var A=Mr();o(d,A)};h(ba,d=>{i().check!==!0&&d(ga)})}w(()=>{B(se,1,`input input-lg w-full ${t.validationErrors.title?"input-error":""}`),oe.disabled=!t.canEdit,L(P,`${(i().title?.length||0)??""}/80 caractères`),te.disabled=!t.canEdit,B(te,1,`input w-full ${t.validationErrors.description?"input-error":""}`),L(C,`${(i().description?.length||0)??""}/200 caractères`),B(ae,1,`input ${t.validationErrors.plate?"input-error":""}`),p.disabled=!t.canEdit,B(E,1,`input w-full min-w-lg ${t.validationErrors.quantite_desc?"input-error":""}`),H.disabled=!t.canEdit,L(xe,`${(i().quantite_desc?.length||0)??""}/100 caractères`),B(ye,1,`select ${t.validationErrors.typeR?"select-error":""}`),Te.disabled=!t.canEdit,Be!==(Be=Ke.ENTREE)&&(Ie.value=(Ie.__value=Ke.ENTREE)??""),Ce!==(Ce=Ke.PLAT)&&(Re.value=(Re.__value=Ke.PLAT)??""),de!==(de=Ke.DESSERT)&&(_e.value=(_e.__value=Ke.DESSERT)??""),ke!==(ke=Ke.AUTRE)&&(be.value=(be.__value=Ke.AUTRE)??""),B(Ne,1,`select w-full ${t.validationErrors.serveHot?"select-error":""}`),Ue.disabled=!t.canEdit,B(ot,1,`select w-full ${t.validationErrors.cuisson?"select-error":""}`),tt.disabled=!t.canEdit,B(xt,1,`input ${t.validationErrors.region?"input-error":""}`),Ct.disabled=!t.canEdit,B(zt,1,` flex w-full flex-wrap space-y-6 rounded-xl border-1 p-4 ${t.validationErrors.check?"border-error":"border-base-300"}`),mt(yt,i()?.check===!0),yt.disabled=!t.canEdit,mt(wt,i()?.check===!1),wt.disabled=!t.canEdit,kt.disabled=!t.canEdit||i().check!==!0}),De(oe,()=>i().title,d=>i(i().title=d,!0)),De(te,()=>i().description,d=>i(i().description=d,!0)),De(p,()=>i().plate,d=>i(i().plate=d,!0)),De(H,()=>i().quantite_desc,d=>i(i().quantite_desc=d,!0)),ct(Te,()=>i().typeR,d=>i(i().typeR=d,!0)),ct(Ue,()=>i().serveHot,d=>i(i().serveHot=d,!0)),ct(tt,()=>i().cuisson,d=>i(i().cuisson=d,!0)),De(Ct,()=>i().region,d=>i(i().region=d,!0)),Va(kt,()=>i().draft,d=>i(i().draft=d,!0)),o(r,n),$e()}Ze(["input","change"]);var Or=c('<div class="alert alert-error text-sm"><!> <span> </span></div>'),Qr=c('<p class="text-error text-xs"> </p>'),Vr=c("<option> </option>"),Gr=c('<p class="text-error text-xs"> </p>'),Wr=(r,t,l)=>t(l),Kr=c('<label><input type="checkbox" class="checkbox checkbox-sm bg-base-100"/> <span class="label-text"> </span></label>'),Xr=c('<p class="text-error text-xs"> </p>'),Yr=(r,t)=>e(t).pF=!0,Zr=(r,t)=>e(t).pF=!1,Jr=c('<p class="text-error text-xs"> </p>'),$r=(r,t)=>e(t).pS=!0,es=(r,t)=>e(t).pS=!1,ts=c('<p class="text-error text-xs"> </p>'),as=(r,t,l)=>{r.currentTarget.checked?e(t).saisons=[...e(t).saisons,e(l).value]:e(t).saisons=e(t).saisons.filter(i=>i!==e(l).value)},rs=c('<label><input type="checkbox" class="checkbox checkbox-sm bg-base-100"/> <span class="label-text"> </span></label>'),ss=c(`<form class="flex flex-col space-y-6"><!> <fieldset class="space-y-4"><div class="fieldset"><legend class="fieldset-legend">Nom *</legend> <label><!> <input id="ingredient-name-input" type="text" placeholder="Nom de l'ingrédient" required minlength="2" maxlength="60"/></label> <!></div> <div class="fieldset"><legend class="fieldset-legend">Type *</legend> <select><option>Sélectionner un type...</option><!></select> <!></div> <div class="fieldset"><legend class="fieldset-legend">Allergènes *</legend> <p class="text-base-content/60 mb-2 text-xs">Précisez les allergènes présents dans l'ingrédient et/ou la nature
            de l'ingrédients (ou cochez "Aucun"). Sert notamment à la
            classification des recettes comme végétarienne, sans-gluten, etc.)</p> <div class="flex flex-wrap gap-2"></div> <!></div> <div class="grid gap-4 md:grid-cols-2"><div class="fieldset"><legend class="fieldset-legend"><div class="flex items-center gap-2"><!> <span>frais ? *</span></div></legend> <p class="text-base-content/60 mb-2 text-xs">Fruits et légumes frais, ou ingrédients qui se conservent au frigo</p> <div><button type="button">Oui</button> <button type="button">Non</button></div> <!></div> <div class="fieldset"><legend class="fieldset-legend"><div class="flex items-center gap-2"><!> <span>Produit surgelé ? *</span></div></legend> <p class="text-base-content/60 mb-2 text-xs">Ingrédients qui se conservent au congélateur</p> <div><button type="button">Oui</button> <button type="button">Non</button></div> <!></div></div> <div class="fieldset"><legend class="fieldset-legend">Saisons (optionnel)</legend> <p class="text-base-content/60 mb-2 text-xs">Si l'ingrédient se trouve surtout à certaines saisons</p> <div class="flex flex-wrap gap-2"></div></div></fieldset></form>`),is=c('<span class="loading loading-spinner"></span>'),ls=c(`<button type="button" class="btn btn-ghost">Annuler</button> <button type="submit" class="btn btn-primary"><!> Créer l'ingrédient</button>`,1),ns=c("<!> <!> <!>",1);function os(r,t){Je(t,!0);let l=qe(t,"open",15,!1),i=qe(t,"initialName",3,""),n=$(gt({name:i(),type:"",allergens:[],pF:null,pS:null,saisons:[]})),v=$(!1),b=$(!1),x=$(null),y=$(gt({}));const U=[{value:"frais",label:"Produits Frais (beurre, fromage, yahourt..."},{value:"legumes",label:"Fruits et Légumes (frais, concerves, surgelés, etc."},{value:"lof",label:"LOF : Laits, oeuf, farines, huiles..."},{value:"sucres",label:"Sucrés (jus, sirop, confiture ...)"},{value:"epices",label:"Assaisonnements (épices, herbes, sauces...)"},{value:"sec",label:"Sec (riz, pâtes, lentilles...)"},{value:"animaux",label:"Viandes et Poissons"},{value:"autres",label:"Autres"}],ee=["Aucun","Produit laitier","Gluten","Crustacé","Oeuf","Poisson","Viande","Porc","Arachides","Soja","Fruits à coque","Céleri","Moutarde","Sésame","Sulfites","Lupin","Mollusque","Alcool","Vérifier emballage"],V=[{value:"printemps",label:"Printemps"},{value:"ete",label:"Eté"},{value:"automne",label:"Automne"},{value:"hiver",label:"Hiver"}];function se(){const _={};return e(n).name.trim()||(_.name="Le nom est requis"),e(n).type.trim()||(_.type="Le type est requis"),e(n).allergens.length===0&&(_.allergens="Cochez 'Aucun' si l'ingrédient ne contient aucun allergène"),e(n).pF===null&&(_.pF="Indiquez si c'est un produit frais"),e(n).pS===null&&(_.pS="Indiquez si c'est un produit surgelé"),_}function ve(_){_==="Aucun"?e(n).allergens=["Aucun"]:(e(n).allergens=e(n).allergens.filter(S=>S!=="Aucun"),e(n).allergens.includes(_)?e(n).allergens=e(n).allergens.filter(S=>S!==_):e(n).allergens.push(_))}async function oe(){if(!e(v)&&(g(b,!0),g(y,se(),!0),!(Object.keys(e(y)).length>0))){g(v,!0),g(x,null);try{const _={name:e(n).name.trim(),type:e(n).type,allergens:e(n).allergens.includes("Aucun")?[]:e(n).allergens,pF:e(n).pF===!0,pS:e(n).pS===!0,saisons:e(n).saisons.length>0?e(n).saisons:void 0},S=await He.addIngredient(_);Ge.success(`Ingrédient "${S.n}" créé avec succès`),t.onIngredientCreated&&t.onIngredientCreated(S),pe(),l(!1)}catch(_){g(x,_ instanceof Error?_.message:"Erreur lors de la création",!0),Ge.error(e(x))}finally{g(v,!1)}}}function pe(){g(n,{name:"",type:"",allergens:[],pF:null,pS:null,saisons:[]},!0),g(b,!1),g(x,null),g(y,{},!0)}function q(){l(!1),pe()}Qe(()=>{l()&&setTimeout(()=>{document.getElementById("ingredient-name-input")?.focus()},50)}),Qe(()=>{i()&&e(n).name===""&&(e(n).name=i())}),ea(r,{get isOpen(){return l()},onClose:q,children:(_,S)=>{var P=ns(),G=fe(P);ta(G,{title:"Créer un nouvel ingrédient",onClose:q});var ie=s(G,2);aa(ie,{children:(le,te)=>{var W=ss(),D=a(W);{var C=f=>{var R=Or(),j=a(R);Yt(j,{size:18});var ce=s(j,2),Le=a(ce);w(()=>L(Le,e(x))),o(f,R)};h(D,f=>{e(x)&&f(C)})}var N=s(D,2),u=a(N),m=s(a(u),2),k=a(m);qa(k,{class:"text-base-content/50 h-5 w-5"});var M=s(k,2),ae=s(m,2);{var J=f=>{var R=Qr(),j=a(R);w(()=>L(j,e(y).name)),o(f,R)};h(ae,f=>{e(b)&&e(y).name&&f(J)})}var p=s(u,2),z=s(a(p),2),F=a(z);F.value=F.__value="";var K=s(F);Oe(K,17,()=>U,f=>f.value,(f,R)=>{var j=Vr(),ce=a(j),Le={};w(()=>{L(ce,e(R).label),Le!==(Le=e(R).value)&&(j.value=(j.__value=e(R).value)??"")}),o(f,j)});var re=s(z,2);{var E=f=>{var R=Gr(),j=a(R);w(()=>L(j,e(y).type)),o(f,R)};h(re,f=>{e(b)&&e(y).type&&f(E)})}var T=s(p,2),H=s(a(T),4);Oe(H,20,()=>ee,f=>f,(f,R)=>{var j=Kr(),ce=a(j);ce.__change=[Wr,ve,R];var Le=s(ce,2),Ne=a(Le);w((Ue,Me)=>{B(j,1,`label border-base-300 cursor-pointer gap-2 rounded-lg border px-3 py-1 ${Ue??""} ${e(b)&&e(y).allergens&&!e(n).allergens.length?"border-error":""}`),mt(ce,Me),L(Ne,R)},[()=>e(n).allergens.includes(R)?"bg-primary/20 border-primary":"bg-base-200",()=>e(n).allergens.includes(R)]),o(f,j)});var X=s(H,2);{var O=f=>{var R=Xr(),j=a(R);w(()=>L(j,e(y).allergens)),o(f,R)};h(X,f=>{e(b)&&e(y).allergens&&f(O)})}var Y=s(T,2),ge=a(Y),xe=a(ge),I=a(xe),Fe=a(I);Ia(Fe,{size:16,class:"opacity-50"});var ye=s(xe,4),we=a(ye);we.__click=[Yr,n];var Te=s(we,2);Te.__click=[Zr,n];var ue=s(ye,2);{var Ie=f=>{var R=Jr(),j=a(R);w(()=>L(j,e(y).pF)),o(f,R)};h(ue,f=>{e(b)&&e(y).pF&&f(Ie)})}var Be=s(ge,2),Re=a(Be),Ce=a(Re),_e=a(Ce);Ra(_e,{size:16,class:"opacity-50"});var de=s(Re,4),be=a(de);be.__click=[$r,n];var ke=s(be,2);ke.__click=[es,n];var Ee=s(de,2);{var me=f=>{var R=ts(),j=a(R);w(()=>L(j,e(y).pS)),o(f,R)};h(Ee,f=>{e(b)&&e(y).pS&&f(me)})}var ze=s(Y,2),Ae=s(a(ze),4);Oe(Ae,21,()=>V,f=>f.value,(f,R)=>{var j=rs(),ce=a(j);ce.__change=[as,n,R];var Le=s(ce,2),Ne=a(Le);w((Ue,Me)=>{B(j,1,`label border-base-300 cursor-pointer gap-2 rounded-lg px-3 py-1 ${Ue??""}`),mt(ce,Me),L(Ne,e(R).label)},[()=>e(n).saisons.includes(e(R).value)?"bg-success/20 border-success":"bg-base-200",()=>e(n).saisons.includes(e(R).value)]),o(f,j)}),w(()=>{N.disabled=e(v),B(m,1,`input w-full ${e(b)&&e(y).name?"input-error":""}`),B(z,1,`select select-bordered w-full ${e(b)&&e(y).type?"select-error":""}`),B(ye,1,`join w-full ${e(b)&&e(y).pF?"join-error":""}`),B(we,1,`btn join-item flex-1 ${e(n).pF===!0?"btn-success":""}`),B(Te,1,`btn join-item flex-1 ${e(n).pF===!1?"btn-error":""}`),B(de,1,`join w-full ${e(b)&&e(y).pS?"join-error":""}`),B(be,1,`btn join-item flex-1 ${e(n).pS===!0?"btn-info":""}`),B(ke,1,`btn join-item flex-1 ${e(n).pS===!1?"btn-error":""}`)}),Ye("submit",W,f=>{f.preventDefault(),oe()}),De(M,()=>e(n).name,f=>e(n).name=f),ct(z,()=>e(n).type,f=>e(n).type=f),o(le,W)}});var Z=s(ie,2);ra(Z,{children:(le,te)=>{var W=ls(),D=fe(W);D.__click=q;var C=s(D,2);C.__click=oe;var N=a(C);{var u=k=>{var M=is();o(k,M)},m=k=>{bt(k,{size:18})};h(N,k=>{e(v)?k(u):k(m,!1)})}w(()=>{D.disabled=e(v),C.disabled=e(v)}),o(le,W)}}),o(_,P)},$$slots:{default:!0}}),$e()}Ze(["change","click"]);function ds(r,t,l,i){e(t)?l():i()}function cs(r,t,l,i,n,v,b,x,y){if(!t())switch(r.key){case"ArrowDown":r.preventDefault(),e(l)?e(n)<e(v).length-1&&st(n):i();break;case"ArrowUp":r.preventDefault(),e(l)&&e(n)>0&&st(n,-1);break;case"Enter":r.preventDefault(),e(l)&&e(v).length>0?b(e(v)[e(n)].u):e(l)||i();break;case"Escape":r.preventDefault(),x(),e(y)?.blur();break;case"Tab":e(l)&&x();break}}var vs=c('<div class="card bg-base-100 border-base-300 border shadow-sm"><div class="card-body p-4"><div class="flex items-center gap-3"><div class="loading loading-spinner loading-sm"></div> <span class="text-sm">Chargement des ingrédients...</span></div></div></div>'),us=c('<div class="card bg-error/10 border-error/20 border shadow-sm"><div class="card-body p-4"><div class="text-error flex items-center gap-3"><!> <span class="text-sm"> </span></div></div></div>'),ps=(r,t)=>t(),_s=c('<div class="border-base-300 mt-1 border-t pt-1"><button type="button" class="hover:bg-primary/20 text-primary flex w-full items-center gap-3 px-4 py-3 text-left hover:cursor-pointer"><!> <span class="text-sm font-medium">Créer un nouvel ingrédient...</span> <span class="text-base-content/50 text-xs"> </span></button></div>'),fs=c('<div class="text-base-content/50 px-4 py-2 text-sm">Aucun ingrédient trouvé</div> <!>',1),bs=(r,t,l)=>t(e(l).u),gs=c('<button type="button" role="option"><div class="flex-1"><span class="truncate text-sm font-medium"> </span></div></button>'),ms=(r,t)=>t(),hs=c('<div class="border-base-300 mt-1 border-t pt-1"><button type="button" class="hover:bg-primary/20 text-primary flex w-full items-center gap-3 px-4 py-3 text-left hover:cursor-pointer"><!> <span class="text-sm font-medium">Créer un nouvel ingrédient...</span></button></div>'),xs=c("<!> <!>",1),ys=c('<div class="text-base-content/50 px-4 py-2 text-sm">Tapez au moins 2 caractères pour rechercher</div>'),ws=c('<div id="ingredients-list" class="border-base-300 bg-base-100 absolute z-50 mt-1 max-h-60 w-full overflow-auto rounded-lg border shadow-lg" role="listbox"><!></div>'),ks=c('<div class="card bg-base-100 border-base-300 border shadow-sm"><div class="card-body gap-3 p-3"><h4 class="flex items-center gap-2 font-bold"><!> Ajouter un ingrédient</h4> <div class="mt-2"><div class="relative"><div><!> <input type="text" placeholder="Rechercher un ingrédient..." class="w-full bg-transparent outline-none" autocomplete="off" role="combobox" aria-controls="ingredients-list"/></div> <button type="button" class="btn btn-ghost btn-sm absolute top-1/2 right-1 -translate-y-1/2"><!></button> <!></div></div></div></div>'),Es=(r,t,l)=>t(e(l).uuid),As=(r,t)=>{e(t).originalUnit==="au goût"&&(e(t).originalQuantity=1)},Ls=c('<div class="text-base-content/60 text-xs italic"> </div>'),Ss=c('<div class="card bg-base-100 border-base-200 border shadow-sm"><div class="card-body p-3"><div class="flex items-start justify-between gap-3"><div class="flex-1 space-y-2"><div class="flex flex-wrap gap-2"><div class="item-start flex min-w-1/2 flex-1 justify-between"><div class="text-base font-medium"> </div> <button class="btn btn-ghost btn-sm btn-square text-error" title="Supprimer cet ingrédient"><!></button></div> <div class="flex flex-wrap gap-2"><label class="input input-sm w-44"><span class="label text-base-content/80">Quantité</span> <div class="flex items-center gap-1"><input type="number" class="text-center" min="0" step="0.1" placeholder="0"/></div></label> <label class="select select-sm w-44"><span class="label text-base-content/80">unité</span> <select class="text-center"><option>Kg</option><option>gr.</option><option>unité</option><option>l.</option><option>ml</option><option>c. à soupe</option><option>c. à café</option><option>pincées</option><option>tête·s</option><option>gousse·s</option><option>bottes</option><option>au goût</option></select></label></div> <!></div> <label class="input input-sm w-full"><span class="label">Note</span> <input type="text" placeholder="Ex: coupées en dés; pour la sauce..." maxlength="100"/></label></div></div></div></div>'),qs=c('<div class="card bg-base-300 border-base-300 border shadow-sm"><div class="card-body p-2"><div class="card-title text-secondary/80 flex items-center gap-2 px-4 text-sm font-semibold"><!> <span class="badge badge-xs badge-primary badge-soft"> </span></div> <div class="space-y-3"></div></div></div>'),Is=c('<div class="space-y-4" id="recipe-ingredients-editor"><!> <!></div> <!>',1);function Rs(r,t){Je(t,!0);let l=qe(t,"ingredients",15),i=qe(t,"disabled",3,!1),n=$(""),v=$(-1),b=$(!1),x=$(void 0),y=$(void 0),U=$(!1),ee=$(""),V=he(()=>e(n).length>1?He.searchIngredients(e(n)):[]),se=he(()=>()=>{const u={};return l().forEach(m=>{const k=m.type||"autres";u[k]||(u[k]=[]),u[k].push(m)}),Object.keys(u).forEach(m=>{u[m].sort((k,M)=>k.name.localeCompare(M.name,"fr",{sensitivity:"base"}))}),u});Qe(()=>{!He.isInitialized&&!He.loading&&He.initialize().catch(u=>{console.error("[RecipeIngredientsEditor] Erreur lors de l'initialisation du recipeDataStore:",u)})}),Qe(()=>{e(V).length>0&&e(v)===-1?g(v,0):e(V).length===0&&g(v,-1)}),Qe(()=>{e(V).length>0&&e(v)>=e(V).length&&g(v,0)}),Qe(()=>{if(e(b)){const u=m=>{e(x)&&!e(x).contains(m.target)&&(g(b,!1),g(n,""))};return document.addEventListener("mousedown",u),()=>{document.removeEventListener("mousedown",u)}}});function ve(u){const m=He.getIngredientByUuid(u);if(!m)return;const k={uuid:Ka(),name:m.n,originalQuantity:0,originalUnit:"gr.",normalizedQuantity:0,normalizedUnit:"gr.",comment:"",allergens:m.a||[],type:m.t||""};l([...l(),k]),g(n,""),g(b,!1),g(v,-1);const M=Ot(k.type).displayName;Ge.success(`Ingredient ajouté dans ${M}`)}function oe(){!i()&&!He.loading&&!He.error&&(g(b,!0),g(v,0))}function pe(){g(b,!1),g(n,""),g(v,-1)}function q(u){l(l().filter(m=>m.uuid!==u))}function _(u){if(!u.originalQuantity||u.originalQuantity<=0)return"";const m=$t.normalize(u.originalQuantity,u.originalUnit||"",u.name);return m.hasConversion?`≈ ${m.quantity} ${m.unit}`:""}function S(u){}function P(){g(ee,e(n).trim(),!0),g(U,!0),pe()}function G(u){ve(u.u)}var ie=Is(),Z=fe(ie),le=a(Z);{var te=u=>{var m=vs();o(u,m)},W=u=>{var m=Ve(),k=fe(m);{var M=J=>{var p=us(),z=a(p),F=a(z),K=a(F);Yt(K,{class:"h-4 w-4"});var re=s(K,2),E=a(re);w(()=>L(E,`Erreur lors du chargement: ${He.error??""}`)),o(J,p)},ae=J=>{var p=ks(),z=a(p),F=a(z),K=a(F);bt(K,{class:"text-primary h-4 w-4"});var re=s(F,2),E=a(re),T=a(E),H=a(T);Ca(H,{class:"h-4 w-4 opacity-50"});var X=s(H,2);X.__keydown=[cs,i,b,oe,v,V,ve,pe,y],vt(X,I=>g(y,I),()=>e(y));var O=s(T,2);O.__click=[ds,b,pe,oe];var Y=a(O);{let I=he(()=>e(b)?"rotate-180":"");Gt(Y,{get class(){return`h-4 w-4 transition-transform ${e(I)??""}`}})}var ge=s(O,2);{var xe=I=>{var Fe=ws(),ye=a(Fe);{var we=ue=>{var Ie=fs(),Be=s(fe(Ie),2);{var Re=Ce=>{var _e=_s(),de=a(_e);de.__click=[ps,P];var be=a(de);bt(be,{class:"h-4 w-4"});var ke=s(be,4),Ee=a(ke);w(()=>{de.disabled=i(),L(Ee,`"${e(n)??""}"`)}),o(Ce,_e)};h(Be,Ce=>{e(n).trim().length>0&&Ce(Re)})}o(ue,Ie)},Te=ue=>{var Ie=Ve(),Be=fe(Ie);{var Re=_e=>{var de=xs(),be=fe(de);Oe(be,19,()=>e(V),me=>me.u,(me,ze,Ae)=>{var f=gs();f.__click=[bs,ve,ze];var R=a(f),j=a(R),ce=a(j);w(()=>{Se(f,"id",`ingredient-${e(Ae)??""}`),B(f,1,`hover:bg-base-200 flex w-full items-center gap-3 px-4 py-3 text-left hover:cursor-pointer ${e(Ae)===e(v)?"bg-base-200":""}`),Se(f,"aria-selected",e(Ae)===e(v)),f.disabled=i(),L(ce,e(ze).n)}),Ye("mouseenter",f,()=>g(v,e(Ae),!0)),o(me,f)});var ke=s(be,2);{var Ee=me=>{var ze=hs(),Ae=a(ze);Ae.__click=[ms,P];var f=a(Ae);bt(f,{class:"h-4 w-4"}),w(()=>Ae.disabled=i()),o(me,ze)};h(ke,me=>{e(n).trim().length>0&&me(Ee)})}o(_e,de)},Ce=_e=>{var de=Ve(),be=fe(de);{var ke=Ee=>{var me=ys();o(Ee,me)};h(be,Ee=>{e(n).length<=1&&Ee(ke)},!0)}o(_e,de)};h(Be,_e=>{e(V).length>0?_e(Re):_e(Ce,!1)},!0)}o(ue,Ie)};h(ye,ue=>{e(n).length>1&&e(V).length===0?ue(we):ue(Te,!1)})}o(I,Fe)};h(ge,I=>{e(b)&&I(xe)})}vt(re,I=>g(x,I),()=>e(x)),w(()=>{B(T,1,`input flex w-full items-center gap-2 pr-10 ${i()?"input-disabled":""}`),X.disabled=i(),Se(X,"aria-expanded",e(b)),Se(X,"aria-activedescendant",e(b)?`ingredient-${e(v)}`:void 0),O.disabled=i(),Se(O,"aria-label",e(b)?"Fermer le menu":"Ouvrir le menu")}),Ye("focus",X,oe),De(X,()=>e(n),I=>g(n,I)),o(J,p)};h(k,J=>{He.error?J(M):J(ae,!1)},!0)}o(u,m)};h(le,u=>{He.loading?u(te):u(W,!1)})}var D=s(le,2);{var C=u=>{var m=Ve(),k=fe(m);Oe(k,17,()=>Object.entries(e(se)()),([M,ae])=>M,(M,ae)=>{var J=he(()=>Xa(e(ae),2));let p=()=>e(J)[0],z=()=>e(J)[1];const F=he(()=>Ot(p())),K=he(()=>e(F).icon);var re=qs(),E=a(re),T=a(E),H=a(T);Wa(H,()=>e(K),(xe,I)=>{I(xe,{class:"h-4 w-4"})});var X=s(H),O=s(X),Y=a(O),ge=s(T,2);Oe(ge,21,z,ut,(xe,I,Fe)=>{const ye=he(()=>_(e(I)));var we=Ss(),Te=a(we),ue=a(Te),Ie=a(ue),Be=a(Ie),Re=a(Be),Ce=a(Re),_e=a(Ce),de=s(Ce,2);de.__click=[Es,q,I];var be=a(de);Zt(be,{class:"h-4 w-4"});var ke=s(Re,2),Ee=a(ke),me=s(a(Ee),2),ze=a(me),Ae=s(Ee,2),f=s(a(Ae),2);f.__change=[As,I];var R=a(f);R.value=R.__value="kg";var j=s(R);j.value=j.__value="gr.";var ce=s(j);ce.value=ce.__value="unité";var Le=s(ce);Le.value=Le.__value="l.";var Ne=s(Le);Ne.value=Ne.__value="ml";var Ue=s(Ne);Ue.value=Ue.__value="c. à soupe";var Me=s(Ue);Me.value=Me.__value="c. à café";var Xe=s(Me);Xe.value=Xe.__value="pincées";var et=s(Xe);et.value=et.__value="tête·s";var lt=s(et);lt.value=lt.__value="gousse·s";var nt=s(lt);nt.value=nt.__value="bottes";var pt=s(nt);pt.value=pt.__value="au goût";var _t=s(ke,2);{var ht=Pe=>{var at=Ls(),ft=a(at);w(()=>L(ft,e(ye))),o(Pe,at)};h(_t,Pe=>{e(ye)&&Pe(ht)})}var ot=s(Be,2),tt=s(a(ot),2);w(()=>{L(_e,e(I).name),de.disabled=i(),ze.disabled=e(I).originalUnit==="au goût",f.disabled=i(),tt.disabled=i()}),Ye("blur",ze,()=>(e(I),void 0)),De(ze,()=>e(I).originalQuantity,Pe=>e(I).originalQuantity=Pe),Ye("blur",f,()=>(e(I),void 0)),ct(f,()=>e(I).originalUnit,Pe=>e(I).originalUnit=Pe),De(tt,()=>e(I).comment,Pe=>e(I).comment=Pe),Jt(3,we,()=>ir),o(xe,we)}),w(()=>{L(X,` ${e(F).displayName??""} `),L(Y,z().length)}),o(M,re)}),o(u,m)};h(D,u=>{l().length>0&&u(C)})}var N=s(Z,2);os(N,{get initialName(){return e(ee)},onIngredientCreated:G,get open(){return e(U)},set open(u){g(U,u,!0)}}),o(r,ie),$e()}Ze(["keydown","click","change"]);var Cs=c('<label class="label"><span class="label-text font-medium"> </span></label>'),zs=(r,t)=>e(t).chain().focus().toggleBold().run(),Ps=(r,t)=>e(t).chain().focus().toggleItalic().run(),Ts=(r,t)=>e(t).chain().focus().toggleBulletList().run(),js=(r,t)=>e(t).chain().focus().toggleOrderedList().run(),Ds=(r,t)=>e(t).chain().focus().undo().run(),Fs=(r,t)=>e(t).chain().focus().redo().run(),Bs=c('<div class="border-base-200 bg-base-200 flex flex-wrap items-center gap-1 border-b p-1"><button type="button" title="Gras"><!></button> <button type="button" title="Italique"><!></button> <div class="divider divider-horizontal mx-0 h-6"></div> <button type="button" title="Liste à puces"><!></button> <button type="button" title="Liste ordonnée"><!></button> <div class="divider divider-horizontal mx-0 h-6"></div> <button type="button" class="btn btn-ghost btn-square btn-sm" title="Annuler"><!></button> <button type="button" class="btn btn-ghost btn-square btn-sm" title="Rétablir"><!></button></div>'),Ns=c('<div class="label"><span class="text-error"> </span></div>'),Us=c('<div class=" w-full"><!> <div><!> <div></div></div> <!></div>');function Vt(r,t){Je(t,!0);let l=qe(t,"value",15);qe(t,"placeholder",3,"Commencez à rédiger...");let i=$(null),n=$(null),v=$(0),b=$(!1);Ya(()=>{e(i)&&g(n,new nr({element:e(i),extensions:[or.configure({codeBlock:!1,blockquote:!1}),dr.configure({html:!1,tightLists:!0})],content:l(),editorProps:{attributes:{class:"prose prose-sm max-w-none focus:outline-none min-h-[150px] p-4"}},onUpdate:({editor:_})=>{const S=_.storage.markdown.getMarkdown();l()!==S&&l(S)},onSelectionUpdate:()=>{st(v)},onTransaction:()=>{st(v)},onFocus:()=>g(b,!0),onBlur:()=>g(b,!1)}),!0)}),Za(()=>{e(n)&&e(n).destroy()});var x=Us(),y=a(x);{var U=_=>{var S=Cs(),P=a(S),G=a(P);w(()=>{Se(S,"for",t.id),L(G,t.label)}),o(_,S)};h(y,_=>{t.label&&_(U)})}var ee=s(y,2);let V;var se=a(ee);{var ve=_=>{var S=Bs(),P=a(S);let G;P.__click=[zs,n];var ie=a(P);za(ie,{class:"h-4 w-4"});var Z=s(P,2);let le;Z.__click=[Ps,n];var te=a(Z);Pa(te,{class:"h-4 w-4"});var W=s(Z,4);let D;W.__click=[Ts,n];var C=a(W);Ta(C,{class:"h-4 w-4"});var N=s(W,2);let u;N.__click=[js,n];var m=a(N);ja(m,{class:"h-4 w-4"});var k=s(N,4);k.__click=[Ds,n];var M=a(k);Da(M,{class:"h-4 w-4"});var ae=s(k,2);ae.__click=[Fs,n];var J=a(ae);Fa(J,{class:"h-4 w-4"}),w((p,z,F,K,re,E)=>{G=B(P,1,"btn btn-ghost btn-square btn-sm",null,G,p),le=B(Z,1,"btn btn-ghost btn-square btn-sm",null,le,z),D=B(W,1,"btn btn-ghost btn-square btn-sm",null,D,F),u=B(N,1,"btn btn-ghost btn-square btn-sm",null,u,K),k.disabled=re,ae.disabled=E},[()=>({"btn-active":e(v)>=0&&e(n).isActive("bold")}),()=>({"btn-active":e(v)>=0&&e(n).isActive("italic")}),()=>({"btn-active":e(v)>=0&&e(n).isActive("bulletList")}),()=>({"btn-active":e(v)>=0&&e(n).isActive("orderedList")}),()=>!(e(v)>=0&&e(n).can().undo()),()=>!(e(v)>=0&&e(n).can().redo())]),o(_,S)};h(se,_=>{e(n)&&_(ve)})}var oe=s(se,2);vt(oe,_=>g(i,_),()=>e(i));var pe=s(ee,2);{var q=_=>{var S=Ns(),P=a(S),G=a(P);w(()=>L(G,t.error)),o(_,S)};h(pe,_=>{t.error&&_(q)})}w(_=>{V=B(ee,1,"bg-base-100 overflow-hidden rounded-lg border-2 transition-all",null,V,_),Se(oe,"id",t.id)},[()=>({"border-primary":e(b),"border-error":t.error,"border-base-300":!e(b)&&!t.error})]),o(r,x),$e()}Ze(["click"]);var Ms=c('<div class="alert alert-error mt-4"><span class="text-sm"> </span></div>'),Hs=(r,t)=>{t(t().astuces=[...t().astuces,{astuce:""}],!0)},Os=c('<p class="py-2 text-sm italic opacity-50">Aucune astuce ajoutée</p>'),Qs=c('<span class="text-error text-xs"> </span>'),Vs=c("<span></span>"),Gs=c(`<div class="flex flex-col gap-1"><div class="flex items-start gap-2"><div class="flex-1"><textarea placeholder="Ex: Ajouter un filet d'huile d'olive au moment de servir" maxlength="250"></textarea></div> <button type="button" class="btn btn-square btn-sm text-error" title="Supprimer l'astuce"><!></button></div> <div class="flex justify-between px-1"><!> <span> </span></div></div>`),Ws=c('<div class="space-y-3"></div>'),Ks=c(`<div class="grid grid-cols-1 gap-6 md:grid-cols-2"><div><div class="card-body"><h2 class="card-title mb-4"><!> Ingrédients</h2> <!> <!></div></div> <div class="card bg-base-100 shadow-xl"><div class="card-body"><h2 class="card-title mb-4"><!> Préparation</h2> <div class="space-y-6"><!> <div><!> <p class="text-end text-xs italic opacity-60">La préparation à l'avance sera mise en évidence au dessus des autres
            étapes.</p></div></div> <div class="divider"></div> <div class="space-y-4"><div class="flex items-center justify-between"><h3 class="flex items-center gap-2 font-semibold"><!> Astuces et conseils</h3> <button type="button" class="btn btn-outline btn-primary btn-sm">+ Ajouter une astuce</button></div> <!></div></div></div></div>`);function Ei(r,t){Je(t,!0);let l=qe(t,"recipe",15);var i=Ks(),n=a(i),v=a(n),b=a(v),x=a(b);Kt(x,{class:"h-5 w-4"});var y=s(b,2);{let C=he(()=>!t.canEdit);Rs(y,{get disabled(){return e(C)},get ingredients(){return l().ingredients},set ingredients(N){l(l().ingredients=N,!0)}})}var U=s(y,2);{var ee=C=>{var N=Ms(),u=a(N),m=a(u);w(()=>L(m,t.validationErrors.ingredients)),o(C,N)};h(U,C=>{t.validationErrors.ingredients&&l().ingredients.length===0&&C(ee)})}var V=s(n,2),se=a(V),ve=a(se),oe=a(ve);Xt(oe,{class:"h-5 w-4"});var pe=s(ve,2),q=a(pe);Vt(q,{id:"recipe-preparation",label:"Instructions de préparation",get error(){return t.validationErrors.preparation},placeholder:"Décrivez les étapes de préparation...",get value(){return l().preparation},set value(C){l(l().preparation=C,!0)}});var _=s(q,2),S=a(_);Vt(S,{id:"recipe-preparation24h",label:"Préparation à l'avance (optionnel)",get error(){return t.validationErrors.preparation24h},placeholder:"Étapes à réaliser avant le jour j...",get value(){return l().preparation24h},set value(C){l(l().preparation24h=C,!0)}});var P=s(pe,4),G=a(P),ie=a(G),Z=a(ie);Ba(Z,{class:"text-warning h-4 w-4"});var le=s(ie,2);le.__click=[Hs,l];var te=s(G,2);{var W=C=>{var N=Os();o(C,N)},D=C=>{var N=Ws();Oe(N,21,()=>l().astuces,ut,(u,m,k)=>{var M=Gs(),ae=a(M),J=a(ae),p=a(J),z=s(J,2);z.__click=()=>{l(l().astuces=l().astuces.filter((O,Y)=>Y!==k),!0)};var F=a(z);Zt(F,{size:14});var K=s(ae,2),re=a(K);{var E=O=>{var Y=Qs(),ge=a(Y);w(()=>L(ge,t.validationErrors.astuces[k])),o(O,Y)},T=O=>{var Y=Vs();o(O,Y)};h(re,O=>{t.validationErrors.astuces?.[k]?O(E):O(T,!1)})}var H=s(re,2),X=a(H);w(()=>{p.disabled=!t.canEdit,B(p,1,`textarea textarea-bordered h-20 w-full text-sm ${t.validationErrors.astuces?.[k]?"textarea-error":""}`),z.disabled=!t.canEdit,B(H,1,`text-xs ${e(m).astuce.length>250?"text-error font-bold":"opacity-50"}`),L(X,`${e(m).astuce.length??""} / 250`)}),De(p,()=>e(m).astuce,O=>e(m).astuce=O),o(u,M)}),o(C,N)};h(te,C=>{l().astuces.length===0?C(W):C(D,!1)})}w(()=>{B(n,1,`card bg-base-100 shadow-xl ${t.validationErrors.ingredients?"ring-error ring-2":""}`),le.disabled=!t.canEdit}),o(r,i),$e()}Ze(["click"]);var Xs=(r,t,l)=>t(e(l)),Ys=c('<button class="btn btn-circle btn-xs btn-error btn-ghost ms-2" title="Retirer les droits"><!></button>'),Zs=c('<div class="badge badge-lg badge-soft gap-2 p-4"><span> </span> <!></div>'),Js=(r,t)=>g(t,!0),$s=c('<button class="btn btn-primary btn-sm btn-outline ms-4" title="Gérer les collaborateurs"><!> Ajouter des contributeur·ices</button>'),ei=c(`<div class="space-y-4"><div class="alert alert-info alert-soft border-info/20 text-xs"><!> <span>Par défaut, seul l'auteur·ice peut modifier la recette. Les autres
        utilisateur·ices peuvent la consulter ou la dupliquer pour créer leur
        propre version. Ajoutez des collaborateur·ices ici pour leur donner
        explicitement le droit de modifier cette version originale.</span></div> <div class="flex flex-wrap gap-2"><div class="badge badge-lg badge-soft badge-info gap-2 p-4"><!> <span class="font-bold"> </span> <div class="badge badge-xs">Auteur</div></div> <!> <!></div></div>`),ti=(r,t)=>r.key==="Enter"&&t(),ai=c('<span class="loading loading-spinner loading-xs"></span>'),ri=c('<p class="text-error mt-2 flex items-center gap-1 text-xs"><!> </p>'),si=c('<p class="text-xs opacity-60">Sélectionnez des membres de vos équipes pour les ajouter :</p> <div class="max-h-48 overflow-y-auto pr-2"><!></div>',1),ii=c(`<p class="py-4 text-center text-sm italic opacity-40">Vous n'avez pas encore d'équipe créée.</p>`),li=c('<p class="py-4 text-center text-sm italic opacity-40">Tous les membres de vos équipes sont déjà ajoutés.</p>'),ni=c('<div class="space-y-6"><fieldset class="fieldset"><legend class="fieldset-legend">Ajouter par email</legend> <div class="flex gap-2"><label class="input input-bordered flex grow items-center gap-2"><!> <input type="email" class="grow" placeholder="utilisateur@email.com"/></label> <button class="btn btn-primary"><!></button></div> <!></fieldset> <div class="divider text-xs font-bold tracking-widest uppercase opacity-50">Ou via vos équipes</div> <div class="space-y-4"><!></div></div>'),oi=c('<button class="btn btn-block btn-primary">Terminer</button>'),di=c("<!> <!> <!>",1),ci=c("<!> <!>",1);function Ai(r,t){Je(t,!0);let l=qe(t,"permissionWrite",15),i=$(!1),n=$(""),v=$(!1),b=$(null),x=gt({});Qe(()=>{t.createdBy===it.userId&&(x[t.createdBy]=it.userName||"Propriétaire");for(const q of Lt.teams)if(q.members)for(const _ of q.members)_.name&&!x[_.id]&&(x[_.id]=_.name)});let y=he(()=>{const q=[];for(const _ of Lt.teams)if(_.members)for(const S of _.members)S.id!==t.createdBy&&(q.some(P=>P.id===S.id)||q.push({id:S.id,label:S.name,selected:!1}));return q});async function U(){if(!e(n))return;const q=e(n).trim();g(v,!0),g(b,null);try{const{checkUserEmails:_}=await $a(async()=>{const{checkUserEmails:G}=await import("./appwrite.js").then(ie=>ie.bi);return{checkUserEmails:G}},[]),P=(await _([q]))[q];P?l()?.includes(P.id)?g(b,"Cet utilisateur a déjà les droits d'écriture."):(l([...l()||[],P.id]),x[P.id]=P.name||q,g(n,""),Ge.success(`Permission d'édition ajouté pour ${P.name||q}`)):g(b,"Utilisateur introuvable. Seuls les utilisateur·ices inscrit sur enka-cookbook peuvent être ajouté·es. Vous pouvez invitez des personnes depuis votre dashboard")}catch(_){console.error("Erreur check email:",_),g(b,"Erreur lors de la vérification de l'email.")}finally{g(v,!1)}}function ee(q){l()?.includes(q)?l((l()||[]).filter(_=>_!==q)):l([...l()||[],q])}function V(q){q!==t.createdBy&&l((l()||[]).filter(_=>_!==q))}function se(){g(i,!1),g(n,""),g(b,null)}var ve=ci(),oe=fe(ve);cr(oe,{get iconComponent(){return Ht},legend:"Permissions",children:(q,_)=>{var S=ei(),P=a(S),G=a(P);Na(G,{size:16});var ie=s(P,2),Z=a(ie),le=a(Z);Ua(le,{size:14});var te=s(le,2),W=a(te),D=s(Z,2);Oe(D,17,()=>(l()||[]).filter(u=>t.createdBy!==void 0&&u!==t.createdBy),ut,(u,m)=>{var k=Zs(),M=a(k),ae=a(M),J=s(M,2);{var p=z=>{var F=Ys();F.__click=[Xs,V,m];var K=a(F);Wt(K,{size:16}),o(z,F)};h(J,z=>{t.canEdit&&z(p)})}w(()=>L(ae,x[e(m)]||e(m))),Jt(3,k,()=>lr,()=>({duration:200})),o(u,k)});var C=s(D,2);{var N=u=>{var m=$s();m.__click=[Js,i];var k=a(m);Ma(k,{size:18}),o(u,m)};h(C,u=>{t.canEdit&&u(N)})}w(()=>L(W,t.createdBy&&x[t.createdBy]||"Propriétaire")),o(q,S)},$$slots:{default:!0}});var pe=s(oe,2);ea(pe,{get isOpen(){return e(i)},onClose:se,children:(q,_)=>{var S=di(),P=fe(S);ta(P,{title:"Gérer les collaborateurs",onClose:se,children:(Z,le)=>{Ht(Z,{class:"text-primary"})},$$slots:{default:!0}});var G=s(P,2);aa(G,{children:(Z,le)=>{var te=ni(),W=a(te),D=s(a(W),2),C=a(D),N=a(C);Ha(N,{class:"opacity-40",size:18});var u=s(N,2);u.__keydown=[ti,U];var m=s(C,2);m.__click=U;var k=a(m);{var M=E=>{var T=ai();o(E,T)},ae=E=>{var T=Ja("Ajouter");o(E,T)};h(k,E=>{e(v)?E(M):E(ae,!1)})}var J=s(D,2);{var p=E=>{var T=ri(),H=a(T);Oa(H,{size:14});var X=s(H);w(()=>L(X,` ${e(b)??""}`)),o(E,T)};h(J,E=>{e(b)&&E(p)})}var z=s(W,4),F=a(z);{var K=E=>{var T=si(),H=s(fe(T),2),X=a(H);vr(X,{get items(){return e(y)},onToggleItem:ee,size:"sm"}),o(E,T)},re=E=>{var T=Ve(),H=fe(T);{var X=Y=>{var ge=ii();o(Y,ge)},O=Y=>{var ge=li();o(Y,ge)};h(H,Y=>{Lt.teams.length===0?Y(X):Y(O,!1)},!0)}o(E,T)};h(F,E=>{e(y).length>0?E(K):E(re,!1)})}w(()=>m.disabled=e(v)||!e(n)),De(u,()=>e(n),E=>g(n,E)),o(Z,te)}});var ie=s(G,2);ra(ie,{children:(Z,le)=>{var te=oi();te.__click=se,o(Z,te)}}),o(q,S)},$$slots:{default:!0}}),o(r,ve),$e()}Ze(["click","keydown"]);const vi=["title","description","plate","preparation","preparation24h","cuisson","serveHot","typeR","categories","regime","saison","ingredients","quantite_desc","auteur","astuces","prepAlt","check","draft","permissionWrite","materiel","region","rootRecipeId","versionLabel","manuallyAddedVariants","variantsToRemove"];function Li(){return{title:"",plate:100,ingredients:[],preparation:"",materiel:[],preparation24h:"",astuces:[],categories:[],saison:[],typeR:"",cuisson:"",serveHot:"",regime:[],description:"",quantite_desc:"",region:"",prepAlt:[],check:null,draft:!0,lockedBy:null,auteur:null,publishedAt:null,createdBy:it.userId||"",permissionWrite:[it.userId||""],teams:null,status:er.PUBLIC,rootRecipeId:null,versionLabel:null,manuallyAddedVariants:[],variantsToRemove:[]}}function Si(r,t={}){return{...r,...t,categories:r.categories||[],saison:r.saison||[],ingredients:r.ingredients??[],astuces:r.astuces??[],prepAlt:r.prepAlt||[],materiel:r.materiel||[],regime:r.regime||[],check:r.check??null}}function qi(r){const t={};return vi.forEach(l=>{t[l]=r[l]}),JSON.stringify(t)}function Ii(r){return{title:r.title,plate:r.plate,preparation:r.preparation,cuisson:r.cuisson===""?!1:r.cuisson,serveHot:r.serveHot===""?!0:r.serveHot,check:r.check??!1,typeR:r.typeR,permissionWrite:r.permissionWrite&&r.permissionWrite.length>0?r.permissionWrite:[it.userId],draft:r.draft??!0,categories:r.categories||[],regime:r.regime||[],saison:r.saison||[],materiel:r.materiel||[],quantite_desc:r.quantite_desc||null,description:r.description||null,region:r.region||null,auteur:r.auteur||null,preparation24h:r.preparation24h||null,teams:r.teams||null,status:r.status||"private",ingredients:[],astuces:null,prepAlt:null,lockedBy:null,publishedAt:null,rootRecipeId:r.rootRecipeId||null,versionLabel:r.versionLabel||null}}function Ri(r,t,l){const i={...t,ingredients:r.ingredients,id:l.id,createdAt:l.createdAt,updatedAt:l.updatedAt,createdBy:l.createdBy};return delete i.$id,delete i.$createdAt,delete i.$updatedAt,i}function ui(r){if(!r.originalQuantity||r.originalQuantity<=0)return{...r,normalizedQuantity:0,normalizedUnit:r.originalUnit||"gr."};const t=$t.normalize(r.originalQuantity,r.originalUnit||"",r.name);return{...r,normalizedQuantity:t.quantity,normalizedUnit:t.unit}}function pi(r){return r.map(t=>ui(t))}function _i(r){const t=new ar;let l=!1;r.forEach(v=>{v.allergens&&v.allergens.length>0&&v.allergens.forEach(b=>t.add(b)),v.type==="animaux"&&(l=!0)});const i=Array.from(t);(i.includes("Viande")||i.includes("Poisson")||i.includes("Crustacé")||i.includes("Mollusque")||i.includes("Porc"))&&(l=!0);const n=[];return!l&&!i.includes("Produit laitier")&&!i.includes("Oeuf")?n.push("vegan"):l||n.push("vegetarien"),i.includes("Gluten")||n.push("sans-gluten"),i.includes("Produit laitier")||n.push("sans-lactose"),{regimes:n}}function Ci(r,t){if(!r)return!1;t.value={};let l=!1;if(!r.title?.trim())t.value.title="Le titre est obligatoire",l=!0;else if(r.title.length>100)t.value.title="Le titre ne peut pas dépasser 100 caractères",l=!0;else if(!/^[a-zA-Z0-9\s\-àâäéèêëïîôùûüçÀÂÄÉÈÊËÏÎÔÙÛÜÇ]+$/.test(r.title.trim()))t.value.title="Le titre ne peut contenir que des lettres, chiffres, espaces et tirets",l=!0;else{const n=r.title.trim().toLowerCase(),v=r.versionLabel?.trim().toLowerCase()||"";tr.recipesIndex.find(x=>{const y=x.title.trim().toLowerCase()===n,U=x.versionLabel?.trim().toLowerCase()||"";return y&&v===U&&x.$id!==r.$id})&&(t.value.title=r.versionLabel?"Une recette avec ce nom et cette version existe déjà":"Une recette porte déjà ce nom (sans version)",l=!0)}if(r.versionLabel&&(/^[a-zA-Z0-9\s\-]+$/.test(r.versionLabel.trim())||(t.value.versionLabel="La version ne peut contenir que des caractères alphanumériques, des espaces et des tirets",l=!0)),r.typeR||(t.value.typeR="Le type de recette est obligatoire",l=!0),(r.cuisson===null||r.cuisson===void 0)&&(t.value.cuisson="Veuillez spécifier si une cuisson est nécessaire",l=!0),(r.serveHot===null||r.serveHot===void 0)&&(t.value.serveHot="Veuillez spécifier la température de service",l=!0),!r.plate||r.plate<1?(t.value.plate="Le nombre de couverts doit être d'au moins 1",l=!0):r.plate>1e4&&(t.value.plate="Le nombre de couverts ne peut pas dépasser 10 000",l=!0),r.quantite_desc&&r.quantite_desc.length>100&&(t.value.quantite_desc="La description des quantités ne peut pas dépasser 100 caractères",l=!0),r.description&&r.description.length>200&&(t.value.description="La description ne peut pas dépasser 200 caractères",l=!0),r.region&&r.region.length>50&&(t.value.region="La spécialité ne peut pas dépasser 50 caractères",l=!0),(!r.ingredients||r.ingredients.length===0)&&(t.value.ingredients="Au moins un ingrédient est requis",l=!0),r.preparation?.trim()?r.preparation.length>15e3&&(t.value.preparation="La préparation ne peut pas dépasser 15 000 caractères",l=!0):(t.value.preparation="La préparation est obligatoire",l=!0),r.preparation24h&&r.preparation24h.length>15e3&&(t.value.preparation24h="La préparation 24h ne peut pas dépasser 15 000 caractères",l=!0),(r.check===null||r.check===void 0)&&(t.value.check="Veuillez indiquer si la recette a été testée",l=!0),r.astuces&&r.astuces.length>0){const n=[];r.astuces.forEach((v,b)=>{v.astuce.length>250&&(n[b]="Maximum 250 caractères",l=!0)}),n.length>0&&(t.value.astuces=n)}l&&(Ge.error("Veuillez corriger les champs invalides",{autoCloseDelay:5e3}),setTimeout(()=>{const n=Object.keys(t.value)[0],b={title:"recipe-title",typeR:"recipe-type",cuisson:"recipe-cuisson",serveHot:"recipe-servehot",plate:"recipe-plate",quantite_desc:"recipe-quantite-desc",description:"description",region:"recipe-region",check:"recipe-check-fieldset",ingredients:"recipe-ingredients-editor",preparation:"recipe-preparation",preparation24h:"recipe-preparation24h"}[n];if(b){const x=document.getElementById(b);x&&(x.scrollIntoView({behavior:"smooth",block:"center"}),(x.tagName==="INPUT"||x.tagName==="SELECT"||x.tagName==="TEXTAREA")&&x.focus())}},100)),r.title=r.title.trim().charAt(0).toUpperCase()+r.title.trim().slice(1).toLowerCase(),r.ingredients=pi(r.ingredients);const{regimes:i}=_i(r.ingredients);return r.regime=i,!l}async function zi(r,t){const l=Ge.loading("Suppression de la recette...");try{await rr(r);try{await sr("delete_recipe",r,it.userId||"",{},!0)}catch(i){console.warn("Sync GitHub échouée lors de la suppression:",i)}t&&await t(),Ge.update(l,{state:"success",message:"Recette supprimée avec succès"})}catch(i){throw console.error("Erreur suppression:",i),Ge.update(l,{state:"error",message:"Erreur lors de la suppression"}),i}finally{setTimeout(()=>Ge.dismiss(l),3e3)}}export{ki as R,qi as a,Ei as b,Li as c,Ai as d,_i as e,zi as f,Ii as n,Ri as p,Si as t,Ci as v};
