import{U as J,ad as $,c as ee,P as ae}from"./icons.js";import{Z as K,d as N,V as v,h as c,g as r,a2 as h,m as n,u as T,W as P,X as I,b as o,c as Y,y as V,A as M,a1 as W,ah as te,k as R,aI as re,q as X,v as z,j as Z,e as se}from"./appwrite.js";import{C as ne,T as oe}from"./CreateTeamModal.js";import{n as F}from"./index.js";import"./ConfirmModal.js";import"./InfoCollapse.js";var ie=(i,a)=>a.onClick(a.team.$id),de=(i,a)=>{(i.key==="Enter"||i.key===" ")&&(i.preventDefault(),a.onClick(a.team.$id))},le=v('<p class="text-base-content/70 mb-2 line-clamp-2 text-sm"> </p>'),ve=v('<div class="badge badge-warning badge-sm gap-1"> </div>'),ce=(i,a)=>{i.stopPropagation(),a()},me=v(`<button class="btn btn-ghost btn-xs text-error" title="Quitter l'équipe"><!> Quitter</button>`),ue=v("<span></span>"),be=v('<div class="card bg-base-100 border-base-200 hover:border-primary/50 group cursor-pointer border text-left shadow-xl transition-all hover:shadow-2xl" role="button" tabindex="0"><div class="card-body"><div class="mb-2 flex items-start justify-between"><h3 class="card-title group-hover:text-primary text-lg transition-colors"> </h3></div> <!> <div class="text-base-content/70 mt-2 flex items-center gap-4 text-sm"><div class="flex items-center gap-1"><!> <span> </span></div> <!></div> <div class="card-actions mt-4 justify-between"><!> <span class="text-primary flex items-center gap-1 text-xs font-semibold opacity-0 transition-opacity group-hover:opacity-100">Gérer <!></span></div></div></div>');function _e(i,a){N(a,!0);const q=T(()=>{const e=V.userId;return e&&a.team.members.find(l=>l.id===e)?.roles?.[0]||null}),b=T(()=>a.team.members.filter(e=>e.confirmed)),_=T(()=>a.team.members.filter(e=>!e.confirmed).length),y=T(()=>a.team.prefs?.description),O=T(()=>{const e=a.team.members.find(t=>t.id===V.userId);return e&&e.confirmed});async function U(){const e=a.team.members.find(t=>t.id===V.userId);e&&e.roles?.[0]!=="owner"&&await M.removeMember(a.teamId,e.$id)}var g=be();g.__click=[ie,a],g.__keydown=[de,a];var D=r(g),w=r(D),Q=r(w),B=r(Q),j=c(w,2);{var A=e=>{var t=le(),l=r(t);P(()=>I(l,n(y))),o(e,t)};h(j,e=>{n(y)&&e(A)})}var S=c(j,2),s=r(S),d=r(s);J(d,{class:"h-4 w-4"});var k=c(d,2),E=r(k),G=c(s,2);{var m=e=>{var t=ve(),l=r(t);P(()=>I(l,`${n(_)??""} invitation${n(_)>1?"s":""}`)),o(e,t)};h(G,e=>{n(q)==="owner"&&n(_)>0&&e(m)})}var f=c(S,2),x=r(f);{var C=e=>{var t=me();t.__click=[ce,U];var l=r(t);ee(l,{class:"h-4 w-4"}),o(e,t)},L=e=>{var t=ue();o(e,t)};h(x,e=>{n(O)&&n(q)!=="owner"?e(C):e(L,!1)})}var u=c(x,2),p=c(r(u));$(p,{class:"h-4 w-4"}),P(()=>{I(B,a.team.name),I(E,`${n(b).length??""} membre${n(b).length>1?"s":""}`)}),o(i,g),Y()}K(["click","keydown"]);function H(i,a){z(a,!0)}var fe=v('<button class="btn btn-primary"><!> Créer une équipe</button>'),pe=v('<div class="alert alert-warning"><span>Vous devez être connecté pour voir vos équipes</span></div>'),ge=v('<div class="alert alert-error shadow-lg"><span> </span></div>'),xe=v(`<div class="bg-base-200 rounded-box border-base-200 border-2 border-dashed py-20 text-center"><div class="bg-base-200 mb-4 inline-block rounded-full p-4"><!></div> <h3 class="mb-2 text-lg font-bold">Aucune équipe</h3> <p class="text-base-content/60 mb-6">Vous n'avez pas encore créé ou rejoint d'équipe.</p> <button class="btn btn-primary btn-sm">Créer ma première équipe</button></div>`),he=v('<div class="grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3"></div>'),ye=v('<div class="mx-auto max-w-7xl px-4 py-8"><!></div> <!> <!>',1);function qe(i,a){N(a,!0);const q=s=>{var d=fe();d.__click=[H,b];var k=r(d);ae(k,{class:"h-4 w-4"}),o(s,d)};let b=X(!1),_=X(null);function y(s){z(_,s,!0)}function O(){z(_,null)}function U(){z(b,!1)}function g(s){U(),y(s)}W(()=>{re()}),W(()=>{F.setConfig({title:"Équipes",actions:q})}),te(()=>{F.reset()});var D=ye(),w=R(D),Q=r(w);{var B=s=>{var d=pe();o(s,d)},j=s=>{var d=Z(),k=R(d);{var E=m=>{var f=ge(),x=r(f),C=r(x);P(()=>I(C,M.error)),o(m,f)},G=m=>{var f=Z(),x=R(f);{var C=u=>{var p=xe(),e=r(p),t=r(e);J(t,{class:"h-8 w-8 opacity-50"});var l=c(e,6);l.__click=[H,b],o(u,p)},L=u=>{var p=he();se(p,21,()=>M.teams,e=>e.$id,(e,t)=>{_e(e,{get team(){return n(t)},get teamId(){return n(t).$id},onClick:l=>y(l)})}),o(u,p)};h(x,u=>{M.count===0?u(C):u(L,!1)},!0)}o(m,f)};h(k,m=>{M.error?m(E):m(G,!1)},!0)}o(s,d)};h(Q,s=>{V.isAuthenticated?s(j,!1):s(B)})}var A=c(w,2);ne(A,{get isOpen(){return n(b)},onClose:U,onSuccess:g});var S=c(A,2);oe(S,{get teamId(){return n(_)},onClose:O}),o(i,D),Y()}K(["click"]);export{qe as default};
