import{U as W,ae as ee,c as ae,P as te}from"./icons.js";import{B as X,d as Y,v,g as r,o as t,h as c,I as w,m as o,u as q,w as G,x as D,b as i,c as Z,G as O,K as $,F as j,H as re,$ as se,k as L,y as R,A as B,j as J,e as ne}from"./appwrite.js";import{C as oe,T as ie}from"./CreateTeamModal.js";import{n as N}from"./index.js";import"./ConfirmModal.js";import"./InfoCollapse.js";var de=v('<p class="text-base-content/70 mb-2 line-clamp-2 text-sm"> </p>'),le=v('<div class="badge badge-warning badge-sm gap-1"> </div>'),ve=v(`<button class="btn btn-ghost btn-xs text-error" title="Quitter l'équipe"><!> Quitter</button>`),ce=v("<span></span>"),me=v('<div class="card bg-base-100 border-base-200 hover:border-primary/50 group cursor-pointer border text-left shadow-xl transition-all hover:shadow-2xl" role="button" tabindex="0"><div class="card-body"><div class="mb-2 flex items-start justify-between"><h3 class="card-title group-hover:text-primary text-lg transition-colors"> </h3></div> <!> <div class="text-base-content/70 mt-2 flex items-center gap-4 text-sm"><div class="flex items-center gap-1"><!> <span> </span></div> <!></div> <div class="card-actions mt-4 justify-between"><!> <span class="text-primary flex items-center gap-1 text-xs font-semibold opacity-0 transition-opacity group-hover:opacity-100">Gérer <!></span></div></div></div>');function ue(Q,s){Y(s,!0);const A=q(()=>{const e=O.userId;return e&&s.team.members.find(l=>l.id===e)?.roles?.[0]||null}),p=q(()=>s.team.members.filter(e=>e.confirmed)),_=q(()=>s.team.members.filter(e=>!e.confirmed).length),k=q(()=>s.team.prefs?.description),V=q(()=>{const e=s.team.members.find(a=>a.id===O.userId);return e&&e.confirmed});async function S(){const e=s.team.members.find(a=>a.id===O.userId);e&&e.roles?.[0]!=="owner"&&await j.removeMember(s.teamId,e.$id)}var b=me();b.__click=()=>s.onClick(s.team.$id),b.__keydown=e=>{(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),s.onClick(s.team.$id))};var U=r(b),g=r(U),x=r(g),E=r(x,!0);t(x),t(g);var P=c(g,2);{var F=e=>{var a=de(),l=r(a,!0);t(a),G(()=>D(l,o(k))),i(e,a)};w(P,e=>{o(k)&&e(F)})}var h=c(P,2),C=r(h),n=r(C);W(n,{class:"h-4 w-4"});var d=c(n,2),T=r(d);t(d),t(C);var H=c(C,2);{var K=e=>{var a=le(),l=r(a);t(a),G(()=>D(l,`${o(_)??""} invitation${o(_)>1?"s":""}`)),i(e,a)};w(H,e=>{o(A)==="owner"&&o(_)>0&&e(K)})}t(h);var m=c(h,2),u=r(m);{var y=e=>{var a=ve();a.__click=M=>{M.stopPropagation(),S()};var l=r(a);ae(l,{class:"h-4 w-4"}),$(),t(a),i(e,a)},I=e=>{var a=ce();i(e,a)};w(u,e=>{o(V)&&o(A)!=="owner"?e(y):e(I,!1)})}var z=c(u,2),f=c(r(z));ee(f,{class:"h-4 w-4"}),t(z),t(m),t(U),t(b),G(()=>{D(E,s.team.name),D(T,`${o(p).length??""} membre${o(p).length>1?"s":""}`)}),i(Q,b),Z()}X(["click","keydown"]);var be=v('<button class="btn btn-primary"><!> Créer une équipe</button>'),fe=v('<div class="alert alert-warning"><span>Vous devez être connecté pour voir vos équipes</span></div>'),_e=v('<div class="alert alert-error shadow-lg"><span> </span></div>'),pe=v(`<div class="bg-base-200 rounded-box border-base-200 border-2 border-dashed py-20 text-center"><div class="bg-base-200 mb-4 inline-block rounded-full p-4"><!></div> <h3 class="mb-2 text-lg font-bold">Aucune équipe</h3> <p class="text-base-content/60 mb-6">Vous n'avez pas encore créé ou rejoint d'équipe.</p> <button class="btn btn-primary btn-sm">Créer ma première équipe</button></div>`),ge=v('<div class="grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3"></div>'),xe=v('<div class="mx-auto max-w-7xl px-4 py-8"><!></div> <!> <!>',1);function Ie(Q,s){Y(s,!0);const A=n=>{var d=be();d.__click=S;var T=r(d);te(T,{class:"h-4 w-4"}),$(),t(d),i(n,d)};let p=R(!1),_=R(null);function k(n){B(_,n,!0)}function V(){B(_,null)}function S(){B(p,!0)}function b(){B(p,!1)}function U(n){b(),k(n)}re(()=>{N.setConfig({title:"Équipes",actions:A})}),se(()=>{N.reset()});var g=xe(),x=L(g),E=r(x);{var P=n=>{var d=fe();i(n,d)},F=n=>{var d=J(),T=L(d);{var H=m=>{var u=_e(),y=r(u),I=r(y,!0);t(y),t(u),G(()=>D(I,j.error)),i(m,u)},K=m=>{var u=J(),y=L(u);{var I=f=>{var e=pe(),a=r(e),l=r(a);W(l,{class:"h-8 w-8 opacity-50"}),t(a);var M=c(a,6);M.__click=S,t(e),i(f,e)},z=f=>{var e=ge();ne(e,21,()=>j.teams,a=>a.$id,(a,l)=>{ue(a,{get team(){return o(l)},get teamId(){return o(l).$id},onClick:M=>k(M)})}),t(e),i(f,e)};w(y,f=>{j.count===0?f(I):f(z,!1)},!0)}i(m,u)};w(T,m=>{j.error?m(H):m(K,!1)},!0)}i(n,d)};w(E,n=>{O.isAuthenticated?n(F,!1):n(P)})}t(x);var h=c(x,2);oe(h,{get isOpen(){return o(p)},onClose:b,onSuccess:U});var C=c(h,2);ie(C,{get teamId(){return o(_)},onClose:V}),i(Q,g),Z()}X(["click"]);export{Ie as default};
