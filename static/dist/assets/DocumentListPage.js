import{x as J,j as te,W as c,B as _,A as r,D as G,E,$ as T,v as n,X as O,_ as ee,w as U,Z as V,o as H,z as ae,g as e,u as B,a1 as we,a3 as Ce,ae as se,ac as oe,Y as Z,s as Y,p as Ae,b as ne,aa as De,a9 as ke,a as M,af as Se,ag as Te}from"./vendor.js";import{n as ce,t as N}from"./index.js";import{y as ie,n as ze}from"./appwrite.js";import{D as Fe}from"./DocCard.js";import{L as Be}from"./LeftPanel.js";import{F as de}from"./Fieldset.js";import{C as ve}from"./CheckboxBadge.js";import{F as Ie,b9 as Qe,ba as Re,S as Pe,X as Ee,o as Le,A as Oe,p as je,E as Me,P as ue}from"./icons.js";import"./editor.js";import"./markdown.js";import"./date-helpers.js";var Ne=c('<div class="flex flex-wrap gap-2"></div>'),Xe=c('<p class="text-base-content/60 text-sm">Aucun tag disponible</p>'),qe=c('<div class="flex flex-wrap gap-2"></div>'),Ke=c('<p class="text-base-content/60 text-sm">Aucun statut disponible</p>'),We=c('<div><div class="mb-4 flex items-center justify-between"><h4 class="text-lg font-bold">Filtres</h4> <button class="btn btn-warning btn-sm"><!> Effacer</button></div> <!> <!></div>');function Ye(w,t){J(t,!0);let p=te(t,"filters",15),h=te(t,"disabled",3,!1);function b(v,i){const u=v.indexOf(i);u===-1?v.push(i):v.splice(u,1),p({...p()})}var d=We();let x;var C=r(d),I=_(r(C),2);I.__click=function(...v){t.onReset?.apply(this,v)};var Q=r(I);Ie(Q,{class:"h-4 w-4"});var A=_(C,2);de(A,{legend:"Tags",get iconComponent(){return Qe},children:(v,i)=>{var u=G(),f=E(u);{var P=a=>{var s=Ne();H(s,21,()=>t.availableTags,ae,(o,m)=>{{let z=B(()=>p().tags.includes(e(m)));ve(o,{get checked(){return e(z)},get label(){return e(m)},onchange:()=>b(p().tags,e(m)),get disabled(){return h()}})}}),n(a,s)},D=a=>{var s=Xe();n(a,s)};T(f,a=>{t.availableTags.length>0?a(P):a(D,!1)})}n(v,u)},$$slots:{default:!0}});var R=_(A,2);de(R,{legend:"Statut",get iconComponent(){return Re},children:(v,i)=>{var u=G(),f=E(u);{var P=a=>{var s=qe();H(s,21,()=>t.availableStatus,ae,(o,m)=>{{let z=B(()=>p().status.includes(e(m)));ve(o,{get checked(){return e(z)},get label(){return e(m)},onchange:()=>b(p().status,e(m)),get disabled(){return h()}})}}),n(a,s)},D=a=>{var s=Ke();n(a,s)};T(f,a=>{t.availableStatus.length>0?a(P):a(D,!1)})}n(v,u)},$$slots:{default:!0}}),O(v=>{x=ee(d,1,"mt-16 space-y-4",null,x,v),I.disabled=h()},[()=>({"opacity-30":h()})]),n(w,d),U()}V(["click"]);function Ze(w,t){w.key==="Escape"&&t.onReset()}var Ge=c('<button class="btn join-item btn-ghost btn-lg" aria-label="Effacer la recherche"><!></button>'),He=c('<div class="input input-lg w-full"><!> <input type="text" class="join-item grow" aria-label="Rechercher"/> <!></div>');function Je(w,t){J(t,!0);let p=te(t,"searchQuery",15),h=te(t,"placeholder",3,"Rechercher...");var b=He(),d=r(b);Pe(d,{class:"text-base-content/50 join-item h-5 w-5"});var x=_(d,2);x.__keydown=[Ze,t];var C=_(x,2);{var I=Q=>{var A=Ge();A.__click=function(...v){t.onReset?.apply(this,v)};var R=r(A);Ee(R,{class:"h-5 w-5"}),n(Q,A)};T(C,Q=>{p().length>0&&Q(I)})}O(()=>Ce(x,"placeholder",h())),we(x,p),n(w,b),U()}V(["keydown","click"]);var Ue=(w,t)=>t("title"),Ve=(w,t)=>t("$createdAt"),$e=(w,t)=>t("$updatedAt"),et=c('<div class="bg-base-300 rounded-box flex flex-wrap items-center justify-between gap-6 px-6 py-6"><fieldset class="fieldset w-full"><legend class="legend label"><!> Trier par :</legend> <div class="btn-group"><button aria-label="Trier par titre">Titre</button> <button aria-label="Trier par date de création"><!> Date de création</button> <button aria-label="Trier par date de modification"><!> Date de modification</button></div></fieldset></div>');function tt(w,t){J(t,!0);const p=a=>t.sortBy!==a?"inactive":t.sortOrder,h=a=>{a==="title"?t.onSortChange("title",t.sortBy==="title"&&t.sortOrder==="asc"?"desc":"asc"):t.sortBy!==a?t.onSortChange(a,"desc"):t.sortOrder==="desc"?t.onSortChange(a,"asc"):t.onSortChange("title","asc")},b=a=>{const s=p(a),o="btn btn-sm btn-primary btn-outline gap-2";return s==="inactive"?`${o}`:s==="asc"?`${o} btn-active`:`${o} btn-active`},d=a=>{const s=p(a);return s==="inactive"?null:s==="asc"?Oe:je};var x=et(),C=r(x),I=r(C),Q=r(I);Le(Q,{class:"inline size-4"});var A=_(I,2),R=r(A);R.__click=[Ue,h];var v=_(R,2);v.__click=[Ve,h];var i=r(v);{var u=a=>{const s=B(()=>d("$createdAt"));var o=G(),m=E(o);oe(m,()=>e(s),(z,k)=>{k(z,{size:16})}),n(a,o)};T(i,a=>{d("$createdAt")&&a(u)})}var f=_(v,2);f.__click=[$e,h];var P=r(f);{var D=a=>{const s=B(()=>d("$updatedAt"));var o=G(),m=E(o);oe(m,()=>e(s),(z,k)=>{k(z,{size:16})}),n(a,o)};T(P,a=>{d("$updatedAt")&&a(D)})}O((a,s,o)=>{ee(R,1,a),ee(v,1,s),ee(f,1,o)},[()=>se(b("title")),()=>se(b("$createdAt")),()=>se(b("$updatedAt"))]),n(w,x),U()}V(["click"]);var at=c(`<span class="font-semibold"> </span> correspondent
        aux critères`,1),rt=c('<span class="font-semibold">1 document</span> correspond aux critères',1),st=c('<span class="text-warning">Aucun document</span> ne correspond aux critères...',1),nt=c('<legend class="legend text-base-content/70 ms-4"><!></legend>'),it=c('<div class="text-base-content/70 text-base"> </div>'),lt=c('<div><span class="text-base-content/60 italic">contient (dans le titre ou le contenu) :</span> <span class="font-bold"> </span></div>'),ot=c('<span class="badge badge-primary"> </span>'),ct=c('<span class="badge badge-secondary"> </span>'),dt=c('<div class="flex flex-wrap gap-2"><!> <!></div> <div class="mt-3 text-end"><button class="btn btn-warning btn-sm"><!> Effacer tous les filtres</button></div>',1),vt=c('<fieldset class="fieldset border-base-300 relative rounded-lg border-2"><!> <div class="p-4"><!> <!></div></fieldset>');function ut(w,t){J(t,!0);const p=B(()=>t.filters.tags.length>0||t.filters.status.length>0);function h(i){switch(i.toLowerCase()){case"draft":case"brouillon":return"Brouillon";case"published":case"publié":return"Publié";case"archived":case"archivé":return"Archivé";default:return i}}var b=vt(),d=r(b);{var x=i=>{var u=nt(),f=r(u);{var P=a=>{var s=at(),o=E(s),m=r(o);O(()=>Z(m,`${t.resultCount??""} documents`)),n(a,s)},D=a=>{var s=G(),o=E(s);{var m=k=>{var X=rt();n(k,X)},z=k=>{var X=st();n(k,X)};T(o,k=>{t.resultCount===1?k(m):k(z,!1)},!0)}n(a,s)};T(f,a=>{t.resultCount>1?a(P):a(D,!1)})}n(i,u)};T(d,i=>{(e(p)||t.searchQuery.length>=2)&&i(x)})}var C=_(d,2),I=r(C);{var Q=i=>{var u=it(),f=r(u);O(()=>Z(f,`${t.resultCount??""} document${t.resultCount>1?"s":""}`)),n(i,u)};T(I,i=>{!e(p)&&t.searchQuery.length<2&&i(Q)})}var A=_(I,2);{var R=i=>{var u=lt(),f=_(r(u),2),P=r(f);O(()=>Z(P,t.searchQuery)),n(i,u)},v=i=>{var u=G(),f=E(u);{var P=D=>{var a=dt(),s=E(a),o=r(s);H(o,17,()=>t.filters.tags,ae,(j,K)=>{var q=ot(),W=r(q);O(()=>Z(W,e(K))),n(j,q)});var m=_(o,2);H(m,17,()=>t.filters.status,ae,(j,K)=>{var q=ct(),W=r(q);O(re=>Z(W,re),[()=>h(e(K))]),n(j,q)});var z=_(s,2),k=r(z);k.__click=function(...j){t.onResetFilters?.apply(this,j)};var X=r(k);Me(X,{class:"h-4 w-4"}),n(D,a)};T(f,D=>{e(p)&&D(P)},!0)}n(i,u)};T(A,i=>{t.searchQuery.length>=2?i(R):i(v,!1)})}n(w,b),U()}V(["click"]);var gt=(w,t)=>ie(`/createdocument/${e(t)}/new`),ft=c('<button class="btn btn-primary"><!> Créer un document</button>'),_t=c('<div class="alert alert-error"><span> </span></div>'),bt=c('<div class="py-8 text-center"><span class="loading loading-spinner loading-md"></span></div>'),mt=c('<div class="py-12 text-center"><p class="text-base-content/60 text-lg">Aucun document ne correspond aux critères...</p></div>'),ht=(w,t)=>ie(`/createdocument/${e(t)}/new`),pt=c('<div class="py-12 text-center"><p class="text-base-content/60 mb-4 text-lg">Aucun document dans cette équipe</p> <button class="btn btn-primary"><!> Créer le premier document</button></div>'),xt=c('<div class="my-8 space-y-3"></div> <!> <!> <!>',1),yt=c('<!> <div class="p-4 lg:ml-100"><div class="mx-auto max-w-4xl"><div class="mb-10 space-y-6"><div class="mb-4"><!></div> <div class="mb-6"><!></div> <!></div> <!></div></div>',1);function Qt(w,t){J(t,!0);const p=l=>{var g=ft();g.__click=[gt,h];var y=r(g);ue(y,{size:18}),n(l,g)};let h=B(()=>t.params.teamId),b=Y(""),d=Y(Ae({tags:[],status:[]})),x=Y("$updatedAt"),C=Y("desc"),I=20,Q=Y(1),A=Y(void 0),R=B(()=>ze.myTeams.find(l=>l.$id===e(h)));const v=B(()=>N.isInitialized?N.getTeamDocuments(e(h)):[]),i=B(()=>N.getTeamTags(e(h))),u=B(()=>["draft","published","archived"]),f=B(()=>{if(e(b).length>=2){const l=e(b).toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu,"");return e(v).filter(g=>{const y=g.title.toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu,"").includes(l),F=g.content?.toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu,"").includes(l);return y||F})}return e(v).filter(l=>{const g=!e(d).tags.length||e(d).tags.some(F=>l.tags?.includes(F)),y=!e(d).status.length||e(d).status.includes(l.status);return g&&y})}),P=B(()=>[...e(f)].sort((g,y)=>{if(e(x)==="title")return e(C)==="asc"?g.title.localeCompare(y.title,"fr"):y.title.localeCompare(g.title,"fr");if(e(x)==="$createdAt"){const F=new Date(y.$createdAt||0).getTime()-new Date(g.$createdAt||0).getTime();return e(C)==="asc"?-F:F}else{const F=new Date(y.$updatedAt||0).getTime()-new Date(g.$updatedAt||0).getTime();return e(C)==="asc"?-F:F}})),D=B(()=>e(P).slice(0,e(Q)*I)),a=B(()=>e(b).length>=2);function s(){M(b,"")}function o(){M(d,{tags:[],status:[]},!0)}ne(()=>{if(!e(A))return;const l=new IntersectionObserver(g=>{g[0].isIntersecting&&e(D).length<e(f).length&&Se(Q)},{threshold:.1});return l.observe(e(A)),()=>l.disconnect()}),ne(()=>{e(f),e(x),e(C),M(Q,1)}),ne(()=>{e(R)&&ce.setConfig({title:`Documents - ${e(R).name}`,actions:p})}),De(()=>{ce.reset()}),ke(async()=>{N.isInitialized||await N.initialize(),e(R)||ie("/dashboard/teams")});var m=yt(),z=E(m);Be(z,{width:"100",children:(l,g)=>{Ye(l,{get availableTags(){return e(i)},get availableStatus(){return e(u)},get disabled(){return e(a)},onReset:o,get filters(){return e(d)},set filters(y){M(d,y,!0)}})},$$slots:{default:!0}});var k=_(z,2),X=r(k),j=r(X),K=r(j),q=r(K);Je(q,{onReset:s,placeholder:"Rechercher dans les documents...",get searchQuery(){return e(b)},set searchQuery(l){M(b,l,!0)}});var W=_(K,2),re=r(W);ut(re,{get searchQuery(){return e(b)},get filters(){return e(d)},get resultCount(){return e(f).length},onResetFilters:o});var ge=_(W,2);tt(ge,{get sortBy(){return e(x)},get sortOrder(){return e(C)},onSortChange:(l,g)=>{M(x,l,!0),M(C,g,!0)}});var fe=_(j,2);{var _e=l=>{var g=_t(),y=r(g),F=r(y);O(()=>Z(F,`Erreur : ${N.error??""}`)),n(l,g)},be=l=>{var g=xt(),y=E(g);H(y,21,()=>e(D),S=>S.$id,(S,L)=>{Fe(S,{get doc(){return e(L)},get teamId(){return e(h)},get highlightedTags(){return e(d).tags},bgClass:"bg-base-100"})});var F=_(y,2);{var me=S=>{var L=bt();Te(L,$=>M(A,$),()=>e(A)),n(S,L)};T(F,S=>{e(D).length<e(f).length&&S(me)})}var le=_(F,2);{var he=S=>{var L=mt();n(S,L)};T(le,S=>{e(f).length===0&&S(he)})}var pe=_(le,2);{var xe=S=>{var L=pt(),$=_(r(L),2);$.__click=[ht,h];var ye=r($);ue(ye,{size:18}),n(S,L)};T(pe,S=>{e(v).length===0&&!N.loading&&S(xe)})}n(l,g)};T(fe,l=>{N.error?l(_e):l(be,!1)})}n(w,m),U()}V(["click"]);export{Qt as default};
