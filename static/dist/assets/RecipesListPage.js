import{S as Me,X as Te,F as ze,k as Pe,l as Be,m as Oe,n as Le,o as Ne,p as Ee,E as Qe,q as je,A as He,r as qe,s as Xe,P as Ke}from"./icons.js";import{p as Ce,V as v,h as i,a9 as Ue,b as s,c as ue,d as _e,g as n,Z as be,e as ae,k as B,v as se,m as a,q as ce,u as G,W as y,_ as A,i as ne,X as M,a2 as f,j as $,aa as Se,am as Ve,y as ie,a0 as xe,a4 as Re,an as de,ak as Ae,Y as We,a1 as ye,ah as Ye,ag as Ze,ao as Ge,$ as Je,a3 as ke,ap as $e}from"./appwrite.js";import{F as le}from"./Fieldset.js";import{A as et}from"./AutocompleteInput.js";import{B as tt}from"./BadgeList.js";import{C as Ie}from"./CheckboxBadge.js";import{R as Fe}from"./RecipeRegimeBadges.js";import{L as at}from"./LeftPanel.js";import{r as we}from"./RecipeDataStore.svelte.js";import{n as De}from"./index.js";import"./keyboardNavigation.svelte.js";var rt=v('<div><label class="input input-lg w-full"><!> <input type="text" placeholder="Rechercher... (parmi les titres, auteur·ices, spécialités. Désactive les filtres sélectionnés)"/> <button class="btn btn-circle" title="Effacer la recherche"><!></button></label></div>');function st(h,e){_e(e,!0);let l=Ce(e,"searchQuery",15);var o=rt(),L=n(o),I=n(L);Me(I,{class:"h-5 w-5 opacity-50"});var N=i(I,2),X=i(N,2);X.__click=function(...K){e.onReset?.apply(this,K)};var j=n(X);Te(j,{class:"h-5 w-5"}),Ue(N,l),s(h,o),ue()}be(["click"]);var nt=v('<div class="flex flex-wrap gap-3"></div>'),it=v('<div class="flex flex-wrap gap-3"></div>'),ot=v('<div class="mb-3"><!></div> <div><div class="mb-2 text-xs font-medium"> </div> <!></div>',1),lt=(h,e)=>e(e().testedStatus="all",!0),ct=(h,e)=>e(e().testedStatus="tested",!0),dt=(h,e)=>e(e().testedStatus="untested",!0),vt=v('<div class="bg-base-100 flex gap-1 rounded-xl p-2 font-semibold"><button type="button" aria-label="Toutes">Toutes</button> <button type="button" aria-label="Testées">Testées</button> <button type="button" aria-label="Non testées">À tester</button></div>'),ut=(h,e)=>e(e().temperature="",!0),_t=(h,e)=>e(e().temperature="Chaud",!0),bt=(h,e)=>e(e().temperature="Froid",!0),gt=v('<div class="bg-base-100 flex gap-1 rounded-xl p-2 font-semibold"><button type="button" aria-label="Indifférent">Indifférent</button> <button type="button" aria-label="Servir chaud">Chaud</button> <button type="button" aria-label="Servir froid">Froid</button></div>'),ft=(h,e)=>e(e().cuisson="",!0),mt=(h,e)=>e(e().cuisson="Oui",!0),pt=(h,e)=>e(e().cuisson="Non",!0),ht=v('<div class="bg-base-100 flex gap-1 rounded-xl p-2 font-semibold"><button type="button" aria-label="Indifférent">Indifférent</button> <button type="button" aria-label="Avec cuisson">Avec</button> <button type="button" aria-label="Sans cuisson">Sans</button></div>'),xt=(h,e)=>e(e().saison="",!0),yt=(h,e)=>e(e().saison="printemps",!0),kt=(h,e)=>e(e().saison="ete",!0),wt=(h,e)=>e(e().saison="automne",!0),Ct=(h,e)=>e(e().saison="hiver",!0),St=v('<div class="bg-base-100 flex flex-wrap gap-1 rounded-xl p-2 font-semibold"><button type="button" aria-label="Indifférent">Toutes</button> <button type="button" aria-label="Printemps">Printemps</button> <button type="button" aria-label="Été">Été</button> <button type="button" aria-label="Automne">Automne</button> <button type="button" aria-label="Hiver">Hiver</button></div>'),Rt=v('<div><div class="mb-4 flex items-center justify-between"><h4 class="text-lg font-bold">Filtres</h4> <button class="btn btn-warning btn-sm"><!> Effacer</button></div> <!> <!> <!> <!> <!> <!> <!></div>');function At(h,e){_e(e,!0);let l=Ce(e,"filters",15),o=Ce(e,"disabled",3,!1);function L(c,p){const d=c.indexOf(p);d===-1?c.push(p):c.splice(d,1),l({...l()})}let I=ce("");function N(c){l().ingredients.includes(c)||(l().ingredients.push(c),l({...l()}))}function X(c,p){const d=l().ingredients.indexOf(c);d!==-1&&(l().ingredients.splice(d,1),l({...l()}))}let j=G(()=>e.availableIngredients.filter(c=>!l().ingredients.includes(c)));var K=Rt();let ee;var te=n(K),J=i(n(te),2);J.__click=function(...c){e.onReset?.apply(this,c)};var k=n(J);ze(k,{class:"h-4 w-4"});var O=i(te,2);le(O,{legend:"Catégories",get iconComponent(){return Pe},children:(c,p)=>{var d=nt();ae(d,21,()=>e.availableCategories,ne,(_,u)=>{{let m=G(()=>l().categories.includes(a(u)));Ie(_,{get checked(){return a(m)},get label(){return a(u)},onchange:()=>L(l().categories,a(u)),get disabled(){return o()}})}}),s(c,d)},$$slots:{default:!0}});var H=i(O,2);le(H,{legend:"Régimes",get iconComponent(){return Be},children:(c,p)=>{var d=it();ae(d,21,()=>e.availableRegimes,ne,(_,u)=>{{let m=G(()=>l().regimes.includes(a(u)));Ie(_,{get checked(){return a(m)},get label(){return a(u)},onchange:()=>L(l().regimes,a(u)),get disabled(){return o()}})}}),s(c,d)},$$slots:{default:!0}});var q=i(H,2);le(q,{legend:"Ingrédients",get iconComponent(){return Oe},children:(c,p)=>{var d=ot(),_=B(d),u=n(_);et(u,{get items(){return a(j)},onSelect:N,placeholder:"Ajouter un ingrédient...",get disabled(){return o()},minQueryLength:1,get value(){return a(I)},set value(U){se(I,U,!0)}});var m=i(_,2),z=n(m),S=n(z),E=i(z,2);tt(E,{get items(){return l().ingredients},onRemove:X,badgeClass:"badge-success",get disabled(){return o()},itemKey:(U,Z)=>U}),y(()=>M(S,`Ingrédients sélectionnés (${l().ingredients.length??""})`)),s(c,d)},$$slots:{default:!0}});var V=i(q,2);le(V,{legend:"Testé",children:(c,p)=>{var d=vt(),_=n(d);_.__click=[lt,l];var u=i(_,2);u.__click=[ct,l];var m=i(u,2);m.__click=[dt,l],y(()=>{A(_,1,`btn btn-sm flex-1 ${l().testedStatus==="all"&&"btn-secondary"}`),A(u,1,`btn btn-sm flex-1 ${l().testedStatus==="tested"&&"btn-success"}`),A(m,1,`btn btn-sm flex-1 ${l().testedStatus==="untested"&&"btn-error"}`)}),s(c,d)},$$slots:{default:!0}});var F=i(V,2);le(F,{legend:"Service",get iconComponent(){return Le},children:(c,p)=>{var d=gt(),_=n(d);_.__click=[ut,l];var u=i(_,2);u.__click=[_t,l];var m=i(u,2);m.__click=[bt,l],y(()=>{A(_,1,`btn btn-sm flex-1 ${l().temperature===""&&"btn-secondary"}`),A(u,1,`btn btn-sm flex-1 ${l().temperature==="Chaud"&&"btn-error"}`),A(m,1,`btn btn-sm flex-1 ${l().temperature==="Froid"&&"btn-info"}`)}),s(c,d)},$$slots:{default:!0}});var T=i(F,2);le(T,{legend:"Cuisson",get iconComponent(){return Ne},children:(c,p)=>{var d=ht(),_=n(d);_.__click=[ft,l];var u=i(_,2);u.__click=[mt,l];var m=i(u,2);m.__click=[pt,l],y(()=>{A(_,1,`btn btn-sm flex-1 ${l().cuisson===""&&"btn-secondary"}`),A(u,1,`btn btn-sm flex-1 ${l().cuisson==="Oui"&&"btn-warning"}`),A(m,1,`btn btn-sm flex-1 ${l().cuisson==="Non"&&"btn-success"}`)}),s(c,d)},$$slots:{default:!0}});var Y=i(T,2);le(Y,{legend:"Saison",get iconComponent(){return Ee},children:(c,p)=>{var d=St(),_=n(d);_.__click=[xt,l];var u=i(_,2);u.__click=[yt,l];var m=i(u,2);m.__click=[kt,l];var z=i(m,2);z.__click=[wt,l];var S=i(z,2);S.__click=[Ct,l],y(()=>{A(_,1,`btn btn-sm flex-1 ${l().saison===""&&"btn-secondary"}`),A(u,1,`btn btn-sm flex-1 ${l().saison==="printemps"&&"btn-success"}`),A(m,1,`btn btn-sm flex-1 ${l().saison==="ete"&&"btn-warning"}`),A(z,1,`btn btn-sm flex-1 ${l().saison==="automne"&&"btn-accent"}`),A(S,1,`btn btn-sm flex-1 ${l().saison==="hiver"&&"btn-info"}`)}),s(c,d)},$$slots:{default:!0}}),y(c=>{ee=A(K,1,"mt-16 space-y-4",null,ee,c),J.disabled=o()},[()=>({"opacity-30":o()})]),s(h,K),ue()}be(["click"]);var It=v(`<span class="font-semibold"> </span> correspondent
          aux critères`,1),Ft=v(`<span class="font-semibold"> </span> correspondent
          aux critères`,1),Dt=v('<span class="font-semibold"> </span> correspond aux critères',1),Mt=v('<span class="font-semibold">1 recette</span> correspond aux critères',1),Tt=v('<span class="text-warning"> </span> ne correspond aux critères...',1),zt=v('<span class="text-warning">Aucune recette</span> ne correspond aux critères...',1),Pt=v('<legend class="legend text-base-content/70 ms-4"><!></legend>'),Bt=v('<div class="text-base-content/70 text-base"><!></div>'),Ot=v('<div><span class="text-base-content/60 italic">contient (dans son titre/auteur·ice...) :</span> <span class="font-bold"> </span></div>'),Lt=v('<span class="badge badge-success"> </span>'),Nt=v('<span class="badge badge-secondary"> </span>'),Et=v('<span class="badge badge-error text-white">Servir Chaud</span>'),Qt=v('<span class="badge badge-info">Servir Froid</span>'),jt=v('<span class="badge badge-warning">Avec Cuisson</span>'),Ht=v('<span class="badge badge-success">Sans Cuisson</span>'),qt=v('<span class="badge badge-accent"> </span>'),Xt=v('<span class="badge badge-success"> </span>'),Kt=v('<span class="badge badge-success">Testées</span>'),Ut=v('<span class="badge badge-error">À tester</span>'),Vt=v('<span class="badge badge-warning"> </span>'),Wt=v('<div class="flex flex-wrap gap-2"><!> <!> <!> <!> <!> <!> <!> <!></div> <div class="mt-3 text-end"><button class="btn btn-warning btn-sm"><!> Effacer tous les filtres</button></div>',1),Yt=v('<fieldset class="fieldset border-base-300 relative rounded-lg border-2"><!> <div class="p-4"><!> <!></div></fieldset>');function Zt(h,e){_e(e,!0);const l=G(()=>e.filters.categories.length>0||e.filters.regimes.length>0||e.filters.ingredients.length>0||e.filters.temperature!==""||e.filters.cuisson!==""||e.filters.saison!==""||e.filters.testedStatus!=="all"),o=G(()=>{switch(e.filters.typeR){case"entree":return"entrée";case"plat":return"plat";case"dessert":return"dessert";default:return""}});var L=Yt(),I=n(L);{var N=k=>{var O=Pt(),H=n(O);{var q=F=>{var T=$(),Y=B(T);{var c=d=>{var _=It(),u=B(_),m=n(u);y(()=>M(m,`${e.resultCount??""} ${a(o)??""}s`)),s(d,_)},p=d=>{var _=Ft(),u=B(_),m=n(u);y(()=>M(m,`${e.resultCount??""} recettes`)),s(d,_)};f(Y,d=>{a(o)?d(c):d(p,!1)})}s(F,T)},V=F=>{var T=$(),Y=B(T);{var c=d=>{var _=$(),u=B(_);{var m=S=>{var E=Dt(),U=B(E),Z=n(U);y(()=>M(Z,`1 ${a(o)??""}`)),s(S,E)},z=S=>{var E=Mt();s(S,E)};f(u,S=>{a(o)?S(m):S(z,!1)})}s(d,_)},p=d=>{var _=$(),u=B(_);{var m=S=>{var E=Tt(),U=B(E),Z=n(U);y(()=>M(Z,`Aucun ${a(o)??""}`)),s(S,E)},z=S=>{var E=zt();s(S,E)};f(u,S=>{a(o)?S(m):S(z,!1)},!0)}s(d,_)};f(Y,d=>{e.resultCount===1?d(c):d(p,!1)},!0)}s(F,T)};f(H,F=>{e.resultCount>1?F(q):F(V,!1)})}s(k,O)};f(I,k=>{a(l)&&k(N)})}var X=i(I,2),j=n(X);{var K=k=>{var O=Bt(),H=n(O);{var q=F=>{var T=Se();y(()=>M(T,`${e.resultCount??""} ${a(o)??""}s`)),s(F,T)},V=F=>{var T=Se();y(()=>M(T,`${e.resultCount??""} recettes`)),s(F,T)};f(H,F=>{a(o)?F(q):F(V,!1)})}s(k,O)};f(j,k=>{a(l)||k(K)})}var ee=i(j,2);{var te=k=>{var O=Ot(),H=i(n(O),2),q=n(H);y(()=>M(q,e.searchQuery)),s(k,O)},J=k=>{var O=$(),H=B(O);{var q=V=>{var F=Wt(),T=B(F),Y=n(T);ae(Y,17,()=>e.filters.categories,ne,(t,r)=>{var b=Lt(),w=n(b);y(()=>M(w,a(r))),s(t,b)});var c=i(Y,2);ae(c,17,()=>e.filters.regimes,ne,(t,r)=>{var b=Nt(),w=n(b);y(()=>M(w,a(r))),s(t,b)});var p=i(c,2);{var d=t=>{var r=Et();s(t,r)},_=t=>{var r=$(),b=B(r);{var w=C=>{var x=Qt();s(C,x)};f(b,C=>{e.filters.temperature==="Froid"&&C(w)},!0)}s(t,r)};f(p,t=>{e.filters.temperature==="Chaud"?t(d):t(_,!1)})}var u=i(p,2);{var m=t=>{var r=jt();s(t,r)},z=t=>{var r=$(),b=B(r);{var w=C=>{var x=Ht();s(C,x)};f(b,C=>{e.filters.cuisson==="Non"&&C(w)},!0)}s(t,r)};f(u,t=>{e.filters.cuisson==="Oui"?t(m):t(z,!1)})}var S=i(u,2);{var E=t=>{var r=qt(),b=n(r);y(()=>M(b,e.filters.saison)),s(t,r)};f(S,t=>{e.filters.saison&&t(E)})}var U=i(S,2);ae(U,17,()=>e.filters.ingredients,ne,(t,r)=>{var b=Xt(),w=n(b);y(()=>M(w,a(r))),s(t,b)});var Z=i(U,2);{var ge=t=>{var r=Kt();s(t,r)},fe=t=>{var r=$(),b=B(r);{var w=C=>{var x=Ut();s(C,x)};f(b,C=>{e.filters.testedStatus==="untested"&&C(w)},!0)}s(t,r)};f(Z,t=>{e.filters.testedStatus==="tested"?t(ge):t(fe,!1)})}var me=i(Z,2);{var ve=t=>{var r=Vt(),b=n(r);y(()=>M(b,a(o))),s(t,r)};f(me,t=>{e.filters.typeR&&t(ve)})}var pe=i(T,2),g=n(pe);g.__click=function(...t){e.onResetFilters?.apply(this,t)};var R=n(g);Qe(R,{class:"h-4 w-4"}),s(V,F)};f(H,V=>{a(l)&&V(q)},!0)}s(k,O)};f(ee,k=>{e.searchQuery.length>=2?k(te):k(J,!1)})}s(h,L),ue()}be(["click"]);var Gt=(h,e)=>{(h.key==="Enter"||h.key===" ")&&e()},Jt=v('<div class="badge badge-accent badge-outline badge-sm">brouillon</div>'),$t=v('<h3 class="text-primary bg-base-100 rounded-t-box border-t-base-300 absolute -top-4 left-0 flex max-w-4/5 items-center-safe gap-3 border-t-1 py-0.5 ps-4 pe-6"><svg class="inline size-6 shrink-0"><use></use></svg> <!></h3> <div class="bg-base-100 rounded-t-box border-base-300 absolute -top-4 right-0 border-t-1 px-1"><!></div>',1),ea=v('<div class="badge badge-accent badge-outline badge-sm">brouillon</div>'),ta=v('<div class="flex gap-4"><div class="text-primary mb-2 inline-flex flex-wrap items-center-safe gap-2 text-lg font-semibold"><div class="items-start-safe inline-flex gap-2"><svg class="mt-0.5 size-6 min-w-6"><use></use></svg> </div> <!></div> <!></div>'),aa=v('<span class="text-primary text-base font-bold"> </span>'),ra=v("<span> </span>"),sa=v("<p> </p>"),na=v("<p> <strong>(non testée)</strong></p>"),ia=v('<span class="badge badge-ghost badge-sm"> </span>'),oa=v('<span class="badge badge-primary badge-soft badge-sm"> </span>'),la=v("<!> <!>",1),ca=v('<span class="badge badge-soft badge-sm badge-error">Servir Chaud</span>'),da=v('<span class="badge badge-soft badge-sm badge-info">Servir Froid</span>'),va=v('<span class="badge badge-soft badge-sm badge-warning">Avec Cuisson</span>'),ua=v('<span class="badge badge-soft badge-sm badge-success">Sans Cuisson</span>'),_a=v('<span class="badge badge-soft badge-accent badge-sm"> </span>'),ba=v("<span> <!></span>"),ga=v('<div class="my-1 text-sm"><span class="font-semibold">Ingrédients :</span> <!></div>'),fa=v('<span class="me-1"> <!></span>'),ma=v('<div class="text-sm"><span class="font-semibold">Matériel :</span> <!></div>'),pa=v('<div role="button" tabindex="0"><!> <div class=" flex flex-wrap items-start justify-between gap-4 @md:my-2"><div class="min-w-72 flex-1"><!> <div class=" flex flex-col"><div><!> <!></div> <div class="text-base-content/60 text-sm"><!></div></div></div> <div class="ms-auto flex flex-col justify-end gap-2"><div class=" flex flex-wrap justify-end gap-1 pt-1"><!></div> <div class="mb-2 flex flex-wrap justify-end gap-1"><!> <!> <!></div></div></div> <!> <!></div>');function ha(h,e){_e(e,!0);let l=Ce(e,"highlightedIngredients",19,()=>[]);function o(){xe(`/recipe/${e.recipe.$id}`)}const L=Ve(e.recipe.typeR,e.recipe.categories||void 0);var I=pa();I.__click=o,I.__keydown=[Gt,o];var N=n(I);{var X=t=>{var r=$t(),b=B(r),w=n(b),C=n(w),x=i(w),D=i(x);{var Q=P=>{var he=Jt();s(P,he)};f(D,P=>{e.recipe.draft&&P(Q)})}var W=i(b,2),oe=n(W);{var re=P=>{Fe(P,{get regimes(){return e.recipe.regime},iconOnly:!0})};f(oe,P=>{e.recipe.regime&&P(re)})}y(()=>{Re(C,"href",`/icons/sprite.svg#${L.iconId}`),M(x,` ${e.recipe.title??""} `)}),s(t,r)};f(N,t=>{ie.isDesktop&&t(X)})}var j=i(N,2),K=n(j),ee=n(K);{var te=t=>{var r=ta(),b=n(r),w=n(b),C=n(w),x=n(C),D=i(C),Q=i(w,2);{var W=P=>{var he=ea();s(P,he)};f(Q,P=>{e.recipe.draft&&P(W)})}var oe=i(b,2);{var re=P=>{Fe(P,{get regimes(){return e.recipe.regime},iconOnly:!0})};f(oe,P=>{e.recipe.regime&&P(re)})}y(()=>{Re(x,"href",`/icons/sprite.svg#${L.iconId}`),M(D,` ${e.recipe.title??""}`)}),s(t,r)};f(ee,t=>{ie.isDesktop||t(te)})}var J=i(ee,2),k=n(J),O=n(k);{var H=t=>{var r=aa(),b=n(r);y(()=>M(b,e.recipe.versionLabel)),s(t,r)};f(O,t=>{e.recipe.versionLabel&&t(H)})}var q=i(O,2);{var V=t=>{var r=ra(),b=n(r);y(()=>{A(r,1,de(e.recipe.auteur===ie.userName?"text-accent font-semibold":"text-base-content/70 ")),M(b,`de ${e.recipe.auteur??""}`)}),s(t,r)};f(q,t=>{e.recipe.auteur&&t(V)})}var F=i(k,2),T=n(F);{var Y=t=>{var r=sa(),b=n(r);y(()=>M(b,`testée pour ${e.recipe.plate??""}
              couverts`)),s(t,r)},c=t=>{var r=na(),b=n(r);y(()=>M(b,`théoriquement pour ${e.recipe.plate??""} couverts `)),s(t,r)};f(T,t=>{e.recipe.check?t(Y):t(c,!1)})}var p=i(K,2),d=n(p),_=n(d);{var u=t=>{var r=la(),b=B(r);{var w=x=>{var D=ia(),Q=n(D);y(()=>M(Q,e.recipe.region)),s(x,D)};f(b,x=>{e.recipe.region&&x(w)})}var C=i(b,2);ae(C,17,()=>e.recipe.categories,ne,(x,D)=>{var Q=oa(),W=n(Q);y(()=>M(W,a(D))),s(x,Q)}),s(t,r)};f(_,t=>{e.recipe.categories&&t(u)})}var m=i(d,2),z=n(m);{var S=t=>{var r=ca();s(t,r)},E=t=>{var r=da();s(t,r)};f(z,t=>{e.recipe.serveHot?t(S):t(E,!1)})}var U=i(z,2);{var Z=t=>{var r=va();s(t,r)},ge=t=>{var r=ua();s(t,r)};f(U,t=>{e.recipe.cuisson?t(Z):t(ge,!1)})}var fe=i(U,2);{var me=t=>{var r=$(),b=B(r);ae(b,17,()=>e.recipe.saison,ne,(w,C)=>{var x=_a(),D=n(x);y(()=>M(D,a(C))),s(w,x)}),s(t,r)};f(fe,t=>{e.recipe.saison&&t(me)})}var ve=i(j,2);{var pe=t=>{var r=ga(),b=i(n(r),2);ae(b,17,()=>e.recipe.ingredients,ne,(w,C,x)=>{var D=ba();let Q;var W=n(D),oe=i(W);{var re=P=>{var he=Se(",");s(P,he)};f(oe,P=>{x<e.recipe.ingredients.length-1&&P(re)})}y(P=>{Q=A(D,1,"me-1",null,Q,P),M(W,a(C))},[()=>({"font-bold":l().includes(a(C)),underline:l().includes(a(C))})]),s(w,D)}),s(t,r)};f(ve,t=>{e.recipe.ingredients&&e.recipe.ingredients.length>0&&t(pe)})}var g=i(ve,2);{var R=t=>{var r=ma(),b=i(n(r),2);ae(b,17,()=>e.recipe.materiel,ne,(w,C,x)=>{var D=fa(),Q=n(D),W=i(Q);{var oe=re=>{var P=Se(",");s(re,P)};f(W,re=>{x<e.recipe.materiel.length-1&&re(oe)})}y(()=>M(Q,a(C))),s(w,D)}),s(t,r)};f(g,t=>{e.recipe.materiel&&e.recipe.materiel.length>0&&t(R)})}y(()=>A(I,1,`card bg-base-100 cursor-pointer p-4 shadow-sm transition-shadow hover:shadow-md ${e.recipe.auteur===ie.userName&&"border-accent/60 border-l-3"}`)),s(h,I),ue()}be(["click","keydown"]);var xa=(h,e)=>e("title"),ya=(h,e)=>e("$createdAt"),ka=(h,e)=>e("$updatedAt"),wa=()=>xe("/recipe"),Ca=()=>xe("/recipe/my"),Sa=()=>xe("/recipe/my/draft"),Ra=v('<fieldset class="fieldset"><legend class="legend label"><!> Filtrer :</legend> <div class="btn-group"><button>Tout</button> <button>Mes recettes</button> <button>Mes brouillons</button></div></fieldset>'),Aa=v('<div class="bg-base-300 rounded-box flex flex-wrap items-center justify-between gap-6 px-6 py-6"><fieldset class="fieldset"><legend class="legend label"><!> Trier par :</legend> <div class="btn-group"><button aria-label="Trier par titre">Titre</button> <button aria-label="Trier par date de création"><!> Date de création</button> <button aria-label="Trier par date de modification"><!> Date de modification</button></div></fieldset> <!></div>');function Ia(h,e){_e(e,!0);const l=c=>e.sortBy!==c?"inactive":e.sortOrder,o=c=>{c==="title"?e.onSortChange("title",e.sortBy==="title"&&e.sortOrder==="asc"?"desc":"asc"):e.sortBy!==c?e.onSortChange(c,"desc"):e.sortOrder==="desc"?e.onSortChange(c,"asc"):e.onSortChange("title","asc")},L=c=>{const p=l(c),d="btn btn-sm btn-primary btn-outline gap-2";return p==="inactive"?`${d}`:p==="asc"?`${d} btn-active`:`${d} btn-active`},I=c=>{const p=l(c);return p==="inactive"?null:p==="asc"?He:qe},N=c=>{const p="btn btn-sm btn-secondary";return e.scope===c?`${p}`:`${p} btn-outline`};var X=Aa(),j=n(X),K=n(j),ee=n(K);je(ee,{class:"inline size-4"});var te=i(K,2),J=n(te);J.__click=[xa,o];var k=i(J,2);k.__click=[ya,o];var O=n(k);{var H=c=>{const p=G(()=>I("$createdAt"));var d=$(),_=B(d);Ae(_,()=>a(p),(u,m)=>{m(u,{size:16})}),s(c,d)};f(O,c=>{I("$createdAt")&&c(H)})}var q=i(k,2);q.__click=[ka,o];var V=n(q);{var F=c=>{const p=G(()=>I("$updatedAt"));var d=$(),_=B(d);Ae(_,()=>a(p),(u,m)=>{m(u,{size:16})}),s(c,d)};f(V,c=>{I("$updatedAt")&&c(F)})}var T=i(j,2);{var Y=c=>{var p=Ra(),d=n(p),_=n(d);Xe(_,{class:"inline h-4 w-4"});var u=i(d,2),m=n(u);m.__click=[wa];var z=i(m,2);z.__click=[Ca];var S=i(z,2);S.__click=[Sa],y((E,U,Z)=>{A(m,1,E),A(z,1,U),A(S,1,Z)},[()=>de(N("all")),()=>de(N("mine")),()=>de(N("drafts"))]),s(c,p)};f(T,c=>{ie.isAuthenticated&&c(Y)})}y((c,p,d)=>{A(J,1,c),A(k,1,p),A(q,1,d)},[()=>de(L("title")),()=>de(L("$createdAt")),()=>de(L("$updatedAt"))]),s(h,X),ue()}be(["click"]);const Fa=h=>{var e=$(),l=B(e);{var o=L=>{var I=Ma();I.__click=[Da];var N=n(I);Ke(N,{size:18}),s(L,I)};f(l,L=>{ie.isAuthenticated&&L(o)})}s(h,e)};var Da=()=>xe("/recipe/new"),Ma=v('<button class="btn btn-primary"><!> Créer une recette</button>'),Ta=(h,e)=>a(e).typeR="",za=(h,e)=>a(e).typeR="entree",Pa=(h,e)=>a(e).typeR="plat",Ba=(h,e)=>a(e).typeR="dessert",Oa=v('<div class="alert alert-error"><span> </span></div>'),La=v('<div class="py-8 text-center"><span class="loading loading-spinner loading-md"></span></div>'),Na=v('<div class="py-12 text-center"><p class="text-base-content/60 text-lg">Aucune recette ne correspond aux critères...</p></div>'),Ea=v('<div class="my-8 space-y-10"></div> <!> <!>',1),Qa=v('<!> <div class="p-4 lg:ml-100"><div class="mx-auto max-w-4xl"><div class="mb-10 space-y-6"><div class="tabs tabs-border tabs-lg mb-6 font-bold"><button>Toutes</button> <button>Entrées</button> <button>Plats</button> <button>Desserts</button></div> <div class="mb-4"><!></div> <div class="mb-6"><!></div> <!></div> <!></div></div> ```',1);function Ja(h,e){_e(e,!0);let l=ce(""),o=ce(We({categories:[],regimes:[],temperature:"",cuisson:"",saison:"",testedStatus:"all",ingredients:[],typeR:"",scope:"all"})),L=20,I=ce(1),N=ce(void 0),X=ce("title"),j=ce("asc");const K=G(()=>ke.isInitialized?ke.getAllRecipes():[]),ee=G(()=>{const g=new Set;return a(K).forEach(R=>R.categories?.forEach(t=>g.add(t))),Array.from(g).sort()}),te=["vegan","vegetarien","sans-gluten","sans-lactose"],J=G(()=>we.isInitialized?we.ingredientNames:[]),k=G(()=>{if(a(l).length>=2){const g=a(l).toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu,"");return a(K).filter(R=>{const t=R.title.toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu,"").includes(g),r=R.auteur?.toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu,"").includes(g)||!1,b=R.region?.toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu,"").includes(g)||!1,w=!a(o).typeR||R.typeR===a(o).typeR;return(t||r||b)&&w})}return a(K).filter(g=>{const R=!a(o).categories.length||a(o).categories.some(W=>g.categories?.includes(W)),t=!a(o).regimes.length||a(o).regimes.some(W=>g.regime?.includes(W)),r=!a(o).temperature||g.serveHot===(a(o).temperature==="Chaud"),b=!a(o).cuisson||(a(o).cuisson==="Oui"?g.cuisson===!0:g.cuisson===!1),w=!a(o).saison||g.saison?.includes(a(o).saison),C=a(o).testedStatus==="all"||a(o).testedStatus==="tested"&&g.check||a(o).testedStatus==="untested"&&!g.check,x=!a(o).ingredients.length||a(o).ingredients.every(W=>g.ingredients?.includes(W)),D=!a(o).typeR||g.typeR===a(o).typeR;let Q=!0;return a(o).scope==="mine"?Q=g.createdBy===ie.userId:a(o).scope==="drafts"&&(Q=g.createdBy===ie.userId&&g.draft===!0),R&&t&&r&&b&&w&&C&&x&&D&&Q})}),O=G(()=>[...a(k)].sort((R,t)=>{if(a(X)==="title")return a(j)==="asc"?R.title.localeCompare(t.title,"fr"):t.title.localeCompare(R.title,"fr");if(a(X)==="$createdAt"){const r=new Date(t.$createdAt||0).getTime()-new Date(R.$createdAt||0).getTime();return a(j)==="asc"?-r:r}else{const r=new Date(t.$updatedAt||0).getTime()-new Date(R.$updatedAt||0).getTime();return a(j)==="asc"?-r:r}})),H=G(()=>a(O).slice(0,a(I)*L)),q=G(()=>a(l).length>=2);function V(){se(l,"")}function F(){se(o,{categories:[],regimes:[],temperature:"",cuisson:"",saison:"",testedStatus:"all",ingredients:[],typeR:"",scope:a(o).scope},!0)}ye(()=>{if(!a(N))return;const g=new IntersectionObserver(R=>{R[0].isIntersecting&&a(H).length<a(k).length&&Ge(I)},{threshold:.1});return g.observe(a(N)),()=>g.disconnect()}),ye(()=>{a(k),a(X),a(j),se(I,1)}),ye(()=>{const g=Je.path;g==="/recipe/my/draft"?a(o).scope="drafts":g==="/recipe/my"?a(o).scope="mine":a(o).scope="all"}),ye(()=>{De.setConfig({title:a(o).scope==="mine"?"Mes recettes":a(o).scope==="drafts"?"Mes brouillons":"Recettes",actions:Fa})}),Ye(()=>{De.reset()}),Ze(async()=>{we.isInitialized||await we.initialize()});var T=Qa(),Y=B(T);at(Y,{width:"100",children:(g,R)=>{At(g,{get disabled(){return a(q)},get availableCategories(){return a(ee)},get availableRegimes(){return te},get availableIngredients(){return a(J)},onReset:F,get filters(){return a(o)},set filters(t){se(o,t,!0)}})},$$slots:{default:!0}});var c=i(Y,2),p=n(c),d=n(p),_=n(d),u=n(_);u.__click=[Ta,o];var m=i(u,2);m.__click=[za,o];var z=i(m,2);z.__click=[Pa,o];var S=i(z,2);S.__click=[Ba,o];var E=i(_,2),U=n(E);st(U,{onReset:V,get searchQuery(){return a(l)},set searchQuery(g){se(l,g,!0)}});var Z=i(E,2),ge=n(Z);Zt(ge,{get searchQuery(){return a(l)},get filters(){return a(o)},get resultCount(){return a(k).length},onResetFilters:F});var fe=i(Z,2);Ia(fe,{get sortBy(){return a(X)},get sortOrder(){return a(j)},onSortChange:(g,R)=>{se(X,g,!0),se(j,R,!0)},get scope(){return a(o).scope}});var me=i(d,2);{var ve=g=>{var R=Oa(),t=n(R),r=n(t);y(()=>M(r,`Erreur : ${ke.error??""}`)),s(g,R)},pe=g=>{var R=Ea(),t=B(R);ae(t,21,()=>a(H),x=>x.$id,(x,D)=>{ha(x,{get recipe(){return a(D)},get highlightedIngredients(){return a(o).ingredients}})});var r=i(t,2);{var b=x=>{var D=La();$e(D,Q=>se(N,Q),()=>a(N)),s(x,D)};f(r,x=>{a(H).length<a(k).length&&x(b)})}var w=i(r,2);{var C=x=>{var D=Na();s(x,D)};f(w,x=>{a(k).length===0&&x(C)})}s(g,R)};f(me,g=>{ke.error?g(ve):g(pe,!1)})}y(()=>{A(u,1,`tab ${a(o).typeR===""?"tab-active":""}`),A(m,1,`tab ${a(o).typeR==="entree"?"tab-active":""}`),A(z,1,`tab ${a(o).typeR==="plat"?"tab-active":""}`),A(S,1,`tab ${a(o).typeR==="dessert"?"tab-active":""}`)}),s(h,T),ue()}be(["click"]);export{Ja as default};
