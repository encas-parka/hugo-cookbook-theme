import{Z as G,v as x,I as y,O as K,b as l,c as Z,d as F,g as r,D as I,A as c,_ as H,G as J,y as P,E,B as N,m,j as L,k as q,h as b,w as T,x as j,K as Q,o as s}from"./appwrite.js";import{e as W,j as X,C as Y}from"./icons.js";import{f as $}from"./index.js";var ee=x('<div class="flex flex-col items-center gap-4 text-center"><!> <h2 class="text-2xl font-bold">Vérification en cours...</h2> <p class="text-base-content/70">Veuillez patienter pendant que nous vérifions votre email.</p></div>'),te=x('<div class="flex flex-col items-center gap-4 text-center"><!> <h2 class="text-success text-2xl font-bold">Email vérifié !</h2> <p class="text-base-content/70"> </p> <button class="btn btn-primary">Aller au tableau de bord</button></div>'),ae=x(`<div class="flex flex-col items-center gap-4 text-center"><!> <h2 class="text-error text-2xl font-bold">Erreur de vérification</h2> <p class="text-base-content/70"> </p> <div class="flex gap-2"><button class="btn btn-outline">Retour à l'accueil</button> <button class="btn btn-primary">Tableau de bord</button></div></div>`),re=x('<div class="bg-base-200 flex min-h-screen items-center justify-center p-4"><div class="bg-base-100 max-w-md rounded-xl p-8 shadow-lg"><!></div></div>');function ne(D,R){F(R,!0);let i=P("loading"),d=P("");G(async()=>{let t=I.query.userId,a=I.query.secret;if(!t||!a){const e=new URLSearchParams(window.location.search);t=e.get("userId"),a=e.get("secret")}if(!t||!a){c(i,"error"),c(d,"Paramètres de vérification manquants. Vérifiez le lien dans l'email.");return}try{const{account:e}=await H(()=>import("./appwrite.js").then(v=>v.b3),[]).then(v=>v.getAppwriteInstances());await(await e).updateVerification(t,a),await J.refreshAuthAfterLogin(),c(i,"success"),c(d,"Votre email a été vérifié avec succès ! Vous allez être redirigé..."),setTimeout(()=>{E("/dashboard")},2e3)}catch(e){console.error("Erreur lors de la vérification:",e),c(i,"error"),c(d,e instanceof Error?e.message:"Une erreur est survenue lors de la vérification. Le lien a peut-être expiré.",!0)}});function V(){E("/dashboard")}var g=re(),h=r(g),C=r(h);{var M=t=>{var a=ee(),e=r(a);W(e,{class:"text-primary size-16 animate-spin"}),Q(4),s(a),l(t,a)},O=t=>{var a=L(),e=q(a);{var v=o=>{var n=te(),p=r(n);X(p,{class:"text-success size-16"});var u=b(p,4),f=r(u,!0);s(u);var _=b(u,2);_.__click=V,s(n),T(()=>j(f,m(d))),l(o,n)},S=o=>{var n=L(),p=q(n);{var u=f=>{var _=ae(),k=r(_);Y(k,{class:"text-error size-16"});var w=b(k,4),U=r(w,!0);s(w);var z=b(w,2),A=r(z);A.__click=()=>E("/");var B=b(A,2);B.__click=V,s(z),s(_),T(()=>j(U,m(d))),l(f,_)};y(p,f=>{m(i)==="error"&&f(u)},!0)}l(o,n)};y(e,o=>{m(i)==="success"?o(v):o(S,!1)},!0)}l(t,a)};y(C,t=>{m(i)==="loading"?t(M):t(O,!1)})}s(h),s(g),K(1,h,()=>$),l(D,g),Z()}N(["click"]);export{ne as default};
