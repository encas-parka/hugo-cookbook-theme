const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/RecipesListPage.js","assets/icons.js","assets/appwrite.js","assets/Fieldset.js","assets/AutocompleteInput.js","assets/keyboardNavigation.svelte.js","assets/BadgeList.js","assets/CheckboxBadge.js","assets/RecipeRegimeBadges.js","assets/LeftPanel.js","assets/RecipeDataStore.svelte.js","assets/RecipeCreatePage.js","assets/RecipeEditPage2.js","assets/products-display.js","assets/tiptap-markdown.es.js","assets/BtnGroupCheck.js","assets/RecipeEditPage.css","assets/UnsavedChangesGuard.js","assets/RecipeEditPage.js","assets/ConfirmModal.js","assets/RecipeVariants.js","assets/RecipeDetailPage.js","assets/RecipePreparation.js","assets/SvelteMarkdown.js","assets/SvelteMarkdown.css","assets/AcceptInvite.js","assets/ResetPassword.js","assets/ResetPassword.css","assets/DashboardPage.js","assets/date-helpers.js","assets/CreateTeamModal.js","assets/InfoCollapse.js","assets/event-stats-helpers.js","assets/DocCard.js","assets/TeamsManagement.js","assets/EventCreatePage.js","assets/EventMealCard.js","assets/EventEditPage.js","assets/EventInvitationAlert.js","assets/EventStats.js","assets/EventRecipesPage.js","assets/EventRecipesPage.css","assets/EventProductsPage.js","assets/EventProductsPage.css","assets/EventPosterPage.js","assets/EventPosterPage.css","assets/MaterielPage.js","assets/LoansPage.js","assets/LoanReturnPage.js","assets/EventListPage.js","assets/CreateDocumentPage.js","assets/MarkdownEditorAdvanced.js","assets/MarkdownEditorAdvanced.css","assets/CreateDocumentPage.css","assets/EditDocumentPage.js","assets/EditDocumentPage.css","assets/DocumentListPage.js"])))=>i.map(i=>d[i]);
var da=Object.defineProperty;var jt=n=>{throw TypeError(n)};var ua=(n,e,t)=>e in n?da(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var ze=(n,e,t)=>ua(n,typeof e!="symbol"?e+"":e,t),Dt=(n,e,t)=>e.has(n)||jt("Cannot "+t);var a=(n,e,t)=>(Dt(n,e,"read from private field"),t?t.call(n):e.get(n)),B=(n,e,t)=>e.has(n)?jt("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),Ie=(n,e,t,r)=>(Dt(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t),V=(n,e,t)=>(Dt(n,e,"access private method"),t);import{q as P,m as o,v as l,w as Vt,x as qe,y as x,z as ht,A as Ye,B as kt,C as Le,D as Et,S as xt,u as he,Q as dt,E as qt,F as Yt,G as va,H as ha,I as ma,J as bt,K as fa,L as _a,M as pa,N as ba,O as ga,P as ya,R as wa,T as Ea,U as Sa,V as b,h,g as c,W as U,X as ve,b as u,Y as xa,Z as Ne,d as xe,e as et,_ as Pe,i as It,c as Ae,$,a0 as de,p as ye,a1 as ct,k as Y,a2 as w,s as Ue,a3 as Ct,a4 as Je,j as ce,a5 as tt,a6 as He,a7 as Pt,t as Aa,a8 as Ta,a9 as Ra,aa as Ma,ab as Ia,ac as La,ad as Da,ae as J,af as Ca,ag as Oa,ah as ka,ai as Ot,aj as Pa,ak as Na}from"./appwrite.js";import{X as Jt,C as Ba,a as za,L as Ut,b as Fa,U as $a,P as ja,B as Va,R as qa,c as Ya,d as Ua,e as Ha,f as Ga,A as Wa,g as Ka,h as Ht}from"./icons.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var We,at,rt,St;class Qa{constructor(){B(this,rt);B(this,We,P(!1));B(this,at,!1)}async loadCache(){o(a(this,We))||(l(a(this,We),!0),console.log("[NotificationStore] Cache charg√© : 0 notifications (pas de cache)"))}async syncFromRemote(){console.log("[NotificationStore] Sync : pas de donn√©es √† charger")}async setupRealtime(){if(a(this,at)){console.log("[NotificationStore] D√©j√† configur√©, skip.");return}try{console.log("[NotificationStore] Configuration du realtime...");const e=Vt();qe.register([`databases.${e}.collections.user_notifications.documents`],async t=>{const r=t.payload,i=x.currentMainId;if(!(r.userId!=="broadcast"&&r.userId!==x.userId)&&t.events.some(s=>s.includes(".create"))){if(r.notificationType==="event_access_granted"&&r.targetCollection==="main")console.log("[NotificationStore] üîî Event access granted:",r.targetDocumentId),await ht.reload(),await V(this,rt,St).call(this,r.$id);else if(r.notificationType==="team_access_granted")console.log("[NotificationStore] üîî Team access granted:",r.targetDocumentId),await Ye.reload(),await V(this,rt,St).call(this,r.$id);else if(r.notificationType==="batch_products_update"){const s=r.targetDocumentId;i===s&&(console.log("[NotificationStore] üîî Batch data update for current event:",s),await kt.syncFromAppwrite(),kt.clearSyncStatus(),console.log("[NotificationStore] ‚úÖ Sync status cleared for batch update"),r.from?r.from===x.userId?console.log("[NotificationStore] Batch update from current user - no toast"):r.from==="system"?Le.info("Produits mis a jour",{source:"system"}):Le.info("Les produits ont √©t√© modifi√©s par un¬∑e autre utilisateur¬∑ices",{source:"realtime-other"}):console.warn("[NotificationStore] Legacy notification without 'from' field - ignoring")),await V(this,rt,St).call(this,r.$id)}}}),l(a(this,We),!0),Ie(this,at,!0),console.log("[NotificationStore] ‚úÖ Notifications de d√©couverte configur√©es (RealtimeManager)")}catch(e){throw console.error("[NotificationStore] Erreur lors de la configuration du realtime:",e),e}}async initialize(){await this.loadCache(),await this.syncFromRemote(),await this.setupRealtime()}destroy(){l(a(this,We),!1),Ie(this,at,!1),console.log("[NotificationStore] Store d√©truit")}}We=new WeakMap,at=new WeakMap,rt=new WeakSet,St=async function(e){try{const t=await Et(),r=Vt();await t.tables.deleteRow({databaseId:r,tableId:"user_notifications",rowId:e}),console.log(`[NotificationStore] Notification supprim√©e: ${e}`)}catch(t){console.error("[NotificationStore] Erreur lors de la suppression de la notification:",t)}};const gt=new Qa;class Ja{constructor(){ze(this,"dbName","materiel-cache");ze(this,"db",null);ze(this,"version",1);ze(this,"MATERIELS_STORE","materiels");ze(this,"LOANS_STORE","loans");ze(this,"METADATA_STORE","metadata");ze(this,"LAST_SYNC_MATERIEL_KEY","lastSyncMateriel");ze(this,"LAST_SYNC_LOANS_KEY","lastSyncLoans")}async open(){if(this.db)return;const e=()=>new Promise((d,v)=>{const m=indexedDB.open(this.dbName,this.version);m.onerror=()=>v(m.error),m.onsuccess=()=>d(m.result),m.onupgradeneeded=f=>{const g=f.target.result;g.objectStoreNames.contains(this.MATERIELS_STORE)||(g.createObjectStore(this.MATERIELS_STORE,{keyPath:"$id"}),console.log("[MaterielIDBCache] Object store 'materiels' cr√©√©")),g.objectStoreNames.contains(this.LOANS_STORE)||(g.createObjectStore(this.LOANS_STORE,{keyPath:"$id"}),console.log("[MaterielIDBCache] Object store 'loans' cr√©√©")),g.objectStoreNames.contains(this.METADATA_STORE)||(g.createObjectStore(this.METADATA_STORE,{keyPath:"key"}),console.log("[MaterielIDBCache] Object store 'metadata' cr√©√©"))}});let t=await e();const r=t.objectStoreNames.contains(this.MATERIELS_STORE),i=t.objectStoreNames.contains(this.LOANS_STORE),s=t.objectStoreNames.contains(this.METADATA_STORE);(!r||!i||!s)&&(console.warn(`[MaterielIDBCache] Base incompl√®te d√©tect√©e (materiels=${r}, loans=${i}, metadata=${s}), suppression et recr√©ation...`),t.close(),await new Promise((d,v)=>{const m=indexedDB.deleteDatabase(this.dbName);m.onsuccess=()=>d(),m.onerror=()=>v(m.error),m.onblocked=()=>{console.warn("[MaterielIDBCache] Suppression bloqu√©e, r√©essai...")}}),t=await e()),this.db=t,console.log(`[MaterielIDBCache] Base ouverte: ${this.dbName}`)}async loadMateriels(){if(!this.db)throw new Error("DB non ouverte");return new Promise((e,t)=>{const s=this.db.transaction(this.MATERIELS_STORE,"readonly").objectStore(this.MATERIELS_STORE).getAll();s.onsuccess=()=>{const d=new Map;s.result.forEach(v=>{d.set(v.$id,v)}),console.log(`[MaterielIDBCache] ${d.size} mat√©riels charg√©s`),e(d)},s.onerror=()=>t(s.error)})}async saveMateriels(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((t,r)=>{const i=this.db.transaction(this.MATERIELS_STORE,"readwrite"),s=i.objectStore(this.MATERIELS_STORE);s.clear(),e.forEach(d=>{s.put(d)}),i.oncomplete=()=>{console.log(`[MaterielIDBCache] ${e.size} mat√©riels sauvegard√©s`),t()},i.onerror=()=>r(i.error)})}async upsertMateriel(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((t,r)=>{const d=this.db.transaction(this.MATERIELS_STORE,"readwrite").objectStore(this.MATERIELS_STORE).put(e);d.onsuccess=()=>{console.log(`[MaterielIDBCache] Mat√©riel ${e.$id} sauvegard√©`),t()},d.onerror=()=>r(d.error)})}async deleteMateriel(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((t,r)=>{const d=this.db.transaction(this.MATERIELS_STORE,"readwrite").objectStore(this.MATERIELS_STORE).delete(e);d.onsuccess=()=>{console.log(`[MaterielIDBCache] Mat√©riel ${e} supprim√©`),t()},d.onerror=()=>r(d.error)})}async loadLoans(){if(!this.db)throw new Error("DB non ouverte");return new Promise((e,t)=>{const s=this.db.transaction(this.LOANS_STORE,"readonly").objectStore(this.LOANS_STORE).getAll();s.onsuccess=()=>{const d=new Map;s.result.forEach(v=>{d.set(v.$id,v)}),console.log(`[MaterielIDBCache] ${d.size} emprunts charg√©s`),e(d)},s.onerror=()=>t(s.error)})}async saveLoans(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((t,r)=>{const i=this.db.transaction(this.LOANS_STORE,"readwrite"),s=i.objectStore(this.LOANS_STORE);s.clear(),e.forEach(d=>{s.put(d)}),i.oncomplete=()=>{console.log(`[MaterielIDBCache] ${e.size} emprunts sauvegard√©s`),t()},i.onerror=()=>r(i.error)})}async upsertLoan(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((t,r)=>{const d=this.db.transaction(this.LOANS_STORE,"readwrite").objectStore(this.LOANS_STORE).put(e);d.onsuccess=()=>{console.log(`[MaterielIDBCache] Emprunt ${e.$id} sauvegard√©`),t()},d.onerror=()=>r(d.error)})}async deleteLoan(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((t,r)=>{const d=this.db.transaction(this.LOANS_STORE,"readwrite").objectStore(this.LOANS_STORE).delete(e);d.onsuccess=()=>{console.log(`[MaterielIDBCache] Emprunt ${e} supprim√©`),t()},d.onerror=()=>r(d.error)})}async loadMetadata(){if(!this.db)throw new Error("DB non ouverte");return new Promise((e,t)=>{const s=this.db.transaction(this.METADATA_STORE,"readonly").objectStore(this.METADATA_STORE).getAll();s.onsuccess=()=>{const d=s.result,v={lastSyncMateriel:null,lastSyncLoans:null};d.forEach(m=>{m.key===this.LAST_SYNC_MATERIEL_KEY&&(v.lastSyncMateriel=m.value),m.key===this.LAST_SYNC_LOANS_KEY&&(v.lastSyncLoans=m.value)}),console.log(`[MaterielIDBCache] Metadata charg√©es: lastSyncMateriel=${v.lastSyncMateriel}, lastSyncLoans=${v.lastSyncLoans}`),e(v)},s.onerror=()=>t(s.error)})}async saveMetadata(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((t,r)=>{const i=this.db.transaction(this.METADATA_STORE,"readwrite"),s=i.objectStore(this.METADATA_STORE);s.put({key:this.LAST_SYNC_MATERIEL_KEY,value:e.lastSyncMateriel}),s.put({key:this.LAST_SYNC_LOANS_KEY,value:e.lastSyncLoans}),i.oncomplete=()=>{console.log("[MaterielIDBCache] Metadata sauvegard√©es"),t()},i.onerror=()=>r(i.error)})}async clear(){if(!this.db)throw new Error("DB non ouverte");return new Promise((e,t)=>{const r=this.db.transaction([this.MATERIELS_STORE,this.LOANS_STORE,this.METADATA_STORE],"readwrite");r.objectStore(this.MATERIELS_STORE).clear(),r.objectStore(this.LOANS_STORE).clear(),r.objectStore(this.METADATA_STORE).clear(),r.oncomplete=()=>{console.log("[MaterielIDBCache] Cache vid√©"),e()},r.onerror=()=>t(r.error)})}close(){this.db&&(this.db.close(),this.db=null,console.log("[MaterielIDBCache] Connexion ferm√©e"))}}async function Xa(){const n=new Ja;return await n.open(),n}function Nt(n){const e={electronic:{label:"√âlectronique",badgeClass:"badge-warning",textColor:"text-warning",bgColor:"bg-warning/10"},manual:{label:"Manuel",badgeClass:"badge-info",textColor:"text-info",bgColor:"bg-info/10"},tools:{label:"Outils",badgeClass:"badge-secondary",textColor:"text-secondary",bgColor:"bg-secondary/10"},dish:{label:"Vaisselle",badgeClass:"badge-primary",textColor:"text-primary",bgColor:"bg-primary/10"},cooking:{label:"Cuisine",badgeClass:"badge-success",textColor:"text-success",bgColor:"bg-success/10"},gaz:{label:"Gaz",badgeClass:"badge-error",textColor:"text-error",bgColor:"bg-error/10"},hygiene:{label:"Hygi√®ne",badgeClass:"badge-info",textColor:"text-info",bgColor:"bg-info/10"},other:{label:"Autre",badgeClass:"badge-neutral",textColor:"text-neutral",bgColor:"bg-neutral/10"}};return e[n||"other"]||e.other}function Qs(n){return Nt(n).badgeClass}function Js(n){return Nt(n).textColor}function Xs(n){return Nt(n).bgColor}function Zs(n){return{ok:"OK",lost:"Perdu",torepair:"√Ä r√©parer"}[n||"ok"]||n||"OK"}const Gt={userName:"",userId:"",teamName:"",teamId:""};function Za(n){if(!n)return Gt;try{return typeof n=="string"?JSON.parse(n):n}catch(e){return console.error("[materiel.utils] Error parsing owner from Appwrite:",n,e),Gt}}function Bt(n){if(!n)return[];try{return Array.isArray(n)?n.map(e=>{try{return JSON.parse(e)}catch{return console.warn("[materiel.utils] Failed to parse loan item string:",e),null}}).filter(e=>e!==null):typeof n=="string"?JSON.parse(n):[]}catch(e){return console.error("[materiel.utils] Error parsing loan items from Appwrite:",n,e),[]}}function er(n){return Bt(n)}function ut(n){return{...n,materielItems:er(n.materiels)}}function Xt(n,e,t=new Date){const r=Za(n.owner),i=[];let s=0;e.forEach(f=>{const M=Bt(f.materiels).filter(_=>_.materielId===n.$id);if(M.length===0)return;const E=new Date(f.startDate),F=new Date(f.endDate),z=E<=t&&F>=t,ne=E>t,C=["accepted","asked"].includes(f.status);(z||ne)&&C&&M.forEach(_=>{i.push({loanId:f.$id,responsibleName:f.responsibleName||"",startDate:f.startDate,endDate:f.endDate,quantity:_.quantity,status:f.status})}),z&&C&&M.forEach(_=>{s+=_.quantity})});const v=i.some(f=>{const g=new Date(f.startDate),M=new Date(f.endDate);return g<=t&&M>=t})?"loan":n.status,m=n.quantity-s;return{...n,status:v,ownerData:r,loanDetails:i,availableQuantity:m,totalLoanedQuantity:s,isAvailable:m>0,isFullyLoaned:m===0}}function tr(n,e){const t={...n};return Xt(t,e)}function ar(n){return["asked","accepted"].includes(n.status)}function rr(n,e,t,r){return n<=r&&e>=t}function sr(n,e,t,r){let i=0;return e.forEach(s=>{if(!ar(s))return;const d=new Date(s.startDate),v=new Date(s.endDate);if(!rr(d,v,t,r))return;const f=Bt(s.materiels).filter(g=>g.materielId===n);i+=f.reduce((g,M)=>g+M.quantity,0)}),i}var ee,ie,K,te,Z,Ke,mt,st,Oe,ke,At,Fe,Tt,Rt,Mt,ft,Q,Zt,ea,ta,aa,ra,sa,Xe,Ze;class or{constructor(){B(this,Q);B(this,ee,new xt);B(this,ie,new xt);B(this,K,null);B(this,te,P(!1));B(this,Z,P(null));B(this,Ke,P(!1));B(this,mt,P(!1));B(this,st,!1);B(this,Oe,P(null));B(this,ke,P(null));B(this,At,null);B(this,Fe,he(()=>Array.from(a(this,ee).values())));B(this,Tt,he(()=>Array.from(a(this,ie).values())));B(this,Rt,he(()=>{if(!x.userId)return[];const e=Ye.myTeams.map(t=>t.$id);return o(a(this,Fe)).filter(t=>t.ownerData?.teamId&&e.includes(t.ownerData.teamId))}));B(this,Mt,he(()=>{if(!x.userId)return[];const e=Ye.myTeams.map(t=>t.$id);return o(a(this,Fe)).filter(t=>t.shareableWith?.some(i=>e.includes(i))&&!(t.ownerData?.teamId&&e.includes(t.ownerData.teamId)))}));B(this,ft,he(()=>o(a(this,Fe)).filter(e=>e.isAvailable)))}get loading(){return o(a(this,te))}get error(){return o(a(this,Z))}get isInitialized(){return o(a(this,Ke))}get isRealtimeActive(){return o(a(this,mt))}get count(){return a(this,ee).size}get materiels(){return o(a(this,Fe))}get loans(){return o(a(this,Tt))}get teamMateriels(){return o(a(this,Rt))}get shareableMateriels(){return o(a(this,Mt))}get availableMateriels(){return o(a(this,ft))}getAvailableMaterielsByOwner(e){return o(a(this,ft)).filter(t=>t.ownerData?.teamId===e&&t.status!=="lost"&&t.status!=="torepair")}getMaterielsByOwner(e){return o(a(this,Fe)).filter(t=>t.ownerData?.teamId===e)}getAvailableMaterielsForPeriod(e,t,r){const i=new Date(t),s=new Date(r),d=Array.from(a(this,ie).values());return o(a(this,Fe)).filter(v=>v.ownerData?.teamId===e).filter(v=>v.status!=="lost"&&v.status!=="torepair").map(v=>{const m=sr(v.$id,d,i,s),f=v.quantity-m;return{...v,availableForPeriod:f}}).filter(v=>v.availableForPeriod>0)}async loadCache(){if(!o(a(this,Ke))){l(a(this,te),!0),l(a(this,Z),null);try{if(!x.userId){l(a(this,Ke),!0);return}Ie(this,K,await Xa()),await V(this,Q,Zt).call(this),l(a(this,Ke),!0),console.log(`[MaterielStore] Cache charg√© : ${a(this,ee).size} mat√©riels, ${a(this,ie).size} emprunts`)}catch(e){throw l(a(this,Z),e instanceof Error?e.message:"Erreur de chargement du cache",!0),console.error("[MaterielStore] LoadCache error:",e),e}finally{l(a(this,te),!1)}}}async syncFromRemote(){l(a(this,te),!0),l(a(this,Z),null);try{if(!x.userId)return;await V(this,Q,ea).call(this),console.log(`[MaterielStore] Sync termin√© : ${a(this,ee).size} mat√©riels, ${a(this,ie).size} emprunts`)}catch(e){throw l(a(this,Z),e instanceof Error?e.message:"Erreur de synchronisation",!0),console.error("[MaterielStore] SyncFromRemote error:",e),e}finally{l(a(this,te),!1)}}async setupRealtime(){if(x.userId){if(a(this,st)){console.log("[MaterielStore] Realtime d√©j√† configur√©");return}try{await V(this,Q,aa).call(this),l(a(this,mt),!0),Ie(this,st,!0),console.log("[MaterielStore] Realtime configur√©")}catch(e){throw l(a(this,Z),e instanceof Error?e.message:"Erreur de configuration realtime",!0),console.error("[MaterielStore] SetupRealtime error:",e),e}}}async initialize(){await this.loadCache(),await this.syncFromRemote(),await this.setupRealtime()}getMaterielById(e){return a(this,ee).get(e)}getLoanById(e){return a(this,ie).get(e)}async createMateriel(e){l(a(this,te),!0),l(a(this,Z),null);try{if(!x.userId)throw new Error("Utilisateur non connect√©");const t=await ma(e,x.userId),r=V(this,Q,Xe).call(this,t);return a(this,ee).set(t.$id,r),a(this,K)?.upsertMateriel(r),r}catch(t){throw l(a(this,Z),t instanceof Error?t.message:"Erreur de cr√©ation",!0),t}finally{l(a(this,te),!1)}}async updateMateriel(e,t){l(a(this,te),!0),l(a(this,Z),null);try{const r=await bt(e,t),i=V(this,Q,Xe).call(this,r);a(this,ee).set(r.$id,i),a(this,K)?.upsertMateriel(i)}catch(r){throw l(a(this,Z),r instanceof Error?r.message:"Erreur de mise √† jour",!0),r}finally{l(a(this,te),!1)}}async deleteMateriel(e){l(a(this,te),!0),l(a(this,Z),null);try{await fa(e),a(this,ee).delete(e),a(this,K)?.deleteMateriel(e)}catch(t){throw l(a(this,Z),t instanceof Error?t.message:"Erreur de suppression",!0),t}finally{l(a(this,te),!1)}}async createLoan(e){l(a(this,te),!0),l(a(this,Z),null);try{if(!x.userId)throw new Error("Utilisateur non connect√©");const t=await _a(e,x.userId);return ut(t)}catch(t){throw l(a(this,Z),t instanceof Error?t.message:"Erreur de cr√©ation",!0),t}finally{l(a(this,te),!1)}}async updateLoan(e,t){l(a(this,te),!0),l(a(this,Z),null);try{await pa(e,t)}catch(r){throw l(a(this,Z),r instanceof Error?r.message:"Erreur de mise √† jour",!0),r}finally{l(a(this,te),!1)}}async acceptLoan(e){await this.updateLoan(e,{status:"accepted"})}async refuseLoan(e){await this.updateLoan(e,{status:"refused"})}async cancelLoan(e){await this.updateLoan(e,{status:"canceled"})}async completeLoanWithReturn(e,t){for(const r of t.materiels){const i=r.lostQuantity||0,s=r.brokenQuantity||0;i+s>=r.quantity?await bt(r.materielId,{status:"lost"}):s>0?await bt(r.materielId,{status:"torepair"}):await bt(r.materielId,{status:"ok"})}await this.updateLoan(e,{status:"completed",returnedAt:new Date().toISOString(),returnNotes:t.returnNotes,materiels:t.materiels})}async completeLoan(e){await this.updateLoan(e,{status:"completed",returnedAt:new Date().toISOString()})}async deleteLoan(e){l(a(this,te),!0),l(a(this,Z),null);try{const t=a(this,ie).get(e);t&&V(this,Q,Ze).call(this,t),await ba(e)}catch(t){throw l(a(this,Z),t instanceof Error?t.message:"Erreur de suppression",!0),t}finally{l(a(this,te),!1)}}async hardReset(){console.log("[MaterielStore] üîÑ HARD RESET - Vidage complet..."),l(a(this,te),!0),l(a(this,Z),null);try{if(a(this,ee).clear(),a(this,ie).clear(),a(this,K)&&(await a(this,K).clear(),console.log("[MaterielStore] Cache IDB vid√©")),await V(this,Q,ta).call(this),a(this,K)){for(const[,e]of a(this,ee))await a(this,K).upsertMateriel(e);for(const[,e]of a(this,ie))await a(this,K).upsertLoan(e);await a(this,K).saveMetadata({lastSyncMateriel:o(a(this,Oe)),lastSyncLoans:o(a(this,ke))}),console.log("[MaterielStore] Cache IDB recr√©√©")}console.log("[MaterielStore] ‚úì HARD RESET termin√©")}catch(e){const t=e instanceof Error?e.message:"Erreur lors du hard reset";throw l(a(this,Z),t,!0),console.error("[MaterielStore] Erreur hard reset:",e),e}finally{l(a(this,te),!1)}}destroy(){var e;(e=a(this,At))==null||e.call(this),a(this,ee).clear(),a(this,ie).clear(),Ie(this,K,null),Ie(this,st,!1)}}ee=new WeakMap,ie=new WeakMap,K=new WeakMap,te=new WeakMap,Z=new WeakMap,Ke=new WeakMap,mt=new WeakMap,st=new WeakMap,Oe=new WeakMap,ke=new WeakMap,At=new WeakMap,Fe=new WeakMap,Tt=new WeakMap,Rt=new WeakMap,Mt=new WeakMap,ft=new WeakMap,Q=new WeakSet,Zt=async function(){if(a(this,K))try{(await a(this,K).loadMateriels()).forEach(i=>{a(this,ee).set(i.$id,i)}),(await a(this,K).loadLoans()).forEach(i=>{const s=ut(i);a(this,ie).set(i.$id,s)});const r=await a(this,K).loadMetadata();l(a(this,Oe),r.lastSyncMateriel,!0),l(a(this,ke),r.lastSyncLoans,!0),console.log(`[MaterielStore] ${a(this,ee).size} mat√©riels et ${a(this,ie).size} emprunts charg√©s du cache IDB`)}catch(e){console.warn("[MaterielStore] Erreur lecture cache IDB, ignor√©:",e)}},ea=async function(){try{const e=o(a(this,Oe))?[dt.greaterThan("$updatedAt",o(a(this,Oe)))]:[],t=await qt(e);for(const s of t){const d=V(this,Q,Xe).call(this,s);a(this,ee).set(s.$id,d),a(this,K)?.upsertMateriel(d)}l(a(this,Oe),new Date().toISOString(),!0);const r=o(a(this,ke))?[dt.greaterThan("$updatedAt",o(a(this,ke))),dt.limit(100)]:[],i=await Yt(r);for(const s of i){const d=ut(s);a(this,ie).set(s.$id,d),a(this,K)?.upsertLoan(s),V(this,Q,Ze).call(this,d)}l(a(this,ke),new Date().toISOString(),!0),await a(this,K)?.saveMetadata({lastSyncMateriel:o(a(this,Oe)),lastSyncLoans:o(a(this,ke))}),console.log("[MaterielStore] Sync termin√©")}catch(e){throw console.error("[MaterielStore] Erreur sync:",e),e}},ta=async function(){try{console.log("[MaterielStore] Chargement complet depuis Appwrite...");const e=await qt([dt.limit(1e3)]);for(const i of e){const s=V(this,Q,Xe).call(this,i);a(this,ee).set(i.$id,s)}const t=await Yt([dt.limit(1e3)]),r=[];for(const i of t){const s=ut(i);a(this,ie).set(i.$id,s),r.push(s)}for(const i of r)V(this,Q,Ze).call(this,i);l(a(this,Oe),new Date().toISOString(),!0),l(a(this,ke),new Date().toISOString(),!0),console.log(`[MaterielStore] ${e.length} mat√©riels et ${t.length} emprunts charg√©s`)}catch(e){throw console.error("[MaterielStore] Erreur chargement complet:",e),e}},aa=async function(){qe.register(va(),async e=>{await V(this,Q,ra).call(this,e)}),qe.register(ha(),async e=>{await V(this,Q,sa).call(this,e)})},ra=async function(e){try{const t=e.events,r=e.payload;if(!r){console.warn("[MaterielStore] Realtime Materiel : pas de payload dans la r√©ponse");return}const i=t.some(s=>s.includes(".create"))?"create":t.some(s=>s.includes(".delete"))?"delete":"update";if(console.log(`[MaterielStore] ‚ö°Ô∏è Realtime Materiel RECEIVED: ${i} pour ${r.$id}`),i==="create"||i==="update"){const s=V(this,Q,Xe).call(this,r);a(this,ee).set(r.$id,s),a(this,K)?.upsertMateriel(s)}else i==="delete"&&(a(this,ee).delete(r.$id),a(this,K)?.deleteMateriel(r.$id))}catch(t){console.error("[MaterielStore] Erreur realtime Materiel:",t)}},sa=async function(e){try{const t=e.events,r=e.payload;if(!r){console.warn("[MaterielStore] Realtime Loan : pas de payload dans la r√©ponse");return}const i=t.some(s=>s.includes(".create"))?"create":t.some(s=>s.includes(".delete"))?"delete":"update";if(console.log(`[MaterielStore] ‚ö°Ô∏è Realtime Loan RECEIVED: ${i} pour ${r.$id}`),i==="create"||i==="update"){const s=ut(r);a(this,ie).set(r.$id,s),a(this,K)?.upsertLoan(r),V(this,Q,Ze).call(this,s)}else if(i==="delete"){const s=a(this,ie).get(r.$id);s&&V(this,Q,Ze).call(this,s),a(this,ie).delete(r.$id),a(this,K)?.deleteLoan(r.$id)}}catch(t){console.error("[MaterielStore] Erreur realtime Loan:",t)}},Xe=function(e){const t=Array.from(a(this,ie).values());return Xt(e,t)},Ze=function(e){const t=e.materielItems,r=Array.from(a(this,ie).values());for(const i of t){const s=a(this,ee).get(i.materielId);if(s){const d=tr(s,r);a(this,ee).set(i.materielId,d),a(this,K)?.upsertMateriel(d)}}};const yt=new or;var fe,ot,je,$e,Ve,it,nt,_t,Qe,lt,we,oa,ia,Ge;class ir{constructor(){B(this,we);B(this,fe,new xt);B(this,ot,new xt);B(this,je,P(!1));B(this,$e,P(null));B(this,Ve,P(!1));B(this,it,P(!1));B(this,nt,!1);B(this,_t,P(null));B(this,Qe,null);B(this,lt,he(()=>Array.from(a(this,fe).values())))}get loading(){return o(a(this,je))}get error(){return o(a(this,$e))}get isInitialized(){return o(a(this,Ve))}get isRealtimeActive(){return o(a(this,it))}get count(){return a(this,fe).size}get documents(){return o(a(this,lt))}getTeamDocuments(e){return o(a(this,lt)).filter(t=>t.teamId===e)}getTeamTags(e){return a(this,ot).get(e)||[]}async loadCache(){if(!o(a(this,Ve))){l(a(this,je),!0),l(a(this,$e),null);try{if(!x.userId){l(a(this,Ve),!0);return}l(a(this,Ve),!0),console.log("[TeamdocsStore] Cache charg√© (sans IDB)")}catch(e){throw l(a(this,$e),e instanceof Error?e.message:"Erreur de chargement du cache",!0),console.error("[TeamdocsStore] LoadCache error:",e),e}finally{l(a(this,je),!1)}}}async syncFromRemote(){l(a(this,je),!0),l(a(this,$e),null);try{if(!x.userId)return;const e=await ga();for(const t of e)a(this,fe).set(t.$id,t);await V(this,we,Ge).call(this),l(a(this,_t),new Date().toISOString(),!0),console.log(`[TeamdocsStore] Sync termin√© : ${a(this,fe).size} documents`)}catch(e){throw l(a(this,$e),e instanceof Error?e.message:"Erreur de synchronisation",!0),console.error("[TeamdocsStore] SyncFromRemote error:",e),e}finally{l(a(this,je),!1)}}async setupRealtime(){if(x.userId){if(a(this,nt)){console.log("[TeamdocsStore] Realtime d√©j√† configur√©");return}try{await V(this,we,oa).call(this),l(a(this,it),!0),Ie(this,nt,!0),console.log("[TeamdocsStore] Realtime configur√©")}catch(e){throw l(a(this,$e),e instanceof Error?e.message:"Erreur de configuration realtime",!0),console.error("[TeamdocsStore] SetupRealtime error:",e),e}}}async initialize(){await this.loadCache(),await this.syncFromRemote(),await this.setupRealtime()}async createDocument(e,t){if(!x.userId||!x.userName)throw new Error("Utilisateur non connect√©");const r=await ya(e,t,x.userId,x.userName);return a(this,fe).set(r.$id,r),await V(this,we,Ge).call(this),console.log(`[TeamdocsStore] Document cr√©√© : ${r.$id}`),r}async updateDocument(e,t){const r=await wa(e,t);return a(this,fe).set(e,r),t.tags&&await V(this,we,Ge).call(this),console.log(`[TeamdocsStore] Document mis √† jour : ${e}`),r}async deleteDocument(e){await Ea(e),a(this,fe).delete(e),await V(this,we,Ge).call(this),console.log(`[TeamdocsStore] Document supprim√© : ${e}`)}getDocumentById(e){return a(this,fe).get(e)}async updateDocumentLock(e,t){if(x.userId)try{await Sa(e,t);const r=a(this,fe).get(e);r&&a(this,fe).set(e,{...r,lockedBy:t}),console.log(`[TeamdocsStore] Verrou ${e} mis √† jour: ${t||"lib√©r√©"}`)}catch(r){throw console.error(`[TeamdocsStore] Erreur verrouillage ${e}:`,r),r}}destroy(){a(this,Qe)&&(a(this,Qe).call(this),Ie(this,Qe,null)),a(this,fe).clear(),a(this,ot).clear(),l(a(this,Ve),!1),l(a(this,it),!1),Ie(this,nt,!1),console.log("[TeamdocsStore] Store d√©truit")}async hardReset(){this.destroy(),l(a(this,_t),null),console.log("[TeamdocsStore] Hard reset effectu√©")}}fe=new WeakMap,ot=new WeakMap,je=new WeakMap,$e=new WeakMap,Ve=new WeakMap,it=new WeakMap,nt=new WeakMap,_t=new WeakMap,Qe=new WeakMap,lt=new WeakMap,we=new WeakSet,oa=async function(){const e=["databases.*.collections.undefined"];qe.register(e,async t=>{await V(this,we,ia).call(this,t)}),Ie(this,Qe,()=>{})},ia=async function(e){const{events:t,payload:r}=e,i=t?.[0];if(!i)return;const s=r;switch(i){case"databases.*.collections.*.documents.create":case"databases.*.collections.*.documents.update":s&&(a(this,fe).set(s.$id,s),await V(this,we,Ge).call(this),console.log(`[TeamdocsStore] Document mis √† jour : ${s.$id}`));break;case"databases.*.collections.*.documents.delete":s?.$id&&(a(this,fe).delete(s.$id),await V(this,we,Ge).call(this),console.log(`[TeamdocsStore] Document supprim√© : ${s.$id}`));break}},Ge=async function(){const e=new Map;for(const t of o(a(this,lt))){const r=t.teamId;e.has(r)||e.set(r,new Set),t.tags&&t.tags.forEach(i=>{e.get(r).add(i)})}e.forEach((t,r)=>{a(this,ot).set(r,Array.from(t).sort())}),console.log(`[TeamdocsStore] Tags mis √† jour pour ${e.size} √©quipes`)};const wt=new ir;var nr=b('<div class="alert alert-error shadow-lg"><svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l-2-2m0 0l-2-2m2 2l2-2m-2 2l-2 2m8-8l2 2m0 0l2 2m-2-2l-2-2m2 2l2 2"></path></svg> <div><h3 class="font-bold">Erreur</h3> <div class="text-sm"> </div></div></div>');function Wt(n,e){var t=nr(),r=h(c(t),2),i=h(c(r),2),s=c(i);U(()=>ve(s,e.message)),u(n,t)}var _e;class lr{constructor(){B(this,_e,P(xa({title:""})))}get title(){return o(a(this,_e)).title||"ENKA Cookbook"}get backAction(){return o(a(this,_e)).backAction}get actions(){return o(a(this,_e)).actions}get tabs(){return o(a(this,_e)).tabs}get eventId(){return o(a(this,_e)).eventId}get activeTab(){return o(a(this,_e)).activeTab||0}get isLockedByOthers(){return o(a(this,_e)).isLockedByOthers||!1}get lockedByUserName(){return o(a(this,_e)).lockedByUserName||""}get hasUnsavedChanges(){return o(a(this,_e)).hasUnsavedChanges||!1}get materielContext(){return o(a(this,_e)).materielContext||null}get teamId(){return o(a(this,_e)).teamId}setConfig(e){l(a(this,_e),{...e},!0)}reset(){l(a(this,_e),{title:""},!0)}}_e=new WeakMap;const le=new lr;var cr=b("<button> </button>"),dr=b('<div class="rounded-box bg-secondary/10 px-4 py-1"><div class="tabs tabs-border justify-center"></div></div>');function Kt(n,e){xe(e,!0);const t=[{label:"√âditer l'√©v√©nement",path:"/dashboard/eventEdit"},{label:"Voir les recettes",path:"/dashboard/eventEdit/recipes"},{label:"Listes des produits",path:"/dashboard/eventEdit/products"},{label:"Affiches",path:"/dashboard/eventPosters"}],r=he(()=>{const v=$.path;return v.includes("/eventEdit/recipes/")?1:v.includes("/eventEdit/products/")?2:v.includes("/eventPosters/")?3:(v.includes("/eventEdit/")&&e.eventId&&new RegExp(`/dashboard/eventEdit/${e.eventId}(/?$)`).test(v),0)});function i(v){e.eventId&&(v===1?de(`/dashboard/eventEdit/recipes/${e.eventId}`):v===2?de(`/dashboard/eventEdit/products/${e.eventId}`):v===3?de(`/dashboard/eventPosters/${e.eventId}`):de(`/dashboard/eventEdit/${e.eventId}`))}var s=dr(),d=c(s);et(d,21,()=>t,It,(v,m,f)=>{var g=cr();g.__click=()=>i(f);var M=c(g);U(()=>{Pe(g,1,`tab font-semibold ${f===o(r)?"tab-active":""}`),ve(M,o(m).label)}),u(v,g)}),u(n,s),Ae()}Ne(["click"]);var ur=b("<button> </button>"),vr=b('<div class="tabs tabs-lg tabs-border justify-center"></div>');function Qt(n,e){xe(e,!0);const t=[{label:"Mat√©riel",getPath:()=>i()},{label:"Reservations",getPath:()=>s()}],r=he(()=>$.path.includes("/loans")?1:0);function i(){if(e.currentTeamId)return`/dashboard/materiel/${e.currentTeamId}`;const m=Ye.myTeams;return m.length>0?`/dashboard/materiel/${m[0].$id}`:"/dashboard/materiel"}function s(){if(e.currentTeamId)return`/dashboard/loans/${e.currentTeamId}`;const m=Ye.myTeams;return m.length>0?`/dashboard/loans/${m[0].$id}`:"/dashboard/loans"}function d(m){const f=t[m].getPath();de(f)}var v=vr();et(v,21,()=>t,It,(m,f,g)=>{var M=ur();M.__click=()=>d(g);var E=c(M);U(()=>{Pe(M,1,`tab font-medium ${g===o(r)?"tab-active":""}`),ve(E,o(f).label)}),u(m,M)}),u(n,v),Ae()}Ne(["click"]);function hr(n,e,t){l(e,!1),t.onClose()}function mr(n,e){l(e,!1)}var fr=b('<div role="dialog" aria-modal="true"><!></div>'),_r=b('<div class="modal modal-open" style="z-index: 1100"><div class="modal-box max-w-md"><h3 class="text-lg font-bold">Confirmer la fermeture</h3> <p class="py-4"> </p> <div class="modal-action"><button class="btn btn-ghost">Annuler</button> <button class="btn btn-error">Fermer sans sauvegarder</button></div></div></div>'),pr=b("<div><!></div> <!>",1);function br(n,e){xe(e,!0);let t=ye(e,"fullscreenOnMobile",3,!0);ye(e,"closeOnBackdropClick",3,!1);let r=ye(e,"hasUnsavedChanges",3,!1),i=ye(e,"confirmCloseMessage",3,"Vous avez des modifications non sauvegard√©es. Voulez-vous vraiment fermer ?"),s=ye(e,"maxWidth",3,"lg"),d=ye(e,"maxHeight",3,"xl"),v=ye(e,"modalClass",3,"");function m(_,y){return{sm:{"max-w":"max-w-[28rem]","max-h":"max-h-[85vh]"},lg:{"max-w":"max-w-[64rem]","max-h":"max-h-[85vh]"},xl:{"max-w":"max-w-[90vw]","max-h":"max-h-[90vh]"}}[_][y]}let f=P(!1);function g(){r()?l(f,!0):e.onClose()}ct(()=>{if(!e.isOpen)return;const _=y=>{y.key==="Escape"&&!o(f)&&g()};return window.addEventListener("keydown",_),()=>window.removeEventListener("keydown",_)}),ct(()=>{if(e.isOpen)return document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}});var M=pr(),E=Y(M),F=c(E);{var z=_=>{var y=fr(),A=c(y);Ue(A,()=>e.children),U((k,p)=>Pe(y,1,`modal-box flex flex-col p-0 ${v()??""} ${t()&&x.isMobile?"fixed inset-0 m-0 h-lvh w-lvw rounded-none":"fixed top-10 m-auto"} ${k??""} ${p??""}`),[()=>x.isDesktop&&m(s(),"max-w"),()=>x.isDesktop&&!v()&&m(d(),"max-h")]),u(_,y)};w(F,_=>{e.isOpen&&_(z)})}var ne=h(E,2);{var C=_=>{var y=_r(),A=c(y),k=h(c(A),2),p=c(k),j=h(k,2),X=c(j);X.__click=[mr,f];var q=h(X,2);q.__click=[hr,f,e],U(()=>ve(p,i())),u(_,y)};w(ne,_=>{o(f)&&_(C)})}U(()=>Pe(E,1,`modal ${(e.isOpen&&"modal-open")??""} `)),u(n,M),Ae()}Ne(["click"]);var gr=b('<button class="btn btn-circle btn-ghost btn-sm flex-none" aria-label="Retour"><!></button>'),yr=b('<button class="btn btn-circle btn-ghost btn-sm flex-none" aria-label="Retour"><!></button>'),wr=b('<p class="text-base-content/70 truncate text-sm"> </p>'),Er=b('<div class="flex items-center gap-2 sm:me-10"><!></div>'),Sr=b('<div class="border-base-300 flex-none border-b px-4 py-3"><div class="absolute top-2 right-2"><!></div> <div class="flex flex-wrap items-center gap-2"><div class="flex min-w-0 flex-1 items-center gap-2"><!> <div class="max-w-11/12 min-w-0 flex-1 items-baseline"><h3 class="truncate text-lg font-bold"> </h3> <!></div></div> <!></div></div>');function xr(n,e){xe(e,!0);let t=ye(e,"showBackButton",3,!0);var r=Sr(),i=c(r),s=c(i);{var d=y=>{var A=gr();A.__click=function(...p){e.onClose?.apply(this,p)};var k=c(A);Jt(k,{class:"h-5 w-5"}),u(y,A)};w(s,y=>{x.isMobile||y(d)})}var v=h(i,2),m=c(v),f=c(m);{var g=y=>{var A=yr();A.__click=function(...p){e.onClose?.apply(this,p)};var k=c(A);Ba(k,{class:"h-5 w-5"}),u(y,A)};w(f,y=>{t()&&x.isMobile&&y(g)})}var M=h(f,2),E=c(M),F=c(E),z=h(E,2);{var ne=y=>{var A=wr(),k=c(A);U(()=>ve(k,e.subtitle)),u(y,A)};w(z,y=>{e.subtitle&&y(ne)})}var C=h(m,2);{var _=y=>{var A=Er(),k=c(A);Ue(k,()=>e.children),u(y,A)};w(C,y=>{e.children&&y(_)})}U(()=>ve(F,e.title)),u(n,r),Ae()}Ne(["click"]);var Ar=b('<div class="flex-1 overflow-y-auto p-4 sm:p-6 sm:pt-2"><!></div>');function Tr(n,e){var t=Ar(),r=c(t);Ue(r,()=>e.children),u(n,t)}var Rr=b('<div class="border-base-300 flex-none border-t px-4 py-3"><div class="flex flex-wrap items-center justify-end gap-2"><!></div></div>');function Mr(n,e){var t=Rr(),r=c(t),i=c(r);Ue(i,()=>e.children),u(n,t)}var Ir=b('<div role="alert" class="alert alert-error svelte-o861tn"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 shrink-0 stroke-current" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span> </span></div>'),Lr=b('<div role="alert" class="alert alert-success svelte-o861tn"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 shrink-0 stroke-current" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span> </span></div>'),Dr=(n,e)=>l(e,!1),Cr=b(`<form class="space-y-4 svelte-o861tn"><div class="form-control svelte-o861tn"><label for="forgot-email" class="label"><span class="label-text">Email</span></label> <input id="forgot-email" type="email" class="input input-bordered w-full" placeholder="votre@email.com"/></div> <div class="alert alert-info alert-soft svelte-o861tn">Un email avec un lien vous sera envoy√© par "noreply@appwrite.io".
            Pensez √† v√©rifier s'il n'a pas att√©ri dans votre dossier spam.</div></form> <div class="text-center svelte-o861tn"><button class="btn btn-ghost btn-sm">‚Üê Retour √† la connexion</button></div>`,1),Or=(n,e)=>l(e,!0),kr=(n,e)=>l(e,!1),Pr=b(`<form class="space-y-4 svelte-o861tn"><div class="form-control svelte-o861tn"><label for="login-email" class="label"><span class="label-text">Email</span></label> <input id="login-email" type="email" class="input input-bordered w-full" placeholder="votre@email.com" required/></div> <div class="form-control svelte-o861tn"><label for="login-password" class="label"><span class="label-text">Mot de passe</span></label> <input id="login-password" type="password" class="input input-bordered w-full" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required/></div></form> <div class="space-y-2 text-center svelte-o861tn"><button class="btn btn-link btn-sm btn-primary svelte-o861tn">Mot de passe oubli√© ?</button> <div class="text-base-content/70 text-sm svelte-o861tn">Pas encore de compte ? <button class="btn btn-primary btn-sm btn-soft ms-1">S'inscrire</button></div></div>`,1),Nr=(n,e)=>l(e,!0),Br=b(`<form class="space-y-4 svelte-o861tn"><div class="form-control svelte-o861tn"><label for="register-name" class="label"><span class="label-text">Nom</span></label> <input id="register-name" type="text" class="input input-bordered w-full" placeholder="Votre nom" required/></div> <div class="form-control svelte-o861tn"><label for="register-email" class="label"><span class="label-text">Email</span></label> <input id="register-email" type="email" class="input input-bordered w-full" placeholder="votre@email.com" required/></div> <div class="form-control svelte-o861tn"><label for="register-password" class="label"><span class="label-text">Mot de passe</span></label> <input id="register-password" type="password" class="input input-bordered w-full" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required/></div> <div class="alert alert-info alert-soft svelte-o861tn">Un email avec un lien vous sera envoy√© par "noreply@appwrite.io".
            Pensez √† v√©rifier s'il n'a pas att√©ri dans votre dossier spam.</div></form> <div class="text-base-content/70 text-center text-sm svelte-o861tn">D√©j√† un compte ? <button class="btn btn-ghost btn-sm text-primary ms-1">Se connecter</button></div>`,1),zr=b('<div class="space-y-4 svelte-o861tn"><!> <!> <!></div>'),Fr=b('<span class="loading loading-spinner"></span>'),$r=b('<button type="submit" class="btn btn-primary btn-block"><!></button>'),jr=b('<span class="loading loading-spinner"></span>'),Vr=b('<button type="submit" class="btn btn-primary btn-block"><!></button>'),qr=b('<span class="loading loading-spinner"></span>'),Yr=b('<button type="submit" class="btn btn-success btn-block"><!></button>'),Ur=b("<!> <!> <!>",1);function Hr(n,e){xe(e,!0);let t=ye(e,"isOpen",15),r=ye(e,"onAuth_success",3,async()=>{}),i=P(!0),s=P(!1),d=P(""),v=P(""),m=P(""),f=P(""),g=P(""),M=P(""),E=P(""),F=P(""),z=P(!1);async function ne(k){if(k.preventDefault(),!o(m)||!o(f)){l(d,"Veuillez remplir tous les champs");return}l(s,!0),l(d,"");try{const{account:p}=await Et();await p.createEmailPasswordSession({email:o(m),password:o(f)}),l(v,"Connexion r√©ussie !"),setTimeout(()=>{r()()},1e3)}catch(p){console.error("Erreur de connexion:",p),l(d,p.message||"Erreur lors de la connexion",!0)}finally{l(s,!1)}}async function C(k){if(k.preventDefault(),!o(g)||!o(M)||!o(E)){l(d,"Veuillez remplir tous les champs");return}l(s,!0),l(d,"");try{const{account:p}=await Et();await p.create({userId:"unique()",email:o(M),password:o(E),name:o(g)}),await p.createEmailPasswordSession({email:o(M),password:o(E)}),l(v,"Compte cr√©√© et connect√© !"),setTimeout(()=>{r()()},1e3)}catch(p){console.error("Erreur d'inscription:",p),l(d,p.message||"Erreur lors de la cr√©ation du compte",!0)}finally{l(s,!1)}}async function _(k){if(k.preventDefault(),!o(F)){l(d,"Veuillez entrer votre email");return}l(s,!0),l(d,"");try{const{account:p}=await Et();await p.createRecovery({email:o(F),url:`${window.location.origin}/#/reset-password`}),l(v,"Email de r√©initialisation envoy√© !"),setTimeout(()=>{l(z,!1),l(F,"")},2e3)}catch(p){console.error("Erreur mot de passe oubli√©:",p),l(d,p.message||"Erreur lors de l'envoi de l'email",!0)}finally{l(s,!1)}}function y(){o(s)||t(!1)}ct(()=>{(o(i)||o(z))&&(l(d,""),l(v,""))});function A(){return o(z)?"Mot de passe oubli√©":o(i)?"Connexion":"Inscription"}br(n,{get isOpen(){return t()},onClose:y,maxWidth:"sm",children:(k,p)=>{var j=Ur(),X=Y(j);{let H=he(A);xr(X,{get title(){return o(H)},onClose:y})}var q=h(X,2);Tr(q,{children:(H,Ee)=>{var be=zr(),ge=c(be);{var Be=L=>{var T=Ir(),D=h(c(T),2),se=c(D);U(()=>ve(se,o(d))),u(L,T)};w(ge,L=>{o(d)&&L(Be)})}var I=h(ge,2);{var R=L=>{var T=Lr(),D=h(c(T),2),se=c(D);U(()=>ve(se,o(v))),u(L,T)};w(I,L=>{o(v)&&L(R)})}var S=h(I,2);{var G=L=>{var T=Cr(),D=Y(T),se=c(D),me=h(c(se),2),N=h(D,2),O=c(N);O.__click=[Dr,z],U(()=>{me.disabled=o(s),O.disabled=o(s)}),Ct("submit",D,_),Je(me,()=>o(F),W=>l(F,W)),u(L,T)},re=L=>{var T=ce(),D=Y(T);{var se=N=>{var O=Pr(),W=Y(O),Se=c(W),Te=h(c(Se),2),oe=h(Se,2),ue=h(c(oe),2),Re=h(W,2),Me=c(Re);Me.__click=[Or,z];var De=h(Me,2),Ce=h(c(De));Ce.__click=[kr,i],U(()=>{Te.disabled=o(s),ue.disabled=o(s),Me.disabled=o(s),Ce.disabled=o(s)}),Ct("submit",W,ne),Je(Te,()=>o(m),pe=>l(m,pe)),Je(ue,()=>o(f),pe=>l(f,pe)),u(N,O)},me=N=>{var O=Br(),W=Y(O),Se=c(W),Te=h(c(Se),2),oe=h(Se,2),ue=h(c(oe),2),Re=h(oe,2),Me=h(c(Re),2),De=h(W,2),Ce=h(c(De));Ce.__click=[Nr,i],U(()=>{Te.disabled=o(s),ue.disabled=o(s),Me.disabled=o(s),Ce.disabled=o(s)}),Ct("submit",W,C),Je(Te,()=>o(g),pe=>l(g,pe)),Je(ue,()=>o(M),pe=>l(M,pe)),Je(Me,()=>o(E),pe=>l(E,pe)),u(N,O)};w(D,N=>{o(i)?N(se):N(me,!1)},!0)}u(L,T)};w(S,L=>{o(z)?L(G):L(re,!1)})}u(H,be)}});var ae=h(q,2);Mr(ae,{children:(H,Ee)=>{var be=ce(),ge=Y(be);{var Be=R=>{var S=$r();S.__click=_;var G=c(S);{var re=T=>{var D=Fr();u(T,D)},L=T=>{var D=tt("Envoyer l'email de r√©initialisation");u(T,D)};w(G,T=>{o(s)?T(re):T(L,!1)})}U(()=>S.disabled=o(s)),u(R,S)},I=R=>{var S=ce(),G=Y(S);{var re=T=>{var D=Vr();D.__click=ne;var se=c(D);{var me=O=>{var W=jr();u(O,W)},N=O=>{var W=tt("Se connecter");u(O,W)};w(se,O=>{o(s)?O(me):O(N,!1)})}U(()=>D.disabled=o(s)),u(T,D)},L=T=>{var D=Yr();D.__click=C;var se=c(D);{var me=O=>{var W=qr();u(O,W)},N=O=>{var W=tt("Cr√©er un compte");u(O,W)};w(se,O=>{o(s)?O(me):O(N,!1)})}U(()=>D.disabled=o(s)),u(T,D)};w(G,T=>{o(i)?T(re):T(L,!1)},!0)}u(R,S)};w(ge,R=>{o(z)?R(Be):R(I,!1)})}u(H,be)}}),u(k,j)},$$slots:{default:!0}}),Ae()}Ne(["click"]);async function Gr(){try{await x.logout(),window.location.href="/"}catch(n){console.error("Erreur lors de la d√©connexion:",n)}}function Wr(n,e){l(e,!0),console.log("showAuthModal",o(e))}async function Kr(n,e,t){if(x.userId){l(e,!0);try{await He.forceReloadAllRecipes(),t()}catch(r){console.error("Erreur lors du rechargement des recettes:",r),alert("Erreur lors du rechargement des recettes")}finally{l(e,!1)}}}var Qr=(()=>de("/")),Jr=()=>de("/dashboard"),Xr=b('<button class="btn btn-ghost not-md:btn-square md:gap-2"><!> <span class="hidden md:inline">Tableau de bord</span></button>'),Zr=()=>de("/recipe"),es=b('<h1 class="truncate text-sm font-bold tracking-wider uppercase opacity-70"> </h1>'),ts=b('<div class="navbar-center absolute left-1/2 -translate-x-1/2 transform"><!></div>'),as=b('<div class="badge badge-warning flex items-center gap-1 py-3 font-medium"><!> <span class="text-xs"> </span></div>'),rs=()=>de("/dashboard"),ss=()=>de("/dashboard/teams"),os=()=>de("/dashboard/eventCreate"),is=()=>de("/recipe"),ns=b('<div class="dropdown dropdown-end"><div tabindex="0" role="button" class="btn btn-ghost btn-circle avatar bg-primary/10 text-primary border-primary/20 border"><div class="flex w-10 items-center justify-center rounded-full text-lg font-bold"> </div></div> <ul class="menu menu-sm dropdown-content bg-base-100 border-base-200 z-[1] mt-3 w-56 rounded-xl border p-2 shadow-xl"><li class="border-base-100 mb-1 border-b px-4 py-2"><span class="block truncate p-0 text-xs font-medium italic opacity-60"> </span></li> <li><button><!> Dashboard</button></li> <li><button><!> √âquipes</button></li> <li><button><!> Nouvel √©v√©nement</button></li> <li><button><!> Recettes</button></li> <li><button class="disabled:opacity-50"><!> </button></li> <!> <li class="border-base-100 my-1 border-t"></li> <li><button class="text-error hover:bg-error/10"><!> Se d√©connecter</button></li></ul></div>'),ls=b('<button class="btn btn-primary btn-sm shadow-md"><!> Connexion</button>'),cs=b('<h1 class="text-center text-sm font-bold tracking-wider uppercase opacity-70"> </h1>'),ds=b('<div class="border-base-300 bg-base-100 border-b px-4 py-3"><!></div>'),us=b('<!> <div><div class="navbar-start w-fit flex-shrink-0 gap-1"><button class="btn btn-ghost px-2"><img src="data/favicon-96x96.png" alt="logo" class="h-8 w-8"/></button> <div class="flex items-center gap-1"><!> <button class="btn btn-ghost not-md:btn-square md:gap-2"><!> <span class="hidden md:inline">Recettes</span></button></div></div> <!> <div class="navbar-end ms-auto w-fit flex-shrink-0 gap-4"><!> <div class="flex items-center gap-2"><!></div> <!></div></div> <!>',1);function vs(n,e){xe(e,!0);let t=P(!1),r=P(!1),i=P(!1);function s(){l(t,!1)}function d(I){I.target.closest(".svelte-user-dropdown")||s()}async function v(){l(r,!1),await x.refreshAuthAfterLogin()}ct(()=>{if(o(t))return document.addEventListener("click",d),()=>document.removeEventListener("click",d)});var m=us(),f=Y(m);Hr(f,{onAuth_success:v,get isOpen(){return o(r)},set isOpen(I){l(r,I,!0)}});var g=h(f,2),M=c(g),E=c(M);E.__click=[Qr];var F=h(E,2),z=c(F);{var ne=I=>{var R=Xr();R.__click=[Jr];var S=c(R);Ut(S,{size:18}),u(I,R)};w(z,I=>{x.isAuthenticated&&I(ne)})}var C=h(z,2);C.__click=[Zr];var _=c(C);za(_,{size:18});var y=h(M,2);{var A=I=>{var R=ts(),S=c(R);{var G=L=>{Qt(L,{get currentTeamId(){return le.teamId}})},re=L=>{var T=ce(),D=Y(T);{var se=N=>{var O=ce(),W=Y(O);Ue(W,()=>le.tabs),u(N,O)},me=N=>{var O=ce(),W=Y(O);{var Se=oe=>{Kt(oe,{get eventId(){return le.eventId}})},Te=oe=>{var ue=es(),Re=c(ue);U(()=>{Pt(ue,"title",le.title),ve(Re,le.title)}),u(oe,ue)};w(W,oe=>{le.eventId!==void 0?oe(Se):oe(Te,!1)},!0)}u(N,O)};w(D,N=>{le.tabs?N(se):N(me,!1)},!0)}u(L,T)};w(S,L=>{le.materielContext?L(G):L(re,!1)})}u(I,R)};w(y,I=>{x.isDesktop&&I(A)})}var k=h(y,2),p=c(k);{var j=I=>{var R=as(),S=c(R);Fa(S,{size:14});var G=h(S,2),re=c(G);U(()=>ve(re,`√âdition par ${le.lockedByUserName??""}`)),u(I,R)};w(p,I=>{le.isLockedByOthers&&I(j)})}var X=h(p,2),q=c(X);{var ae=I=>{var R=ce(),S=Y(R);Ue(S,()=>le.actions),u(I,R)};w(q,I=>{le.actions&&I(ae)})}var H=h(X,2);{var Ee=I=>{var R=ns(),S=c(R),G=c(S),re=c(G),L=h(S,2),T=c(L),D=c(T),se=c(D),me=h(T,2),N=c(me);N.__click=[rs];var O=c(N);Ut(O,{size:16});var W=h(me,2),Se=c(W);Se.__click=[ss];var Te=c(Se);$a(Te,{size:16});var oe=h(W,2),ue=c(oe);ue.__click=[os];var Re=c(ue);ja(Re,{size:16});var Me=h(oe,2),De=c(Me);De.__click=[is];var Ce=c(De);Va(Ce,{size:16});var pe=h(Me,2),Lt=c(pe);Lt.__click=[Kr,i,s];var zt=c(Lt);{let pt=he(()=>o(i)?"animate-spin":"");qa(zt,{size:16,get class(){return o(pt)}})}var na=h(zt),Ft=h(pe,2);w(Ft,pt=>{});var la=h(Ft,4),$t=c(la);$t.__click=[Gr];var ca=c($t);Ya(ca,{size:16}),U(pt=>{ve(re,pt),ve(se,x.user?.email),Lt.disabled=o(i),ve(na,` ${o(i)?"Chargement...":"Recharger les recettes"}`)},[()=>x.user?.name?.charAt(0).toUpperCase()||"U"]),u(I,R)},be=I=>{var R=ls();R.__click=[Wr,r];var S=c(R);Ua(S,{size:16}),u(I,R)};w(H,I=>{x.isAuthenticated?I(Ee):I(be,!1)})}var ge=h(g,2);{var Be=I=>{var R=ds(),S=c(R);{var G=L=>{Qt(L,{get currentTeamId(){return le.teamId}})},re=L=>{var T=ce(),D=Y(T);{var se=N=>{Kt(N,{get eventId(){return le.eventId}})},me=N=>{var O=ce(),W=Y(O);{var Se=oe=>{var ue=ce(),Re=Y(ue);Ue(Re,()=>le.tabs),u(oe,ue)},Te=oe=>{var ue=ce(),Re=Y(ue);{var Me=De=>{var Ce=cs(),pe=c(Ce);U(()=>ve(pe,le.title)),u(De,Ce)};w(Re,De=>{le.title&&De(Me)},!0)}u(oe,ue)};w(W,oe=>{le.tabs?oe(Se):oe(Te,!1)},!0)}u(N,O)};w(D,N=>{le.eventId!==void 0?N(se):N(me,!1)},!0)}u(L,T)};w(S,L=>{le.materielContext?L(G):L(re,!1)})}u(I,R)};w(ge,I=>{x.isDesktop||I(Be)})}U(()=>Pe(g,1,`navbar bg-base-100 border-base-300 sticky top-0 z-[1000] border-b px-4 py-0 shadow-sm print:hidden ${(x.isMobile&&"min-h-11")??""} relative`)),u(n,m),Ae()}Ne(["click"]);var hs=(n,e,t,r)=>e(o(t),o(r)),ms=b('<button class="btn btn-sm btn-primary"> </button>'),fs=(n,e,t)=>e(o(t)),_s=b('<button class="btn btn-ghost btn-xs btn-square" title="Voir les d√©tails" aria-label="Voir les d√©tails"><!></button>'),ps=(n,e,t)=>e(o(t)),bs=b('<button class="btn btn-ghost btn-xs btn-circle" title="Fermer" aria-label="Fermer la notification"><!></button>'),gs=b('<div><div class="flex items-center justify-between gap-4"><div class="flex flex-1 items-center gap-2"><!> <span class="text-xs"> </span></div> <!> <!> <!></div></div>'),ys=b("<div></div>");function ws(n,e){xe(e,!0);let t=ye(e,"position",3,"toast-center toast-bottom"),r=ye(e,"padding",3,"sm");const i=he(()=>r()==="sm"?" py-0.5":""),s=he(()=>Le.toasts),d=he(()=>()=>{const E=new Map;for(const F of o(s)){const z=F.position||t();E.has(z)||E.set(z,[]),E.get(z).push(F)}return E});function v(E){Le.dismiss(E.id)}function m(E){e.onShowDetails?.({id:E.id,message:E.message,details:E.details})}function f(E,F){F.onClick()}var g=ce(),M=Y(g);et(M,17,()=>Array.from(o(d)().entries()),([E,F])=>E,(E,F)=>{var z=he(()=>Aa(o(F),2));let ne=()=>o(z)[0],C=()=>o(z)[1];var _=ys();et(_,21,C,y=>y.id,(y,A)=>{var k=gs(),p=c(k),j=c(p),X=c(j);{var q=S=>{Ha(S,{class:"h-5 w-5 animate-spin"})};w(X,S=>{o(A).state==="loading"&&S(q)})}var ae=h(X,2),H=c(ae),Ee=h(j,2);{var be=S=>{var G=ce(),re=Y(G);et(re,17,()=>o(A).actions,It,(L,T)=>{var D=ms();D.__click=[hs,f,A,T];var se=c(D);U(()=>ve(se,o(T).label)),u(L,D)}),u(S,G)};w(Ee,S=>{o(A).actions&&o(A).actions.length>0&&S(be)})}var ge=h(Ee,2);{var Be=S=>{var G=_s();G.__click=[fs,m,A];var re=c(G);Ga(re,{class:"h-3 w-3"}),u(S,G)};w(ge,S=>{o(A).details&&S(Be)})}var I=h(ge,2);{var R=S=>{var G=bs();G.__click=[ps,v,A];var re=c(G);Jt(re,{class:"h-4 w-4"}),u(S,G)};w(I,S=>{(o(A).state==="error"||o(A).state==="warning"||o(A).state==="loading")&&S(R)})}U(()=>{Pe(k,1,`alert alert-${o(A).state??""}  ${o(i)??""} shadow-lg`),ve(H,o(A).message)}),u(y,k)}),U(()=>Pe(_,1,`toast ${ne()??""} z-1050`)),u(E,_)}),u(n,g),Ae()}Ne(["click"]);const Es=new Ta(()=>window.scrollY,n=>Ra(window,"scroll",n)),Ss=n=>n;function xs(n){const e=n-1;return e*e*e+1}function As(n,{delay:e=0,duration:t=400,easing:r=Ss}={}){const i=+getComputedStyle(n).opacity;return{delay:e,duration:t,easing:r,css:s=>`opacity: ${s*i}`}}function eo(n,{delay:e=0,duration:t=400,easing:r=xs,axis:i="y"}={}){const s=getComputedStyle(n),d=+s.opacity,v=i==="y"?"height":"width",m=parseFloat(s[v]),f=i==="y"?["top","bottom"]:["left","right"],g=f.map(_=>`${_[0].toUpperCase()}${_.slice(1)}`),M=parseFloat(s[`padding${g[0]}`]),E=parseFloat(s[`padding${g[1]}`]),F=parseFloat(s[`margin${g[0]}`]),z=parseFloat(s[`margin${g[1]}`]),ne=parseFloat(s[`border${g[0]}Width`]),C=parseFloat(s[`border${g[1]}Width`]);return{delay:e,duration:t,easing:r,css:_=>`overflow: hidden;opacity: ${Math.min(_*20,1)*d};${v}: ${_*m}px;padding-${f[0]}: ${_*M}px;padding-${f[1]}: ${_*E}px;margin-${f[0]}: ${_*F}px;margin-${f[1]}: ${_*z}px;border-${f[0]}-width: ${_*ne}px;border-${f[1]}-width: ${_*C}px;min-${v}: 0`}}function Ts(){window.scrollTo({top:0,behavior:"smooth"})}var Rs=b('<button class="btn btn-primary btn-circle fixed right-6 bottom-6 z-50 rounded-full shadow-lg" aria-label="Retour en haut de page"><!></button>');function Ms(n,e){xe(e,!0);let t=he(()=>(Es.current||0)>300);var r=ce(),i=Y(r);{var s=d=>{var v=Rs();v.__click=[Ts];var m=c(v);Wa(m,{class:"h-6 w-6"}),Ma(3,v,()=>As),u(d,v)};w(i,d=>{o(t)&&d(s)})}u(n,r),Ae()}Ne(["click"]);function Is(n,e){xe(e,!0),Ae()}Ia();var Ls=b('<img class="w-full object-cover"/>'),Ds=b('<figure class="hover-gallery"></figure>'),Cs=b('<p class="text-base-content/80"><!></p>'),Os=b("<button> </button>"),ks=b('<div class="card bg-base-100 h-[60vh] w-full shadow-xl"><!> <div><h2> </h2> <!> <!> <!></div></div>');function vt(n,e){xe(e,!0);let t=ye(e,"theme",3,"primary");const r={primary:"text-primary",secondary:"text-secondary"};var i=ks(),s=c(i);{var d=C=>{var _=Ds();et(_,21,()=>e.images,It,(y,A)=>{var k=Ls();U(()=>{Pt(k,"src",o(A)),Pt(k,"alt",e.title)}),u(y,k)}),u(C,_)};w(s,C=>{e.images.length>0&&C(d)})}var v=h(s,2),m=c(v),f=c(m),g=h(m,2);{var M=C=>{var _=Cs(),y=c(_);La(y,()=>e.description),u(C,_)};w(g,C=>{e.description&&C(M)})}var E=h(g,2);{var F=C=>{var _=ce(),y=Y(_);Ue(y,()=>e.extra),u(C,_)};w(E,C=>{e.extra&&C(F)})}var z=h(E,2);{var ne=C=>{var _=Os();_.__click=function(...A){e.buttonAction?.apply(this,A)};var y=c(_);U(()=>{Pe(_,1,`btn btn-${t()??""} btn-sm absolute right-4 bottom-4`),ve(y,e.buttonText)}),u(C,_)};w(z,C=>{e.buttonText&&e.buttonAction&&C(ne)})}U(()=>{Pe(v,1,`card-body absolute bottom-0 ${(e.buttonAction&&"pb-15")??""} w-full bg-gray-700/30`),Pe(m,1,`card-title ${r[t()]??""} text-2xl`),ve(f,e.title)}),u(n,i),Ae()}Ne(["click"]);var Ps=()=>de("/recipe"),Ns=()=>de("/dashboard"),Bs=b('<button class="btn btn-outline btn-xl"><!> Acc√©der au tableau de bord</button>'),zs=b('<button class="btn btn-secondary btn-xl">Cr√©er un compte pour commencer <!></button>'),Fs=b('<p class="text-base-content/60 text-center">D√©j√† membre ? Connectez-vous pour g√©rer vos cantines et √©quipes</p>'),$s=b('<div class="bg-base-200 min-h-screen"><section class="hero bg-base-200 min-h-[50vh]"><div class="hero-content text-center"><div class="max-w-3xl"><div class="mb-4 flex justify-center"><img src="/data/logo.svg" alt="Enka Cookbook"/></div> <h1 class="text-6xl font-black tracking-tight">Enka Cookbook</h1> <p class="text-base-content/70 mt-6 text-xl">Outils de planification pour les cantines autog√©r√©es</p></div></div></section> <section class="bg-base-200 mt-15 mb-5"><div class="container mx-auto px-4"><div class="flex flex-col items-center justify-center gap-6"><button class="btn btn-primary btn-xl"><!> <span class="flex items-baseline gap-2">Voir les recettes</span></button> <!> <!></div></div></section> <section class="bg-base-200 py-16"><div class="container mx-auto px-4"><div class="grid gap-8"><div class="grid gap-6 md:grid-cols-3"><!> <!></div> <div class="grid gap-6 md:grid-cols-3"><!> <!> <!></div></div></div></section></div>');function js(n,e){xe(e,!1);function t(){const q=new CustomEvent("open-auth-modal");window.dispatchEvent(q)}Da();var r=$s(),i=h(c(r),2),s=c(i),d=c(s),v=c(d);v.__click=[Ps];var m=c(v);Ka(m,{size:24});var f=h(v,2);{var g=q=>{var ae=Bs();ae.__click=[Ns];var H=c(ae);Ht(H,{size:24}),u(q,ae)},M=q=>{var ae=zs();ae.__click=t;var H=h(c(ae));Ht(H,{size:24}),u(q,ae)};w(f,q=>{x.isAuthenticated?q(g):q(M,!1)})}var E=h(f,2);{var F=q=>{var ae=Fs();u(q,ae)};w(E,q=>{x.isAuthenticated||q(F)})}var z=h(i,2),ne=c(z),C=c(ne),_=c(C),y=c(_);vt(y,{images:["/images/plat.webp","/images/salade.webp"],title:"Partagez vos recettes",description:"D√©couvrez et partagez des recettes avec la communaut√©",buttonText:"Explorer",buttonAction:()=>de("/recipe"),theme:"primary"});var A=h(y,2);vt(A,{images:["/images/home/recipe-print.webp","/images/home/recipe.webp"],title:"Imprimez vos recettes",description:"G√©n√©rez des fiches recettes propres et professionnelles",buttonText:"Imprimer",theme:"primary"});var k=h(_,2),p=c(k);vt(p,{images:["/images/doc/explorer.png"],title:"Organisation",description:"√âlaborez des menus sur plusieurs jours et organisez-vous en √©quipes",buttonText:"Organiser",buttonAction:()=>x.isAuthenticated?de("/dashboard"):t(),theme:"secondary"});var j=h(p,2);vt(j,{images:["/images/home/product.webp"],title:"Listes de courses",description:"G√©n√©rez automatiquement les listes de courses pour vos menus",buttonText:"G√©n√©rer",buttonAction:()=>x.isAuthenticated?de("/dashboard"):t(),theme:"secondary"});var X=h(j,2);vt(X,{images:["/images/friture.webp"],title:"Gestion compl√®te",description:"G√©rez vos stocks, mat√©riel et r√©partissez les t√¢ches",buttonText:"G√©rer",buttonAction:()=>x.isAuthenticated?de("/dashboard"):t(),theme:"secondary"}),u(n,r),Ae()}Ne(["click"]);var Vs=b('<div class="flex h-[50vh] items-center justify-center"><!></div>'),qs=b('<div class="flex h-[80vh] flex-col items-center justify-center gap-4"><div class="loading loading-spinner loading-lg text-primary"></div> <p class="text-base-content/70 animate-pulse font-medium"><!></p></div>'),Ys=b("<!> <!>",1),Us=b('<!> <div class="bg-base-200 min-h-screen"><!></div> <!> <!> <!>',1);function Hs(n,e){xe(e,!0);let t=P("BOOTING"),r=P(null);const i={beforeEnter:async()=>x.isAuthenticated?!0:(console.log("[Router] Acc√®s refus√© > Redirection /"),de("/"),!1)};$.addRoute("/",js),$.addRoute("/recipe",()=>J(()=>import("./RecipesListPage.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),$.addRoute("/recipe/my",()=>J(()=>import("./RecipesListPage.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10])),i),$.addRoute("/recipe/my/draft",()=>J(()=>import("./RecipesListPage.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10])),i),$.addRoute("/recipe/new",()=>J(()=>import("./RecipeCreatePage.js"),__vite__mapDeps([11,1,2,10,12,13,14,3,15,7,16,17])),i),$.addRoute("/recipe/:uuid/edit",()=>J(()=>import("./RecipeEditPage.js"),__vite__mapDeps([18,1,2,10,12,13,14,3,15,7,16,4,5,19,17,20])),i),$.addRoute("/recipe/:uuid/duplicate",()=>J(()=>import("./RecipeCreatePage.js"),__vite__mapDeps([11,1,2,10,12,13,14,3,15,7,16,17])),i),$.addRoute("/recipe/:uuid",()=>J(()=>import("./RecipeDetailPage.js"),__vite__mapDeps([21,1,2,8,22,13,3,23,24,20]))),$.addRoute("/accept-invite",()=>J(()=>import("./AcceptInvite.js"),__vite__mapDeps([25,1,2]))),$.addRoute("/reset-password",()=>J(()=>import("./ResetPassword.js"),__vite__mapDeps([26,1,2,27]))),$.addRoute("/dashboard",()=>J(()=>import("./DashboardPage.js"),__vite__mapDeps([28,1,2,29,30,19,31,13,32,33])),i),$.addRoute("/dashboard/teams",()=>J(()=>import("./TeamsManagement.js"),__vite__mapDeps([34,1,2,30,19,31])),i),$.addRoute("/dashboard/eventCreate",()=>J(()=>import("./EventCreatePage.js"),__vite__mapDeps([35,1,2,36,5,13,29,3])),i),$.addRoute("/dashboard/eventEdit/:id",()=>J(()=>import("./EventEditPage.js"),__vite__mapDeps([37,1,2,36,5,13,29,3,38,32,39,7,15,17,19])),i),$.addRoute("/dashboard/eventEdit/recipes/:id",()=>J(()=>import("./EventRecipesPage.js"),__vite__mapDeps([40,1,2,32,39,29,22,13,3,23,24,8,9,4,5,41])),i),$.addRoute("/dashboard/eventEdit/products/:id",()=>J(()=>import("./EventProductsPage.js"),__vite__mapDeps([42,1,2,29,15,7,31,13,3,39,32,9,43])),i),$.addRoute("/dashboard/eventPosters/:id",()=>J(()=>import("./EventPosterPage.js"),__vite__mapDeps([44,1,2,38,3,19,9,45])),i),$.addRoute("/dashboard/materiel",()=>J(()=>import("./MaterielPage.js"),__vite__mapDeps([46,1,2,29,7,6,3,9])),i),$.addRoute("/dashboard/materiel/:teamId",()=>J(()=>import("./MaterielPage.js"),__vite__mapDeps([46,1,2,29,7,6,3,9])),i),$.addRoute("/dashboard/loans",()=>J(()=>import("./LoansPage.js"),__vite__mapDeps([47,1,2,4,5,15,7,29])),i),$.addRoute("/dashboard/loans/:teamId",()=>J(()=>import("./LoansPage.js"),__vite__mapDeps([47,1,2,4,5,15,7,29])),i),$.addRoute("/dashboard/loans/return/:loanId",()=>J(()=>import("./LoanReturnPage.js"),__vite__mapDeps([48,1,2,29])),i),$.addRoute("/eventList",()=>J(()=>import("./EventListPage.js"),__vite__mapDeps([49,1,2,32,13])),i),$.addRoute("/createdocument/:teamId/new",()=>J(()=>import("./CreateDocumentPage.js"),__vite__mapDeps([50,1,2,51,14,52,15,7,53])),i),$.addRoute("/editdocument/:teamId/:docId",()=>J(()=>import("./EditDocumentPage.js"),__vite__mapDeps([54,1,2,51,14,52,15,7,17,23,24,55])),i),$.addRoute("/documents/:teamId",()=>J(()=>import("./DocumentListPage.js"),__vite__mapDeps([56,1,2,33,29,9,3,7])),i);let s=P(null);async function d(){try{if(l(t,"BOOTING"),await x.initializeAuth(),x.isAuthenticated){l(t,"LOADING_PRIVATE_CACHE");const p=Le.loading("Chargement des donn√©es...");await Promise.all([ht.loadCache(),He.loadCache(),yt.loadCache(),gt.loadCache(),wt.loadCache()]),l(t,"READY_WITH_CACHE"),Le.update(p,{state:"loading",message:"Mise √† jour des donn√©es en cours..."}),Promise.all([ht.syncFromRemote(),He.syncFromRemote(),yt.syncFromRemote(),Ye.syncFromRemote(),gt.syncFromRemote(),wt.syncFromRemote()]).then(async()=>{await Promise.all([ht.setupRealtime(),He.setupRealtime(),yt.setupRealtime(),Ye.setupRealtime(),gt.setupRealtime(),wt.setupRealtime()]),await qe.initialize(),l(t,"READY_FULLY_SYNCED"),Le.dismiss(p),setTimeout(()=>{Ot("/dashboard"),Ot("/recipe")},3e3)}).catch(j=>{console.error("[App] Erreur synchro distante:",j),Le.update(p,{state:"warning",message:"Mode hors ligne : donn√©es mises en cache",autoCloseDelay:5e3}),qe.initialize().catch(console.error)})}else{l(t,"LOADING_PUBLIC_CACHE");const p=Le.loading("Pr√©paration de la cuisine...");await He.loadCache(),l(t,"READY_WITH_CACHE"),Le.update(p,{state:"loading",message:"Mise √† jour des recettes..."}),Promise.all([He.syncFromRemote(),qe.initialize()]).then(()=>{l(t,"READY_FULLY_SYNCED"),setTimeout(()=>{Ot("/recipe")},2e3)}).catch(j=>{console.error("[App] Erreur synchro recettes:",j),Le.update(p,{state:"warning",message:"Mode hors ligne : recettes en cache",autoCloseDelay:1e4})})}}catch(p){console.error("[App] Erreur fatale d'initialisation:",p),l(r,p.message||"Erreur critique de chargement",!0),l(t,"ERROR")}}let v=P("");ct(()=>{const p=$.path,j=o(t);(j==="READY_WITH_CACHE"||j==="READY_FULLY_SYNCED"||j==="READY")&&$.match().then(async X=>{l(s,X,!0),p!==o(v)&&(l(v,p,!0),await ka(),requestAnimationFrame(()=>{requestAnimationFrame(()=>{window.scrollTo({top:0,behavior:"smooth"})})}))})});let m=P(!1),f=P(!1);ct(()=>{const p=x.isAuthenticated;o(f)||o(t)!=="BOOTING"&&o(t)!=="LOADING_PRIVATE_CACHE"&&o(t)!=="LOADING_PUBLIC_CACHE"&&p!==o(m)&&(l(m,p,!0),console.log("[App] Changement d'√©tat Auth d√©tect√© -> Rechargement"),l(f,!0),d().finally(()=>{l(f,!1)}))}),Ca(()=>{d()}),Oa(()=>{console.log("[App] Destruction de l'application - Nettoyage des stores..."),gt.destroy(),Ye.destroy(),ht.destroy(),He.destroy(),yt.destroy(),wt.destroy(),qe.destroy()});let g=he(()=>o(r)||kt.error);var M=Us(),E=Y(M);vs(E,{});var F=h(E,2),z=c(F);{var ne=p=>{const j=he(()=>o(s).component);var X=ce(),q=Y(X);Pa(q,()=>o(j),(ae,H)=>{H(ae,{get params(){return o(s).params},get query(){return o(s).query}})}),u(p,X)},C=p=>{var j=ce(),X=Y(j);{var q=H=>{var Ee=Vs(),be=c(Ee);{let ge=he(()=>o(g)||"Erreur inconnue");Wt(be,{get message(){return o(ge)}})}u(H,Ee)},ae=H=>{var Ee=qs(),be=h(c(Ee),2),ge=c(be);{var Be=R=>{var S=tt("D√©marrage...");u(R,S)},I=R=>{var S=ce(),G=Y(S);{var re=T=>{var D=tt("Chargement des donn√©es en cache...");u(T,D)},L=T=>{var D=ce(),se=Y(D);{var me=N=>{var O=tt("Pr√©paration de la cuisine...");u(N,O)};w(se,N=>{o(t)==="LOADING_PUBLIC_CACHE"&&N(me)},!0)}u(T,D)};w(G,T=>{o(t)==="LOADING_PRIVATE_CACHE"?T(re):T(L,!1)},!0)}u(R,S)};w(ge,R=>{o(t)==="BOOTING"?R(Be):R(I,!1)})}u(H,Ee)};w(X,H=>{o(t)==="ERROR"?H(q):H(ae,!1)},!0)}u(p,j)};w(z,p=>{(o(t)==="READY_WITH_CACHE"||o(t)==="READY_FULLY_SYNCED"||o(t)==="READY")&&o(s)?p(ne):p(C,!1)})}var _=h(F,2);ws(_,{});var y=h(_,2);Ms(y,{});var A=h(y,2);{var k=p=>{var j=Ys(),X=Y(j);{var q=H=>{Wt(H,{get message(){return o(g)}})};w(X,H=>{o(g)&&H(q)})}var ae=h(X,2);Is(ae,{}),u(p,j)};w(A,p=>{x.isAuthenticated&&o(t)==="READY"&&p(k)})}u(n,M),Ae()}Na(Hs,{target:document.getElementById("app")});export{br as M,xr as a,Tr as b,Mr as c,Qs as d,Nt as e,As as f,Xs as g,Js as h,Zs as i,yt as m,le as n,eo as s,wt as t};
