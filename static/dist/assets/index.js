const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/RecipesListPage.js","assets/icons.js","assets/appwrite.js","assets/Fieldset.js","assets/AutocompleteInput.js","assets/keyboardNavigation.svelte.js","assets/BadgeList.js","assets/CheckboxBadge.js","assets/RecipeRegimeBadges.js","assets/LeftPanel.js","assets/RecipeDataStore.svelte.js","assets/RecipeCreatePage.js","assets/RecipeEditPage2.js","assets/products-display.js","assets/tiptap-markdown.es.js","assets/BtnGroupCheck.js","assets/RecipeEditPage.css","assets/UnsavedChangesGuard.js","assets/RecipeEditPage.js","assets/ConfirmModal.js","assets/RecipeVariants.js","assets/RecipeDetailPage.js","assets/RecipePreparation.js","assets/SvelteMarkdown.js","assets/SvelteMarkdown.css","assets/AcceptInvite.js","assets/ResetPassword.js","assets/ResetPassword.css","assets/DashboardPage.js","assets/date-helpers.js","assets/CreateTeamModal.js","assets/InfoCollapse.js","assets/event-stats-helpers.js","assets/DocCard.js","assets/TeamsManagement.js","assets/EventCreatePage.js","assets/EventMealCard.js","assets/EventEditPage.js","assets/EventInvitationAlert.js","assets/EventStats.js","assets/EventRecipesPage.js","assets/EventRecipesPage.css","assets/EventProductsPage.js","assets/EventProductsPage.css","assets/EventPosterPage.js","assets/EventPosterPage.css","assets/MaterielPage.js","assets/LoansPage.js","assets/LoanReturnPage.js","assets/EventListPage.js","assets/CreateDocumentPage.js","assets/MarkdownEditorAdvanced.js","assets/MarkdownEditorAdvanced.css","assets/CreateDocumentPage.css","assets/EditDocumentPage.js","assets/EditDocumentPage.css","assets/DocumentListPage.js"])))=>i.map(i=>d[i]);
var va=Object.defineProperty;var Vt=n=>{throw TypeError(n)};var ha=(n,e,t)=>e in n?va(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Be=(n,e,t)=>ha(n,typeof e!="symbol"?e+"":e,t),Ct=(n,e,t)=>e.has(n)||Vt("Cannot "+t);var a=(n,e,t)=>(Ct(n,e,"read from private field"),t?t.call(n):e.get(n)),z=(n,e,t)=>e.has(n)?Vt("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),Le=(n,e,t,r)=>(Ct(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t),U=(n,e,t)=>(Ct(n,e,"access private method"),t);import{q as F,m as o,v as l,w as qt,x as Ve,y as E,z as mt,A as Ye,B as Pt,C as qe,D as St,S as At,u as me,Q as ut,E as Yt,F as Ut,G as ma,H as fa,I as _a,J as gt,K as pa,L as ba,M as ga,N as ya,O as wa,P as Ea,R as Sa,T as xa,U as Aa,V as p,g as c,h,W as G,X as he,b as u,Y as Ta,Z as Ne,d as xe,e as tt,_ as Pe,i as Lt,c as Ae,$ as Y,a0 as ue,a1 as dt,k as H,a2 as y,j as de,s as Ue,a3 as Ge,a4 as Nt,p as we,t as Ra,a5 as Ma,a6 as Ia,a7 as La,a8 as Ot,a9 as Xe,aa as at,ab as Da,ac as Ca,ad as Oa,ae as ka,af as X,ag as Pa,ah as Na,ai as Ba,aj as kt,ak as za,al as Fa}from"./appwrite.js";import{C as Xt,a as $a,L as Ht,b as ja,U as Va,P as qa,B as Ya,R as Ua,c as Ha,d as Ga,e as Wa,f as Ka,X as Zt,A as Qa,g as Ja,h as Xa,i as Za,j as Gt}from"./icons.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var Ke,rt,st,xt;class er{constructor(){z(this,st);z(this,Ke,F(!1));z(this,rt,!1)}async loadCache(){o(a(this,Ke))||(l(a(this,Ke),!0),console.log("[NotificationStore] Cache charg√© : 0 notifications (pas de cache)"))}async syncFromRemote(){console.log("[NotificationStore] Sync : pas de donn√©es √† charger")}async setupRealtime(){if(a(this,rt)){console.log("[NotificationStore] D√©j√† configur√©, skip.");return}try{console.log("[NotificationStore] Configuration du realtime...");const e=qt();Ve.register([`databases.${e}.collections.user_notifications.documents`],async t=>{const r=t.payload,i=E.currentMainId;if(!(r.userId!=="broadcast"&&r.userId!==E.userId)&&t.events.some(s=>s.includes(".create"))){if(r.notificationType==="event_access_granted"&&r.targetCollection==="main")console.log("[NotificationStore] üîî Event access granted:",r.targetDocumentId),await mt.reload(),await U(this,st,xt).call(this,r.$id);else if(r.notificationType==="team_access_granted")console.log("[NotificationStore] üîî Team access granted:",r.targetDocumentId),await Ye.reload(),await U(this,st,xt).call(this,r.$id);else if(r.notificationType==="batch_products_update"){const s=r.targetDocumentId;i===s&&(console.log("[NotificationStore] üîî Batch data update for current event:",s),await Pt.syncFromAppwrite(),Pt.clearSyncStatus(),console.log("[NotificationStore] ‚úÖ Sync status cleared for batch update"),r.from?r.from===E.userId?console.log("[NotificationStore] Batch update from current user - no toast"):r.from==="system"?qe.info("Produits mis a jour",{source:"system"}):qe.info("Les produits ont √©t√© modifi√©s par un¬∑e autre utilisateur¬∑ices",{source:"realtime-other"}):console.warn("[NotificationStore] Legacy notification without 'from' field - ignoring")),await U(this,st,xt).call(this,r.$id)}}}),l(a(this,Ke),!0),Le(this,rt,!0),console.log("[NotificationStore] ‚úÖ Notifications de d√©couverte configur√©es (RealtimeManager)")}catch(e){throw console.error("[NotificationStore] Erreur lors de la configuration du realtime:",e),e}}async initialize(){await this.loadCache(),await this.syncFromRemote(),await this.setupRealtime()}destroy(){l(a(this,Ke),!1),Le(this,rt,!1),console.log("[NotificationStore] Store d√©truit")}}Ke=new WeakMap,rt=new WeakMap,st=new WeakSet,xt=async function(e){try{const t=await St(),r=qt();await t.tables.deleteRow({databaseId:r,tableId:"user_notifications",rowId:e}),console.log(`[NotificationStore] Notification supprim√©e: ${e}`)}catch(t){console.error("[NotificationStore] Erreur lors de la suppression de la notification:",t)}};const yt=new er;class tr{constructor(){Be(this,"dbName","materiel-cache");Be(this,"db",null);Be(this,"version",1);Be(this,"MATERIELS_STORE","materiels");Be(this,"LOANS_STORE","loans");Be(this,"METADATA_STORE","metadata");Be(this,"LAST_SYNC_MATERIEL_KEY","lastSyncMateriel");Be(this,"LAST_SYNC_LOANS_KEY","lastSyncLoans")}async open(){if(this.db)return;const e=()=>new Promise((d,v)=>{const m=indexedDB.open(this.dbName,this.version);m.onerror=()=>v(m.error),m.onsuccess=()=>d(m.result),m.onupgradeneeded=f=>{const b=f.target.result;b.objectStoreNames.contains(this.MATERIELS_STORE)||(b.createObjectStore(this.MATERIELS_STORE,{keyPath:"$id"}),console.log("[MaterielIDBCache] Object store 'materiels' cr√©√©")),b.objectStoreNames.contains(this.LOANS_STORE)||(b.createObjectStore(this.LOANS_STORE,{keyPath:"$id"}),console.log("[MaterielIDBCache] Object store 'loans' cr√©√©")),b.objectStoreNames.contains(this.METADATA_STORE)||(b.createObjectStore(this.METADATA_STORE,{keyPath:"key"}),console.log("[MaterielIDBCache] Object store 'metadata' cr√©√©"))}});let t=await e();const r=t.objectStoreNames.contains(this.MATERIELS_STORE),i=t.objectStoreNames.contains(this.LOANS_STORE),s=t.objectStoreNames.contains(this.METADATA_STORE);(!r||!i||!s)&&(console.warn(`[MaterielIDBCache] Base incompl√®te d√©tect√©e (materiels=${r}, loans=${i}, metadata=${s}), suppression et recr√©ation...`),t.close(),await new Promise((d,v)=>{const m=indexedDB.deleteDatabase(this.dbName);m.onsuccess=()=>d(),m.onerror=()=>v(m.error),m.onblocked=()=>{console.warn("[MaterielIDBCache] Suppression bloqu√©e, r√©essai...")}}),t=await e()),this.db=t,console.log(`[MaterielIDBCache] Base ouverte: ${this.dbName}`)}async loadMateriels(){if(!this.db)throw new Error("DB non ouverte");return new Promise((e,t)=>{const s=this.db.transaction(this.MATERIELS_STORE,"readonly").objectStore(this.MATERIELS_STORE).getAll();s.onsuccess=()=>{const d=new Map;s.result.forEach(v=>{d.set(v.$id,v)}),console.log(`[MaterielIDBCache] ${d.size} mat√©riels charg√©s`),e(d)},s.onerror=()=>t(s.error)})}async saveMateriels(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((t,r)=>{const i=this.db.transaction(this.MATERIELS_STORE,"readwrite"),s=i.objectStore(this.MATERIELS_STORE);s.clear(),e.forEach(d=>{s.put(d)}),i.oncomplete=()=>{console.log(`[MaterielIDBCache] ${e.size} mat√©riels sauvegard√©s`),t()},i.onerror=()=>r(i.error)})}async upsertMateriel(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((t,r)=>{const d=this.db.transaction(this.MATERIELS_STORE,"readwrite").objectStore(this.MATERIELS_STORE).put(e);d.onsuccess=()=>{console.log(`[MaterielIDBCache] Mat√©riel ${e.$id} sauvegard√©`),t()},d.onerror=()=>r(d.error)})}async deleteMateriel(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((t,r)=>{const d=this.db.transaction(this.MATERIELS_STORE,"readwrite").objectStore(this.MATERIELS_STORE).delete(e);d.onsuccess=()=>{console.log(`[MaterielIDBCache] Mat√©riel ${e} supprim√©`),t()},d.onerror=()=>r(d.error)})}async loadLoans(){if(!this.db)throw new Error("DB non ouverte");return new Promise((e,t)=>{const s=this.db.transaction(this.LOANS_STORE,"readonly").objectStore(this.LOANS_STORE).getAll();s.onsuccess=()=>{const d=new Map;s.result.forEach(v=>{d.set(v.$id,v)}),console.log(`[MaterielIDBCache] ${d.size} emprunts charg√©s`),e(d)},s.onerror=()=>t(s.error)})}async saveLoans(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((t,r)=>{const i=this.db.transaction(this.LOANS_STORE,"readwrite"),s=i.objectStore(this.LOANS_STORE);s.clear(),e.forEach(d=>{s.put(d)}),i.oncomplete=()=>{console.log(`[MaterielIDBCache] ${e.size} emprunts sauvegard√©s`),t()},i.onerror=()=>r(i.error)})}async upsertLoan(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((t,r)=>{const d=this.db.transaction(this.LOANS_STORE,"readwrite").objectStore(this.LOANS_STORE).put(e);d.onsuccess=()=>{console.log(`[MaterielIDBCache] Emprunt ${e.$id} sauvegard√©`),t()},d.onerror=()=>r(d.error)})}async deleteLoan(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((t,r)=>{const d=this.db.transaction(this.LOANS_STORE,"readwrite").objectStore(this.LOANS_STORE).delete(e);d.onsuccess=()=>{console.log(`[MaterielIDBCache] Emprunt ${e} supprim√©`),t()},d.onerror=()=>r(d.error)})}async loadMetadata(){if(!this.db)throw new Error("DB non ouverte");return new Promise((e,t)=>{const s=this.db.transaction(this.METADATA_STORE,"readonly").objectStore(this.METADATA_STORE).getAll();s.onsuccess=()=>{const d=s.result,v={lastSyncMateriel:null,lastSyncLoans:null};d.forEach(m=>{m.key===this.LAST_SYNC_MATERIEL_KEY&&(v.lastSyncMateriel=m.value),m.key===this.LAST_SYNC_LOANS_KEY&&(v.lastSyncLoans=m.value)}),console.log(`[MaterielIDBCache] Metadata charg√©es: lastSyncMateriel=${v.lastSyncMateriel}, lastSyncLoans=${v.lastSyncLoans}`),e(v)},s.onerror=()=>t(s.error)})}async saveMetadata(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((t,r)=>{const i=this.db.transaction(this.METADATA_STORE,"readwrite"),s=i.objectStore(this.METADATA_STORE);s.put({key:this.LAST_SYNC_MATERIEL_KEY,value:e.lastSyncMateriel}),s.put({key:this.LAST_SYNC_LOANS_KEY,value:e.lastSyncLoans}),i.oncomplete=()=>{console.log("[MaterielIDBCache] Metadata sauvegard√©es"),t()},i.onerror=()=>r(i.error)})}async clear(){if(!this.db)throw new Error("DB non ouverte");return new Promise((e,t)=>{const r=this.db.transaction([this.MATERIELS_STORE,this.LOANS_STORE,this.METADATA_STORE],"readwrite");r.objectStore(this.MATERIELS_STORE).clear(),r.objectStore(this.LOANS_STORE).clear(),r.objectStore(this.METADATA_STORE).clear(),r.oncomplete=()=>{console.log("[MaterielIDBCache] Cache vid√©"),e()},r.onerror=()=>t(r.error)})}close(){this.db&&(this.db.close(),this.db=null,console.log("[MaterielIDBCache] Connexion ferm√©e"))}}async function ar(){const n=new tr;return await n.open(),n}function Bt(n){const e={electronic:{label:"√âlectronique",badgeClass:"badge-warning",textColor:"text-warning",bgColor:"bg-warning/10"},manual:{label:"Manuel",badgeClass:"badge-info",textColor:"text-info",bgColor:"bg-info/10"},tools:{label:"Outils",badgeClass:"badge-secondary",textColor:"text-secondary",bgColor:"bg-secondary/10"},dish:{label:"Vaisselle",badgeClass:"badge-primary",textColor:"text-primary",bgColor:"bg-primary/10"},cooking:{label:"Cuisine",badgeClass:"badge-success",textColor:"text-success",bgColor:"bg-success/10"},gaz:{label:"Gaz",badgeClass:"badge-error",textColor:"text-error",bgColor:"bg-error/10"},hygiene:{label:"Hygi√®ne",badgeClass:"badge-info",textColor:"text-info",bgColor:"bg-info/10"},other:{label:"Autre",badgeClass:"badge-neutral",textColor:"text-neutral",bgColor:"bg-neutral/10"}};return e[n||"other"]||e.other}function Js(n){return Bt(n).badgeClass}function Xs(n){return Bt(n).textColor}function Zs(n){return Bt(n).bgColor}function eo(n){return{ok:"OK",lost:"Perdu",torepair:"√Ä r√©parer"}[n||"ok"]||n||"OK"}const Wt={userName:"",userId:"",teamName:"",teamId:""};function rr(n){if(!n)return Wt;try{return typeof n=="string"?JSON.parse(n):n}catch(e){return console.error("[materiel.utils] Error parsing owner from Appwrite:",n,e),Wt}}function zt(n){if(!n)return[];try{return Array.isArray(n)?n.map(e=>{try{return JSON.parse(e)}catch{return console.warn("[materiel.utils] Failed to parse loan item string:",e),null}}).filter(e=>e!==null):typeof n=="string"?JSON.parse(n):[]}catch(e){return console.error("[materiel.utils] Error parsing loan items from Appwrite:",n,e),[]}}function sr(n){return zt(n)}function vt(n){return{...n,materielItems:sr(n.materiels)}}function ea(n,e,t=new Date){const r=rr(n.owner),i=[];let s=0;e.forEach(f=>{const M=zt(f.materiels).filter(_=>_.materielId===n.$id);if(M.length===0)return;const w=new Date(f.startDate),V=new Date(f.endDate),N=w<=t&&V>=t,ne=w>t,D=["accepted","asked"].includes(f.status);(N||ne)&&D&&M.forEach(_=>{i.push({loanId:f.$id,responsibleName:f.responsibleName||"",startDate:f.startDate,endDate:f.endDate,quantity:_.quantity,status:f.status})}),N&&D&&M.forEach(_=>{s+=_.quantity})});const v=i.some(f=>{const b=new Date(f.startDate),M=new Date(f.endDate);return b<=t&&M>=t})?"loan":n.status,m=n.quantity-s;return{...n,status:v,ownerData:r,loanDetails:i,availableQuantity:m,totalLoanedQuantity:s,isAvailable:m>0,isFullyLoaned:m===0}}function or(n,e){const t={...n};return ea(t,e)}function ir(n){return["asked","accepted"].includes(n.status)}function nr(n,e,t,r){return n<=r&&e>=t}function lr(n,e,t,r){let i=0;return e.forEach(s=>{if(!ir(s))return;const d=new Date(s.startDate),v=new Date(s.endDate);if(!nr(d,v,t,r))return;const f=zt(s.materiels).filter(b=>b.materielId===n);i+=f.reduce((b,M)=>b+M.quantity,0)}),i}var re,ie,K,se,te,Qe,ft,ot,Oe,ke,Tt,ze,Rt,Mt,It,_t,Q,ta,aa,ra,sa,oa,ia,Ze,et;class cr{constructor(){z(this,Q);z(this,re,new At);z(this,ie,new At);z(this,K,null);z(this,se,F(!1));z(this,te,F(null));z(this,Qe,F(!1));z(this,ft,F(!1));z(this,ot,!1);z(this,Oe,F(null));z(this,ke,F(null));z(this,Tt,null);z(this,ze,me(()=>Array.from(a(this,re).values())));z(this,Rt,me(()=>Array.from(a(this,ie).values())));z(this,Mt,me(()=>{if(!E.userId)return[];const e=Ye.myTeams.map(t=>t.$id);return o(a(this,ze)).filter(t=>t.ownerData?.teamId&&e.includes(t.ownerData.teamId))}));z(this,It,me(()=>{if(!E.userId)return[];const e=Ye.myTeams.map(t=>t.$id);return o(a(this,ze)).filter(t=>t.shareableWith?.some(i=>e.includes(i))&&!(t.ownerData?.teamId&&e.includes(t.ownerData.teamId)))}));z(this,_t,me(()=>o(a(this,ze)).filter(e=>e.isAvailable)))}get loading(){return o(a(this,se))}get error(){return o(a(this,te))}get isInitialized(){return o(a(this,Qe))}get isRealtimeActive(){return o(a(this,ft))}get count(){return a(this,re).size}get materiels(){return o(a(this,ze))}get loans(){return o(a(this,Rt))}get teamMateriels(){return o(a(this,Mt))}get shareableMateriels(){return o(a(this,It))}get availableMateriels(){return o(a(this,_t))}getAvailableMaterielsByOwner(e){return o(a(this,_t)).filter(t=>t.ownerData?.teamId===e&&t.status!=="lost"&&t.status!=="torepair")}getMaterielsByOwner(e){return o(a(this,ze)).filter(t=>t.ownerData?.teamId===e)}getAvailableMaterielsForPeriod(e,t,r){const i=new Date(t),s=new Date(r),d=Array.from(a(this,ie).values());return o(a(this,ze)).filter(v=>v.ownerData?.teamId===e).filter(v=>v.status!=="lost"&&v.status!=="torepair").map(v=>{const m=lr(v.$id,d,i,s),f=v.quantity-m;return{...v,availableForPeriod:f}}).filter(v=>v.availableForPeriod>0)}async loadCache(){if(!o(a(this,Qe))){l(a(this,se),!0),l(a(this,te),null);try{if(!E.userId){l(a(this,Qe),!0);return}Le(this,K,await ar()),await U(this,Q,ta).call(this),l(a(this,Qe),!0),console.log(`[MaterielStore] Cache charg√© : ${a(this,re).size} mat√©riels, ${a(this,ie).size} emprunts`)}catch(e){throw l(a(this,te),e instanceof Error?e.message:"Erreur de chargement du cache",!0),console.error("[MaterielStore] LoadCache error:",e),e}finally{l(a(this,se),!1)}}}async syncFromRemote(){l(a(this,se),!0),l(a(this,te),null);try{if(!E.userId)return;await U(this,Q,aa).call(this),console.log(`[MaterielStore] Sync termin√© : ${a(this,re).size} mat√©riels, ${a(this,ie).size} emprunts`)}catch(e){throw l(a(this,te),e instanceof Error?e.message:"Erreur de synchronisation",!0),console.error("[MaterielStore] SyncFromRemote error:",e),e}finally{l(a(this,se),!1)}}async setupRealtime(){if(E.userId){if(a(this,ot)){console.log("[MaterielStore] Realtime d√©j√† configur√©");return}try{await U(this,Q,sa).call(this),l(a(this,ft),!0),Le(this,ot,!0),console.log("[MaterielStore] Realtime configur√©")}catch(e){throw l(a(this,te),e instanceof Error?e.message:"Erreur de configuration realtime",!0),console.error("[MaterielStore] SetupRealtime error:",e),e}}}async initialize(){await this.loadCache(),await this.syncFromRemote(),await this.setupRealtime()}getMaterielById(e){return a(this,re).get(e)}getLoanById(e){return a(this,ie).get(e)}async createMateriel(e){l(a(this,se),!0),l(a(this,te),null);try{if(!E.userId)throw new Error("Utilisateur non connect√©");const t=await _a(e,E.userId),r=U(this,Q,Ze).call(this,t);return a(this,re).set(t.$id,r),a(this,K)?.upsertMateriel(r),r}catch(t){throw l(a(this,te),t instanceof Error?t.message:"Erreur de cr√©ation",!0),t}finally{l(a(this,se),!1)}}async updateMateriel(e,t){l(a(this,se),!0),l(a(this,te),null);try{const r=await gt(e,t),i=U(this,Q,Ze).call(this,r);a(this,re).set(r.$id,i),a(this,K)?.upsertMateriel(i)}catch(r){throw l(a(this,te),r instanceof Error?r.message:"Erreur de mise √† jour",!0),r}finally{l(a(this,se),!1)}}async deleteMateriel(e){l(a(this,se),!0),l(a(this,te),null);try{await pa(e),a(this,re).delete(e),a(this,K)?.deleteMateriel(e)}catch(t){throw l(a(this,te),t instanceof Error?t.message:"Erreur de suppression",!0),t}finally{l(a(this,se),!1)}}async createLoan(e){l(a(this,se),!0),l(a(this,te),null);try{if(!E.userId)throw new Error("Utilisateur non connect√©");const t=await ba(e,E.userId);return vt(t)}catch(t){throw l(a(this,te),t instanceof Error?t.message:"Erreur de cr√©ation",!0),t}finally{l(a(this,se),!1)}}async updateLoan(e,t){l(a(this,se),!0),l(a(this,te),null);try{await ga(e,t)}catch(r){throw l(a(this,te),r instanceof Error?r.message:"Erreur de mise √† jour",!0),r}finally{l(a(this,se),!1)}}async acceptLoan(e){await this.updateLoan(e,{status:"accepted"})}async refuseLoan(e){await this.updateLoan(e,{status:"refused"})}async cancelLoan(e){await this.updateLoan(e,{status:"canceled"})}async completeLoanWithReturn(e,t){for(const r of t.materiels){const i=r.lostQuantity||0,s=r.brokenQuantity||0;i+s>=r.quantity?await gt(r.materielId,{status:"lost"}):s>0?await gt(r.materielId,{status:"torepair"}):await gt(r.materielId,{status:"ok"})}await this.updateLoan(e,{status:"completed",returnedAt:new Date().toISOString(),returnNotes:t.returnNotes,materiels:t.materiels})}async completeLoan(e){await this.updateLoan(e,{status:"completed",returnedAt:new Date().toISOString()})}async deleteLoan(e){l(a(this,se),!0),l(a(this,te),null);try{const t=a(this,ie).get(e);t&&U(this,Q,et).call(this,t),await ya(e)}catch(t){throw l(a(this,te),t instanceof Error?t.message:"Erreur de suppression",!0),t}finally{l(a(this,se),!1)}}async hardReset(){console.log("[MaterielStore] üîÑ HARD RESET - Vidage complet..."),l(a(this,se),!0),l(a(this,te),null);try{if(a(this,re).clear(),a(this,ie).clear(),a(this,K)&&(await a(this,K).clear(),console.log("[MaterielStore] Cache IDB vid√©")),await U(this,Q,ra).call(this),a(this,K)){for(const[,e]of a(this,re))await a(this,K).upsertMateriel(e);for(const[,e]of a(this,ie))await a(this,K).upsertLoan(e);await a(this,K).saveMetadata({lastSyncMateriel:o(a(this,Oe)),lastSyncLoans:o(a(this,ke))}),console.log("[MaterielStore] Cache IDB recr√©√©")}console.log("[MaterielStore] ‚úì HARD RESET termin√©")}catch(e){const t=e instanceof Error?e.message:"Erreur lors du hard reset";throw l(a(this,te),t,!0),console.error("[MaterielStore] Erreur hard reset:",e),e}finally{l(a(this,se),!1)}}destroy(){var e;(e=a(this,Tt))==null||e.call(this),a(this,re).clear(),a(this,ie).clear(),Le(this,K,null),Le(this,ot,!1)}}re=new WeakMap,ie=new WeakMap,K=new WeakMap,se=new WeakMap,te=new WeakMap,Qe=new WeakMap,ft=new WeakMap,ot=new WeakMap,Oe=new WeakMap,ke=new WeakMap,Tt=new WeakMap,ze=new WeakMap,Rt=new WeakMap,Mt=new WeakMap,It=new WeakMap,_t=new WeakMap,Q=new WeakSet,ta=async function(){if(a(this,K))try{(await a(this,K).loadMateriels()).forEach(i=>{a(this,re).set(i.$id,i)}),(await a(this,K).loadLoans()).forEach(i=>{const s=vt(i);a(this,ie).set(i.$id,s)});const r=await a(this,K).loadMetadata();l(a(this,Oe),r.lastSyncMateriel,!0),l(a(this,ke),r.lastSyncLoans,!0),console.log(`[MaterielStore] ${a(this,re).size} mat√©riels et ${a(this,ie).size} emprunts charg√©s du cache IDB`)}catch(e){console.warn("[MaterielStore] Erreur lecture cache IDB, ignor√©:",e)}},aa=async function(){try{const e=o(a(this,Oe))?[ut.greaterThan("$updatedAt",o(a(this,Oe)))]:[],t=await Yt(e);for(const s of t){const d=U(this,Q,Ze).call(this,s);a(this,re).set(s.$id,d),a(this,K)?.upsertMateriel(d)}l(a(this,Oe),new Date().toISOString(),!0);const r=o(a(this,ke))?[ut.greaterThan("$updatedAt",o(a(this,ke))),ut.limit(100)]:[],i=await Ut(r);for(const s of i){const d=vt(s);a(this,ie).set(s.$id,d),a(this,K)?.upsertLoan(s),U(this,Q,et).call(this,d)}l(a(this,ke),new Date().toISOString(),!0),await a(this,K)?.saveMetadata({lastSyncMateriel:o(a(this,Oe)),lastSyncLoans:o(a(this,ke))}),console.log("[MaterielStore] Sync termin√©")}catch(e){throw console.error("[MaterielStore] Erreur sync:",e),e}},ra=async function(){try{console.log("[MaterielStore] Chargement complet depuis Appwrite...");const e=await Yt([ut.limit(1e3)]);for(const i of e){const s=U(this,Q,Ze).call(this,i);a(this,re).set(i.$id,s)}const t=await Ut([ut.limit(1e3)]),r=[];for(const i of t){const s=vt(i);a(this,ie).set(i.$id,s),r.push(s)}for(const i of r)U(this,Q,et).call(this,i);l(a(this,Oe),new Date().toISOString(),!0),l(a(this,ke),new Date().toISOString(),!0),console.log(`[MaterielStore] ${e.length} mat√©riels et ${t.length} emprunts charg√©s`)}catch(e){throw console.error("[MaterielStore] Erreur chargement complet:",e),e}},sa=async function(){Ve.register(ma(),async e=>{await U(this,Q,oa).call(this,e)}),Ve.register(fa(),async e=>{await U(this,Q,ia).call(this,e)})},oa=async function(e){try{const t=e.events,r=e.payload;if(!r){console.warn("[MaterielStore] Realtime Materiel : pas de payload dans la r√©ponse");return}const i=t.some(s=>s.includes(".create"))?"create":t.some(s=>s.includes(".delete"))?"delete":"update";if(console.log(`[MaterielStore] ‚ö°Ô∏è Realtime Materiel RECEIVED: ${i} pour ${r.$id}`),i==="create"||i==="update"){const s=U(this,Q,Ze).call(this,r);a(this,re).set(r.$id,s),a(this,K)?.upsertMateriel(s)}else i==="delete"&&(a(this,re).delete(r.$id),a(this,K)?.deleteMateriel(r.$id))}catch(t){console.error("[MaterielStore] Erreur realtime Materiel:",t)}},ia=async function(e){try{const t=e.events,r=e.payload;if(!r){console.warn("[MaterielStore] Realtime Loan : pas de payload dans la r√©ponse");return}const i=t.some(s=>s.includes(".create"))?"create":t.some(s=>s.includes(".delete"))?"delete":"update";if(console.log(`[MaterielStore] ‚ö°Ô∏è Realtime Loan RECEIVED: ${i} pour ${r.$id}`),i==="create"||i==="update"){const s=vt(r);a(this,ie).set(r.$id,s),a(this,K)?.upsertLoan(r),U(this,Q,et).call(this,s)}else if(i==="delete"){const s=a(this,ie).get(r.$id);s&&U(this,Q,et).call(this,s),a(this,ie).delete(r.$id),a(this,K)?.deleteLoan(r.$id)}}catch(t){console.error("[MaterielStore] Erreur realtime Loan:",t)}},Ze=function(e){const t=Array.from(a(this,ie).values());return ea(e,t)},et=function(e){const t=e.materielItems,r=Array.from(a(this,ie).values());for(const i of t){const s=a(this,re).get(i.materielId);if(s){const d=or(s,r);a(this,re).set(i.materielId,d),a(this,K)?.upsertMateriel(d)}}};const wt=new cr;var fe,it,$e,Fe,je,nt,lt,pt,Je,ct,Ee,na,la,We;class dr{constructor(){z(this,Ee);z(this,fe,new At);z(this,it,new At);z(this,$e,F(!1));z(this,Fe,F(null));z(this,je,F(!1));z(this,nt,F(!1));z(this,lt,!1);z(this,pt,F(null));z(this,Je,null);z(this,ct,me(()=>Array.from(a(this,fe).values())))}get loading(){return o(a(this,$e))}get error(){return o(a(this,Fe))}get isInitialized(){return o(a(this,je))}get isRealtimeActive(){return o(a(this,nt))}get count(){return a(this,fe).size}get documents(){return o(a(this,ct))}getTeamDocuments(e){return o(a(this,ct)).filter(t=>t.teamId===e)}getTeamTags(e){return a(this,it).get(e)||[]}async loadCache(){if(!o(a(this,je))){l(a(this,$e),!0),l(a(this,Fe),null);try{if(!E.userId){l(a(this,je),!0);return}l(a(this,je),!0),console.log("[TeamdocsStore] Cache charg√© (sans IDB)")}catch(e){throw l(a(this,Fe),e instanceof Error?e.message:"Erreur de chargement du cache",!0),console.error("[TeamdocsStore] LoadCache error:",e),e}finally{l(a(this,$e),!1)}}}async syncFromRemote(){l(a(this,$e),!0),l(a(this,Fe),null);try{if(!E.userId)return;const e=await wa();for(const t of e)a(this,fe).set(t.$id,t);await U(this,Ee,We).call(this),l(a(this,pt),new Date().toISOString(),!0),console.log(`[TeamdocsStore] Sync termin√© : ${a(this,fe).size} documents`)}catch(e){throw l(a(this,Fe),e instanceof Error?e.message:"Erreur de synchronisation",!0),console.error("[TeamdocsStore] SyncFromRemote error:",e),e}finally{l(a(this,$e),!1)}}async setupRealtime(){if(E.userId){if(a(this,lt)){console.log("[TeamdocsStore] Realtime d√©j√† configur√©");return}try{await U(this,Ee,na).call(this),l(a(this,nt),!0),Le(this,lt,!0),console.log("[TeamdocsStore] Realtime configur√©")}catch(e){throw l(a(this,Fe),e instanceof Error?e.message:"Erreur de configuration realtime",!0),console.error("[TeamdocsStore] SetupRealtime error:",e),e}}}async initialize(){await this.loadCache(),await this.syncFromRemote(),await this.setupRealtime()}async createDocument(e,t){if(!E.userId||!E.userName)throw new Error("Utilisateur non connect√©");const r=await Ea(e,t,E.userId,E.userName);return a(this,fe).set(r.$id,r),await U(this,Ee,We).call(this),console.log(`[TeamdocsStore] Document cr√©√© : ${r.$id}`),r}async updateDocument(e,t){const r=await Sa(e,t);return a(this,fe).set(e,r),t.tags&&await U(this,Ee,We).call(this),console.log(`[TeamdocsStore] Document mis √† jour : ${e}`),r}async deleteDocument(e){await xa(e),a(this,fe).delete(e),await U(this,Ee,We).call(this),console.log(`[TeamdocsStore] Document supprim√© : ${e}`)}getDocumentById(e){return a(this,fe).get(e)}async updateDocumentLock(e,t){if(E.userId)try{await Aa(e,t);const r=a(this,fe).get(e);r&&a(this,fe).set(e,{...r,lockedBy:t}),console.log(`[TeamdocsStore] Verrou ${e} mis √† jour: ${t||"lib√©r√©"}`)}catch(r){throw console.error(`[TeamdocsStore] Erreur verrouillage ${e}:`,r),r}}destroy(){a(this,Je)&&(a(this,Je).call(this),Le(this,Je,null)),a(this,fe).clear(),a(this,it).clear(),l(a(this,je),!1),l(a(this,nt),!1),Le(this,lt,!1),console.log("[TeamdocsStore] Store d√©truit")}async hardReset(){this.destroy(),l(a(this,pt),null),console.log("[TeamdocsStore] Hard reset effectu√©")}}fe=new WeakMap,it=new WeakMap,$e=new WeakMap,Fe=new WeakMap,je=new WeakMap,nt=new WeakMap,lt=new WeakMap,pt=new WeakMap,Je=new WeakMap,ct=new WeakMap,Ee=new WeakSet,na=async function(){const e=["databases.*.collections.undefined"];Ve.register(e,async t=>{await U(this,Ee,la).call(this,t)}),Le(this,Je,()=>{})},la=async function(e){const{events:t,payload:r}=e,i=t?.[0];if(!i)return;const s=r;switch(i){case"databases.*.collections.*.documents.create":case"databases.*.collections.*.documents.update":s&&(a(this,fe).set(s.$id,s),await U(this,Ee,We).call(this),console.log(`[TeamdocsStore] Document mis √† jour : ${s.$id}`));break;case"databases.*.collections.*.documents.delete":s?.$id&&(a(this,fe).delete(s.$id),await U(this,Ee,We).call(this),console.log(`[TeamdocsStore] Document supprim√© : ${s.$id}`));break}},We=async function(){const e=new Map;for(const t of o(a(this,ct))){const r=t.teamId;e.has(r)||e.set(r,new Set),t.tags&&t.tags.forEach(i=>{e.get(r).add(i)})}e.forEach((t,r)=>{a(this,it).set(r,Array.from(t).sort())}),console.log(`[TeamdocsStore] Tags mis √† jour pour ${e.size} √©quipes`)};const Et=new dr;var ur=p('<div class="alert alert-error max-md:alert-vertical shadow-lg"><!> <div><h3 class="font-bold">Erreur</h3> <div class="text-sm"> </div></div></div>');function Kt(n,e){var t=ur(),r=c(t);Xt(r,{class:"h-6 w-6 shrink-0 stroke-current"});var i=h(r,2),s=h(c(i),2),d=c(s);G(()=>he(d,e.message)),u(n,t)}var _e;class vr{constructor(){z(this,_e,F(Ta({title:""})))}get title(){return o(a(this,_e)).title||"ENKA Cookbook"}get backAction(){return o(a(this,_e)).backAction}get actions(){return o(a(this,_e)).actions}get tabs(){return o(a(this,_e)).tabs}get eventId(){return o(a(this,_e)).eventId}get activeTab(){return o(a(this,_e)).activeTab||0}get isLockedByOthers(){return o(a(this,_e)).isLockedByOthers||!1}get lockedByUserName(){return o(a(this,_e)).lockedByUserName||""}get hasUnsavedChanges(){return o(a(this,_e)).hasUnsavedChanges||!1}get materielContext(){return o(a(this,_e)).materielContext||null}get teamId(){return o(a(this,_e)).teamId}setConfig(e){l(a(this,_e),{...e},!0)}reset(){l(a(this,_e),{title:""},!0)}}_e=new WeakMap;const le=new vr;var hr=p("<button> </button>"),mr=p('<div class="rounded-box bg-secondary/10 px-4 py-1"><div class="tabs tabs-border justify-center"></div></div>');function Qt(n,e){xe(e,!0);const t=[{label:"√âditer l'√©v√©nement",path:"/dashboard/eventEdit"},{label:"Voir les recettes",path:"/dashboard/eventEdit/recipes"},{label:"Listes des produits",path:"/dashboard/eventEdit/products"},{label:"Affiches",path:"/dashboard/eventPosters"}],r=me(()=>{const v=Y.path;return v.includes("/eventEdit/recipes/")?1:v.includes("/eventEdit/products/")?2:v.includes("/eventPosters/")?3:(v.includes("/eventEdit/")&&e.eventId&&new RegExp(`/dashboard/eventEdit/${e.eventId}(/?$)`).test(v),0)});function i(v){e.eventId&&(v===1?ue(`/dashboard/eventEdit/recipes/${e.eventId}`):v===2?ue(`/dashboard/eventEdit/products/${e.eventId}`):v===3?ue(`/dashboard/eventPosters/${e.eventId}`):ue(`/dashboard/eventEdit/${e.eventId}`))}var s=mr(),d=c(s);tt(d,21,()=>t,Lt,(v,m,f)=>{var b=hr();b.__click=()=>i(f);var M=c(b);G(()=>{Pe(b,1,`tab font-semibold ${f===o(r)?"tab-active":""}`),he(M,o(m).label)}),u(v,b)}),u(n,s),Ae()}Ne(["click"]);var fr=p("<button> </button>"),_r=p('<div class="tabs tabs-lg tabs-border justify-center"></div>');function Jt(n,e){xe(e,!0);const t=[{label:"Mat√©riel",getPath:()=>i()},{label:"Reservations",getPath:()=>s()}],r=me(()=>Y.path.includes("/loans")?1:0);function i(){if(e.currentTeamId)return`/dashboard/materiel/${e.currentTeamId}`;const m=Ye.myTeams;return m.length>0?`/dashboard/materiel/${m[0].$id}`:"/dashboard/materiel"}function s(){if(e.currentTeamId)return`/dashboard/loans/${e.currentTeamId}`;const m=Ye.myTeams;return m.length>0?`/dashboard/loans/${m[0].$id}`:"/dashboard/loans"}function d(m){const f=t[m].getPath();ue(f)}var v=_r();tt(v,21,()=>t,Lt,(m,f,b)=>{var M=fr();M.__click=()=>d(b);var w=c(M);G(()=>{Pe(M,1,`tab font-medium ${b===o(r)?"tab-active":""}`),he(w,o(f).label)}),u(m,M)}),u(n,v),Ae()}Ne(["click"]);var pr=()=>ue("/"),br=()=>ue("/dashboard"),gr=p('<button class="btn btn-ghost not-md:btn-square md:gap-2"><!> <span class="hidden md:inline">Tableau de bord</span></button>'),yr=()=>ue("/recipe"),wr=p('<h1 class="font-family-fredoka truncate text-sm font-bold tracking-wider uppercase opacity-70"> </h1>'),Er=p('<div class="navbar-center absolute left-1/2 -translate-x-1/2 transform"><!></div>'),Sr=p('<div class="badge badge-warning flex items-center gap-1 py-3 font-medium"><!> <span class="text-xs"> </span></div>'),xr=()=>ue("/dashboard"),Ar=()=>ue("/dashboard/teams"),Tr=()=>ue("/dashboard/eventCreate"),Rr=()=>ue("/recipe"),Mr=p('<div class="dropdown dropdown-end"><div tabindex="0" role="button" class="btn btn-ghost btn-circle avatar bg-primary/10 text-primary border-primary/20 border"><div class="flex w-10 items-center justify-center rounded-full text-lg font-bold"> </div></div> <ul class="menu menu-sm dropdown-content bg-base-100 border-base-200 z-[1] mt-3 w-56 rounded-xl border p-2 shadow-xl"><li class="border-base-100 mb-1 border-b px-4 py-2"><span class="block truncate p-0 text-xs font-medium italic opacity-60"> </span></li> <li><button><!> Dashboard</button></li> <li><button><!> √âquipes</button></li> <li><button><!> Nouvel √©v√©nement</button></li> <li><button><!> Recettes</button></li> <li><button class="disabled:opacity-50"><!> </button></li> <!> <li class="border-base-100 my-1 border-t"></li> <li><button class="text-error hover:bg-error/10"><!> Se d√©connecter</button></li></ul></div>'),Ir=p('<button class="btn btn-primary btn-sm shadow-md"><!> Connexion</button>'),Lr=p('<h1 class="text-center text-sm font-bold tracking-wider uppercase opacity-70"> </h1>'),Dr=p('<div class="border-base-300 bg-base-100 border-b px-4 py-3"><!></div>'),Cr=p('<div><div class="navbar-start w-fit flex-shrink-0 gap-1"><button class="btn btn-ghost btn-circle"><img src="images/favicon.png" alt="logo" class="h-8 w-8"/></button> <div class="flex items-center gap-1"><!> <button class="btn btn-ghost not-md:btn-square md:gap-2"><!> <span class="hidden md:inline">Recettes</span></button></div></div> <!> <div class="navbar-end ms-auto w-fit flex-shrink-0 gap-4"><!> <div class="flex items-center gap-2"><!></div> <!></div></div> <!>',1);function Or(n,e){xe(e,!0);let t=F(!1),r=F(!1);function i(){l(t,!1)}async function s(){try{await E.logout(),window.location.href="/"}catch(x){console.error("Erreur lors de la d√©connexion:",x)}}function d(){E.authModal.isOpen=!0,console.log("globalState.authModal.isOpen",E.authModal.isOpen)}async function v(){if(E.userId){l(r,!0);try{await Ge.forceReloadAllRecipes(),i()}catch(x){console.error("Erreur lors du rechargement des recettes:",x),alert("Erreur lors du rechargement des recettes")}finally{l(r,!1)}}}function m(x){x.target.closest(".svelte-user-dropdown")||i()}dt(()=>{if(o(t))return document.addEventListener("click",m),()=>document.removeEventListener("click",m)});var f=Cr(),b=H(f),M=c(b),w=c(M);w.__click=[pr];var V=h(w,2),N=c(V);{var ne=x=>{var C=gr();C.__click=[br];var A=c(C);Ht(A,{size:18}),u(x,C)};y(N,x=>{E.isAuthenticated&&x(ne)})}var D=h(N,2);D.__click=[yr];var _=c(D);$a(_,{size:18});var g=h(M,2);{var S=x=>{var C=Er(),A=c(C);{var $=I=>{Jt(I,{get currentTeamId(){return le.teamId}})},Z=I=>{var R=de(),L=H(R);{var W=j=>{var k=de(),q=H(k);Ue(q,()=>le.tabs),u(j,k)},ee=j=>{var k=de(),q=H(k);{var ge=oe=>{Qt(oe,{get eventId(){return le.eventId}})},Re=oe=>{var ve=wr(),Me=c(ve);G(()=>{Nt(ve,"title",le.title),he(Me,le.title)}),u(oe,ve)};y(q,oe=>{le.eventId!==void 0?oe(ge):oe(Re,!1)},!0)}u(j,k)};y(L,j=>{le.tabs?j(W):j(ee,!1)},!0)}u(I,R)};y(A,I=>{le.materielContext?I($):I(Z,!1)})}u(x,C)};y(g,x=>{E.isDesktop&&x(S)})}var O=h(g,2),P=c(O);{var be=x=>{var C=Sr(),A=c(C);ja(A,{size:14});var $=h(A,2),Z=c($);G(()=>he(Z,`√âdition par ${le.lockedByUserName??""}`)),u(x,C)};y(P,x=>{le.isLockedByOthers&&x(be)})}var T=h(P,2),B=c(T);{var J=x=>{var C=de(),A=H(C);Ue(A,()=>le.actions),u(x,C)};y(B,x=>{le.actions&&x(J)})}var ce=h(T,2);{var Se=x=>{var C=Mr(),A=c(C),$=c(A),Z=c($),I=h(A,2),R=c(I),L=c(R),W=c(L),ee=h(R,2),j=c(ee);j.__click=[xr];var k=c(j);Ht(k,{size:16});var q=h(ee,2),ge=c(q);ge.__click=[Ar];var Re=c(ge);Va(Re,{size:16});var oe=h(q,2),ve=c(oe);ve.__click=[Tr];var Me=c(ve);qa(Me,{size:16});var Ie=h(oe,2),De=c(Ie);De.__click=[Rr];var Ce=c(De);Ya(Ce,{size:16});var ye=h(Ie,2),Dt=c(ye);Dt.__click=v;var Ft=c(Dt);{let bt=me(()=>o(r)?"animate-spin":"");Ua(Ft,{size:16,get class(){return o(bt)}})}var ca=h(Ft),$t=h(ye,2);y($t,bt=>{});var da=h($t,4),jt=c(da);jt.__click=s;var ua=c(jt);Ha(ua,{size:16}),G(bt=>{he(Z,bt),he(W,E.user?.email),Dt.disabled=o(r),he(ca,` ${o(r)?"Chargement...":"Recharger les recettes"}`)},[()=>E.user?.name?.charAt(0).toUpperCase()||"U"]),u(x,C)},ae=x=>{var C=Ir();C.__click=d;var A=c(C);Ga(A,{size:16}),u(x,C)};y(ce,x=>{E.isAuthenticated?x(Se):x(ae,!1)})}var pe=h(b,2);{var Te=x=>{var C=Dr(),A=c(C);{var $=I=>{Jt(I,{get currentTeamId(){return le.teamId}})},Z=I=>{var R=de(),L=H(R);{var W=j=>{Qt(j,{get eventId(){return le.eventId}})},ee=j=>{var k=de(),q=H(k);{var ge=oe=>{var ve=de(),Me=H(ve);Ue(Me,()=>le.tabs),u(oe,ve)},Re=oe=>{var ve=de(),Me=H(ve);{var Ie=De=>{var Ce=Lr(),ye=c(Ce);G(()=>he(ye,le.title)),u(De,Ce)};y(Me,De=>{le.title&&De(Ie)},!0)}u(oe,ve)};y(q,oe=>{le.tabs?oe(ge):oe(Re,!1)},!0)}u(j,k)};y(L,j=>{le.eventId!==void 0?j(W):j(ee,!1)},!0)}u(I,R)};y(A,I=>{le.materielContext?I($):I(Z,!1)})}u(x,C)};y(pe,x=>{E.isDesktop||x(Te)})}G(()=>Pe(b,1,`navbar bg-base-100 border-base-300 sticky top-0 z-[1000] min-h-13 border-b px-4 py-0 shadow-sm print:hidden ${(E.isMobile&&"min-h-11")??""} relative`)),u(n,f),Ae()}Ne(["click"]);var kr=(n,e,t,r)=>e(o(t),o(r)),Pr=p('<button class="btn btn-sm btn-primary"> </button>'),Nr=(n,e,t)=>e(o(t)),Br=p('<button class="btn btn-ghost btn-xs btn-square" title="Voir les d√©tails" aria-label="Voir les d√©tails"><!></button>'),zr=(n,e,t)=>e(o(t)),Fr=p('<button class="btn btn-ghost btn-xs btn-circle" title="Fermer" aria-label="Fermer la notification"><!></button>'),$r=p('<div><div class="flex items-center justify-between gap-4"><div class="flex flex-1 items-center gap-2"><!> <span class="text-xs"> </span></div> <!> <!> <!></div></div>'),jr=p("<div></div>");function Vr(n,e){xe(e,!0);let t=we(e,"position",3,"toast-center toast-bottom"),r=we(e,"padding",3,"sm");const i=me(()=>r()==="sm"?" py-0.5":""),s=me(()=>qe.toasts),d=me(()=>()=>{const w=new Map;for(const V of o(s)){const N=V.position||t();w.has(N)||w.set(N,[]),w.get(N).push(V)}return w});function v(w){qe.dismiss(w.id)}function m(w){e.onShowDetails?.({id:w.id,message:w.message,details:w.details})}function f(w,V){V.onClick()}var b=de(),M=H(b);tt(M,17,()=>Array.from(o(d)().entries()),([w,V])=>w,(w,V)=>{var N=me(()=>Ra(o(V),2));let ne=()=>o(N)[0],D=()=>o(N)[1];var _=jr();tt(_,21,D,g=>g.id,(g,S)=>{var O=$r(),P=c(O),be=c(P),T=c(be);{var B=A=>{Wa(A,{class:"h-5 w-5 animate-spin"})};y(T,A=>{o(S).state==="loading"&&A(B)})}var J=h(T,2),ce=c(J),Se=h(be,2);{var ae=A=>{var $=de(),Z=H($);tt(Z,17,()=>o(S).actions,Lt,(I,R)=>{var L=Pr();L.__click=[kr,f,S,R];var W=c(L);G(()=>he(W,o(R).label)),u(I,L)}),u(A,$)};y(Se,A=>{o(S).actions&&o(S).actions.length>0&&A(ae)})}var pe=h(Se,2);{var Te=A=>{var $=Br();$.__click=[Nr,m,S];var Z=c($);Ka(Z,{class:"h-3 w-3"}),u(A,$)};y(pe,A=>{o(S).details&&A(Te)})}var x=h(pe,2);{var C=A=>{var $=Fr();$.__click=[zr,v,S];var Z=c($);Zt(Z,{class:"h-4 w-4"}),u(A,$)};y(x,A=>{(o(S).state==="error"||o(S).state==="warning"||o(S).state==="loading")&&A(C)})}G(()=>{Pe(O,1,`alert alert-${o(S).state??""}  ${o(i)??""} shadow-lg`),he(ce,o(S).message)}),u(g,O)}),G(()=>Pe(_,1,`toast ${ne()??""} z-1050`)),u(w,_)}),u(n,b),Ae()}Ne(["click"]);const qr=new Ma(()=>window.scrollY,n=>Ia(window,"scroll",n)),Yr=n=>n;function Ur(n){const e=n-1;return e*e*e+1}function Hr(n,{delay:e=0,duration:t=400,easing:r=Yr}={}){const i=+getComputedStyle(n).opacity;return{delay:e,duration:t,easing:r,css:s=>`opacity: ${s*i}`}}function to(n,{delay:e=0,duration:t=400,easing:r=Ur,axis:i="y"}={}){const s=getComputedStyle(n),d=+s.opacity,v=i==="y"?"height":"width",m=parseFloat(s[v]),f=i==="y"?["top","bottom"]:["left","right"],b=f.map(_=>`${_[0].toUpperCase()}${_.slice(1)}`),M=parseFloat(s[`padding${b[0]}`]),w=parseFloat(s[`padding${b[1]}`]),V=parseFloat(s[`margin${b[0]}`]),N=parseFloat(s[`margin${b[1]}`]),ne=parseFloat(s[`border${b[0]}Width`]),D=parseFloat(s[`border${b[1]}Width`]);return{delay:e,duration:t,easing:r,css:_=>`overflow: hidden;opacity: ${Math.min(_*20,1)*d};${v}: ${_*m}px;padding-${f[0]}: ${_*M}px;padding-${f[1]}: ${_*w}px;margin-${f[0]}: ${_*V}px;margin-${f[1]}: ${_*N}px;border-${f[0]}-width: ${_*ne}px;border-${f[1]}-width: ${_*D}px;min-${v}: 0`}}function Gr(){window.scrollTo({top:0,behavior:"smooth"})}var Wr=p('<button class="btn btn-primary btn-circle fixed right-6 bottom-6 z-50 rounded-full shadow-lg" aria-label="Retour en haut de page"><!></button>');function Kr(n,e){xe(e,!0);let t=me(()=>(qr.current||0)>300);var r=de(),i=H(r);{var s=d=>{var v=Wr();v.__click=[Gr];var m=c(v);Qa(m,{class:"h-6 w-6"}),La(3,v,()=>Hr),u(d,v)};y(i,d=>{o(t)&&d(s)})}u(n,r),Ae()}Ne(["click"]);function Qr(n,e){xe(e,!0),Ae()}function Jr(n,e,t){l(e,!1),t.onClose()}function Xr(n,e){l(e,!1)}var Zr=p('<div role="dialog" aria-modal="true"><!></div>'),es=p('<div class="modal modal-open" style="z-index: 1100"><div class="modal-box max-w-md"><h3 class="text-lg font-bold">Confirmer la fermeture</h3> <p class="py-4"> </p> <div class="modal-action"><button class="btn btn-ghost">Annuler</button> <button class="btn btn-error">Fermer sans sauvegarder</button></div></div></div>'),ts=p("<div><!></div> <!>",1);function as(n,e){xe(e,!0);let t=we(e,"fullscreenOnMobile",3,!0);we(e,"closeOnBackdropClick",3,!1);let r=we(e,"hasUnsavedChanges",3,!1),i=we(e,"confirmCloseMessage",3,"Vous avez des modifications non sauvegard√©es. Voulez-vous vraiment fermer ?"),s=we(e,"maxWidth",3,"lg"),d=we(e,"maxHeight",3,"xl"),v=we(e,"modalClass",3,"");function m(_,g){return{sm:{"max-w":"max-w-[28rem]","max-h":"max-h-[85vh]"},lg:{"max-w":"max-w-[64rem]","max-h":"max-h-[85vh]"},xl:{"max-w":"max-w-[90vw]","max-h":"max-h-[90vh]"}}[_][g]}let f=F(!1);function b(){r()?l(f,!0):e.onClose()}dt(()=>{if(!e.isOpen)return;const _=g=>{g.key==="Escape"&&!o(f)&&b()};return window.addEventListener("keydown",_),()=>window.removeEventListener("keydown",_)}),dt(()=>{if(e.isOpen)return document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}});var M=ts(),w=H(M),V=c(w);{var N=_=>{var g=Zr(),S=c(g);Ue(S,()=>e.children),G((O,P)=>Pe(g,1,`modal-box flex flex-col p-0 ${v()??""} ${t()&&E.isMobile?"fixed inset-0 m-0 h-lvh w-lvw rounded-none":"fixed top-10 m-auto"} ${O??""} ${P??""}`),[()=>E.isDesktop&&m(s(),"max-w"),()=>E.isDesktop&&!v()&&m(d(),"max-h")]),u(_,g)};y(V,_=>{e.isOpen&&_(N)})}var ne=h(w,2);{var D=_=>{var g=es(),S=c(g),O=h(c(S),2),P=c(O),be=h(O,2),T=c(be);T.__click=[Xr,f];var B=h(T,2);B.__click=[Jr,f,e],G(()=>he(P,i())),u(_,g)};y(ne,_=>{o(f)&&_(D)})}G(()=>Pe(w,1,`modal ${(e.isOpen&&"modal-open")??""} `)),u(n,M),Ae()}Ne(["click"]);var rs=p('<button class="btn btn-circle btn-ghost btn-sm flex-none" aria-label="Retour"><!></button>'),ss=p('<button class="btn btn-circle btn-ghost btn-sm flex-none" aria-label="Retour"><!></button>'),os=p('<p class="text-base-content/70 truncate text-sm"> </p>'),is=p('<div class="flex items-center gap-2 sm:me-10"><!></div>'),ns=p('<div class="border-base-300 flex-none border-b px-4 py-3"><div class="absolute top-2 right-2"><!></div> <div class="flex flex-wrap items-center gap-2"><div class="flex min-w-0 flex-1 items-center gap-2"><!> <div class="max-w-11/12 min-w-0 flex-1 items-baseline"><h3 class="truncate text-lg font-bold"> </h3> <!></div></div> <!></div></div>');function ls(n,e){xe(e,!0);let t=we(e,"showBackButton",3,!0);var r=ns(),i=c(r),s=c(i);{var d=g=>{var S=rs();S.__click=function(...P){e.onClose?.apply(this,P)};var O=c(S);Zt(O,{class:"h-5 w-5"}),u(g,S)};y(s,g=>{E.isMobile||g(d)})}var v=h(i,2),m=c(v),f=c(m);{var b=g=>{var S=ss();S.__click=function(...P){e.onClose?.apply(this,P)};var O=c(S);Ja(O,{class:"h-5 w-5"}),u(g,S)};y(f,g=>{t()&&E.isMobile&&g(b)})}var M=h(f,2),w=c(M),V=c(w),N=h(w,2);{var ne=g=>{var S=os(),O=c(S);G(()=>he(O,e.subtitle)),u(g,S)};y(N,g=>{e.subtitle&&g(ne)})}var D=h(m,2);{var _=g=>{var S=is(),O=c(S);Ue(O,()=>e.children),u(g,S)};y(D,g=>{e.children&&g(_)})}G(()=>he(V,e.title)),u(n,r),Ae()}Ne(["click"]);var cs=p('<div class="flex-1 overflow-y-auto p-4 sm:p-6 sm:pt-2"><!></div>');function ds(n,e){var t=cs(),r=c(t);Ue(r,()=>e.children),u(n,t)}var us=p('<div class="border-base-300 flex-none border-t px-4 py-3"><div class="flex flex-wrap items-center justify-end gap-2"><!></div></div>');function vs(n,e){var t=us(),r=c(t),i=c(r);Ue(i,()=>e.children),u(n,t)}var hs=p('<div role="alert" class="alert alert-error max-md:alert-vertical svelte-o861tn"><!> <span> </span></div>'),ms=p('<div role="alert" class="alert alert-success max-md:alert-vertical svelte-o861tn"><!> <span> </span></div>'),fs=(n,e)=>l(e,!1),_s=p(`<form class="space-y-4 svelte-o861tn"><div class="form-control svelte-o861tn"><label for="forgot-email" class="label"><span class="label-text">Email</span></label> <input id="forgot-email" type="email" class="input input-bordered w-full" placeholder="votre@email.com"/></div> <div class="alert alert-info alert-soft svelte-o861tn">Un email avec un lien vous sera envoy√© par "noreply@appwrite.io".
            Pensez √† v√©rifier s'il n'a pas att√©ri dans votre dossier spam.</div></form> <div class="text-center svelte-o861tn"><button class="btn btn-ghost btn-sm">‚Üê Retour √† la connexion</button></div>`,1),ps=(n,e)=>l(e,!0),bs=(n,e)=>l(e,!1),gs=p(`<form class="space-y-4 svelte-o861tn"><div class="form-control svelte-o861tn"><label for="login-email" class="label"><span class="label-text">Email</span></label> <input id="login-email" type="email" class="input input-bordered w-full" placeholder="votre@email.com" required/></div> <div class="form-control svelte-o861tn"><label for="login-password" class="label"><span class="label-text">Mot de passe</span></label> <input id="login-password" type="password" class="input input-bordered w-full" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required/></div></form> <div class="space-y-2 text-center svelte-o861tn"><button class="btn btn-link btn-sm btn-primary svelte-o861tn">Mot de passe oubli√© ?</button> <div class="text-base-content/70 text-sm svelte-o861tn">Pas encore de compte ? <button class="btn btn-primary btn-sm btn-soft ms-1">S'inscrire</button></div></div>`,1),ys=(n,e)=>l(e,!0),ws=p(`<form class="space-y-4 svelte-o861tn"><div class="form-control svelte-o861tn"><label for="register-name" class="label"><span class="label-text">Nom</span></label> <input id="register-name" type="text" class="input input-bordered w-full" placeholder="Votre nom" required/></div> <div class="form-control svelte-o861tn"><label for="register-email" class="label"><span class="label-text">Email</span></label> <input id="register-email" type="email" class="input input-bordered w-full" placeholder="votre@email.com" required/></div> <div class="form-control svelte-o861tn"><label for="register-password" class="label"><span class="label-text">Mot de passe</span></label> <input id="register-password" type="password" class="input input-bordered w-full" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required/></div> <div class="alert alert-info alert-soft svelte-o861tn">Un email avec un lien vous sera envoy√© par "noreply@appwrite.io".
            Pensez √† v√©rifier s'il n'a pas att√©ri dans votre dossier spam.</div></form> <div class="text-base-content/70 text-center text-sm svelte-o861tn">D√©j√† un compte ? <button class="btn btn-ghost btn-sm text-primary ms-1">Se connecter</button></div>`,1),Es=p('<div class="space-y-4 svelte-o861tn"><!> <!> <!></div>'),Ss=p('<span class="loading loading-spinner"></span>'),xs=p('<button type="submit" class="btn btn-primary btn-block"><!></button>'),As=p('<span class="loading loading-spinner"></span>'),Ts=p('<button type="submit" class="btn btn-primary btn-block"><!></button>'),Rs=p('<span class="loading loading-spinner"></span>'),Ms=p('<button type="submit" class="btn btn-success btn-block"><!></button>'),Is=p("<!> <!> <!>",1);function Ls(n,e){xe(e,!0);let t=we(e,"isOpen",15),r=we(e,"onAuth_success",3,async()=>{}),i=F(!0),s=F(!1),d=F(""),v=F(""),m=F(""),f=F(""),b=F(""),M=F(""),w=F(""),V=F(""),N=F(!1);async function ne(O){if(O.preventDefault(),!o(m)||!o(f)){l(d,"Veuillez remplir tous les champs");return}l(s,!0),l(d,"");try{const{account:P}=await St();await P.createEmailPasswordSession({email:o(m),password:o(f)}),l(v,"Connexion r√©ussie !"),setTimeout(()=>{r()()},1e3)}catch(P){console.error("Erreur de connexion:",P),l(d,P.message||"Erreur lors de la connexion",!0)}finally{l(s,!1)}}async function D(O){if(O.preventDefault(),!o(b)||!o(M)||!o(w)){l(d,"Veuillez remplir tous les champs");return}l(s,!0),l(d,"");try{const{account:P}=await St();await P.create({userId:"unique()",email:o(M),password:o(w),name:o(b)}),await P.createEmailPasswordSession({email:o(M),password:o(w)}),l(v,"Compte cr√©√© et connect√© !"),setTimeout(()=>{r()()},1e3)}catch(P){console.error("Erreur d'inscription:",P),l(d,P.message||"Erreur lors de la cr√©ation du compte",!0)}finally{l(s,!1)}}async function _(O){if(O.preventDefault(),!o(V)){l(d,"Veuillez entrer votre email");return}l(s,!0),l(d,"");try{const{account:P}=await St();await P.createRecovery({email:o(V),url:`${window.location.origin}/#/reset-password`}),l(v,"Email de r√©initialisation envoy√© !"),setTimeout(()=>{l(N,!1),l(V,"")},2e3)}catch(P){console.error("Erreur mot de passe oubli√©:",P),l(d,P.message||"Erreur lors de l'envoi de l'email",!0)}finally{l(s,!1)}}function g(){o(s)||t(!1)}dt(()=>{(o(i)||o(N))&&(l(d,""),l(v,""))});function S(){return o(N)?"Mot de passe oubli√©":o(i)?"Connexion":"Inscription"}as(n,{get isOpen(){return t()},onClose:g,maxWidth:"sm",children:(O,P)=>{var be=Is(),T=H(be);{let ce=me(S);ls(T,{get title(){return o(ce)},onClose:g})}var B=h(T,2);ds(B,{children:(ce,Se)=>{var ae=Es(),pe=c(ae);{var Te=I=>{var R=hs(),L=c(R);Xt(L,{class:"h-6 w-6 shrink-0 stroke-current"});var W=h(L,2),ee=c(W);G(()=>he(ee,o(d))),u(I,R)};y(pe,I=>{o(d)&&I(Te)})}var x=h(pe,2);{var C=I=>{var R=ms(),L=c(R);Xa(L,{class:"h-6 w-6 shrink-0 stroke-current"});var W=h(L,2),ee=c(W);G(()=>he(ee,o(v))),u(I,R)};y(x,I=>{o(v)&&I(C)})}var A=h(x,2);{var $=I=>{var R=_s(),L=H(R),W=c(L),ee=h(c(W),2),j=h(L,2),k=c(j);k.__click=[fs,N],G(()=>{ee.disabled=o(s),k.disabled=o(s)}),Ot("submit",L,_),Xe(ee,()=>o(V),q=>l(V,q)),u(I,R)},Z=I=>{var R=de(),L=H(R);{var W=j=>{var k=gs(),q=H(k),ge=c(q),Re=h(c(ge),2),oe=h(ge,2),ve=h(c(oe),2),Me=h(q,2),Ie=c(Me);Ie.__click=[ps,N];var De=h(Ie,2),Ce=h(c(De));Ce.__click=[bs,i],G(()=>{Re.disabled=o(s),ve.disabled=o(s),Ie.disabled=o(s),Ce.disabled=o(s)}),Ot("submit",q,ne),Xe(Re,()=>o(m),ye=>l(m,ye)),Xe(ve,()=>o(f),ye=>l(f,ye)),u(j,k)},ee=j=>{var k=ws(),q=H(k),ge=c(q),Re=h(c(ge),2),oe=h(ge,2),ve=h(c(oe),2),Me=h(oe,2),Ie=h(c(Me),2),De=h(q,2),Ce=h(c(De));Ce.__click=[ys,i],G(()=>{Re.disabled=o(s),ve.disabled=o(s),Ie.disabled=o(s),Ce.disabled=o(s)}),Ot("submit",q,D),Xe(Re,()=>o(b),ye=>l(b,ye)),Xe(ve,()=>o(M),ye=>l(M,ye)),Xe(Ie,()=>o(w),ye=>l(w,ye)),u(j,k)};y(L,j=>{o(i)?j(W):j(ee,!1)},!0)}u(I,R)};y(A,I=>{o(N)?I($):I(Z,!1)})}u(ce,ae)}});var J=h(B,2);vs(J,{children:(ce,Se)=>{var ae=de(),pe=H(ae);{var Te=C=>{var A=xs();A.__click=_;var $=c(A);{var Z=R=>{var L=Ss();u(R,L)},I=R=>{var L=at("Envoyer l'email de r√©initialisation");u(R,L)};y($,R=>{o(s)?R(Z):R(I,!1)})}G(()=>A.disabled=o(s)),u(C,A)},x=C=>{var A=de(),$=H(A);{var Z=R=>{var L=Ts();L.__click=ne;var W=c(L);{var ee=k=>{var q=As();u(k,q)},j=k=>{var q=at("Se connecter");u(k,q)};y(W,k=>{o(s)?k(ee):k(j,!1)})}G(()=>L.disabled=o(s)),u(R,L)},I=R=>{var L=Ms();L.__click=D;var W=c(L);{var ee=k=>{var q=Rs();u(k,q)},j=k=>{var q=at("Cr√©er un compte");u(k,q)};y(W,k=>{o(s)?k(ee):k(j,!1)})}G(()=>L.disabled=o(s)),u(R,L)};y($,R=>{o(i)?R(Z):R(I,!1)},!0)}u(C,A)};y(pe,C=>{o(N)?C(Te):C(x,!1)})}u(ce,ae)}}),u(O,be)},$$slots:{default:!0}}),Ae()}Ne(["click"]);Da();var Ds=p('<img class="w-full object-cover"/>'),Cs=p('<figure class="hover-gallery"></figure>'),Os=p('<p class="text-base-content/80"><!></p>'),ks=p("<button> </button>"),Ps=p('<div class="card bg-base-100 h-[60vh] w-full shadow-xl"><!> <div><h2> </h2> <!> <!> <!></div></div>');function ht(n,e){xe(e,!0);let t=we(e,"theme",3,"primary");const r={primary:"text-primary",secondary:"text-secondary"};var i=Ps(),s=c(i);{var d=D=>{var _=Cs();tt(_,21,()=>e.images,Lt,(g,S)=>{var O=Ds();G(()=>{Nt(O,"src",o(S)),Nt(O,"alt",e.title)}),u(g,O)}),u(D,_)};y(s,D=>{e.images.length>0&&D(d)})}var v=h(s,2),m=c(v),f=c(m),b=h(m,2);{var M=D=>{var _=Os(),g=c(_);Ca(g,()=>e.description),u(D,_)};y(b,D=>{e.description&&D(M)})}var w=h(b,2);{var V=D=>{var _=de(),g=H(_);Ue(g,()=>e.extra),u(D,_)};y(w,D=>{e.extra&&D(V)})}var N=h(w,2);{var ne=D=>{var _=ks();_.__click=function(...S){e.buttonAction?.apply(this,S)};var g=c(_);G(()=>{Pe(_,1,`btn btn-${t()??""} btn-sm absolute right-4 bottom-4`),he(g,e.buttonText)}),u(D,_)};y(N,D=>{e.buttonText&&e.buttonAction&&D(ne)})}G(()=>{Pe(v,1,`card-body absolute bottom-0 ${(e.buttonAction&&"pb-15")??""} w-full bg-gray-700/30`),Pe(m,1,`card-title ${r[t()]??""} text-2xl`),he(f,e.title)}),u(n,i),Ae()}Ne(["click"]);var He=ka(()=>E),Ns=()=>ue("/recipe"),Bs=()=>ue("/dashboard"),zs=p('<button class="btn btn-outline btn-xl"><!> Acc√©der au tableau de bord</button>'),Fs=p('<button class="btn btn-secondary btn-xl">Cr√©er un compte pour commencer <!></button>'),$s=p('<p class="text-base-content/60 text-center">D√©j√† membre ? Connectez-vous pour g√©rer vos cantines et √©quipes</p>'),js=p('<div class="bg-base-200 min-h-screen"><section class="hero bg-base-200 min-h-[50vh]"><div class="hero-content text-center"><div class="max-w-3xl"><div class="mb-4 flex justify-center"><img src="images/logo.svg" alt="Enka Cookbook" class="size-80"/></div> <h1 class="cherry-bomb-one-regular text-7xl svelte-1dajxdy">Enka Cookbook</h1> <p class="text-base-content/70 mt-6 text-xl">Outils de planification pour les cantines autog√©r√©es</p></div></div></section> <section class="bg-base-200 mt-15 mb-5"><div class="container mx-auto px-4"><div class="flex flex-col items-center justify-center gap-6"><button class="btn btn-primary btn-xl"><!> <span class="flex items-baseline gap-2">Voir les recettes</span></button> <!> <!></div></div></section> <section class="bg-base-200 py-16"><div class="container mx-auto px-4"><div class="grid gap-8"><div class="grid gap-6 md:grid-cols-3"><!> <!></div> <div class="grid gap-6 md:grid-cols-3"><!> <!> <!></div></div></div></section></div>');function Vs(n,e){xe(e,!1);function t(){He(He().authModal.isOpen=!0)}Oa();var r=js(),i=h(c(r),2),s=c(i),d=c(s),v=c(d);v.__click=[Ns];var m=c(v);Za(m,{size:24});var f=h(v,2);{var b=B=>{var J=zs();J.__click=[Bs];var ce=c(J);Gt(ce,{size:24}),u(B,J)},M=B=>{var J=Fs();J.__click=t;var ce=h(c(J));Gt(ce,{size:24}),u(B,J)};y(f,B=>{He().isAuthenticated?B(b):B(M,!1)})}var w=h(f,2);{var V=B=>{var J=$s();u(B,J)};y(w,B=>{He().isAuthenticated||B(V)})}var N=h(i,2),ne=c(N),D=c(ne),_=c(D),g=c(_);ht(g,{images:["/images/plat.webp","/images/salade.webp"],title:"Partagez vos recettes",description:"D√©couvrez et partagez des recettes avec la communaut√©",buttonText:"Explorer",buttonAction:()=>ue("/recipe"),theme:"primary"});var S=h(g,2);ht(S,{images:["/images/home/recipe-print.webp","/images/home/recipe.webp"],title:"Imprimez vos recettes",description:"G√©n√©rez des fiches recettes propres et professionnelles",buttonText:"Imprimer",theme:"primary"});var O=h(_,2),P=c(O);ht(P,{images:["/images/doc/explorer.png"],title:"Organisation",description:"√âlaborez des menus sur plusieurs jours et organisez-vous en √©quipes",buttonText:"Organiser",buttonAction:()=>He().isAuthenticated?ue("/dashboard"):t(),theme:"secondary"});var be=h(P,2);ht(be,{images:["/images/home/product.webp"],title:"Listes de courses",description:"G√©n√©rez automatiquement les listes de courses pour vos menus",buttonText:"G√©n√©rer",buttonAction:()=>He().isAuthenticated?ue("/dashboard"):t(),theme:"secondary"});var T=h(be,2);ht(T,{images:["/images/friture.webp"],title:"Gestion compl√®te",description:"G√©rez vos stocks, mat√©riel et r√©partissez les t√¢ches",buttonText:"G√©rer",buttonAction:()=>He().isAuthenticated?ue("/dashboard"):t(),theme:"secondary"}),u(n,r),Ae()}Ne(["click"]);var qs=p('<div class="flex h-[50vh] items-center justify-center"><!></div>'),Ys=p('<div class="flex h-[80vh] flex-col items-center justify-center gap-4"><div class="loading loading-spinner loading-lg text-primary"></div> <p class="text-base-content/70 animate-pulse font-medium"><!></p></div>'),Us=p("<!> <!>",1),Hs=p('<link rel="preconnect" href="https://fonts.googleapis.com"/> <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""/> <link href="https://fonts.googleapis.com/css2?family=Cherry+Bomb+One&amp;family=Fredoka:wght@300..700&amp;display=swap&amp;family=Sora:wght@100..800&amp;display=swap" rel="stylesheet"/> <!> <div class="bg-base-200 min-h-screen"><!></div> <!> <!> <!> <!>',1);function Gs(n,e){xe(e,!0);let t=F("BOOTING"),r=F(null);const i={beforeEnter:async()=>E.isAuthenticated?!0:(console.log("[Router] Acc√®s refus√© > Redirection /"),ue("/"),!1)};Y.addRoute("/",Vs),Y.addRoute("/recipe",()=>X(()=>import("./RecipesListPage.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),Y.addRoute("/recipe/my",()=>X(()=>import("./RecipesListPage.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10])),i),Y.addRoute("/recipe/my/draft",()=>X(()=>import("./RecipesListPage.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10])),i),Y.addRoute("/recipe/new",()=>X(()=>import("./RecipeCreatePage.js"),__vite__mapDeps([11,1,2,10,12,13,14,3,15,7,16,17])),i),Y.addRoute("/recipe/:uuid/edit",()=>X(()=>import("./RecipeEditPage.js"),__vite__mapDeps([18,1,2,10,12,13,14,3,15,7,16,4,5,19,17,20])),i),Y.addRoute("/recipe/:uuid/duplicate",()=>X(()=>import("./RecipeCreatePage.js"),__vite__mapDeps([11,1,2,10,12,13,14,3,15,7,16,17])),i),Y.addRoute("/recipe/:uuid",()=>X(()=>import("./RecipeDetailPage.js"),__vite__mapDeps([21,1,2,8,22,13,3,23,24,20]))),Y.addRoute("/accept-invite",()=>X(()=>import("./AcceptInvite.js"),__vite__mapDeps([25,1,2]))),Y.addRoute("/reset-password",()=>X(()=>import("./ResetPassword.js"),__vite__mapDeps([26,1,2,27]))),Y.addRoute("/dashboard",()=>X(()=>import("./DashboardPage.js"),__vite__mapDeps([28,1,2,29,30,19,31,13,32,33])),i),Y.addRoute("/dashboard/teams",()=>X(()=>import("./TeamsManagement.js"),__vite__mapDeps([34,1,2,30,19,31])),i),Y.addRoute("/dashboard/eventCreate",()=>X(()=>import("./EventCreatePage.js"),__vite__mapDeps([35,1,2,36,5,19,13,29,3])),i),Y.addRoute("/dashboard/eventEdit/:id",()=>X(()=>import("./EventEditPage.js"),__vite__mapDeps([37,1,2,36,5,19,13,29,3,38,32,39,7,15,17])),i),Y.addRoute("/dashboard/eventEdit/recipes/:id",()=>X(()=>import("./EventRecipesPage.js"),__vite__mapDeps([40,1,2,32,39,29,22,13,3,23,24,8,9,4,5,41])),i),Y.addRoute("/dashboard/eventEdit/products/:id",()=>X(()=>import("./EventProductsPage.js"),__vite__mapDeps([42,1,2,29,15,7,31,13,3,39,32,9,43])),i),Y.addRoute("/dashboard/eventPosters/:id",()=>X(()=>import("./EventPosterPage.js"),__vite__mapDeps([44,1,2,38,3,19,9,45])),i),Y.addRoute("/dashboard/materiel",()=>X(()=>import("./MaterielPage.js"),__vite__mapDeps([46,1,2,29,7,6,3,9])),i),Y.addRoute("/dashboard/materiel/:teamId",()=>X(()=>import("./MaterielPage.js"),__vite__mapDeps([46,1,2,29,7,6,3,9])),i),Y.addRoute("/dashboard/loans",()=>X(()=>import("./LoansPage.js"),__vite__mapDeps([47,1,2,4,5,15,7,29])),i),Y.addRoute("/dashboard/loans/:teamId",()=>X(()=>import("./LoansPage.js"),__vite__mapDeps([47,1,2,4,5,15,7,29])),i),Y.addRoute("/dashboard/loans/return/:loanId",()=>X(()=>import("./LoanReturnPage.js"),__vite__mapDeps([48,1,2,29])),i),Y.addRoute("/eventList",()=>X(()=>import("./EventListPage.js"),__vite__mapDeps([49,1,2,32,13])),i),Y.addRoute("/createdocument/:teamId/new",()=>X(()=>import("./CreateDocumentPage.js"),__vite__mapDeps([50,1,2,51,14,52,15,7,53])),i),Y.addRoute("/editdocument/:teamId/:docId",()=>X(()=>import("./EditDocumentPage.js"),__vite__mapDeps([54,1,2,51,14,52,15,7,17,23,24,55])),i),Y.addRoute("/documents/:teamId",()=>X(()=>import("./DocumentListPage.js"),__vite__mapDeps([56,1,2,33,29,9,3,7])),i);let s=F(null);async function d(){try{if(l(t,"BOOTING"),await E.initializeAuth(),E.isAuthenticated){l(t,"LOADING_PRIVATE_CACHE");const T=qe.loading("Chargement des donn√©es...");await Promise.all([mt.loadCache(),Ge.loadCache(),wt.loadCache(),yt.loadCache(),Et.loadCache()]),l(t,"READY_WITH_CACHE"),qe.update(T,{state:"loading",message:"Mise √† jour des donn√©es en cours..."}),Promise.all([mt.syncFromRemote(),Ge.syncFromRemote(),wt.syncFromRemote(),Ye.syncFromRemote(),yt.syncFromRemote(),Et.syncFromRemote()]).then(async()=>{await Promise.all([mt.setupRealtime(),Ge.setupRealtime(),wt.setupRealtime(),Ye.setupRealtime(),yt.setupRealtime(),Et.setupRealtime()]),await Ve.initialize(),l(t,"READY_FULLY_SYNCED"),qe.dismiss(T),setTimeout(()=>{kt("/dashboard"),kt("/recipe")},3e3)}).catch(B=>{console.error("[App] Erreur synchro distante:",B),qe.update(T,{state:"warning",message:"Mode hors ligne : donn√©es mises en cache",autoCloseDelay:5e3}),Ve.initialize().catch(console.error)})}else l(t,"LOADING_PUBLIC_CACHE"),await Ge.loadCache(),l(t,"READY_WITH_CACHE"),Promise.all([Ge.syncFromRemotePublicOnly(),Ve.initialize()]).then(()=>{l(t,"READY_FULLY_SYNCED"),setTimeout(()=>{kt("/recipe")},2e3)}).catch(T=>{console.error("[App] Erreur synchro recettes:",T)})}catch(T){console.error("[App] Erreur fatale d'initialisation:",T),l(r,T.message||"Erreur critique de chargement",!0),l(t,"ERROR")}}let v=F("");dt(()=>{const T=Y.path,B=o(t);(B==="READY_WITH_CACHE"||B==="READY_FULLY_SYNCED"||B==="READY")&&Y.match().then(async J=>{l(s,J,!0),T!==o(v)&&(l(v,T,!0),await Ba(),requestAnimationFrame(()=>{requestAnimationFrame(()=>{window.scrollTo({top:0,behavior:"smooth"})})}))})});let m=F(!1),f=F(!1);dt(()=>{const T=E.isAuthenticated;o(f)||o(t)!=="BOOTING"&&o(t)!=="LOADING_PRIVATE_CACHE"&&o(t)!=="LOADING_PUBLIC_CACHE"&&T!==o(m)&&(l(m,T,!0),console.log("[App] Changement d'√©tat Auth d√©tect√© -> Rechargement"),l(f,!0),d().finally(()=>{l(f,!1)}))}),Pa(()=>{d()}),Na(()=>{console.log("[App] Destruction de l'application - Nettoyage des stores..."),yt.destroy(),Ye.destroy(),mt.destroy(),Ge.destroy(),wt.destroy(),Et.destroy(),Ve.destroy()});let b=me(()=>o(r)||Pt.error);async function M(){E.authModal.isOpen=!1,await E.refreshAuthAfterLogin()}var w=Hs(),V=h(H(w),6);Or(V,{});var N=h(V,2),ne=c(N);{var D=T=>{const B=me(()=>o(s).component);var J=de(),ce=H(J);za(ce,()=>o(B),(Se,ae)=>{ae(Se,{get params(){return o(s).params},get query(){return o(s).query}})}),u(T,J)},_=T=>{var B=de(),J=H(B);{var ce=ae=>{var pe=qs(),Te=c(pe);{let x=me(()=>o(b)||"Erreur inconnue");Kt(Te,{get message(){return o(x)}})}u(ae,pe)},Se=ae=>{var pe=Ys(),Te=h(c(pe),2),x=c(Te);{var C=$=>{var Z=at("D√©marrage...");u($,Z)},A=$=>{var Z=de(),I=H(Z);{var R=W=>{var ee=at("Chargement des donn√©es en cache...");u(W,ee)},L=W=>{var ee=de(),j=H(ee);{var k=q=>{var ge=at("Pr√©paration de la cuisine...");u(q,ge)};y(j,q=>{o(t)==="LOADING_PUBLIC_CACHE"&&q(k)},!0)}u(W,ee)};y(I,W=>{o(t)==="LOADING_PRIVATE_CACHE"?W(R):W(L,!1)},!0)}u($,Z)};y(x,$=>{o(t)==="BOOTING"?$(C):$(A,!1)})}u(ae,pe)};y(J,ae=>{o(t)==="ERROR"?ae(ce):ae(Se,!1)},!0)}u(T,B)};y(ne,T=>{(o(t)==="READY_WITH_CACHE"||o(t)==="READY_FULLY_SYNCED"||o(t)==="READY")&&o(s)?T(D):T(_,!1)})}var g=h(N,2);Vr(g,{});var S=h(g,2);Kr(S,{});var O=h(S,2);{var P=T=>{var B=Us(),J=H(B);{var ce=ae=>{Kt(ae,{get message(){return o(b)}})};y(J,ae=>{o(b)&&ae(ce)})}var Se=h(J,2);Qr(Se,{}),u(T,B)};y(O,T=>{E.isAuthenticated&&o(t)==="READY"&&T(P)})}var be=h(O,2);Ls(be,{onAuth_success:M,get isOpen(){return E.authModal.isOpen},set isOpen(T){E.authModal.isOpen=T}}),u(n,w),Ae()}Fa(Gs,{target:document.getElementById("app")});export{as as M,ls as a,ds as b,vs as c,Js as d,Bt as e,Hr as f,Zs as g,Xs as h,eo as i,wt as m,le as n,to as s,Et as t};
