const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/RecipesListPage.js","assets/vendor.js","assets/editor.js","assets/markdown.js","assets/vendor.css","assets/appwrite.js","assets/icons.js","assets/Fieldset.js","assets/AutocompleteInput.js","assets/keyboardNavigation.svelte.js","assets/BadgeList.js","assets/CheckboxBadge.js","assets/RecipeRegimeBadges.js","assets/LeftPanel.js","assets/RecipeDataStore.svelte.js","assets/RecipeCreatePage.js","assets/RecipeEditPage2.js","assets/products-display.js","assets/BtnGroupCheck.js","assets/RecipeEditPage.css","assets/UnsavedChangesGuard.js","assets/RecipeEditPage.js","assets/ConfirmModal.js","assets/RecipeVariants.js","assets/RecipeDetailPage.js","assets/RecipePreparation.js","assets/AcceptInvite.js","assets/ResetPassword.js","assets/ResetPassword.css","assets/DashboardPage.js","assets/date-helpers.js","assets/CreateTeamModal.js","assets/InfoCollapse.js","assets/event-stats-helpers.js","assets/DocCard.js","assets/TeamsManagement.js","assets/EventCreatePage.js","assets/EventMealCard.js","assets/EventEditPage.js","assets/EventInvitationAlert.js","assets/EventStats.js","assets/EventRecipesPage.js","assets/EventRecipesPage.css","assets/EventProductsPage.js","assets/EventProductsPage.css","assets/EventPosterPage.js","assets/EventPosterPage.css","assets/MaterielPage.js","assets/LoansPage.js","assets/LoanReturnPage.js","assets/EventListPage.js","assets/CreateDocumentPage.js","assets/MarkdownEditorAdvanced.js","assets/MarkdownEditorAdvanced.css","assets/CreateDocumentPage.css","assets/EditDocumentPage.js","assets/EditDocumentPage.css","assets/DocumentListPage.js"])))=>i.map(i=>d[i]);
var da=Object.defineProperty;var Vt=l=>{throw TypeError(l)};var ua=(l,e,t)=>e in l?da(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var ze=(l,e,t)=>ua(l,typeof e!="symbol"?e+"":e,t),Lt=(l,e,t)=>e.has(l)||Vt("Cannot "+t);var a=(l,e,t)=>(Lt(l,e,"read from private field"),t?t.call(l):e.get(l)),B=(l,e,t)=>e.has(l)?Vt("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(l):e.set(l,t),Ie=(l,e,t,r)=>(Lt(l,e,"write to private field"),r?r.call(l,t):e.set(l,t),t),q=(l,e,t)=>(Lt(l,e,"access private method"),t);import{s as P,g as o,a as n,S as At,u as he,W as _,B as h,A as c,X as U,Y as ve,v as u,p as va,Z as Ne,x as Ae,o as et,_ as Pe,z as It,w as xe,j as ye,b as ct,E as $,$ as y,q as $e,a0 as Ct,a1 as Je,D as le,a2 as tt,a3 as kt,G as ha,a4 as ma,a5 as fa,a6 as _a,a7 as ba,a8 as pa,a9 as ga,aa as ya,ab as wa,ac as Ea,ad as Sa}from"./vendor.js";import{g as qt,r as Ye,a as S,e as ht,n as Ue,p as Pt,t as De,b as Et,Q as dt,l as Yt,c as $t,d as Aa,f as xa,h as Ta,u as pt,i as Ra,j as Ma,k as Ia,m as Da,o as La,q as Ca,s as Oa,v as ka,w as Pa,x as j,y as ce,z as He,_ as J,A as Ot}from"./appwrite.js";import{X as Jt,C as Na,a as Ba,L as Ut,b as za,U as ja,P as Fa,B as Va,R as qa,c as Ya,d as $a,e as Ua,f as Ha,A as Ga,g as Wa,h as Ht}from"./icons.js";import"./editor.js";import"./markdown.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var We,at,rt,St;class Ka{constructor(){B(this,rt);B(this,We,P(!1));B(this,at,!1)}async loadCache(){o(a(this,We))||(n(a(this,We),!0),console.log("[NotificationStore] Cache charg√© : 0 notifications (pas de cache)"))}async syncFromRemote(){console.log("[NotificationStore] Sync : pas de donn√©es √† charger")}async setupRealtime(){if(a(this,at)){console.log("[NotificationStore] D√©j√† configur√©, skip.");return}try{console.log("[NotificationStore] Configuration du realtime...");const e=qt();Ye.register([`databases.${e}.collections.user_notifications.documents`],async t=>{const r=t.payload,i=S.currentMainId;if(!(r.userId!=="broadcast"&&r.userId!==S.userId)&&t.events.some(s=>s.includes(".create"))){if(r.notificationType==="event_access_granted"&&r.targetCollection==="main")console.log("[NotificationStore] üîî Event access granted:",r.targetDocumentId),await ht.reload(),await q(this,rt,St).call(this,r.$id);else if(r.notificationType==="team_access_granted")console.log("[NotificationStore] üîî Team access granted:",r.targetDocumentId),await Ue.reload(),await q(this,rt,St).call(this,r.$id);else if(r.notificationType==="batch_products_update"){const s=r.targetDocumentId;i===s&&(console.log("[NotificationStore] üîî Batch data update for current event:",s),await Pt.syncFromAppwrite(),Pt.clearSyncStatus(),console.log("[NotificationStore] ‚úÖ Sync status cleared for batch update"),r.from?r.from===S.userId?console.log("[NotificationStore] Batch update from current user - no toast"):r.from==="system"?De.info("Produits mis a jour",{source:"system"}):De.info("Les produits ont √©t√© modifi√©s par un¬∑e autre utilisateur¬∑ices",{source:"realtime-other"}):console.warn("[NotificationStore] Legacy notification without 'from' field - ignoring")),await q(this,rt,St).call(this,r.$id)}}}),n(a(this,We),!0),Ie(this,at,!0),console.log("[NotificationStore] ‚úÖ Notifications de d√©couverte configur√©es (RealtimeManager)")}catch(e){throw console.error("[NotificationStore] Erreur lors de la configuration du realtime:",e),e}}async initialize(){await this.loadCache(),await this.syncFromRemote(),await this.setupRealtime()}destroy(){n(a(this,We),!1),Ie(this,at,!1),console.log("[NotificationStore] Store d√©truit")}}We=new WeakMap,at=new WeakMap,rt=new WeakSet,St=async function(e){try{const t=await Et(),r=qt();await t.tables.deleteRow({databaseId:r,tableId:"user_notifications",rowId:e}),console.log(`[NotificationStore] Notification supprim√©e: ${e}`)}catch(t){console.error("[NotificationStore] Erreur lors de la suppression de la notification:",t)}};const gt=new Ka;class Qa{constructor(){ze(this,"dbName","materiel-cache");ze(this,"db",null);ze(this,"version",1);ze(this,"MATERIELS_STORE","materiels");ze(this,"LOANS_STORE","loans");ze(this,"METADATA_STORE","metadata");ze(this,"LAST_SYNC_MATERIEL_KEY","lastSyncMateriel");ze(this,"LAST_SYNC_LOANS_KEY","lastSyncLoans")}async open(){if(this.db)return;const e=()=>new Promise((d,v)=>{const m=indexedDB.open(this.dbName,this.version);m.onerror=()=>v(m.error),m.onsuccess=()=>d(m.result),m.onupgradeneeded=b=>{const w=b.target.result;w.objectStoreNames.contains(this.MATERIELS_STORE)||(w.createObjectStore(this.MATERIELS_STORE,{keyPath:"$id"}),console.log("[MaterielIDBCache] Object store 'materiels' cr√©√©")),w.objectStoreNames.contains(this.LOANS_STORE)||(w.createObjectStore(this.LOANS_STORE,{keyPath:"$id"}),console.log("[MaterielIDBCache] Object store 'loans' cr√©√©")),w.objectStoreNames.contains(this.METADATA_STORE)||(w.createObjectStore(this.METADATA_STORE,{keyPath:"key"}),console.log("[MaterielIDBCache] Object store 'metadata' cr√©√©"))}});let t=await e();const r=t.objectStoreNames.contains(this.MATERIELS_STORE),i=t.objectStoreNames.contains(this.LOANS_STORE),s=t.objectStoreNames.contains(this.METADATA_STORE);(!r||!i||!s)&&(console.warn(`[MaterielIDBCache] Base incompl√®te d√©tect√©e (materiels=${r}, loans=${i}, metadata=${s}), suppression et recr√©ation...`),t.close(),await new Promise((d,v)=>{const m=indexedDB.deleteDatabase(this.dbName);m.onsuccess=()=>d(),m.onerror=()=>v(m.error),m.onblocked=()=>{console.warn("[MaterielIDBCache] Suppression bloqu√©e, r√©essai...")}}),t=await e()),this.db=t,console.log(`[MaterielIDBCache] Base ouverte: ${this.dbName}`)}async loadMateriels(){if(!this.db)throw new Error("DB non ouverte");return new Promise((e,t)=>{const s=this.db.transaction(this.MATERIELS_STORE,"readonly").objectStore(this.MATERIELS_STORE).getAll();s.onsuccess=()=>{const d=new Map;s.result.forEach(v=>{d.set(v.$id,v)}),console.log(`[MaterielIDBCache] ${d.size} mat√©riels charg√©s`),e(d)},s.onerror=()=>t(s.error)})}async saveMateriels(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((t,r)=>{const i=this.db.transaction(this.MATERIELS_STORE,"readwrite"),s=i.objectStore(this.MATERIELS_STORE);s.clear(),e.forEach(d=>{s.put(d)}),i.oncomplete=()=>{console.log(`[MaterielIDBCache] ${e.size} mat√©riels sauvegard√©s`),t()},i.onerror=()=>r(i.error)})}async upsertMateriel(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((t,r)=>{const d=this.db.transaction(this.MATERIELS_STORE,"readwrite").objectStore(this.MATERIELS_STORE).put(e);d.onsuccess=()=>{console.log(`[MaterielIDBCache] Mat√©riel ${e.$id} sauvegard√©`),t()},d.onerror=()=>r(d.error)})}async deleteMateriel(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((t,r)=>{const d=this.db.transaction(this.MATERIELS_STORE,"readwrite").objectStore(this.MATERIELS_STORE).delete(e);d.onsuccess=()=>{console.log(`[MaterielIDBCache] Mat√©riel ${e} supprim√©`),t()},d.onerror=()=>r(d.error)})}async loadLoans(){if(!this.db)throw new Error("DB non ouverte");return new Promise((e,t)=>{const s=this.db.transaction(this.LOANS_STORE,"readonly").objectStore(this.LOANS_STORE).getAll();s.onsuccess=()=>{const d=new Map;s.result.forEach(v=>{d.set(v.$id,v)}),console.log(`[MaterielIDBCache] ${d.size} emprunts charg√©s`),e(d)},s.onerror=()=>t(s.error)})}async saveLoans(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((t,r)=>{const i=this.db.transaction(this.LOANS_STORE,"readwrite"),s=i.objectStore(this.LOANS_STORE);s.clear(),e.forEach(d=>{s.put(d)}),i.oncomplete=()=>{console.log(`[MaterielIDBCache] ${e.size} emprunts sauvegard√©s`),t()},i.onerror=()=>r(i.error)})}async upsertLoan(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((t,r)=>{const d=this.db.transaction(this.LOANS_STORE,"readwrite").objectStore(this.LOANS_STORE).put(e);d.onsuccess=()=>{console.log(`[MaterielIDBCache] Emprunt ${e.$id} sauvegard√©`),t()},d.onerror=()=>r(d.error)})}async deleteLoan(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((t,r)=>{const d=this.db.transaction(this.LOANS_STORE,"readwrite").objectStore(this.LOANS_STORE).delete(e);d.onsuccess=()=>{console.log(`[MaterielIDBCache] Emprunt ${e} supprim√©`),t()},d.onerror=()=>r(d.error)})}async loadMetadata(){if(!this.db)throw new Error("DB non ouverte");return new Promise((e,t)=>{const s=this.db.transaction(this.METADATA_STORE,"readonly").objectStore(this.METADATA_STORE).getAll();s.onsuccess=()=>{const d=s.result,v={lastSyncMateriel:null,lastSyncLoans:null};d.forEach(m=>{m.key===this.LAST_SYNC_MATERIEL_KEY&&(v.lastSyncMateriel=m.value),m.key===this.LAST_SYNC_LOANS_KEY&&(v.lastSyncLoans=m.value)}),console.log(`[MaterielIDBCache] Metadata charg√©es: lastSyncMateriel=${v.lastSyncMateriel}, lastSyncLoans=${v.lastSyncLoans}`),e(v)},s.onerror=()=>t(s.error)})}async saveMetadata(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((t,r)=>{const i=this.db.transaction(this.METADATA_STORE,"readwrite"),s=i.objectStore(this.METADATA_STORE);s.put({key:this.LAST_SYNC_MATERIEL_KEY,value:e.lastSyncMateriel}),s.put({key:this.LAST_SYNC_LOANS_KEY,value:e.lastSyncLoans}),i.oncomplete=()=>{console.log("[MaterielIDBCache] Metadata sauvegard√©es"),t()},i.onerror=()=>r(i.error)})}async clear(){if(!this.db)throw new Error("DB non ouverte");return new Promise((e,t)=>{const r=this.db.transaction([this.MATERIELS_STORE,this.LOANS_STORE,this.METADATA_STORE],"readwrite");r.objectStore(this.MATERIELS_STORE).clear(),r.objectStore(this.LOANS_STORE).clear(),r.objectStore(this.METADATA_STORE).clear(),r.oncomplete=()=>{console.log("[MaterielIDBCache] Cache vid√©"),e()},r.onerror=()=>t(r.error)})}close(){this.db&&(this.db.close(),this.db=null,console.log("[MaterielIDBCache] Connexion ferm√©e"))}}async function Ja(){const l=new Qa;return await l.open(),l}function Nt(l){const e={electronic:{label:"√âlectronique",badgeClass:"badge-warning",textColor:"text-warning",bgColor:"bg-warning/10"},manual:{label:"Manuel",badgeClass:"badge-info",textColor:"text-info",bgColor:"bg-info/10"},tools:{label:"Outils",badgeClass:"badge-secondary",textColor:"text-secondary",bgColor:"bg-secondary/10"},dish:{label:"Vaisselle",badgeClass:"badge-primary",textColor:"text-primary",bgColor:"bg-primary/10"},cooking:{label:"Cuisine",badgeClass:"badge-success",textColor:"text-success",bgColor:"bg-success/10"},gaz:{label:"Gaz",badgeClass:"badge-error",textColor:"text-error",bgColor:"bg-error/10"},hygiene:{label:"Hygi√®ne",badgeClass:"badge-info",textColor:"text-info",bgColor:"bg-info/10"},other:{label:"Autre",badgeClass:"badge-neutral",textColor:"text-neutral",bgColor:"bg-neutral/10"}};return e[l||"other"]||e.other}function Ws(l){return Nt(l).badgeClass}function Ks(l){return Nt(l).textColor}function Qs(l){return Nt(l).bgColor}function Js(l){return{ok:"OK",lost:"Perdu",torepair:"√Ä r√©parer"}[l||"ok"]||l||"OK"}const Gt={userName:"",userId:"",teamName:"",teamId:""};function Xa(l){if(!l)return Gt;try{return typeof l=="string"?JSON.parse(l):l}catch(e){return console.error("[materiel.utils] Error parsing owner from Appwrite:",l,e),Gt}}function Bt(l){if(!l)return[];try{return Array.isArray(l)?l.map(e=>{try{return JSON.parse(e)}catch{return console.warn("[materiel.utils] Failed to parse loan item string:",e),null}}).filter(e=>e!==null):typeof l=="string"?JSON.parse(l):[]}catch(e){return console.error("[materiel.utils] Error parsing loan items from Appwrite:",l,e),[]}}function Za(l){return Bt(l)}function ut(l){return{...l,materielItems:Za(l.materiels)}}function Xt(l,e,t=new Date){const r=Xa(l.owner),i=[];let s=0;e.forEach(b=>{const L=Bt(b.materiels).filter(g=>g.materielId===l.$id);if(L.length===0)return;const A=new Date(b.startDate),F=new Date(b.endDate),z=A<=t&&F>=t,de=A>t,O=["accepted","asked"].includes(b.status);(z||de)&&O&&L.forEach(g=>{i.push({loanId:b.$id,responsibleName:b.responsibleName||"",startDate:b.startDate,endDate:b.endDate,quantity:g.quantity,status:b.status})}),z&&O&&L.forEach(g=>{s+=g.quantity})});const v=i.some(b=>{const w=new Date(b.startDate),L=new Date(b.endDate);return w<=t&&L>=t})?"loan":l.status,m=l.quantity-s;return{...l,status:v,ownerData:r,loanDetails:i,availableQuantity:m,totalLoanedQuantity:s,isAvailable:m>0,isFullyLoaned:m===0}}function er(l,e){const t={...l};return Xt(t,e)}function tr(l){return["asked","accepted"].includes(l.status)}function ar(l,e,t,r){return l<=r&&e>=t}function rr(l,e,t,r){let i=0;return e.forEach(s=>{if(!tr(s))return;const d=new Date(s.startDate),v=new Date(s.endDate);if(!ar(d,v,t,r))return;const b=Bt(s.materiels).filter(w=>w.materielId===l);i+=b.reduce((w,L)=>w+L.quantity,0)}),i}var ee,ie,K,te,Z,Ke,mt,st,Oe,ke,xt,je,Tt,Rt,Mt,ft,Q,Zt,ea,ta,aa,ra,sa,Xe,Ze;class sr{constructor(){B(this,Q);B(this,ee,new At);B(this,ie,new At);B(this,K,null);B(this,te,P(!1));B(this,Z,P(null));B(this,Ke,P(!1));B(this,mt,P(!1));B(this,st,!1);B(this,Oe,P(null));B(this,ke,P(null));B(this,xt,null);B(this,je,he(()=>Array.from(a(this,ee).values())));B(this,Tt,he(()=>Array.from(a(this,ie).values())));B(this,Rt,he(()=>{if(!S.userId)return[];const e=Ue.myTeams.map(t=>t.$id);return o(a(this,je)).filter(t=>t.ownerData?.teamId&&e.includes(t.ownerData.teamId))}));B(this,Mt,he(()=>{if(!S.userId)return[];const e=Ue.myTeams.map(t=>t.$id);return o(a(this,je)).filter(t=>t.shareableWith?.some(i=>e.includes(i))&&!(t.ownerData?.teamId&&e.includes(t.ownerData.teamId)))}));B(this,ft,he(()=>o(a(this,je)).filter(e=>e.isAvailable)))}get loading(){return o(a(this,te))}get error(){return o(a(this,Z))}get isInitialized(){return o(a(this,Ke))}get isRealtimeActive(){return o(a(this,mt))}get count(){return a(this,ee).size}get materiels(){return o(a(this,je))}get loans(){return o(a(this,Tt))}get teamMateriels(){return o(a(this,Rt))}get shareableMateriels(){return o(a(this,Mt))}get availableMateriels(){return o(a(this,ft))}getAvailableMaterielsByOwner(e){return o(a(this,ft)).filter(t=>t.ownerData?.teamId===e&&t.status!=="lost"&&t.status!=="torepair")}getMaterielsByOwner(e){return o(a(this,je)).filter(t=>t.ownerData?.teamId===e)}getAvailableMaterielsForPeriod(e,t,r){const i=new Date(t),s=new Date(r),d=Array.from(a(this,ie).values());return o(a(this,je)).filter(v=>v.ownerData?.teamId===e).filter(v=>v.status!=="lost"&&v.status!=="torepair").map(v=>{const m=rr(v.$id,d,i,s),b=v.quantity-m;return{...v,availableForPeriod:b}}).filter(v=>v.availableForPeriod>0)}async loadCache(){if(!o(a(this,Ke))){n(a(this,te),!0),n(a(this,Z),null);try{if(!S.userId){n(a(this,Ke),!0);return}Ie(this,K,await Ja()),await q(this,Q,Zt).call(this),n(a(this,Ke),!0),console.log(`[MaterielStore] Cache charg√© : ${a(this,ee).size} mat√©riels, ${a(this,ie).size} emprunts`)}catch(e){throw n(a(this,Z),e instanceof Error?e.message:"Erreur de chargement du cache",!0),console.error("[MaterielStore] LoadCache error:",e),e}finally{n(a(this,te),!1)}}}async syncFromRemote(){n(a(this,te),!0),n(a(this,Z),null);try{if(!S.userId)return;await q(this,Q,ea).call(this),console.log(`[MaterielStore] Sync termin√© : ${a(this,ee).size} mat√©riels, ${a(this,ie).size} emprunts`)}catch(e){throw n(a(this,Z),e instanceof Error?e.message:"Erreur de synchronisation",!0),console.error("[MaterielStore] SyncFromRemote error:",e),e}finally{n(a(this,te),!1)}}async setupRealtime(){if(S.userId){if(a(this,st)){console.log("[MaterielStore] Realtime d√©j√† configur√©");return}try{await q(this,Q,aa).call(this),n(a(this,mt),!0),Ie(this,st,!0),console.log("[MaterielStore] Realtime configur√©")}catch(e){throw n(a(this,Z),e instanceof Error?e.message:"Erreur de configuration realtime",!0),console.error("[MaterielStore] SetupRealtime error:",e),e}}}async initialize(){await this.loadCache(),await this.syncFromRemote(),await this.setupRealtime()}getMaterielById(e){return a(this,ee).get(e)}getLoanById(e){return a(this,ie).get(e)}async createMateriel(e){n(a(this,te),!0),n(a(this,Z),null);try{if(!S.userId)throw new Error("Utilisateur non connect√©");const t=await Ta(e,S.userId),r=q(this,Q,Xe).call(this,t);return a(this,ee).set(t.$id,r),a(this,K)?.upsertMateriel(r),r}catch(t){throw n(a(this,Z),t instanceof Error?t.message:"Erreur de cr√©ation",!0),t}finally{n(a(this,te),!1)}}async updateMateriel(e,t){n(a(this,te),!0),n(a(this,Z),null);try{const r=await pt(e,t),i=q(this,Q,Xe).call(this,r);a(this,ee).set(r.$id,i),a(this,K)?.upsertMateriel(i)}catch(r){throw n(a(this,Z),r instanceof Error?r.message:"Erreur de mise √† jour",!0),r}finally{n(a(this,te),!1)}}async deleteMateriel(e){n(a(this,te),!0),n(a(this,Z),null);try{await Ra(e),a(this,ee).delete(e),a(this,K)?.deleteMateriel(e)}catch(t){throw n(a(this,Z),t instanceof Error?t.message:"Erreur de suppression",!0),t}finally{n(a(this,te),!1)}}async createLoan(e){n(a(this,te),!0),n(a(this,Z),null);try{if(!S.userId)throw new Error("Utilisateur non connect√©");const t=await Ma(e,S.userId);return ut(t)}catch(t){throw n(a(this,Z),t instanceof Error?t.message:"Erreur de cr√©ation",!0),t}finally{n(a(this,te),!1)}}async updateLoan(e,t){n(a(this,te),!0),n(a(this,Z),null);try{await Ia(e,t)}catch(r){throw n(a(this,Z),r instanceof Error?r.message:"Erreur de mise √† jour",!0),r}finally{n(a(this,te),!1)}}async acceptLoan(e){await this.updateLoan(e,{status:"accepted"})}async refuseLoan(e){await this.updateLoan(e,{status:"refused"})}async cancelLoan(e){await this.updateLoan(e,{status:"canceled"})}async completeLoanWithReturn(e,t){for(const r of t.materiels){const i=r.lostQuantity||0,s=r.brokenQuantity||0;i+s>=r.quantity?await pt(r.materielId,{status:"lost"}):s>0?await pt(r.materielId,{status:"torepair"}):await pt(r.materielId,{status:"ok"})}await this.updateLoan(e,{status:"completed",returnedAt:new Date().toISOString(),returnNotes:t.returnNotes,materiels:t.materiels})}async completeLoan(e){await this.updateLoan(e,{status:"completed",returnedAt:new Date().toISOString()})}async deleteLoan(e){n(a(this,te),!0),n(a(this,Z),null);try{const t=a(this,ie).get(e);t&&q(this,Q,Ze).call(this,t),await Da(e)}catch(t){throw n(a(this,Z),t instanceof Error?t.message:"Erreur de suppression",!0),t}finally{n(a(this,te),!1)}}async hardReset(){console.log("[MaterielStore] üîÑ HARD RESET - Vidage complet..."),n(a(this,te),!0),n(a(this,Z),null);try{if(a(this,ee).clear(),a(this,ie).clear(),a(this,K)&&(await a(this,K).clear(),console.log("[MaterielStore] Cache IDB vid√©")),await q(this,Q,ta).call(this),a(this,K)){for(const[,e]of a(this,ee))await a(this,K).upsertMateriel(e);for(const[,e]of a(this,ie))await a(this,K).upsertLoan(e);await a(this,K).saveMetadata({lastSyncMateriel:o(a(this,Oe)),lastSyncLoans:o(a(this,ke))}),console.log("[MaterielStore] Cache IDB recr√©√©")}console.log("[MaterielStore] ‚úì HARD RESET termin√©")}catch(e){const t=e instanceof Error?e.message:"Erreur lors du hard reset";throw n(a(this,Z),t,!0),console.error("[MaterielStore] Erreur hard reset:",e),e}finally{n(a(this,te),!1)}}destroy(){var e;(e=a(this,xt))==null||e.call(this),a(this,ee).clear(),a(this,ie).clear(),Ie(this,K,null),Ie(this,st,!1)}}ee=new WeakMap,ie=new WeakMap,K=new WeakMap,te=new WeakMap,Z=new WeakMap,Ke=new WeakMap,mt=new WeakMap,st=new WeakMap,Oe=new WeakMap,ke=new WeakMap,xt=new WeakMap,je=new WeakMap,Tt=new WeakMap,Rt=new WeakMap,Mt=new WeakMap,ft=new WeakMap,Q=new WeakSet,Zt=async function(){if(a(this,K))try{(await a(this,K).loadMateriels()).forEach(i=>{a(this,ee).set(i.$id,i)}),(await a(this,K).loadLoans()).forEach(i=>{const s=ut(i);a(this,ie).set(i.$id,s)});const r=await a(this,K).loadMetadata();n(a(this,Oe),r.lastSyncMateriel,!0),n(a(this,ke),r.lastSyncLoans,!0),console.log(`[MaterielStore] ${a(this,ee).size} mat√©riels et ${a(this,ie).size} emprunts charg√©s du cache IDB`)}catch(e){console.warn("[MaterielStore] Erreur lecture cache IDB, ignor√©:",e)}},ea=async function(){try{const e=o(a(this,Oe))?[dt.greaterThan("$updatedAt",o(a(this,Oe)))]:[],t=await Yt(e);for(const s of t){const d=q(this,Q,Xe).call(this,s);a(this,ee).set(s.$id,d),a(this,K)?.upsertMateriel(d)}n(a(this,Oe),new Date().toISOString(),!0);const r=o(a(this,ke))?[dt.greaterThan("$updatedAt",o(a(this,ke))),dt.limit(100)]:[],i=await $t(r);for(const s of i){const d=ut(s);a(this,ie).set(s.$id,d),a(this,K)?.upsertLoan(s),q(this,Q,Ze).call(this,d)}n(a(this,ke),new Date().toISOString(),!0),await a(this,K)?.saveMetadata({lastSyncMateriel:o(a(this,Oe)),lastSyncLoans:o(a(this,ke))}),console.log("[MaterielStore] Sync termin√©")}catch(e){throw console.error("[MaterielStore] Erreur sync:",e),e}},ta=async function(){try{console.log("[MaterielStore] Chargement complet depuis Appwrite...");const e=await Yt([dt.limit(1e3)]);for(const i of e){const s=q(this,Q,Xe).call(this,i);a(this,ee).set(i.$id,s)}const t=await $t([dt.limit(1e3)]),r=[];for(const i of t){const s=ut(i);a(this,ie).set(i.$id,s),r.push(s)}for(const i of r)q(this,Q,Ze).call(this,i);n(a(this,Oe),new Date().toISOString(),!0),n(a(this,ke),new Date().toISOString(),!0),console.log(`[MaterielStore] ${e.length} mat√©riels et ${t.length} emprunts charg√©s`)}catch(e){throw console.error("[MaterielStore] Erreur chargement complet:",e),e}},aa=async function(){Ye.register(Aa(),async e=>{await q(this,Q,ra).call(this,e)}),Ye.register(xa(),async e=>{await q(this,Q,sa).call(this,e)})},ra=async function(e){try{const t=e.events,r=e.payload;if(!r){console.warn("[MaterielStore] Realtime Materiel : pas de payload dans la r√©ponse");return}const i=t.some(s=>s.includes(".create"))?"create":t.some(s=>s.includes(".delete"))?"delete":"update";if(console.log(`[MaterielStore] ‚ö°Ô∏è Realtime Materiel RECEIVED: ${i} pour ${r.$id}`),i==="create"||i==="update"){const s=q(this,Q,Xe).call(this,r);a(this,ee).set(r.$id,s),a(this,K)?.upsertMateriel(s)}else i==="delete"&&(a(this,ee).delete(r.$id),a(this,K)?.deleteMateriel(r.$id))}catch(t){console.error("[MaterielStore] Erreur realtime Materiel:",t)}},sa=async function(e){try{const t=e.events,r=e.payload;if(!r){console.warn("[MaterielStore] Realtime Loan : pas de payload dans la r√©ponse");return}const i=t.some(s=>s.includes(".create"))?"create":t.some(s=>s.includes(".delete"))?"delete":"update";if(console.log(`[MaterielStore] ‚ö°Ô∏è Realtime Loan RECEIVED: ${i} pour ${r.$id}`),i==="create"||i==="update"){const s=ut(r);a(this,ie).set(r.$id,s),a(this,K)?.upsertLoan(r),q(this,Q,Ze).call(this,s)}else if(i==="delete"){const s=a(this,ie).get(r.$id);s&&q(this,Q,Ze).call(this,s),a(this,ie).delete(r.$id),a(this,K)?.deleteLoan(r.$id)}}catch(t){console.error("[MaterielStore] Erreur realtime Loan:",t)}},Xe=function(e){const t=Array.from(a(this,ie).values());return Xt(e,t)},Ze=function(e){const t=e.materielItems,r=Array.from(a(this,ie).values());for(const i of t){const s=a(this,ee).get(i.materielId);if(s){const d=er(s,r);a(this,ee).set(i.materielId,d),a(this,K)?.upsertMateriel(d)}}};const yt=new sr;var fe,ot,Ve,Fe,qe,it,nt,_t,Qe,lt,we,oa,ia,Ge;class or{constructor(){B(this,we);B(this,fe,new At);B(this,ot,new At);B(this,Ve,P(!1));B(this,Fe,P(null));B(this,qe,P(!1));B(this,it,P(!1));B(this,nt,!1);B(this,_t,P(null));B(this,Qe,null);B(this,lt,he(()=>Array.from(a(this,fe).values())))}get loading(){return o(a(this,Ve))}get error(){return o(a(this,Fe))}get isInitialized(){return o(a(this,qe))}get isRealtimeActive(){return o(a(this,it))}get count(){return a(this,fe).size}get documents(){return o(a(this,lt))}getTeamDocuments(e){return o(a(this,lt)).filter(t=>t.teamId===e)}getTeamTags(e){return a(this,ot).get(e)||[]}async loadCache(){if(!o(a(this,qe))){n(a(this,Ve),!0),n(a(this,Fe),null);try{if(!S.userId){n(a(this,qe),!0);return}n(a(this,qe),!0),console.log("[TeamdocsStore] Cache charg√© (sans IDB)")}catch(e){throw n(a(this,Fe),e instanceof Error?e.message:"Erreur de chargement du cache",!0),console.error("[TeamdocsStore] LoadCache error:",e),e}finally{n(a(this,Ve),!1)}}}async syncFromRemote(){n(a(this,Ve),!0),n(a(this,Fe),null);try{if(!S.userId)return;const e=await La();for(const t of e)a(this,fe).set(t.$id,t);await q(this,we,Ge).call(this),n(a(this,_t),new Date().toISOString(),!0),console.log(`[TeamdocsStore] Sync termin√© : ${a(this,fe).size} documents`)}catch(e){throw n(a(this,Fe),e instanceof Error?e.message:"Erreur de synchronisation",!0),console.error("[TeamdocsStore] SyncFromRemote error:",e),e}finally{n(a(this,Ve),!1)}}async setupRealtime(){if(S.userId){if(a(this,nt)){console.log("[TeamdocsStore] Realtime d√©j√† configur√©");return}try{await q(this,we,oa).call(this),n(a(this,it),!0),Ie(this,nt,!0),console.log("[TeamdocsStore] Realtime configur√©")}catch(e){throw n(a(this,Fe),e instanceof Error?e.message:"Erreur de configuration realtime",!0),console.error("[TeamdocsStore] SetupRealtime error:",e),e}}}async initialize(){await this.loadCache(),await this.syncFromRemote(),await this.setupRealtime()}async createDocument(e,t){if(!S.userId||!S.userName)throw new Error("Utilisateur non connect√©");const r=await Ca(e,t,S.userId,S.userName);return a(this,fe).set(r.$id,r),await q(this,we,Ge).call(this),console.log(`[TeamdocsStore] Document cr√©√© : ${r.$id}`),r}async updateDocument(e,t){const r=await Oa(e,t);return a(this,fe).set(e,r),t.tags&&await q(this,we,Ge).call(this),console.log(`[TeamdocsStore] Document mis √† jour : ${e}`),r}async deleteDocument(e){await ka(e),a(this,fe).delete(e),await q(this,we,Ge).call(this),console.log(`[TeamdocsStore] Document supprim√© : ${e}`)}getDocumentById(e){return a(this,fe).get(e)}async updateDocumentLock(e,t){if(S.userId)try{await Pa(e,t);const r=a(this,fe).get(e);r&&a(this,fe).set(e,{...r,lockedBy:t}),console.log(`[TeamdocsStore] Verrou ${e} mis √† jour: ${t||"lib√©r√©"}`)}catch(r){throw console.error(`[TeamdocsStore] Erreur verrouillage ${e}:`,r),r}}destroy(){a(this,Qe)&&(a(this,Qe).call(this),Ie(this,Qe,null)),a(this,fe).clear(),a(this,ot).clear(),n(a(this,qe),!1),n(a(this,it),!1),Ie(this,nt,!1),console.log("[TeamdocsStore] Store d√©truit")}async hardReset(){this.destroy(),n(a(this,_t),null),console.log("[TeamdocsStore] Hard reset effectu√©")}}fe=new WeakMap,ot=new WeakMap,Ve=new WeakMap,Fe=new WeakMap,qe=new WeakMap,it=new WeakMap,nt=new WeakMap,_t=new WeakMap,Qe=new WeakMap,lt=new WeakMap,we=new WeakSet,oa=async function(){const e=["databases.*.collections.undefined"];Ye.register(e,async t=>{await q(this,we,ia).call(this,t)}),Ie(this,Qe,()=>{})},ia=async function(e){const{events:t,payload:r}=e,i=t?.[0];if(!i)return;const s=r;switch(i){case"databases.*.collections.*.documents.create":case"databases.*.collections.*.documents.update":s&&(a(this,fe).set(s.$id,s),await q(this,we,Ge).call(this),console.log(`[TeamdocsStore] Document mis √† jour : ${s.$id}`));break;case"databases.*.collections.*.documents.delete":s?.$id&&(a(this,fe).delete(s.$id),await q(this,we,Ge).call(this),console.log(`[TeamdocsStore] Document supprim√© : ${s.$id}`));break}},Ge=async function(){const e=new Map;for(const t of o(a(this,lt))){const r=t.teamId;e.has(r)||e.set(r,new Set),t.tags&&t.tags.forEach(i=>{e.get(r).add(i)})}e.forEach((t,r)=>{a(this,ot).set(r,Array.from(t).sort())}),console.log(`[TeamdocsStore] Tags mis √† jour pour ${e.size} √©quipes`)};const wt=new or;var ir=_('<div class="alert alert-error shadow-lg"><svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l-2-2m0 0l-2-2m2 2l2-2m-2 2l-2 2m8-8l2 2m0 0l2 2m-2-2l-2-2m2 2l2 2"></path></svg> <div><h3 class="font-bold">Erreur</h3> <div class="text-sm"> </div></div></div>');function Wt(l,e){var t=ir(),r=h(c(t),2),i=h(c(r),2),s=c(i);U(()=>ve(s,e.message)),u(l,t)}var _e;class nr{constructor(){B(this,_e,P(va({title:""})))}get title(){return o(a(this,_e)).title||"ENKA Cookbook"}get backAction(){return o(a(this,_e)).backAction}get actions(){return o(a(this,_e)).actions}get tabs(){return o(a(this,_e)).tabs}get eventId(){return o(a(this,_e)).eventId}get activeTab(){return o(a(this,_e)).activeTab||0}get isLockedByOthers(){return o(a(this,_e)).isLockedByOthers||!1}get lockedByUserName(){return o(a(this,_e)).lockedByUserName||""}get hasUnsavedChanges(){return o(a(this,_e)).hasUnsavedChanges||!1}get materielContext(){return o(a(this,_e)).materielContext||null}get teamId(){return o(a(this,_e)).teamId}setConfig(e){n(a(this,_e),{...e},!0)}reset(){n(a(this,_e),{title:""},!0)}}_e=new WeakMap;const ne=new nr;var lr=_("<button> </button>"),cr=_('<div class="rounded-box bg-secondary/10 px-4 py-1"><div class="tabs tabs-border justify-center"></div></div>');function Kt(l,e){Ae(e,!0);const t=[{label:"√âditer l'√©v√©nement",path:"/dashboard/eventEdit"},{label:"Voir les recettes",path:"/dashboard/eventEdit/recipes"},{label:"Listes des produits",path:"/dashboard/eventEdit/products"},{label:"Affiches",path:"/dashboard/eventPosters"}],r=he(()=>{const v=j.path;return v.includes("/eventEdit/recipes/")?1:v.includes("/eventEdit/products/")?2:v.includes("/eventPosters/")?3:(v.includes("/eventEdit/")&&e.eventId&&new RegExp(`/dashboard/eventEdit/${e.eventId}(/?$)`).test(v),0)});function i(v){e.eventId&&(v===1?ce(`/dashboard/eventEdit/recipes/${e.eventId}`):v===2?ce(`/dashboard/eventEdit/products/${e.eventId}`):v===3?ce(`/dashboard/eventPosters/${e.eventId}`):ce(`/dashboard/eventEdit/${e.eventId}`))}var s=cr(),d=c(s);et(d,21,()=>t,It,(v,m,b)=>{var w=lr();w.__click=()=>i(b);var L=c(w);U(()=>{Pe(w,1,`tab font-semibold ${b===o(r)?"tab-active":""}`),ve(L,o(m).label)}),u(v,w)}),u(l,s),xe()}Ne(["click"]);var dr=_("<button> </button>"),ur=_('<div class="tabs tabs-lg tabs-border justify-center"></div>');function Qt(l,e){Ae(e,!0);const t=[{label:"Mat√©riel",getPath:()=>i()},{label:"Reservations",getPath:()=>s()}],r=he(()=>j.path.includes("/loans")?1:0);function i(){if(e.currentTeamId)return`/dashboard/materiel/${e.currentTeamId}`;const m=Ue.myTeams;return m.length>0?`/dashboard/materiel/${m[0].$id}`:"/dashboard/materiel"}function s(){if(e.currentTeamId)return`/dashboard/loans/${e.currentTeamId}`;const m=Ue.myTeams;return m.length>0?`/dashboard/loans/${m[0].$id}`:"/dashboard/loans"}function d(m){const b=t[m].getPath();ce(b)}var v=ur();et(v,21,()=>t,It,(m,b,w)=>{var L=dr();L.__click=()=>d(w);var A=c(L);U(()=>{Pe(L,1,`tab font-medium ${w===o(r)?"tab-active":""}`),ve(A,o(b).label)}),u(m,L)}),u(l,v),xe()}Ne(["click"]);function vr(l,e,t){n(e,!1),t.onClose()}function hr(l,e){n(e,!1)}var mr=_('<div role="dialog" aria-modal="true"><!></div>'),fr=_('<div class="modal modal-open" style="z-index: 1100"><div class="modal-box max-w-md"><h3 class="text-lg font-bold">Confirmer la fermeture</h3> <p class="py-4"> </p> <div class="modal-action"><button class="btn btn-ghost">Annuler</button> <button class="btn btn-error">Fermer sans sauvegarder</button></div></div></div>'),_r=_("<div><!></div> <!>",1);function br(l,e){Ae(e,!0);let t=ye(e,"fullscreenOnMobile",3,!0);ye(e,"closeOnBackdropClick",3,!1);let r=ye(e,"hasUnsavedChanges",3,!1),i=ye(e,"confirmCloseMessage",3,"Vous avez des modifications non sauvegard√©es. Voulez-vous vraiment fermer ?"),s=ye(e,"maxWidth",3,"lg"),d=ye(e,"maxHeight",3,"xl"),v=ye(e,"modalClass",3,"");function m(g,p){return{sm:{"max-w":"max-w-[28rem]","max-h":"max-h-[85vh]"},lg:{"max-w":"max-w-[64rem]","max-h":"max-h-[85vh]"},xl:{"max-w":"max-w-[90vw]","max-h":"max-h-[90vh]"}}[g][p]}let b=P(!1);function w(){r()?n(b,!0):e.onClose()}ct(()=>{if(!e.isOpen)return;const g=p=>{p.key==="Escape"&&!o(b)&&w()};return window.addEventListener("keydown",g),()=>window.removeEventListener("keydown",g)}),ct(()=>{if(e.isOpen)return document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}});var L=_r(),A=$(L),F=c(A);{var z=g=>{var p=mr(),x=c(p);$e(x,()=>e.children),U((k,f)=>Pe(p,1,`modal-box flex flex-col p-0 ${v()??""} ${t()&&S.isMobile?"fixed inset-0 m-0 h-lvh w-lvw rounded-none":"fixed top-10 m-auto"} ${k??""} ${f??""}`),[()=>S.isDesktop&&m(s(),"max-w"),()=>S.isDesktop&&!v()&&m(d(),"max-h")]),u(g,p)};y(F,g=>{e.isOpen&&g(z)})}var de=h(A,2);{var O=g=>{var p=fr(),x=c(p),k=h(c(x),2),f=c(k),V=h(k,2),X=c(V);X.__click=[hr,b];var Y=h(X,2);Y.__click=[vr,b,e],U(()=>ve(f,i())),u(g,p)};y(de,g=>{o(b)&&g(O)})}U(()=>Pe(A,1,`modal ${(e.isOpen&&"modal-open")??""} `)),u(l,L),xe()}Ne(["click"]);var pr=_('<button class="btn btn-circle btn-ghost btn-sm flex-none" aria-label="Retour"><!></button>'),gr=_('<button class="btn btn-circle btn-ghost btn-sm flex-none" aria-label="Retour"><!></button>'),yr=_('<p class="text-base-content/70 truncate text-sm"> </p>'),wr=_('<div class="flex items-center gap-2 sm:me-10"><!></div>'),Er=_('<div class="border-base-300 flex-none border-b px-4 py-3"><div class="absolute top-2 right-2"><!></div> <div class="flex flex-wrap items-center gap-2"><div class="flex min-w-0 flex-1 items-center gap-2"><!> <div class="max-w-11/12 min-w-0 flex-1 items-baseline"><h3 class="truncate text-lg font-bold"> </h3> <!></div></div> <!></div></div>');function Sr(l,e){Ae(e,!0);let t=ye(e,"showBackButton",3,!0);var r=Er(),i=c(r),s=c(i);{var d=p=>{var x=pr();x.__click=function(...f){e.onClose?.apply(this,f)};var k=c(x);Jt(k,{class:"h-5 w-5"}),u(p,x)};y(s,p=>{S.isMobile||p(d)})}var v=h(i,2),m=c(v),b=c(m);{var w=p=>{var x=gr();x.__click=function(...f){e.onClose?.apply(this,f)};var k=c(x);Na(k,{class:"h-5 w-5"}),u(p,x)};y(b,p=>{t()&&S.isMobile&&p(w)})}var L=h(b,2),A=c(L),F=c(A),z=h(A,2);{var de=p=>{var x=yr(),k=c(x);U(()=>ve(k,e.subtitle)),u(p,x)};y(z,p=>{e.subtitle&&p(de)})}var O=h(m,2);{var g=p=>{var x=wr(),k=c(x);$e(k,()=>e.children),u(p,x)};y(O,p=>{e.children&&p(g)})}U(()=>ve(F,e.title)),u(l,r),xe()}Ne(["click"]);var Ar=_('<div class="flex-1 overflow-y-auto p-4 sm:p-6 sm:pt-2"><!></div>');function xr(l,e){var t=Ar(),r=c(t);$e(r,()=>e.children),u(l,t)}var Tr=_('<div class="border-base-300 flex-none border-t px-4 py-3"><div class="flex flex-wrap items-center justify-end gap-2"><!></div></div>');function Rr(l,e){var t=Tr(),r=c(t),i=c(r);$e(i,()=>e.children),u(l,t)}var Mr=_('<div role="alert" class="alert alert-error svelte-o861tn"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 shrink-0 stroke-current" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span> </span></div>'),Ir=_('<div role="alert" class="alert alert-success svelte-o861tn"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 shrink-0 stroke-current" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span> </span></div>'),Dr=(l,e)=>n(e,!1),Lr=_(`<form class="space-y-4 svelte-o861tn"><div class="form-control svelte-o861tn"><label for="forgot-email" class="label"><span class="label-text">Email</span></label> <input id="forgot-email" type="email" class="input input-bordered w-full" placeholder="votre@email.com"/></div> <div class="alert alert-info alert-soft svelte-o861tn">Un email avec un lien vous sera envoy√© par "noreply@appwrite.io".
            Pensez √† v√©rifier s'il n'a pas att√©ri dans votre dossier spam.</div></form> <div class="text-center svelte-o861tn"><button class="btn btn-ghost btn-sm">‚Üê Retour √† la connexion</button></div>`,1),Cr=(l,e)=>n(e,!0),Or=(l,e)=>n(e,!1),kr=_(`<form class="space-y-4 svelte-o861tn"><div class="form-control svelte-o861tn"><label for="login-email" class="label"><span class="label-text">Email</span></label> <input id="login-email" type="email" class="input input-bordered w-full" placeholder="votre@email.com" required/></div> <div class="form-control svelte-o861tn"><label for="login-password" class="label"><span class="label-text">Mot de passe</span></label> <input id="login-password" type="password" class="input input-bordered w-full" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required/></div></form> <div class="space-y-2 text-center svelte-o861tn"><button class="btn btn-link btn-sm btn-primary svelte-o861tn">Mot de passe oubli√© ?</button> <div class="text-base-content/70 text-sm svelte-o861tn">Pas encore de compte ? <button class="btn btn-primary btn-sm btn-soft ms-1">S'inscrire</button></div></div>`,1),Pr=(l,e)=>n(e,!0),Nr=_(`<form class="space-y-4 svelte-o861tn"><div class="form-control svelte-o861tn"><label for="register-name" class="label"><span class="label-text">Nom</span></label> <input id="register-name" type="text" class="input input-bordered w-full" placeholder="Votre nom" required/></div> <div class="form-control svelte-o861tn"><label for="register-email" class="label"><span class="label-text">Email</span></label> <input id="register-email" type="email" class="input input-bordered w-full" placeholder="votre@email.com" required/></div> <div class="form-control svelte-o861tn"><label for="register-password" class="label"><span class="label-text">Mot de passe</span></label> <input id="register-password" type="password" class="input input-bordered w-full" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required/></div> <div class="alert alert-info alert-soft svelte-o861tn">Un email avec un lien vous sera envoy√© par "noreply@appwrite.io".
            Pensez √† v√©rifier s'il n'a pas att√©ri dans votre dossier spam.</div></form> <div class="text-base-content/70 text-center text-sm svelte-o861tn">D√©j√† un compte ? <button class="btn btn-ghost btn-sm text-primary ms-1">Se connecter</button></div>`,1),Br=_('<div class="space-y-4 svelte-o861tn"><!> <!> <!></div>'),zr=_('<span class="loading loading-spinner"></span>'),jr=_('<button type="submit" class="btn btn-primary btn-block"><!></button>'),Fr=_('<span class="loading loading-spinner"></span>'),Vr=_('<button type="submit" class="btn btn-primary btn-block"><!></button>'),qr=_('<span class="loading loading-spinner"></span>'),Yr=_('<button type="submit" class="btn btn-success btn-block"><!></button>'),$r=_("<!> <!> <!>",1);function Ur(l,e){Ae(e,!0);let t=ye(e,"isOpen",15),r=ye(e,"onAuth_success",3,async()=>{}),i=P(!0),s=P(!1),d=P(""),v=P(""),m=P(""),b=P(""),w=P(""),L=P(""),A=P(""),F=P(""),z=P(!1);async function de(k){if(k.preventDefault(),!o(m)||!o(b)){n(d,"Veuillez remplir tous les champs");return}n(s,!0),n(d,"");try{const{account:f}=await Et();await f.createEmailPasswordSession({email:o(m),password:o(b)}),n(v,"Connexion r√©ussie !"),setTimeout(()=>{r()()},1e3)}catch(f){console.error("Erreur de connexion:",f),n(d,f.message||"Erreur lors de la connexion",!0)}finally{n(s,!1)}}async function O(k){if(k.preventDefault(),!o(w)||!o(L)||!o(A)){n(d,"Veuillez remplir tous les champs");return}n(s,!0),n(d,"");try{const{account:f}=await Et();await f.create({userId:"unique()",email:o(L),password:o(A),name:o(w)}),await f.createEmailPasswordSession({email:o(L),password:o(A)}),n(v,"Compte cr√©√© et connect√© !"),setTimeout(()=>{r()()},1e3)}catch(f){console.error("Erreur d'inscription:",f),n(d,f.message||"Erreur lors de la cr√©ation du compte",!0)}finally{n(s,!1)}}async function g(k){if(k.preventDefault(),!o(F)){n(d,"Veuillez entrer votre email");return}n(s,!0),n(d,"");try{const{account:f}=await Et();await f.createRecovery({email:o(F),url:`${window.location.origin}/#/reset-password`}),n(v,"Email de r√©initialisation envoy√© !"),setTimeout(()=>{n(z,!1),n(F,"")},2e3)}catch(f){console.error("Erreur mot de passe oubli√©:",f),n(d,f.message||"Erreur lors de l'envoi de l'email",!0)}finally{n(s,!1)}}function p(){o(s)||t(!1)}ct(()=>{(o(i)||o(z))&&(n(d,""),n(v,""))});function x(){return o(z)?"Mot de passe oubli√©":o(i)?"Connexion":"Inscription"}br(l,{get isOpen(){return t()},onClose:p,maxWidth:"sm",children:(k,f)=>{var V=$r(),X=$(V);{let H=he(x);Sr(X,{get title(){return o(H)},onClose:p})}var Y=h(X,2);xr(Y,{children:(H,Ee)=>{var pe=Br(),ge=c(pe);{var Be=I=>{var T=Mr(),D=h(c(T),2),se=c(D);U(()=>ve(se,o(d))),u(I,T)};y(ge,I=>{o(d)&&I(Be)})}var M=h(ge,2);{var R=I=>{var T=Ir(),D=h(c(T),2),se=c(D);U(()=>ve(se,o(v))),u(I,T)};y(M,I=>{o(v)&&I(R)})}var E=h(M,2);{var G=I=>{var T=Lr(),D=$(T),se=c(D),me=h(c(se),2),N=h(D,2),C=c(N);C.__click=[Dr,z],U(()=>{me.disabled=o(s),C.disabled=o(s)}),Ct("submit",D,g),Je(me,()=>o(F),W=>n(F,W)),u(I,T)},re=I=>{var T=le(),D=$(T);{var se=N=>{var C=kr(),W=$(C),Se=c(W),Te=h(c(Se),2),oe=h(Se,2),ue=h(c(oe),2),Re=h(W,2),Me=c(Re);Me.__click=[Cr,z];var Le=h(Me,2),Ce=h(c(Le));Ce.__click=[Or,i],U(()=>{Te.disabled=o(s),ue.disabled=o(s),Me.disabled=o(s),Ce.disabled=o(s)}),Ct("submit",W,de),Je(Te,()=>o(m),be=>n(m,be)),Je(ue,()=>o(b),be=>n(b,be)),u(N,C)},me=N=>{var C=Nr(),W=$(C),Se=c(W),Te=h(c(Se),2),oe=h(Se,2),ue=h(c(oe),2),Re=h(oe,2),Me=h(c(Re),2),Le=h(W,2),Ce=h(c(Le));Ce.__click=[Pr,i],U(()=>{Te.disabled=o(s),ue.disabled=o(s),Me.disabled=o(s),Ce.disabled=o(s)}),Ct("submit",W,O),Je(Te,()=>o(w),be=>n(w,be)),Je(ue,()=>o(L),be=>n(L,be)),Je(Me,()=>o(A),be=>n(A,be)),u(N,C)};y(D,N=>{o(i)?N(se):N(me,!1)},!0)}u(I,T)};y(E,I=>{o(z)?I(G):I(re,!1)})}u(H,pe)}});var ae=h(Y,2);Rr(ae,{children:(H,Ee)=>{var pe=le(),ge=$(pe);{var Be=R=>{var E=jr();E.__click=g;var G=c(E);{var re=T=>{var D=zr();u(T,D)},I=T=>{var D=tt("Envoyer l'email de r√©initialisation");u(T,D)};y(G,T=>{o(s)?T(re):T(I,!1)})}U(()=>E.disabled=o(s)),u(R,E)},M=R=>{var E=le(),G=$(E);{var re=T=>{var D=Vr();D.__click=de;var se=c(D);{var me=C=>{var W=Fr();u(C,W)},N=C=>{var W=tt("Se connecter");u(C,W)};y(se,C=>{o(s)?C(me):C(N,!1)})}U(()=>D.disabled=o(s)),u(T,D)},I=T=>{var D=Yr();D.__click=O;var se=c(D);{var me=C=>{var W=qr();u(C,W)},N=C=>{var W=tt("Cr√©er un compte");u(C,W)};y(se,C=>{o(s)?C(me):C(N,!1)})}U(()=>D.disabled=o(s)),u(T,D)};y(G,T=>{o(i)?T(re):T(I,!1)},!0)}u(R,E)};y(ge,R=>{o(z)?R(Be):R(M,!1)})}u(H,pe)}}),u(k,V)},$$slots:{default:!0}}),xe()}Ne(["click"]);async function Hr(){try{await S.logout(),window.location.href="/"}catch(l){console.error("Erreur lors de la d√©connexion:",l)}}function Gr(l,e){n(e,!0),console.log("showAuthModal",o(e))}async function Wr(l,e,t){if(S.userId){n(e,!0);try{await He.forceReloadAllRecipes(),t()}catch(r){console.error("Erreur lors du rechargement des recettes:",r),alert("Erreur lors du rechargement des recettes")}finally{n(e,!1)}}}var Kr=(()=>ce("/")),Qr=()=>ce("/dashboard"),Jr=_('<button class="btn btn-ghost not-md:btn-square md:gap-2"><!> <span class="hidden md:inline">Tableau de bord</span></button>'),Xr=()=>ce("/recipe"),Zr=_('<h1 class="truncate text-sm font-bold tracking-wider uppercase opacity-70"> </h1>'),es=_('<div class="navbar-center absolute left-1/2 -translate-x-1/2 transform"><!></div>'),ts=_('<div class="badge badge-warning flex items-center gap-1 py-3 font-medium"><!> <span class="text-xs"> </span></div>'),as=()=>ce("/dashboard"),rs=()=>ce("/dashboard/teams"),ss=()=>ce("/dashboard/eventCreate"),os=()=>ce("/recipe"),is=_('<div class="dropdown dropdown-end"><div tabindex="0" role="button" class="btn btn-ghost btn-circle avatar bg-primary/10 text-primary border-primary/20 border"><div class="flex w-10 items-center justify-center rounded-full text-lg font-bold"> </div></div> <ul class="menu menu-sm dropdown-content bg-base-100 border-base-200 z-[1] mt-3 w-56 rounded-xl border p-2 shadow-xl"><li class="border-base-100 mb-1 border-b px-4 py-2"><span class="block truncate p-0 text-xs font-medium italic opacity-60"> </span></li> <li><button><!> Dashboard</button></li> <li><button><!> √âquipes</button></li> <li><button><!> Nouvel √©v√©nement</button></li> <li><button><!> Recettes</button></li> <li><button class="disabled:opacity-50"><!> </button></li> <!> <li class="border-base-100 my-1 border-t"></li> <li><button class="text-error hover:bg-error/10"><!> Se d√©connecter</button></li></ul></div>'),ns=_('<button class="btn btn-primary btn-sm shadow-md"><!> Connexion</button>'),ls=_('<h1 class="text-center text-sm font-bold tracking-wider uppercase opacity-70"> </h1>'),cs=_('<div class="border-base-300 bg-base-100 border-b px-4 py-3"><!></div>'),ds=_('<!> <div><div class="navbar-start w-fit flex-shrink-0 gap-1"><button class="btn btn-ghost px-2"><img src="data/favicon-96x96.png" alt="logo" class="h-8 w-8"/></button> <div class="flex items-center gap-1"><!> <button class="btn btn-ghost not-md:btn-square md:gap-2"><!> <span class="hidden md:inline">Recettes</span></button></div></div> <!> <div class="navbar-end ms-auto w-fit flex-shrink-0 gap-4"><!> <div class="flex items-center gap-2"><!></div> <!></div></div> <!>',1);function us(l,e){Ae(e,!0);let t=P(!1),r=P(!1),i=P(!1);function s(){n(t,!1)}function d(M){M.target.closest(".svelte-user-dropdown")||s()}async function v(){n(r,!1),await S.refreshAuthAfterLogin()}ct(()=>{if(o(t))return document.addEventListener("click",d),()=>document.removeEventListener("click",d)});var m=ds(),b=$(m);Ur(b,{onAuth_success:v,get isOpen(){return o(r)},set isOpen(M){n(r,M,!0)}});var w=h(b,2),L=c(w),A=c(L);A.__click=[Kr];var F=h(A,2),z=c(F);{var de=M=>{var R=Jr();R.__click=[Qr];var E=c(R);Ut(E,{size:18}),u(M,R)};y(z,M=>{S.isAuthenticated&&M(de)})}var O=h(z,2);O.__click=[Xr];var g=c(O);Ba(g,{size:18});var p=h(L,2);{var x=M=>{var R=es(),E=c(R);{var G=I=>{Qt(I,{get currentTeamId(){return ne.teamId}})},re=I=>{var T=le(),D=$(T);{var se=N=>{var C=le(),W=$(C);$e(W,()=>ne.tabs),u(N,C)},me=N=>{var C=le(),W=$(C);{var Se=oe=>{Kt(oe,{get eventId(){return ne.eventId}})},Te=oe=>{var ue=Zr(),Re=c(ue);U(()=>{kt(ue,"title",ne.title),ve(Re,ne.title)}),u(oe,ue)};y(W,oe=>{ne.eventId!==void 0?oe(Se):oe(Te,!1)},!0)}u(N,C)};y(D,N=>{ne.tabs?N(se):N(me,!1)},!0)}u(I,T)};y(E,I=>{ne.materielContext?I(G):I(re,!1)})}u(M,R)};y(p,M=>{S.isDesktop&&M(x)})}var k=h(p,2),f=c(k);{var V=M=>{var R=ts(),E=c(R);za(E,{size:14});var G=h(E,2),re=c(G);U(()=>ve(re,`√âdition par ${ne.lockedByUserName??""}`)),u(M,R)};y(f,M=>{ne.isLockedByOthers&&M(V)})}var X=h(f,2),Y=c(X);{var ae=M=>{var R=le(),E=$(R);$e(E,()=>ne.actions),u(M,R)};y(Y,M=>{ne.actions&&M(ae)})}var H=h(X,2);{var Ee=M=>{var R=is(),E=c(R),G=c(E),re=c(G),I=h(E,2),T=c(I),D=c(T),se=c(D),me=h(T,2),N=c(me);N.__click=[as];var C=c(N);Ut(C,{size:16});var W=h(me,2),Se=c(W);Se.__click=[rs];var Te=c(Se);ja(Te,{size:16});var oe=h(W,2),ue=c(oe);ue.__click=[ss];var Re=c(ue);Fa(Re,{size:16});var Me=h(oe,2),Le=c(Me);Le.__click=[os];var Ce=c(Le);Va(Ce,{size:16});var be=h(Me,2),Dt=c(be);Dt.__click=[Wr,i,s];var zt=c(Dt);{let bt=he(()=>o(i)?"animate-spin":"");qa(zt,{size:16,get class(){return o(bt)}})}var na=h(zt),jt=h(be,2);y(jt,bt=>{});var la=h(jt,4),Ft=c(la);Ft.__click=[Hr];var ca=c(Ft);Ya(ca,{size:16}),U(bt=>{ve(re,bt),ve(se,S.user?.email),Dt.disabled=o(i),ve(na,` ${o(i)?"Chargement...":"Recharger les recettes"}`)},[()=>S.user?.name?.charAt(0).toUpperCase()||"U"]),u(M,R)},pe=M=>{var R=ns();R.__click=[Gr,r];var E=c(R);$a(E,{size:16}),u(M,R)};y(H,M=>{S.isAuthenticated?M(Ee):M(pe,!1)})}var ge=h(w,2);{var Be=M=>{var R=cs(),E=c(R);{var G=I=>{Qt(I,{get currentTeamId(){return ne.teamId}})},re=I=>{var T=le(),D=$(T);{var se=N=>{Kt(N,{get eventId(){return ne.eventId}})},me=N=>{var C=le(),W=$(C);{var Se=oe=>{var ue=le(),Re=$(ue);$e(Re,()=>ne.tabs),u(oe,ue)},Te=oe=>{var ue=le(),Re=$(ue);{var Me=Le=>{var Ce=ls(),be=c(Ce);U(()=>ve(be,ne.title)),u(Le,Ce)};y(Re,Le=>{ne.title&&Le(Me)},!0)}u(oe,ue)};y(W,oe=>{ne.tabs?oe(Se):oe(Te,!1)},!0)}u(N,C)};y(D,N=>{ne.eventId!==void 0?N(se):N(me,!1)},!0)}u(I,T)};y(E,I=>{ne.materielContext?I(G):I(re,!1)})}u(M,R)};y(ge,M=>{S.isDesktop||M(Be)})}U(()=>Pe(w,1,`navbar bg-base-100 border-base-300 sticky top-0 z-[1000] border-b px-4 py-0 shadow-sm print:hidden ${(S.isMobile&&"min-h-11")??""} relative`)),u(l,m),xe()}Ne(["click"]);var vs=(l,e,t,r)=>e(o(t),o(r)),hs=_('<button class="btn btn-sm btn-primary"> </button>'),ms=(l,e,t)=>e(o(t)),fs=_('<button class="btn btn-ghost btn-xs btn-square" title="Voir les d√©tails" aria-label="Voir les d√©tails"><!></button>'),_s=(l,e,t)=>e(o(t)),bs=_('<button class="btn btn-ghost btn-xs btn-circle" title="Fermer" aria-label="Fermer la notification"><!></button>'),ps=_('<div><div class="flex items-center justify-between gap-4"><div class="flex flex-1 items-center gap-2"><!> <span class="text-xs"> </span></div> <!> <!> <!></div></div>'),gs=_("<div></div>");function ys(l,e){Ae(e,!0);let t=ye(e,"position",3,"toast-center toast-bottom"),r=ye(e,"padding",3,"sm");const i=he(()=>r()==="sm"?" py-0.5":""),s=he(()=>De.toasts),d=he(()=>()=>{const A=new Map;for(const F of o(s)){const z=F.position||t();A.has(z)||A.set(z,[]),A.get(z).push(F)}return A});function v(A){De.dismiss(A.id)}function m(A){e.onShowDetails?.({id:A.id,message:A.message,details:A.details})}function b(A,F){F.onClick()}var w=le(),L=$(w);et(L,17,()=>Array.from(o(d)().entries()),([A,F])=>A,(A,F)=>{var z=he(()=>ha(o(F),2));let de=()=>o(z)[0],O=()=>o(z)[1];var g=gs();et(g,21,O,p=>p.id,(p,x)=>{var k=ps(),f=c(k),V=c(f),X=c(V);{var Y=E=>{Ua(E,{class:"h-5 w-5 animate-spin"})};y(X,E=>{o(x).state==="loading"&&E(Y)})}var ae=h(X,2),H=c(ae),Ee=h(V,2);{var pe=E=>{var G=le(),re=$(G);et(re,17,()=>o(x).actions,It,(I,T)=>{var D=hs();D.__click=[vs,b,x,T];var se=c(D);U(()=>ve(se,o(T).label)),u(I,D)}),u(E,G)};y(Ee,E=>{o(x).actions&&o(x).actions.length>0&&E(pe)})}var ge=h(Ee,2);{var Be=E=>{var G=fs();G.__click=[ms,m,x];var re=c(G);Ha(re,{class:"h-3 w-3"}),u(E,G)};y(ge,E=>{o(x).details&&E(Be)})}var M=h(ge,2);{var R=E=>{var G=bs();G.__click=[_s,v,x];var re=c(G);Jt(re,{class:"h-4 w-4"}),u(E,G)};y(M,E=>{(o(x).state==="error"||o(x).state==="warning"||o(x).state==="loading")&&E(R)})}U(()=>{Pe(k,1,`alert alert-${o(x).state??""}  ${o(i)??""} shadow-lg`),ve(H,o(x).message)}),u(p,k)}),U(()=>Pe(g,1,`toast ${de()??""} z-1050`)),u(A,g)}),u(l,w),xe()}Ne(["click"]);function ws(){window.scrollTo({top:0,behavior:"smooth"})}var Es=_('<button class="btn btn-primary btn-circle fixed right-6 bottom-6 z-50 rounded-full shadow-lg" aria-label="Retour en haut de page"><!></button>');function Ss(l,e){Ae(e,!0);let t=he(()=>(ma.current||0)>300);var r=le(),i=$(r);{var s=d=>{var v=Es();v.__click=[ws];var m=c(v);Ga(m,{class:"h-6 w-6"}),fa(3,v,()=>_a),u(d,v)};y(i,d=>{o(t)&&d(s)})}u(l,r),xe()}Ne(["click"]);function As(l,e){Ae(e,!0),xe()}var xs=_('<img class="w-full object-cover"/>'),Ts=_('<figure class="hover-gallery"></figure>'),Rs=_('<p class="text-base-content/80"><!></p>'),Ms=_("<button> </button>"),Is=_('<div class="card bg-base-100 h-[60vh] w-full shadow-xl"><!> <div><h2> </h2> <!> <!> <!></div></div>');function vt(l,e){Ae(e,!0);let t=ye(e,"theme",3,"primary");const r={primary:"text-primary",secondary:"text-secondary"};var i=Is(),s=c(i);{var d=O=>{var g=Ts();et(g,21,()=>e.images,It,(p,x)=>{var k=xs();U(()=>{kt(k,"src",o(x)),kt(k,"alt",e.title)}),u(p,k)}),u(O,g)};y(s,O=>{e.images.length>0&&O(d)})}var v=h(s,2),m=c(v),b=c(m),w=h(m,2);{var L=O=>{var g=Rs(),p=c(g);ba(p,()=>e.description),u(O,g)};y(w,O=>{e.description&&O(L)})}var A=h(w,2);{var F=O=>{var g=le(),p=$(g);$e(p,()=>e.extra),u(O,g)};y(A,O=>{e.extra&&O(F)})}var z=h(A,2);{var de=O=>{var g=Ms();g.__click=function(...x){e.buttonAction?.apply(this,x)};var p=c(g);U(()=>{Pe(g,1,`btn btn-${t()??""} btn-sm absolute right-4 bottom-4`),ve(p,e.buttonText)}),u(O,g)};y(z,O=>{e.buttonText&&e.buttonAction&&O(de)})}U(()=>{Pe(v,1,`card-body absolute bottom-0 ${(e.buttonAction&&"pb-15")??""} w-full bg-gray-700/30`),Pe(m,1,`card-title ${r[t()]??""} text-2xl`),ve(b,e.title)}),u(l,i),xe()}Ne(["click"]);var Ds=()=>ce("/recipe"),Ls=()=>ce("/dashboard"),Cs=_('<button class="btn btn-outline btn-xl"><!> Acc√©der au tableau de bord</button>'),Os=_('<button class="btn btn-secondary btn-xl">Cr√©er un compte pour commencer <!></button>'),ks=_('<p class="text-base-content/60 text-center">D√©j√† membre ? Connectez-vous pour g√©rer vos cantines et √©quipes</p>'),Ps=_('<div class="bg-base-200 min-h-screen"><section class="hero bg-base-200 min-h-[50vh]"><div class="hero-content text-center"><div class="max-w-3xl"><div class="mb-4 flex justify-center"><img src="/data/logo.svg" alt="Enka Cookbook"/></div> <h1 class="text-6xl font-black tracking-tight">Enka Cookbook</h1> <p class="text-base-content/70 mt-6 text-xl">Outils de planification pour les cantines autog√©r√©es</p></div></div></section> <section class="bg-base-200 mt-15 mb-5"><div class="container mx-auto px-4"><div class="flex flex-col items-center justify-center gap-6"><button class="btn btn-primary btn-xl"><!> <span class="flex items-baseline gap-2">Voir les recettes</span></button> <!> <!></div></div></section> <section class="bg-base-200 py-16"><div class="container mx-auto px-4"><div class="grid gap-8"><div class="grid gap-6 md:grid-cols-3"><!> <!></div> <div class="grid gap-6 md:grid-cols-3"><!> <!> <!></div></div></div></section></div>');function Ns(l,e){Ae(e,!1);function t(){const Y=new CustomEvent("open-auth-modal");window.dispatchEvent(Y)}pa();var r=Ps(),i=h(c(r),2),s=c(i),d=c(s),v=c(d);v.__click=[Ds];var m=c(v);Wa(m,{size:24});var b=h(v,2);{var w=Y=>{var ae=Cs();ae.__click=[Ls];var H=c(ae);Ht(H,{size:24}),u(Y,ae)},L=Y=>{var ae=Os();ae.__click=t;var H=h(c(ae));Ht(H,{size:24}),u(Y,ae)};y(b,Y=>{S.isAuthenticated?Y(w):Y(L,!1)})}var A=h(b,2);{var F=Y=>{var ae=ks();u(Y,ae)};y(A,Y=>{S.isAuthenticated||Y(F)})}var z=h(i,2),de=c(z),O=c(de),g=c(O),p=c(g);vt(p,{images:["/images/plat.webp","/images/salade.webp"],title:"Partagez vos recettes",description:"D√©couvrez et partagez des recettes avec la communaut√©",buttonText:"Explorer",buttonAction:()=>ce("/recipe"),theme:"primary"});var x=h(p,2);vt(x,{images:["/images/home/recipe-print.webp","/images/home/recipe.webp"],title:"Imprimez vos recettes",description:"G√©n√©rez des fiches recettes propres et professionnelles",buttonText:"Imprimer",theme:"primary"});var k=h(g,2),f=c(k);vt(f,{images:["/images/doc/explorer.png"],title:"Organisation",description:"√âlaborez des menus sur plusieurs jours et organisez-vous en √©quipes",buttonText:"Organiser",buttonAction:()=>S.isAuthenticated?ce("/dashboard"):t(),theme:"secondary"});var V=h(f,2);vt(V,{images:["/images/home/product.webp"],title:"Listes de courses",description:"G√©n√©rez automatiquement les listes de courses pour vos menus",buttonText:"G√©n√©rer",buttonAction:()=>S.isAuthenticated?ce("/dashboard"):t(),theme:"secondary"});var X=h(V,2);vt(X,{images:["/images/friture.webp"],title:"Gestion compl√®te",description:"G√©rez vos stocks, mat√©riel et r√©partissez les t√¢ches",buttonText:"G√©rer",buttonAction:()=>S.isAuthenticated?ce("/dashboard"):t(),theme:"secondary"}),u(l,r),xe()}Ne(["click"]);var Bs=_('<div class="flex h-[50vh] items-center justify-center"><!></div>'),zs=_('<div class="flex h-[80vh] flex-col items-center justify-center gap-4"><div class="loading loading-spinner loading-lg text-primary"></div> <p class="text-base-content/70 animate-pulse font-medium"><!></p></div>'),js=_("<!> <!>",1),Fs=_('<!> <div class="bg-base-200 min-h-screen"><!></div> <!> <!> <!>',1);function Vs(l,e){Ae(e,!0);let t=P("BOOTING"),r=P(null);const i={beforeEnter:async()=>S.isAuthenticated?!0:(console.log("[Router] Acc√®s refus√© > Redirection /"),ce("/"),!1)};j.addRoute("/",Ns),j.addRoute("/recipe",()=>J(()=>import("./RecipesListPage.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]))),j.addRoute("/recipe/my",()=>J(()=>import("./RecipesListPage.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14])),i),j.addRoute("/recipe/my/draft",()=>J(()=>import("./RecipesListPage.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14])),i),j.addRoute("/recipe/new",()=>J(()=>import("./RecipeCreatePage.js"),__vite__mapDeps([15,1,2,3,4,5,14,16,6,17,7,18,11,19,20])),i),j.addRoute("/recipe/:uuid/edit",()=>J(()=>import("./RecipeEditPage.js"),__vite__mapDeps([21,1,2,3,4,5,14,16,6,17,7,18,11,19,8,9,22,20,23])),i),j.addRoute("/recipe/:uuid/duplicate",()=>J(()=>import("./RecipeCreatePage.js"),__vite__mapDeps([15,1,2,3,4,5,14,16,6,17,7,18,11,19,20])),i),j.addRoute("/recipe/:uuid",()=>J(()=>import("./RecipeDetailPage.js"),__vite__mapDeps([24,1,2,3,4,5,12,25,17,6,7,23]))),j.addRoute("/accept-invite",()=>J(()=>import("./AcceptInvite.js"),__vite__mapDeps([26,1,2,3,4,5,6]))),j.addRoute("/reset-password",()=>J(()=>import("./ResetPassword.js"),__vite__mapDeps([27,1,2,3,4,5,6,28]))),j.addRoute("/dashboard",()=>J(()=>import("./DashboardPage.js"),__vite__mapDeps([29,1,2,3,4,5,30,6,31,22,32,17,33,34])),i),j.addRoute("/dashboard/teams",()=>J(()=>import("./TeamsManagement.js"),__vite__mapDeps([35,1,2,3,4,5,6,31,22,32])),i),j.addRoute("/dashboard/eventCreate",()=>J(()=>import("./EventCreatePage.js"),__vite__mapDeps([36,1,2,3,4,37,5,9,6,17,30,7])),i),j.addRoute("/dashboard/eventEdit/:id",()=>J(()=>import("./EventEditPage.js"),__vite__mapDeps([38,1,2,3,4,37,5,9,6,17,30,7,39,33,40,11,18,20,22])),i),j.addRoute("/dashboard/eventEdit/recipes/:id",()=>J(()=>import("./EventRecipesPage.js"),__vite__mapDeps([41,1,2,3,4,5,33,40,6,30,25,17,7,12,13,8,9,42])),i),j.addRoute("/dashboard/eventEdit/products/:id",()=>J(()=>import("./EventProductsPage.js"),__vite__mapDeps([43,1,2,3,4,5,30,18,11,6,32,17,7,40,33,13,44])),i),j.addRoute("/dashboard/eventPosters/:id",()=>J(()=>import("./EventPosterPage.js"),__vite__mapDeps([45,1,2,3,4,5,39,6,7,22,13,46])),i),j.addRoute("/dashboard/materiel",()=>J(()=>import("./MaterielPage.js"),__vite__mapDeps([47,1,2,3,4,5,30,6,11,10,7,13])),i),j.addRoute("/dashboard/materiel/:teamId",()=>J(()=>import("./MaterielPage.js"),__vite__mapDeps([47,1,2,3,4,5,30,6,11,10,7,13])),i),j.addRoute("/dashboard/loans",()=>J(()=>import("./LoansPage.js"),__vite__mapDeps([48,1,2,3,4,5,8,9,6,18,11,30])),i),j.addRoute("/dashboard/loans/:teamId",()=>J(()=>import("./LoansPage.js"),__vite__mapDeps([48,1,2,3,4,5,8,9,6,18,11,30])),i),j.addRoute("/dashboard/loans/return/:loanId",()=>J(()=>import("./LoanReturnPage.js"),__vite__mapDeps([49,1,2,3,4,5,30,6])),i),j.addRoute("/eventList",()=>J(()=>import("./EventListPage.js"),__vite__mapDeps([50,1,2,3,4,5,33,17,6])),i),j.addRoute("/createdocument/:teamId/new",()=>J(()=>import("./CreateDocumentPage.js"),__vite__mapDeps([51,1,2,3,4,5,52,6,53,18,11,54])),i),j.addRoute("/editdocument/:teamId/:docId",()=>J(()=>import("./EditDocumentPage.js"),__vite__mapDeps([55,1,2,3,4,5,52,6,53,18,11,20,56])),i),j.addRoute("/documents/:teamId",()=>J(()=>import("./DocumentListPage.js"),__vite__mapDeps([57,1,2,3,4,5,34,30,6,13,7,11])),i);let s=P(null);async function d(){try{if(n(t,"BOOTING"),await S.initializeAuth(),S.isAuthenticated){n(t,"LOADING_PRIVATE_CACHE");const f=De.loading("Chargement des donn√©es...");await Promise.all([ht.loadCache(),He.loadCache(),yt.loadCache(),gt.loadCache(),wt.loadCache()]),n(t,"READY_WITH_CACHE"),De.update(f,{state:"loading",message:"Mise √† jour des donn√©es en cours..."}),Promise.all([ht.syncFromRemote(),He.syncFromRemote(),yt.syncFromRemote(),Ue.syncFromRemote(),gt.syncFromRemote(),wt.syncFromRemote()]).then(async()=>{await Promise.all([ht.setupRealtime(),He.setupRealtime(),yt.setupRealtime(),Ue.setupRealtime(),gt.setupRealtime(),wt.setupRealtime()]),await Ye.initialize(),n(t,"READY_FULLY_SYNCED"),De.dismiss(f),setTimeout(()=>{Ot("/dashboard"),Ot("/recipe")},3e3)}).catch(V=>{console.error("[App] Erreur synchro distante:",V),De.update(f,{state:"warning",message:"Mode hors ligne : donn√©es mises en cache",autoCloseDelay:5e3}),Ye.initialize().catch(console.error)})}else{n(t,"LOADING_PUBLIC_CACHE");const f=De.loading("Pr√©paration de la cuisine...");await He.loadCache(),n(t,"READY_WITH_CACHE"),De.update(f,{state:"loading",message:"Mise √† jour des recettes..."}),Promise.all([He.syncFromRemote(),Ye.initialize()]).then(()=>{n(t,"READY_FULLY_SYNCED"),setTimeout(()=>{Ot("/recipe")},2e3)}).catch(V=>{console.error("[App] Erreur synchro recettes:",V),De.update(f,{state:"warning",message:"Mode hors ligne : recettes en cache",autoCloseDelay:1e4})})}}catch(f){console.error("[App] Erreur fatale d'initialisation:",f),n(r,f.message||"Erreur critique de chargement",!0),n(t,"ERROR")}}let v=P("");ct(()=>{const f=j.path,V=o(t);(V==="READY_WITH_CACHE"||V==="READY_FULLY_SYNCED"||V==="READY")&&j.match().then(async X=>{n(s,X,!0),f!==o(v)&&(n(v,f,!0),await wa(),requestAnimationFrame(()=>{requestAnimationFrame(()=>{window.scrollTo({top:0,behavior:"smooth"})})}))})});let m=P(!1),b=P(!1);ct(()=>{const f=S.isAuthenticated;o(b)||o(t)!=="BOOTING"&&o(t)!=="LOADING_PRIVATE_CACHE"&&o(t)!=="LOADING_PUBLIC_CACHE"&&f!==o(m)&&(n(m,f,!0),console.log("[App] Changement d'√©tat Auth d√©tect√© -> Rechargement"),n(b,!0),d().finally(()=>{n(b,!1)}))}),ga(()=>{d()}),ya(()=>{console.log("[App] Destruction de l'application - Nettoyage des stores..."),gt.destroy(),Ue.destroy(),ht.destroy(),He.destroy(),yt.destroy(),wt.destroy(),Ye.destroy()});let w=he(()=>o(r)||Pt.error);var L=Fs(),A=$(L);us(A,{});var F=h(A,2),z=c(F);{var de=f=>{const V=he(()=>o(s).component);var X=le(),Y=$(X);Ea(Y,()=>o(V),(ae,H)=>{H(ae,{get params(){return o(s).params},get query(){return o(s).query}})}),u(f,X)},O=f=>{var V=le(),X=$(V);{var Y=H=>{var Ee=Bs(),pe=c(Ee);{let ge=he(()=>o(w)||"Erreur inconnue");Wt(pe,{get message(){return o(ge)}})}u(H,Ee)},ae=H=>{var Ee=zs(),pe=h(c(Ee),2),ge=c(pe);{var Be=R=>{var E=tt("D√©marrage...");u(R,E)},M=R=>{var E=le(),G=$(E);{var re=T=>{var D=tt("Chargement des donn√©es en cache...");u(T,D)},I=T=>{var D=le(),se=$(D);{var me=N=>{var C=tt("Pr√©paration de la cuisine...");u(N,C)};y(se,N=>{o(t)==="LOADING_PUBLIC_CACHE"&&N(me)},!0)}u(T,D)};y(G,T=>{o(t)==="LOADING_PRIVATE_CACHE"?T(re):T(I,!1)},!0)}u(R,E)};y(ge,R=>{o(t)==="BOOTING"?R(Be):R(M,!1)})}u(H,Ee)};y(X,H=>{o(t)==="ERROR"?H(Y):H(ae,!1)},!0)}u(f,V)};y(z,f=>{(o(t)==="READY_WITH_CACHE"||o(t)==="READY_FULLY_SYNCED"||o(t)==="READY")&&o(s)?f(de):f(O,!1)})}var g=h(F,2);ys(g,{});var p=h(g,2);Ss(p,{});var x=h(p,2);{var k=f=>{var V=js(),X=$(V);{var Y=H=>{Wt(H,{get message(){return o(w)}})};y(X,H=>{o(w)&&H(Y)})}var ae=h(X,2);As(ae,{}),u(f,V)};y(x,f=>{S.isAuthenticated&&o(t)==="READY"&&f(k)})}u(l,L),xe()}Sa(Vs,{target:document.getElementById("app")});export{br as M,Sr as a,xr as b,Rr as c,Ws as d,Nt as e,Ks as f,Qs as g,Js as h,yt as m,ne as n,wt as t};
