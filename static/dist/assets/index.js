(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();const Xs=!1;var Ft=Array.isArray,bi=Array.prototype.indexOf,Gr=Array.from,Lr=Object.defineProperty,tt=Object.getOwnPropertyDescriptor,Si=Object.getOwnPropertyDescriptors,Zs=Object.prototype,Ei=Array.prototype,Kr=Object.getPrototypeOf,vs=Object.isExtensible;function Lt(e){return typeof e=="function"}const qe=()=>{};function Ti(e){for(var t=0;t<e.length;t++)e[t]()}function Fs(){var e,t,r=new Promise((s,n)=>{e=s,t=n});return{promise:r,resolve:e,reject:t}}function Di(e,t){if(Array.isArray(e))return e;if(!(Symbol.iterator in e))return Array.from(e);const r=[];for(const s of e)if(r.push(s),r.length===t)break;return r}const ge=2,Yr=4,Vr=8,_t=16,Ve=32,wt=64,Jr=128,Ie=256,hr=512,ae=1024,De=2048,nt=4096,Me=8192,yt=16384,Xr=32768,Nt=65536,gs=1<<17,Pi=1<<18,kt=1<<19,Ai=1<<20,Ur=1<<21,mr=1<<22,ht=1<<23,pt=Symbol("$state"),en=Symbol("legacy props"),Ri=Symbol(""),Gt=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function tn(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Ii(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Ci(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function xi(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Ni(e){throw new Error("https://svelte.dev/e/effect_orphan")}function ki(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function $i(e){throw new Error("https://svelte.dev/e/props_invalid_value")}function Oi(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Mi(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function qi(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Bi(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const _r=1,wr=2,rn=4,ji=8,Li=16,Ui=1,Hi=2,zi=4,Qi=8,Wi=16,Gi=1,Ki=2,F=Symbol(),Yi="http://www.w3.org/1999/xhtml",Vi="http://www.w3.org/2000/svg",Ji="@attach";function Xi(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function Zi(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}let Fi=!1;function sn(e){return e===this.v}function ea(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function nn(e){return!ea(e,this.v)}let $t=!1,ta=!1;function ra(){$t=!0}const sa=[];function Tt(e,t=!1,r=!1){return dr(e,new Map,"",sa,null,r)}function dr(e,t,r,s,n=null,i=!1){if(typeof e=="object"&&e!==null){var a=t.get(e);if(a!==void 0)return a;if(e instanceof Map)return new Map(e);if(e instanceof Set)return new Set(e);if(Ft(e)){var l=Array(e.length);t.set(e,l),n!==null&&t.set(n,l);for(var c=0;c<e.length;c+=1){var u=e[c];c in e&&(l[c]=dr(u,t,r,s,null,i))}return l}if(Kr(e)===Zs){l={},t.set(e,l),n!==null&&t.set(n,l);for(var d in e)l[d]=dr(e[d],t,r,s,null,i);return l}if(e instanceof Date)return structuredClone(e);if(typeof e.toJSON=="function"&&!i)return dr(e.toJSON(),t,r,s,e)}if(e instanceof EventTarget)return e;try{return structuredClone(e)}catch{return e}}let J=null;function Rt(e){J=e}function me(e,t=!1,r){J={p:J,c:null,e:null,s:e,x:null,l:$t&&!t?{s:null,u:null,$:[]}:null}}function _e(e){var t=J,r=t.e;if(r!==null){t.e=null;for(var s of r)Sn(s)}return J=t.p,{}}function er(){return!$t||J!==null&&J.l===null}let ut=[];function an(){var e=ut;ut=[],Ti(e)}function gt(e){if(ut.length===0&&!Kt){var t=ut;queueMicrotask(()=>{t===ut&&an()})}ut.push(e)}function na(){for(;ut.length>0;)an()}const ia=new WeakMap;function on(e){var t=O;if(t===null)return M.f|=ht,e;if((t.f&Xr)===0){if((t.f&Jr)===0)throw!t.parent&&e instanceof Error&&ln(e),e;t.b.error(e)}else It(e,t)}function It(e,t){for(;t!==null;){if((t.f&Jr)!==0)try{t.b.error(e);return}catch(r){e=r}t=t.parent}throw e instanceof Error&&ln(e),e}function ln(e){const t=ia.get(e);t&&(Lr(e,"message",{value:t.message}),Lr(e,"stack",{value:t.stack}))}const lr=new Set;let W=null,fr=null,Hr=new Set,je=[],yr=null,zr=!1,Kt=!1;class Re{current=new Map;#e=new Map;#t=new Set;#r=0;#a=null;#u=[];#l=[];#i=[];#o=[];#d=[];#c=[];skipped_effects=new Set;process(t){je=[],fr=null;var r=Re.apply(this);for(const i of t)this.#f(i);if(this.#r===0){this.#h();var s=this.#l,n=this.#i;this.#l=[],this.#i=[],this.#o=[],fr=this,W=null,ms(s),ms(n),fr=null,this.#a?.resolve()}else this.#s(this.#l),this.#s(this.#i),this.#s(this.#o);r();for(const i of this.#u)Xt(i);this.#u=[]}#f(t){t.f^=ae;for(var r=t.first;r!==null;){var s=r.f,n=(s&(Ve|wt))!==0,i=n&&(s&ae)!==0,a=i||(s&Me)!==0||this.skipped_effects.has(r);if(!a&&r.fn!==null){n?r.f^=ae:(s&Yr)!==0?this.#i.push(r):(s&ae)===0&&((s&mr)!==0&&r.b?.is_pending()?this.#u.push(r):Tr(r)&&((r.f&_t)!==0&&this.#o.push(r),Xt(r)));var l=r.first;if(l!==null){r=l;continue}}var c=r.parent;for(r=r.next;r===null&&c!==null;)r=c.next,c=c.parent}}#s(t){for(const r of t)((r.f&De)!==0?this.#d:this.#c).push(r),ce(r,ae);t.length=0}capture(t,r){this.#e.has(t)||this.#e.set(t,r),this.current.set(t,t.v)}activate(){W=this}deactivate(){W=null}flush(){if(je.length>0){if(this.activate(),cn(),W!==null&&W!==this)return}else this.#r===0&&this.#h();this.deactivate();for(const t of Hr)if(Hr.delete(t),t(),W!==null)break}#h(){for(const t of this.#t)t();if(this.#t.clear(),lr.size>1){this.#e.clear();let t=!0;for(const r of lr){if(r===this){t=!1;continue}for(const[s,n]of this.current){if(r.current.has(s))if(t)r.current.set(s,n);else continue;un(s)}if(je.length>0){W=r;const s=Re.apply(r);for(const n of je)r.#f(n);je=[],s()}}W=null}lr.delete(this)}increment(){this.#r+=1}decrement(){this.#r-=1;for(const t of this.#d)ce(t,De),mt(t);for(const t of this.#c)ce(t,nt),mt(t);this.flush()}add_callback(t){this.#t.add(t)}settled(){return(this.#a??=Fs()).promise}static ensure(){if(W===null){const t=W=new Re;lr.add(W),Kt||Re.enqueue(()=>{W===t&&t.flush()})}return W}static enqueue(t){gt(t)}static apply(t){return qe}}function aa(e){var t=Kt;Kt=!0;try{for(var r;;){if(na(),je.length===0&&(W?.flush(),je.length===0))return yr=null,r;cn()}}finally{Kt=t}}function cn(){var e=At;zr=!0;try{var t=0;for(bs(!0);je.length>0;){var r=Re.ensure();if(t++>1e3){var s,n;oa()}r.process(je),rt.clear()}}finally{zr=!1,bs(e),yr=null}}function oa(){try{ki()}catch(e){It(e,yr)}}let ct=null;function ms(e){var t=e.length;if(t!==0){for(var r=0;r<t;){var s=e[r++];if((s.f&(yt|Me))===0&&Tr(s)&&(ct=[],Xt(s),s.deps===null&&s.first===null&&s.nodes_start===null&&(s.teardown===null&&s.ac===null?Pn(s):s.fn=null),ct?.length>0)){rt.clear();for(const n of ct)Xt(n);ct=[]}}ct=null}}function un(e){if(e.reactions!==null)for(const t of e.reactions){const r=t.f;(r&ge)!==0?un(t):(r&(mr|_t))!==0&&(ce(t,De),mt(t))}}function mt(e){for(var t=yr=e;t.parent!==null;){t=t.parent;var r=t.f;if(zr&&t===O&&(r&_t)!==0)return;if((r&(wt|Ve))!==0){if((r&ae)===0)return;t.f^=ae}}je.push(t)}function Zr(e){let t=0,r=st(0),s;return()=>{Ea()&&(o(r),En(()=>(t===0&&(s=rr(()=>e(()=>Le(r)))),t+=1,()=>{gt(()=>{t-=1,t===0&&(s?.(),s=void 0,Le(r))})})))}}var la=Nt|kt|Jr;function ca(e,t,r){new ua(e,t,r)}class ua{parent;#e=!1;#t;#r=null;#a;#u;#l;#i=null;#o=null;#d=null;#c=null;#f=0;#s=0;#h=!1;#p=null;#v=()=>{this.#p&&Ct(this.#p,this.#f)};#S=Zr(()=>(this.#p=st(this.#f),()=>{this.#p=null}));constructor(t,r,s){this.#t=t,this.#a=r,this.#u=s,this.parent=O.b,this.#e=!!this.#a.pending,this.#l=bt(()=>{O.b=this;{try{this.#i=le(()=>s(this.#t))}catch(n){this.error(n)}this.#s>0?this.#g():this.#e=!1}},la)}#E(){try{this.#i=le(()=>this.#u(this.#t))}catch(t){this.error(t)}this.#e=!1}#_(){const t=this.#a.pending;t&&(this.#o=le(()=>t(this.#t)),Re.enqueue(()=>{this.#i=this.#n(()=>(Re.ensure(),le(()=>this.#u(this.#t)))),this.#s>0?this.#g():(vt(this.#o,()=>{this.#o=null}),this.#e=!1)}))}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#a.pending}#n(t){var r=O,s=M,n=J;He(this.#l),ve(this.#l),Rt(this.#l.ctx);try{return t()}catch(i){return on(i),null}finally{He(r),ve(s),Rt(n)}}#g(){const t=this.#a.pending;this.#i!==null&&(this.#c=document.createDocumentFragment(),da(this.#i,this.#c)),this.#o===null&&(this.#o=le(()=>t(this.#t)))}#m(t){if(!this.has_pending_snippet()){this.parent&&this.parent.#m(t);return}this.#s+=t,this.#s===0&&(this.#e=!1,this.#o&&vt(this.#o,()=>{this.#o=null}),this.#c&&(this.#t.before(this.#c),this.#c=null),gt(()=>{Re.ensure().flush()}))}update_pending_count(t){this.#m(t),this.#f+=t,Hr.add(this.#v)}get_effect_pending(){return this.#S(),o(this.#p)}error(t){var r=this.#a.onerror;let s=this.#a.failed;if(this.#h||!r&&!s)throw t;this.#i&&(te(this.#i),this.#i=null),this.#o&&(te(this.#o),this.#o=null),this.#d&&(te(this.#d),this.#d=null);var n=!1,i=!1;const a=()=>{if(n){Zi();return}n=!0,i&&Bi(),Re.ensure(),this.#f=0,this.#d!==null&&vt(this.#d,()=>{this.#d=null}),this.#e=this.has_pending_snippet(),this.#i=this.#n(()=>(this.#h=!1,le(()=>this.#u(this.#t)))),this.#s>0?this.#g():this.#e=!1};var l=M;try{ve(null),i=!0,r?.(t,a),i=!1}catch(c){It(c,this.#l&&this.#l.parent)}finally{ve(l)}s&&gt(()=>{this.#d=this.#n(()=>{this.#h=!0;try{return le(()=>{s(this.#t,()=>t,()=>a)})}catch(c){return It(c,this.#l.parent),null}finally{this.#h=!1}})})}}function da(e,t){for(var r=e.nodes_start,s=e.nodes_end;r!==null;){var n=r===s?null:tr(r);t.append(r),r=n}}function dn(e,t,r){const s=er()?br:Fr;if(t.length===0){r(e.map(s));return}var n=W,i=O,a=fa();Promise.all(t.map(l=>ha(l))).then(l=>{a();try{r([...e.map(s),...l])}catch(c){(i.f&yt)===0&&It(c,i)}n?.deactivate(),fn()}).catch(l=>{It(l,i)})}function fa(){var e=O,t=M,r=J,s=W;return function(){He(e),ve(t),Rt(r),s?.activate()}}function fn(){He(null),ve(null),Rt(null)}function br(e){var t=ge|De,r=M!==null&&(M.f&ge)!==0?M:null;return O===null||r!==null&&(r.f&Ie)!==0?t|=Ie:O.f|=kt,{ctx:J,deps:null,effects:null,equals:sn,f:t,fn:e,reactions:null,rv:0,v:F,wv:0,parent:r??O,ac:null}}function ha(e,t){let r=O;r===null&&Ii();var s=r.b,n=void 0,i=st(F),a=!M,l=new Map;return Da(()=>{var c=Fs();n=c.promise;try{Promise.resolve(e()).then(c.resolve,c.reject)}catch(v){c.reject(v)}var u=W,d=s.is_pending();a&&(s.update_pending_count(1),d||(u.increment(),l.get(u)?.reject(Gt),l.set(u,c)));const p=(v,f=void 0)=>{d||u.activate(),f?f!==Gt&&(i.f|=ht,Ct(i,f)):((i.f&ht)!==0&&(i.f^=ht),Ct(i,v)),a&&(s.update_pending_count(-1),d||u.decrement()),fn()};c.promise.then(p,v=>p(null,v||"unknown"))}),ts(()=>{for(const c of l.values())c.reject(Gt)}),new Promise(c=>{function u(d){function p(){d===n?c(i):u(n)}d.then(p,p)}u(n)})}function Q(e){const t=br(e);return In(t),t}function Fr(e){const t=br(e);return t.equals=nn,t}function hn(e){var t=e.effects;if(t!==null){e.effects=null;for(var r=0;r<t.length;r+=1)te(t[r])}}function pa(e){for(var t=e.parent;t!==null;){if((t.f&ge)===0)return t;t=t.parent}return null}function es(e){var t,r=O;He(pa(e));try{hn(e),t=kn(e)}finally{He(r)}return t}function pn(e){var t=es(e);if(e.equals(t)||(e.v=t,e.wv=xn()),!St){var r=(et||(e.f&Ie)!==0)&&e.deps!==null?nt:ae;ce(e,r)}}const rt=new Map;function st(e,t){var r={f:0,v:e,reactions:null,equals:sn,rv:0,wv:0};return r}function A(e,t){const r=st(e);return In(r),r}function va(e,t=!1,r=!0){const s=st(e);return t||(s.equals=nn),$t&&r&&J!==null&&J.l!==null&&(J.l.s??=[]).push(s),s}function h(e,t,r=!1){M!==null&&(!Oe||(M.f&gs)!==0)&&er()&&(M.f&(ge|_t|mr|gs))!==0&&!Ke?.includes(e)&&qi();let s=r?pe(t):t;return Ct(e,s)}function Ct(e,t){if(!e.equals(t)){var r=e.v;St?rt.set(e,t):rt.set(e,r),e.v=t;var s=Re.ensure();s.capture(e,r),(e.f&ge)!==0&&((e.f&De)!==0&&es(e),ce(e,(e.f&Ie)===0?ae:nt)),e.wv=xn(),vn(e,De),er()&&O!==null&&(O.f&ae)!==0&&(O.f&(Ve|wt))===0&&(Pe===null?Ra([e]):Pe.push(e))}return t}function Le(e){h(e,e.v+1)}function vn(e,t){var r=e.reactions;if(r!==null)for(var s=er(),n=r.length,i=0;i<n;i++){var a=r[i],l=a.f;if(!(!s&&a===O)){var c=(l&De)===0;c&&ce(a,t),(l&ge)!==0?vn(a,nt):c&&((l&_t)!==0&&ct!==null&&ct.push(a),mt(a))}}}function pe(e){if(typeof e!="object"||e===null||pt in e)return e;const t=Kr(e);if(t!==Zs&&t!==Ei)return e;var r=new Map,s=Ft(e),n=A(0),i=Ye,a=l=>{if(Ye===i)return l();var c=M,u=Ye;ve(null),Es(i);var d=l();return ve(c),Es(u),d};return s&&r.set("length",A(e.length)),new Proxy(e,{defineProperty(l,c,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&Oi();var d=r.get(c);return d===void 0?d=a(()=>{var p=A(u.value);return r.set(c,p),p}):h(d,u.value,!0),!0},deleteProperty(l,c){var u=r.get(c);if(u===void 0){if(c in l){const d=a(()=>A(F));r.set(c,d),Le(n)}}else h(u,F),Le(n);return!0},get(l,c,u){if(c===pt)return e;var d=r.get(c),p=c in l;if(d===void 0&&(!p||tt(l,c)?.writable)&&(d=a(()=>{var f=pe(p?l[c]:F),g=A(f);return g}),r.set(c,d)),d!==void 0){var v=o(d);return v===F?void 0:v}return Reflect.get(l,c,u)},getOwnPropertyDescriptor(l,c){var u=Reflect.getOwnPropertyDescriptor(l,c);if(u&&"value"in u){var d=r.get(c);d&&(u.value=o(d))}else if(u===void 0){var p=r.get(c),v=p?.v;if(p!==void 0&&v!==F)return{enumerable:!0,configurable:!0,value:v,writable:!0}}return u},has(l,c){if(c===pt)return!0;var u=r.get(c),d=u!==void 0&&u.v!==F||Reflect.has(l,c);if(u!==void 0||O!==null&&(!d||tt(l,c)?.writable)){u===void 0&&(u=a(()=>{var v=d?pe(l[c]):F,f=A(v);return f}),r.set(c,u));var p=o(u);if(p===F)return!1}return d},set(l,c,u,d){var p=r.get(c),v=c in l;if(s&&c==="length")for(var f=u;f<p.v;f+=1){var g=r.get(f+"");g!==void 0?h(g,F):f in l&&(g=a(()=>A(F)),r.set(f+"",g))}if(p===void 0)(!v||tt(l,c)?.writable)&&(p=a(()=>A(void 0)),h(p,pe(u)),r.set(c,p));else{v=p.v!==F;var S=a(()=>pe(u));h(p,S)}var b=Reflect.getOwnPropertyDescriptor(l,c);if(b?.set&&b.set.call(d,u),!v){if(s&&typeof c=="string"){var E=r.get("length"),R=Number(c);Number.isInteger(R)&&R>=E.v&&h(E,R+1)}Le(n)}return!0},ownKeys(l){o(n);var c=Reflect.ownKeys(l).filter(p=>{var v=r.get(p);return v===void 0||v.v!==F});for(var[u,d]of r)d.v!==F&&!(u in l)&&c.push(u);return c},setPrototypeOf(){Mi()}})}function _s(e){try{if(e!==null&&typeof e=="object"&&pt in e)return e[pt]}catch{}return e}function ga(e,t){return Object.is(_s(e),_s(t))}var ws,gn,mn,_n;function ma(){if(ws===void 0){ws=window,gn=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,r=Text.prototype;mn=tt(t,"firstChild").get,_n=tt(t,"nextSibling").get,vs(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),vs(r)&&(r.__t=void 0)}}function Ot(e=""){return document.createTextNode(e)}function xt(e){return mn.call(e)}function tr(e){return _n.call(e)}function _(e,t){return xt(e)}function G(e,t=!1){{var r=xt(e);return r instanceof Comment&&r.data===""?tr(r):r}}function w(e,t=1,r=!1){let s=e;for(;t--;)s=tr(s);return s}function _a(e){e.textContent=""}function wn(){return!1}function wa(e,t){if(t){const r=document.body;e.autofocus=!0,gt(()=>{document.activeElement===r&&e.focus()})}}let ys=!1;function ya(){ys||(ys=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function Sr(e){var t=M,r=O;ve(null),He(null);try{return e()}finally{ve(t),He(r)}}function yn(e,t,r,s=r){e.addEventListener(t,()=>Sr(r));const n=e.__on_r;n?e.__on_r=()=>{n(),s(!0)}:e.__on_r=()=>s(!0),ya()}function ba(e){O===null&&M===null&&Ni(),M!==null&&(M.f&Ie)!==0&&O===null&&xi(),St&&Ci()}function Sa(e,t){var r=t.last;r===null?t.last=t.first=e:(r.next=e,e.prev=r,t.last=e)}function Je(e,t,r,s=!0){var n=O;n!==null&&(n.f&Me)!==0&&(e|=Me);var i={ctx:J,deps:null,nodes_start:null,nodes_end:null,f:e|De,first:null,fn:t,last:null,next:null,parent:n,b:n&&n.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(r)try{Xt(i),i.f|=Xr}catch(c){throw te(i),c}else t!==null&&mt(i);if(s){var a=i;if(r&&a.deps===null&&a.teardown===null&&a.nodes_start===null&&a.first===a.last&&(a.f&kt)===0&&(a=a.first),a!==null&&(a.parent=n,n!==null&&Sa(a,n),M!==null&&(M.f&ge)!==0&&(e&wt)===0)){var l=M;(l.effects??=[]).push(a)}}return i}function Ea(){return M!==null&&!Oe}function ts(e){const t=Je(Vr,null,!1);return ce(t,ae),t.teardown=e,t}function bn(e){ba();var t=O.f,r=!M&&(t&Ve)!==0&&(t&Xr)===0;if(r){var s=J;(s.e??=[]).push(e)}else return Sn(e)}function Sn(e){return Je(Yr|Ai,e,!1)}function Ta(e){Re.ensure();const t=Je(wt|kt,e,!0);return(r={})=>new Promise(s=>{r.outro?vt(t,()=>{te(t),s(void 0)}):(te(t),s(void 0))})}function rs(e){return Je(Yr,e,!1)}function Da(e){return Je(mr|kt,e,!0)}function En(e,t=0){return Je(Vr|t,e,!0)}function V(e,t=[],r=[]){dn(t,r,s=>{Je(Vr,()=>e(...s.map(o)),!0)})}function bt(e,t=0){var r=Je(_t|t,e,!0);return r}function le(e,t=!0){return Je(Ve|kt,e,!0,t)}function Tn(e){var t=e.teardown;if(t!==null){const r=St,s=M;Ss(!0),ve(null);try{t.call(null)}finally{Ss(r),ve(s)}}}function Dn(e,t=!1){var r=e.first;for(e.first=e.last=null;r!==null;){const n=r.ac;n!==null&&Sr(()=>{n.abort(Gt)});var s=r.next;(r.f&wt)!==0?r.parent=null:te(r,t),r=s}}function Pa(e){for(var t=e.first;t!==null;){var r=t.next;(t.f&Ve)===0&&te(t),t=r}}function te(e,t=!0){var r=!1;(t||(e.f&Pi)!==0)&&e.nodes_start!==null&&e.nodes_end!==null&&(Aa(e.nodes_start,e.nodes_end),r=!0),Dn(e,t&&!r),pr(e,0),ce(e,yt);var s=e.transitions;if(s!==null)for(const i of s)i.stop();Tn(e);var n=e.parent;n!==null&&n.first!==null&&Pn(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=e.ac=null}function Aa(e,t){for(;e!==null;){var r=e===t?null:tr(e);e.remove(),e=r}}function Pn(e){var t=e.parent,r=e.prev,s=e.next;r!==null&&(r.next=s),s!==null&&(s.prev=r),t!==null&&(t.first===e&&(t.first=s),t.last===e&&(t.last=r))}function vt(e,t){var r=[];ss(e,r,!0),An(r,()=>{te(e),t&&t()})}function An(e,t){var r=e.length;if(r>0){var s=()=>--r||t();for(var n of e)n.out(s)}else t()}function ss(e,t,r){if((e.f&Me)===0){if(e.f^=Me,e.transitions!==null)for(const a of e.transitions)(a.is_global||r)&&t.push(a);for(var s=e.first;s!==null;){var n=s.next,i=(s.f&Nt)!==0||(s.f&Ve)!==0;ss(s,t,i?r:!1),s=n}}}function Er(e){Rn(e,!0)}function Rn(e,t){if((e.f&Me)!==0){e.f^=Me,(e.f&ae)===0&&(ce(e,De),mt(e));for(var r=e.first;r!==null;){var s=r.next,n=(r.f&Nt)!==0||(r.f&Ve)!==0;Rn(r,n?t:!1),r=s}if(e.transitions!==null)for(const i of e.transitions)(i.is_global||t)&&i.in()}}let At=!1;function bs(e){At=e}let St=!1;function Ss(e){St=e}let M=null,Oe=!1;function ve(e){M=e}let O=null;function He(e){O=e}let Ke=null;function In(e){M!==null&&(Ke===null?Ke=[e]:Ke.push(e))}let oe=null,Te=0,Pe=null;function Ra(e){Pe=e}let Cn=1,Jt=0,Ye=Jt;function Es(e){Ye=e}let et=!1;function xn(){return++Cn}function Tr(e){var t=e.f;if((t&De)!==0)return!0;if((t&nt)!==0){var r=e.deps,s=(t&Ie)!==0;if(r!==null){var n,i,a=(t&hr)!==0,l=s&&O!==null&&!et,c=r.length;if((a||l)&&(O===null||(O.f&yt)===0)){var u=e,d=u.parent;for(n=0;n<c;n++)i=r[n],(a||!i?.reactions?.includes(u))&&(i.reactions??=[]).push(u);a&&(u.f^=hr),l&&d!==null&&(d.f&Ie)===0&&(u.f^=Ie)}for(n=0;n<c;n++)if(i=r[n],Tr(i)&&pn(i),i.wv>e.wv)return!0}(!s||O!==null&&!et)&&ce(e,ae)}return!1}function Nn(e,t,r=!0){var s=e.reactions;if(s!==null&&!Ke?.includes(e))for(var n=0;n<s.length;n++){var i=s[n];(i.f&ge)!==0?Nn(i,t,!1):t===i&&(r?ce(i,De):(i.f&ae)!==0&&ce(i,nt),mt(i))}}function kn(e){var t=oe,r=Te,s=Pe,n=M,i=et,a=Ke,l=J,c=Oe,u=Ye,d=e.f;oe=null,Te=0,Pe=null,et=(d&Ie)!==0&&(Oe||!At||M===null),M=(d&(Ve|wt))===0?e:null,Ke=null,Rt(e.ctx),Oe=!1,Ye=++Jt,e.ac!==null&&(Sr(()=>{e.ac.abort(Gt)}),e.ac=null);try{e.f|=Ur;var p=e.fn,v=p(),f=e.deps;if(oe!==null){var g;if(pr(e,Te),f!==null&&Te>0)for(f.length=Te+oe.length,g=0;g<oe.length;g++)f[Te+g]=oe[g];else e.deps=f=oe;if(!et||(d&ge)!==0&&e.reactions!==null)for(g=Te;g<f.length;g++)(f[g].reactions??=[]).push(e)}else f!==null&&Te<f.length&&(pr(e,Te),f.length=Te);if(er()&&Pe!==null&&!Oe&&f!==null&&(e.f&(ge|nt|De))===0)for(g=0;g<Pe.length;g++)Nn(Pe[g],e);return n!==null&&n!==e&&(Jt++,Pe!==null&&(s===null?s=Pe:s.push(...Pe))),(e.f&ht)!==0&&(e.f^=ht),v}catch(S){return on(S)}finally{e.f^=Ur,oe=t,Te=r,Pe=s,M=n,et=i,Ke=a,Rt(l),Oe=c,Ye=u}}function Ia(e,t){let r=t.reactions;if(r!==null){var s=bi.call(r,e);if(s!==-1){var n=r.length-1;n===0?r=t.reactions=null:(r[s]=r[n],r.pop())}}r===null&&(t.f&ge)!==0&&(oe===null||!oe.includes(t))&&(ce(t,nt),(t.f&(Ie|hr))===0&&(t.f^=hr),hn(t),pr(t,0))}function pr(e,t){var r=e.deps;if(r!==null)for(var s=t;s<r.length;s++)Ia(e,r[s])}function Xt(e){var t=e.f;if((t&yt)===0){ce(e,ae);var r=O,s=At;O=e,At=!0;try{(t&_t)!==0?Pa(e):Dn(e),Tn(e);var n=kn(e);e.teardown=typeof n=="function"?n:null,e.wv=Cn;var i;Xs&&ta&&(e.f&De)!==0&&e.deps}finally{At=s,O=r}}}async function Ca(){await Promise.resolve(),aa()}function o(e){var t=e.f,r=(t&ge)!==0;if(M!==null&&!Oe){var s=O!==null&&(O.f&yt)!==0;if(!s&&!Ke?.includes(e)){var n=M.deps;if((M.f&Ur)!==0)e.rv<Jt&&(e.rv=Jt,oe===null&&n!==null&&n[Te]===e?Te++:oe===null?oe=[e]:(!et||!oe.includes(e))&&oe.push(e));else{(M.deps??=[]).push(e);var i=e.reactions;i===null?e.reactions=[M]:i.includes(M)||i.push(M)}}}else if(r&&e.deps===null&&e.effects===null){var a=e,l=a.parent;l!==null&&(l.f&Ie)===0&&(a.f^=Ie)}if(St){if(rt.has(e))return rt.get(e);if(r){a=e;var c=a.v;return((a.f&ae)===0&&a.reactions!==null||$n(a))&&(c=es(a)),rt.set(a,c),c}}else r&&(a=e,Tr(a)&&pn(a));if((e.f&ht)!==0)throw e.v;return e.v}function $n(e){if(e.v===F)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(rt.has(t)||(t.f&ge)!==0&&$n(t))return!0;return!1}function rr(e){var t=Oe;try{return Oe=!0,e()}finally{Oe=t}}const xa=-7169;function ce(e,t){e.f=e.f&xa|t}function Na(e){return e.endsWith("capture")&&e!=="gotpointercapture"&&e!=="lostpointercapture"}const ka=["beforeinput","click","change","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"];function $a(e){return ka.includes(e)}const Oa={formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly",defaultvalue:"defaultValue",defaultchecked:"defaultChecked",srcobject:"srcObject",novalidate:"noValidate",allowfullscreen:"allowFullscreen",disablepictureinpicture:"disablePictureInPicture",disableremoteplayback:"disableRemotePlayback"};function Ma(e){return e=e.toLowerCase(),Oa[e]??e}const qa=["touchstart","touchmove"];function Ba(e){return qa.includes(e)}const On=new Set,Qr=new Set;function ns(e,t,r,s={}){function n(i){if(s.capture||Qt.call(t,i),!i.cancelBubble)return Sr(()=>r?.call(this,i))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?gt(()=>{t.addEventListener(e,n,s)}):t.addEventListener(e,n,s),n}function Wr(e,t,r,s={}){var n=ns(t,e,r,s);return()=>{e.removeEventListener(t,n,s)}}function $r(e,t,r,s,n){var i={capture:s,passive:n},a=ns(e,t,r,i);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&ts(()=>{t.removeEventListener(e,a,i)})}function K(e){for(var t=0;t<e.length;t++)On.add(e[t]);for(var r of Qr)r(e)}let Ts=null;function Qt(e){var t=this,r=t.ownerDocument,s=e.type,n=e.composedPath?.()||[],i=n[0]||e.target;Ts=e;var a=0,l=Ts===e&&e.__root;if(l){var c=n.indexOf(l);if(c!==-1&&(t===document||t===window)){e.__root=t;return}var u=n.indexOf(t);if(u===-1)return;c<=u&&(a=c)}if(i=n[a]||e.target,i!==t){Lr(e,"currentTarget",{configurable:!0,get(){return i||r}});var d=M,p=O;ve(null),He(null);try{for(var v,f=[];i!==null;){var g=i.assignedSlot||i.parentNode||i.host||null;try{var S=i["__"+s];if(S!=null&&(!i.disabled||e.target===i))if(Ft(S)){var[b,...E]=S;b.apply(i,[e,...E])}else S.call(i,e)}catch(R){v?f.push(R):v=R}if(e.cancelBubble||g===t||g===null)break;i=g}if(v){for(let R of f)queueMicrotask(()=>{throw R});throw v}}finally{e.__root=t,delete e.currentTarget,ve(d),He(p)}}}function Mn(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function Zt(e,t){var r=O;r.nodes_start===null&&(r.nodes_start=e,r.nodes_end=t)}function k(e,t){var r=(t&Gi)!==0,s=(t&Ki)!==0,n,i=!e.startsWith("<!>");return()=>{n===void 0&&(n=Mn(i?e:"<!>"+e),r||(n=xt(n)));var a=s||gn?document.importNode(n,!0):n.cloneNode(!0);if(r){var l=xt(a),c=a.lastChild;Zt(l,c)}else Zt(a,a);return a}}function ja(e,t,r="svg"){var s=!e.startsWith("<!>"),n=`<${r}>${s?e:"<!>"+e}</${r}>`,i;return()=>{if(!i){var a=Mn(n),l=xt(a);i=xt(l)}var c=i.cloneNode(!0);return Zt(c,c),c}}function La(e,t){return ja(e,t,"svg")}function de(){var e=document.createDocumentFragment(),t=document.createComment(""),r=Ot();return e.append(t,r),Zt(t,r),e}function C(e,t){e!==null&&e.before(t)}function q(e,t){var r=t==null?"":typeof t=="object"?t+"":t;r!==(e.__t??=e.nodeValue)&&(e.__t=r,e.nodeValue=r+"")}function Ua(e,t){return Ha(e,t)}const Dt=new Map;function Ha(e,{target:t,anchor:r,props:s={},events:n,context:i,intro:a=!0}){ma();var l=new Set,c=p=>{for(var v=0;v<p.length;v++){var f=p[v];if(!l.has(f)){l.add(f);var g=Ba(f);t.addEventListener(f,Qt,{passive:g});var S=Dt.get(f);S===void 0?(document.addEventListener(f,Qt,{passive:g}),Dt.set(f,1)):Dt.set(f,S+1)}}};c(Gr(On)),Qr.add(c);var u=void 0,d=Ta(()=>{var p=r??t.appendChild(Ot());return ca(p,{pending:()=>{}},v=>{if(i){me({});var f=J;f.c=i}n&&(s.$$events=n),u=e(v,s)||{},i&&_e()}),()=>{for(var v of l){t.removeEventListener(v,Qt);var f=Dt.get(v);--f===0?(document.removeEventListener(v,Qt),Dt.delete(v)):Dt.set(v,f)}Qr.delete(c),p!==r&&p.parentNode?.removeChild(p)}});return za.set(u,d),u}let za=new WeakMap;function H(e,t,r=!1){var s=e,n=null,i=null,a=F,l=r?Nt:0,c=!1;const u=(f,g=!0)=>{c=!0,v(g,f)};var d=null;function p(){d!==null&&(d.lastChild.remove(),s.before(d),d=null);var f=a?n:i,g=a?i:n;f&&Er(f),g&&vt(g,()=>{a?i=null:n=null})}const v=(f,g)=>{if(a!==(a=f)){var S=wn(),b=s;if(S&&(d=document.createDocumentFragment(),d.append(b=Ot())),a?n??=g&&le(()=>g(b)):i??=g&&le(()=>g(b)),S){var E=W,R=a?n:i,I=a?i:n;R&&E.skipped_effects.delete(R),I&&E.skipped_effects.add(I),E.add_callback(p)}else p()}};bt(()=>{c=!1,t(u),c||v(null,null)},l)}function Yt(e,t){return t}function Qa(e,t,r){for(var s=e.items,n=[],i=t.length,a=0;a<i;a++)ss(t[a].e,n,!0);var l=i>0&&n.length===0&&r!==null;if(l){var c=r.parentNode;_a(c),c.append(r),s.clear(),Be(e,t[0].prev,t[i-1].next)}An(n,()=>{for(var u=0;u<i;u++){var d=t[u];l||(s.delete(d.k),Be(e,d.prev,d.next)),te(d.e,!l)}})}function dt(e,t,r,s,n,i=null){var a=e,l={flags:t,items:new Map,first:null},c=(t&rn)!==0;if(c){var u=e;a=u.appendChild(Ot())}var d=null,p=!1,v=new Map,f=Fr(()=>{var E=r();return Ft(E)?E:E==null?[]:Gr(E)}),g,S;function b(){Wa(S,g,l,v,a,n,t,s,r),i!==null&&(g.length===0?d?Er(d):d=le(()=>i(a)):d!==null&&vt(d,()=>{d=null}))}bt(()=>{S??=O,g=o(f);var E=g.length;if(!(p&&E===0)){p=E===0;var R,I,D,y;if(wn()){var T=new Set,x=W;for(I=0;I<E;I+=1){D=g[I],y=s(D,I);var $=l.items.get(y)??v.get(y);$?(t&(_r|wr))!==0&&qn($,D,I,t):(R=Bn(null,l,null,null,D,y,I,n,t,r,!0),v.set(y,R)),T.add(y)}for(const[re,we]of l.items)T.has(re)||x.skipped_effects.add(we.e);x.add_callback(b)}else b();o(f)}})}function Wa(e,t,r,s,n,i,a,l,c){var u=(a&ji)!==0,d=(a&(_r|wr))!==0,p=t.length,v=r.items,f=r.first,g=f,S,b=null,E,R=[],I=[],D,y,T,x;if(u)for(x=0;x<p;x+=1)D=t[x],y=l(D,x),T=v.get(y),T!==void 0&&(T.a?.measure(),(E??=new Set).add(T));for(x=0;x<p;x+=1){if(D=t[x],y=l(D,x),T=v.get(y),T===void 0){var $=s.get(y);if($!==void 0){s.delete(y),v.set(y,$);var re=b?b.next:g;Be(r,b,$),Be(r,$,re),Or($,re,n),b=$}else{var we=g?g.e.nodes_start:n;b=Bn(we,r,b,b===null?r.first:b.next,D,y,x,i,a,c)}v.set(y,b),R=[],I=[],g=b.next;continue}if(d&&qn(T,D,x,a),(T.e.f&Me)!==0&&(Er(T.e),u&&(T.a?.unfix(),(E??=new Set).delete(T))),T!==g){if(S!==void 0&&S.has(T)){if(R.length<I.length){var j=I[0],z;b=j.prev;var se=R[0],Ce=R[R.length-1];for(z=0;z<R.length;z+=1)Or(R[z],j,n);for(z=0;z<I.length;z+=1)S.delete(I[z]);Be(r,se.prev,Ce.next),Be(r,b,se),Be(r,Ce,j),g=j,b=Ce,x-=1,R=[],I=[]}else S.delete(T),Or(T,g,n),Be(r,T.prev,T.next),Be(r,T,b===null?r.first:b.next),Be(r,b,T),b=T;continue}for(R=[],I=[];g!==null&&g.k!==y;)(g.e.f&Me)===0&&(S??=new Set).add(g),I.push(g),g=g.next;if(g===null)continue;T=g}R.push(T),b=T,g=T.next}if(g!==null||S!==void 0){for(var ne=S===void 0?[]:Gr(S);g!==null;)(g.e.f&Me)===0&&ne.push(g),g=g.next;var fe=ne.length;if(fe>0){var xe=(a&rn)!==0&&p===0?n:null;if(u){for(x=0;x<fe;x+=1)ne[x].a?.measure();for(x=0;x<fe;x+=1)ne[x].a?.fix()}Qa(r,ne,xe)}}u&&gt(()=>{if(E!==void 0)for(T of E)T.a?.apply()}),e.first=r.first&&r.first.e,e.last=b&&b.e;for(var L of s.values())te(L.e);s.clear()}function qn(e,t,r,s){(s&_r)!==0&&Ct(e.v,t),(s&wr)!==0?Ct(e.i,r):e.i=r}function Bn(e,t,r,s,n,i,a,l,c,u,d){var p=(c&_r)!==0,v=(c&Li)===0,f=p?v?va(n,!1,!1):st(n):n,g=(c&wr)===0?a:st(a),S={i:g,v:f,k:i,a:null,e:null,prev:r,next:s};try{if(e===null){var b=document.createDocumentFragment();b.append(e=Ot())}return S.e=le(()=>l(e,f,g,u),Fi),S.e.prev=r&&r.e,S.e.next=s&&s.e,r===null?d||(t.first=S):(r.next=S,r.e.next=S.e),s!==null&&(s.prev=S,s.e.prev=S.e),S}finally{}}function Or(e,t,r){for(var s=e.next?e.next.e.nodes_start:r,n=t?t.e.nodes_start:r,i=e.e.nodes_start;i!==null&&i!==s;){var a=tr(i);n.before(i),i=a}}function Be(e,t,r){t===null?e.first=r:(t.next=r,t.e.next=r&&r.e),r!==null&&(r.prev=t,r.e.prev=t&&t.e)}function Xe(e,t,...r){var s=e,n=qe,i;bt(()=>{n!==(n=t())&&(i&&(te(i),i=null),i=le(()=>n(s,...r)))},Nt)}function Ga(e,t,r,s,n,i){var a,l,c=null,u=e,d;bt(()=>{const p=t()||null;var v=Vi;p!==a&&(d&&(p===null?vt(d,()=>{d=null,l=null}):p===l?Er(d):te(d)),p&&p!==l&&(d=le(()=>{if(c=document.createElementNS(v,p),Zt(c,c),s){var f=c.appendChild(Ot());s(c,f)}O.nodes_end=c,u.before(c)})),a=p,a&&(l=a))},Nt)}function Ka(e,t){var r=void 0,s;bt(()=>{r!==(r=t())&&(s&&(te(s),s=null),r&&(s=le(()=>{rs(()=>r(e))})))})}function jn(e){var t,r,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var n=e.length;for(t=0;t<n;t++)e[t]&&(r=jn(e[t]))&&(s&&(s+=" "),s+=r)}else for(r in e)e[r]&&(s&&(s+=" "),s+=r);return s}function Ya(){for(var e,t,r=0,s="",n=arguments.length;r<n;r++)(e=arguments[r])&&(t=jn(e))&&(s&&(s+=" "),s+=t);return s}function Va(e){return typeof e=="object"?Ya(e):e??""}const Ds=[...` 	
\r\f \v\uFEFF`];function Ja(e,t,r){var s=e==null?"":""+e;if(t&&(s=s?s+" "+t:t),r){for(var n in r)if(r[n])s=s?s+" "+n:n;else if(s.length)for(var i=n.length,a=0;(a=s.indexOf(n,a))>=0;){var l=a+i;(a===0||Ds.includes(s[a-1]))&&(l===s.length||Ds.includes(s[l]))?s=(a===0?"":s.substring(0,a))+s.substring(l+1):a=l}}return s===""?null:s}function Ps(e,t=!1){var r=t?" !important;":";",s="";for(var n in e){var i=e[n];i!=null&&i!==""&&(s+=" "+n+": "+i+r)}return s}function Mr(e){return e[0]!=="-"||e[1]!=="-"?e.toLowerCase():e}function Xa(e,t){if(t){var r="",s,n;if(Array.isArray(t)?(s=t[0],n=t[1]):s=t,e){e=String(e).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var i=!1,a=0,l=!1,c=[];s&&c.push(...Object.keys(s).map(Mr)),n&&c.push(...Object.keys(n).map(Mr));var u=0,d=-1;const S=e.length;for(var p=0;p<S;p++){var v=e[p];if(l?v==="/"&&e[p-1]==="*"&&(l=!1):i?i===v&&(i=!1):v==="/"&&e[p+1]==="*"?l=!0:v==='"'||v==="'"?i=v:v==="("?a++:v===")"&&a--,!l&&i===!1&&a===0){if(v===":"&&d===-1)d=p;else if(v===";"||p===S-1){if(d!==-1){var f=Mr(e.substring(u,d).trim());if(!c.includes(f)){v!==";"&&p++;var g=e.substring(u,p).trim();r+=" "+g+";"}}u=p+1,d=-1}}}}return s&&(r+=Ps(s)),n&&(r+=Ps(n,!0)),r=r.trim(),r===""?null:r}return e==null?null:String(e)}function vr(e,t,r,s,n,i){var a=e.__className;if(a!==r||a===void 0){var l=Ja(r,s,i);l==null?e.removeAttribute("class"):t?e.className=l:e.setAttribute("class",l),e.__className=r}else if(i&&n!==i)for(var c in i){var u=!!i[c];(n==null||u!==!!n[c])&&e.classList.toggle(c,u)}return i}function qr(e,t={},r,s){for(var n in r){var i=r[n];t[n]!==i&&(r[n]==null?e.style.removeProperty(n):e.style.setProperty(n,i,s))}}function Za(e,t,r,s){var n=e.__style;if(n!==t){var i=Xa(t,s);i==null?e.removeAttribute("style"):e.style.cssText=i,e.__style=t}else s&&(Array.isArray(s)?(qr(e,r?.[0],s[0]),qr(e,r?.[1],s[1],"important")):qr(e,r,s));return s}function gr(e,t,r=!1){if(e.multiple){if(t==null)return;if(!Ft(t))return Xi();for(var s of e.options)s.selected=t.includes(Vt(s));return}for(s of e.options){var n=Vt(s);if(ga(n,t)){s.selected=!0;return}}(!r||t!==void 0)&&(e.selectedIndex=-1)}function Ln(e){var t=new MutationObserver(()=>{gr(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),ts(()=>{t.disconnect()})}function Fa(e,t,r=t){var s=!0;yn(e,"change",n=>{var i=n?"[selected]":":checked",a;if(e.multiple)a=[].map.call(e.querySelectorAll(i),Vt);else{var l=e.querySelector(i)??e.querySelector("option:not([disabled])");a=l&&Vt(l)}r(a)}),rs(()=>{var n=t();if(gr(e,n,s),s&&n===void 0){var i=e.querySelector(":checked");i!==null&&(n=Vt(i),r(n))}e.__value=n,s=!1}),Ln(e)}function Vt(e){return"__value"in e?e.__value:e.value}const Ut=Symbol("class"),Ht=Symbol("style"),Un=Symbol("is custom element"),Hn=Symbol("is html");function eo(e,t){t?e.hasAttribute("selected")||e.setAttribute("selected",""):e.removeAttribute("selected")}function As(e,t,r,s){var n=zn(e);n[t]!==(n[t]=r)&&(t==="loading"&&(e[Ri]=r),r==null?e.removeAttribute(t):typeof r!="string"&&Qn(e).includes(t)?e[t]=r:e.setAttribute(t,r))}function to(e,t,r,s,n=!1,i=!1){var a=zn(e),l=a[Un],c=!a[Hn],u=t||{},d=e.tagName==="OPTION";for(var p in t)p in r||(r[p]=null);r.class?r.class=Va(r.class):r[Ut]&&(r.class=null),r[Ht]&&(r.style??=null);var v=Qn(e);for(const D in r){let y=r[D];if(d&&D==="value"&&y==null){e.value=e.__value="",u[D]=y;continue}if(D==="class"){var f=e.namespaceURI==="http://www.w3.org/1999/xhtml";vr(e,f,y,s,t?.[Ut],r[Ut]),u[D]=y,u[Ut]=r[Ut];continue}if(D==="style"){Za(e,y,t?.[Ht],r[Ht]),u[D]=y,u[Ht]=r[Ht];continue}var g=u[D];if(!(y===g&&!(y===void 0&&e.hasAttribute(D)))){u[D]=y;var S=D[0]+D[1];if(S!=="$$")if(S==="on"){const T={},x="$$"+D;let $=D.slice(2);var b=$a($);if(Na($)&&($=$.slice(0,-7),T.capture=!0),!b&&g){if(y!=null)continue;e.removeEventListener($,u[x],T),u[x]=null}if(y!=null)if(b)e[`__${$}`]=y,K([$]);else{let re=function(we){u[D].call(this,we)};var I=re;u[x]=ns($,e,re,T)}else b&&(e[`__${$}`]=void 0)}else if(D==="style")As(e,D,y);else if(D==="autofocus")wa(e,!!y);else if(!l&&(D==="__value"||D==="value"&&y!=null))e.value=e.__value=y;else if(D==="selected"&&d)eo(e,y);else{var E=D;c||(E=Ma(E));var R=E==="defaultValue"||E==="defaultChecked";if(y==null&&!l&&!R)if(a[D]=null,E==="value"||E==="checked"){let T=e;const x=t===void 0;if(E==="value"){let $=T.defaultValue;T.removeAttribute(E),T.defaultValue=$,T.value=T.__value=x?$:null}else{let $=T.defaultChecked;T.removeAttribute(E),T.defaultChecked=$,T.checked=x?$:!1}}else e.removeAttribute(D);else R||v.includes(E)&&(l||typeof y!="string")?(e[E]=y,E in a&&(a[E]=F)):typeof y!="function"&&As(e,E,y)}}}return u}function Rs(e,t,r=[],s=[],n,i=!1,a=!1){dn(r,s,l=>{var c=void 0,u={},d=e.nodeName==="SELECT",p=!1;if(bt(()=>{var f=t(...l.map(o)),g=to(e,c,f,n,i,a);p&&d&&"value"in f&&gr(e,f.value);for(let b of Object.getOwnPropertySymbols(u))f[b]||te(u[b]);for(let b of Object.getOwnPropertySymbols(f)){var S=f[b];b.description===Ji&&(!c||S!==c[b])&&(u[b]&&te(u[b]),u[b]=le(()=>Ka(e,()=>S))),g[b]=S}c=g}),d){var v=e;rs(()=>{gr(v,c.value,!0),Ln(v)})}p=!0})}function zn(e){return e.__attributes??={[Un]:e.nodeName.includes("-"),[Hn]:e.namespaceURI===Yi}}var Is=new Map;function Qn(e){var t=e.getAttribute("is")||e.nodeName,r=Is.get(t);if(r)return r;Is.set(t,r=[]);for(var s,n=e,i=Element.prototype;i!==n;){s=Si(n);for(var a in s)s[a].set&&r.push(a);n=Kr(n)}return r}function lt(e,t,r=t){var s=new WeakSet;yn(e,"input",async n=>{var i=n?e.defaultValue:e.value;if(i=Br(e)?jr(i):i,r(i),W!==null&&s.add(W),await Ca(),i!==(i=t())){var a=e.selectionStart,l=e.selectionEnd;e.value=i??"",l!==null&&(e.selectionStart=a,e.selectionEnd=Math.min(l,e.value.length))}}),rr(t)==null&&e.value&&(r(Br(e)?jr(e.value):e.value),W!==null&&s.add(W)),En(()=>{var n=t();if(e===document.activeElement){var i=fr??W;if(s.has(i))return}Br(e)&&n===jr(e.value)||e.type==="date"&&!n&&!e.value||n!==e.value&&(e.value=n??"")})}function Br(e){var t=e.type;return t==="number"||t==="range"}function jr(e){return e===""?null:+e}let cr=!1;function ro(e){var t=cr;try{return cr=!1,[e(),cr]}finally{cr=t}}const so={get(e,t){if(!e.exclude.includes(t))return e.props[t]},set(e,t){return!1},getOwnPropertyDescriptor(e,t){if(!e.exclude.includes(t)&&t in e.props)return{enumerable:!0,configurable:!0,value:e.props[t]}},has(e,t){return e.exclude.includes(t)?!1:t in e.props},ownKeys(e){return Reflect.ownKeys(e.props).filter(t=>!e.exclude.includes(t))}};function Ze(e,t,r){return new Proxy({props:e,exclude:t},so)}const no={get(e,t){let r=e.props.length;for(;r--;){let s=e.props[r];if(Lt(s)&&(s=s()),typeof s=="object"&&s!==null&&t in s)return s[t]}},set(e,t,r){let s=e.props.length;for(;s--;){let n=e.props[s];Lt(n)&&(n=n());const i=tt(n,t);if(i&&i.set)return i.set(r),!0}return!1},getOwnPropertyDescriptor(e,t){let r=e.props.length;for(;r--;){let s=e.props[r];if(Lt(s)&&(s=s()),typeof s=="object"&&s!==null&&t in s){const n=tt(s,t);return n&&!n.configurable&&(n.configurable=!0),n}}},has(e,t){if(t===pt||t===en)return!1;for(let r of e.props)if(Lt(r)&&(r=r()),r!=null&&t in r)return!0;return!1},ownKeys(e){const t=[];for(let r of e.props)if(Lt(r)&&(r=r()),!!r){for(const s in r)t.includes(s)||t.push(s);for(const s of Object.getOwnPropertySymbols(r))t.includes(s)||t.push(s)}return t}};function it(...e){return new Proxy({props:e},no)}function Ge(e,t,r,s){var n=!$t||(r&Hi)!==0,i=(r&Qi)!==0,a=(r&Wi)!==0,l=s,c=!0,u=()=>(c&&(c=!1,l=a?rr(s):s),l),d;if(i){var p=pt in e||en in e;d=tt(e,t)?.set??(p&&t in e?I=>e[t]=I:void 0)}var v,f=!1;i?[v,f]=ro(()=>e[t]):v=e[t],v===void 0&&s!==void 0&&(v=u(),d&&(n&&$i(),d(v)));var g;if(n?g=()=>{var I=e[t];return I===void 0?u():(c=!0,I)}:g=()=>{var I=e[t];return I!==void 0&&(l=void 0),I===void 0?l:I},n&&(r&zi)===0)return g;if(d){var S=e.$$legacy;return(function(I,D){return arguments.length>0?((!n||!D||S||f)&&d(D?g():I),I):g()})}var b=!1,E=((r&Ui)!==0?br:Fr)(()=>(b=!1,g()));i&&o(E);var R=O;return(function(I,D){if(arguments.length>0){const y=D?o(E):n&&i?pe(I):I;return h(E,y),b=!0,l!==void 0&&(l=y),I}return St&&b||(R.f&yt)!==0?E.v:o(E)})}function is(e){J===null&&tn(),$t&&J.l!==null?ao(J).m.push(e):bn(()=>{const t=rr(e);if(typeof t=="function")return t})}function io(e){J===null&&tn(),is(()=>()=>rr(e))}function ao(e){var t=e.l;return t.u??={a:[],b:[],m:[]}}const oo="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(oo);const lo="modulepreload",co=function(e){return"/"+e},Cs={},xs=function(t,r,s){let n=Promise.resolve();if(r&&r.length>0){let u=function(d){return Promise.all(d.map(p=>Promise.resolve(p).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};var a=u;document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");n=u(r.map(d=>{if(d=co(d),d in Cs)return;Cs[d]=!0;const p=d.endsWith(".css"),v=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${v}`))return;const f=document.createElement("link");if(f.rel=p?"stylesheet":lo,p||(f.as="script"),f.crossOrigin="",f.href=d,c&&f.setAttribute("nonce",c),document.head.appendChild(f),p)return new Promise((g,S)=>{f.addEventListener("load",g),f.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return n.then(l=>{for(const c of l||[])c.status==="rejected"&&i(c.reason);return t().catch(i)})};class Pt extends Map{#e=new Map;#t=A(0);#r=A(0);#a=Ye||-1;constructor(t){if(super(),t){for(var[r,s]of t)super.set(r,s);this.#r.v=super.size}}#u(t){return Ye===this.#a?A(t):st(t)}has(t){var r=this.#e,s=r.get(t);if(s===void 0){var n=super.get(t);if(n!==void 0)s=this.#u(0),r.set(t,s);else return o(this.#t),!1}return o(s),!0}forEach(t,r){this.#l(),super.forEach(t,r)}get(t){var r=this.#e,s=r.get(t);if(s===void 0){var n=super.get(t);if(n!==void 0)s=this.#u(0),r.set(t,s);else{o(this.#t);return}}return o(s),super.get(t)}set(t,r){var s=this.#e,n=s.get(t),i=super.get(t),a=super.set(t,r),l=this.#t;if(n===void 0)n=this.#u(0),s.set(t,n),h(this.#r,super.size),Le(l);else if(i!==r){Le(n);var c=l.reactions===null?null:new Set(l.reactions),u=c===null||!n.reactions?.every(d=>c.has(d));u&&Le(l)}return a}delete(t){var r=this.#e,s=r.get(t),n=super.delete(t);return s!==void 0&&(r.delete(t),h(this.#r,super.size),h(s,-1),Le(this.#t)),n}clear(){if(super.size!==0){super.clear();var t=this.#e;h(this.#r,0);for(var r of t.values())h(r,-1);Le(this.#t),t.clear()}}#l(){o(this.#t);var t=this.#e;if(this.#r.v!==t.size){for(var r of super.keys())if(!t.has(r)){var s=this.#u(0);t.set(r,s)}}for([,s]of this.#e)o(s)}keys(){return o(this.#t),super.keys()}values(){return this.#l(),super.values()}entries(){return this.#l(),super.entries()}[Symbol.iterator](){return this.entries()}get size(){return o(this.#r),super.size}}class uo{#e;#t;constructor(t,r){this.#e=t,this.#t=Zr(r)}get current(){return this.#t(),this.#e()}}const fo=/\(.+\)/,ho=new Set(["all","print","screen","and","or","not","only"]);class po extends uo{constructor(t,r){let s=fo.test(t)||t.split(/[\s,]+/).some(i=>ho.has(i.trim()))?t:`(${t})`;const n=window.matchMedia(s);super(()=>n.matches,i=>Wr(n,"change",i))}}const vo=typeof window<"u"?window:void 0;function go(e){let t=e.activeElement;for(;t?.shadowRoot;){const r=t.shadowRoot.activeElement;if(r===t)break;t=r}return t}class mo{#e;#t;constructor(t={}){const{window:r=vo,document:s=r?.document}=t;r!==void 0&&(this.#e=s,this.#t=Zr(n=>{const i=Wr(r,"focusin",n),a=Wr(r,"focusout",n);return()=>{i(),a()}}))}get current(){return this.#t?.(),this.#e?go(this.#e):null}}new mo;function _o(e){return typeof e=="function"}function wo(e,t){if(_o(e)){const s=e();return s===void 0?t:s}return e===void 0?t:e}function yo(e,t){let r=A(null);const s=Q(()=>wo(t,250));function n(...i){if(o(r))o(r).timeout&&clearTimeout(o(r).timeout);else{let a,l;const c=new Promise((u,d)=>{a=u,l=d});h(r,{timeout:null,runner:null,promise:c,resolve:a,reject:l},!0)}return o(r).runner=async()=>{if(!o(r))return;const a=o(r);h(r,null);try{a.resolve(await e.apply(this,i))}catch(l){a.reject(l)}},o(r).timeout=setTimeout(o(r).runner,o(s)),o(r).promise}return n.cancel=async()=>{(!o(r)||o(r).timeout===null)&&(await new Promise(i=>setTimeout(i,0)),!o(r)||o(r).timeout===null)||(clearTimeout(o(r).timeout),o(r).reject("Cancelled"),h(r,null))},n.runScheduledNow=async()=>{(!o(r)||!o(r).timeout)&&(await new Promise(i=>setTimeout(i,0)),!o(r)||!o(r).timeout)||(clearTimeout(o(r).timeout),o(r).timeout=null,await o(r).runner?.())},Object.defineProperty(n,"pending",{enumerable:!0,get(){return!!o(r)?.timeout}}),n}function Ue(e){if(!e?.trim())return null;try{return JSON.parse(e)}catch(t){return console.warn("[ProductsStore] Erreur parsing JSON:",t),null}}function Dr(e){return e?.length?e.filter(t=>t.quantity!=null&&t.unit).map(t=>({q:typeof t.quantity=="number"?t.quantity:parseFloat(t.quantity),u:t.unit})).filter(t=>!isNaN(t.q)):[]}function Pr(e){if(!e?.length)return[];const t=new Map;return e.forEach(r=>{if(!r.q||!r.u||typeof r.q!="number"||isNaN(r.q))return;const s=t.get(r.u)||0;t.set(r.u,s+r.q)}),Array.from(t.entries()).map(([r,s])=>({q:s,u:r}))}function Ar(e,t){if(!e?.length)return{numeric:[],display:"✅ Complet"};if(!t?.length){const l=e.map(c=>ft(c.q.toString(),c.u)).join(" et ");return{numeric:e,display:l}}const r=new Map,s=new Map;e.forEach(l=>{const c=parseFloat(l.q);isNaN(c)||r.set(l.u,(r.get(l.u)||0)+c)}),t.forEach(l=>{s.set(l.u,(s.get(l.u)||0)+l.q)});const n=[],i=[];r.forEach((l,c)=>{const u=s.get(c)||0,d=l-u;d>0&&(n.push({q:d,u:c}),i.push(ft(d.toString(),c)))});const a=i.length>0?i.join(" et "):"✅ Complet";return{numeric:n,display:a}}function ue(e){return e?.length?e.map(t=>ft(t.q.toString(),t.u)).join(" et "):"-"}function ft(e,t){const r=parseFloat(e);if(isNaN(r))return`${e} ${t}`;if((t==="gr."||t==="ml")&&r>=1e3){const s=r/1e3,n=t==="gr."?"kg":"l.";let a=(Math.round(s*100)/100).toString();return a.endsWith(",0")&&(a=a.slice(0,-2)),a.endsWith(",00")&&(a=a.slice(0,-3)),`${a} ${n}`}if(!["gr.","ml","kg","l."].includes(t)){let n=(Math.round(r*10)/10).toString();return n.endsWith(",0")&&(n=n.slice(0,-2)),`${n} ${t}`}return`${r} ${t}`}function as(e){if(!e?.length)return[];const t=new Map;return e.forEach(({q:r,u:s})=>{if(typeof r=="number"&&!isNaN(r)){const n=t.get(s)||0;t.set(s,n+r)}}),Array.from(t.entries()).map(([r,s])=>({q:s,u:r}))}function bo(e){return e?Object.values(e).some(t=>t.recipes?.some(r=>r.q!==void 0||r.u!==void 0)):!1}function os(e){if(!e)return[];const t=Object.values(e).flatMap(r=>r.totalConsolidated);return as(t)}function Wn(e,t){const r=new Map,s=new Map;e.forEach(({q:a,u:l})=>{r.set(l,(r.get(l)||0)+a)}),t.forEach(({q:a,u:l})=>{s.set(l,(s.get(l)||0)+a)});const n=[],i=new Set([...r.keys(),...s.keys()]);for(const a of i){const l=r.get(a)||0,c=s.get(a)||0,u=l-c;Math.abs(u)>.001&&n.push({q:u,u:a})}return n}function ls(e){if(!e?.length)return"Équilibré";const t=e.filter(s=>s.q>0),r=e.filter(s=>s.q<0);if(t.length>0&&r.length>0){const s=t.map(i=>ft(i.q.toString(),i.u)).join(" et "),n=r.map(i=>ft(Math.abs(i.q).toString(),i.u)).join(" et ");return`${s} disponibles, ${n} manquant${r.length>1?"s":""}`}else return t.length>0?t.map(s=>"+"+ft(s.q.toString(),s.u)).join(" et ")+" disponibles":r.length>0?r.map(s=>ft(Math.abs(s.q).toString(),s.u)).join(" et ")+` manquant${r.length>1?"s":""}`:"Équilibré"}function So(e,t){if(t.searchQuery.trim()){const r=t.searchQuery.toLowerCase();if(!e.productName.toLowerCase().includes(r))return!1}return!(t.selectedStores.length>0&&(!e.storeInfo?.storeName||!t.selectedStores.includes(e.storeInfo.storeName))||t.selectedWho.length>0&&(!e.who||!e.who.some(r=>t.selectedWho.includes(r)))||t.selectedProductTypes.length>0&&(!e.productType||!t.selectedProductTypes.includes(e.productType))||t.selectedTemperatures.length>0&&!(t.selectedTemperatures.includes("frais")&&e.pFrais||t.selectedTemperatures.includes("surgele")&&e.pSurgel))}function Ns(e){return{...e,products:e.products?.map(t=>typeof t=="string"?t:t.$id)||[],mainId:e.mainId}}function Eo(e){const t=Ue(e.specs)??null,r=Pr(Dr(e.purchases??[]));let s=[];t?.quantity&&(s=[t.quantity]);const{numeric:n,display:i}=Ar(s,r),a=Ue(e.stockReel)??null,l=ue(r),c=e.store?Ue(e.store):null,u=a?`${a.quantity} ${a.unit}`:l;return{$id:e.$id,$createdAt:e.$createdAt,$updatedAt:e.$updatedAt,productHugoUuid:e.productHugoUuid||"",productName:e.productName,productType:e.productType||"none",pFrais:t?.pFrais??!1,pSurgel:t?.pSurgel??!1,nbRecipes:0,totalAssiettes:0,isSynced:e.isSynced,mainId:e.mainId,totalNeededRaw:[],status:e.status,who:e.who,store:e.store,stockReel:e.stockReel,previousNames:e.previousNames,isMerged:e.isMerged,mergedFrom:e.mergedFrom,mergeDate:e.mergeDate,mergeReason:e.mergeReason,mergedInto:e.mergedInto,totalNeededOverride:e.totalNeededOverride,purchases:e.purchases,specs:e.specs,byDate:{},storeInfo:c,stockParsed:a,specsParsed:t,totalNeededArray:s,totalPurchasesArray:r,missingQuantityArray:n,stockOrTotalPurchases:u,displayTotalNeeded:ue(s),displayTotalPurchases:l,displayMissingQuantity:i,totalNeededOverrideParsed:Ue(e.totalNeededOverride),displayTotalOverride:(()=>{const d=Ue(e.totalNeededOverride);return d?ue([d.totalOverride]):""})()}}function ur(e,t){const r=e.purchases??t.purchases,s=e.specs??t.specs,n=s?Ue(s):t.specsParsed,i=Pr(Dr(r??[])),a=ue(i);let l=t.totalNeededArray;!t.productHugoUuid&&n?.quantity&&(l=[n.quantity]);const{numeric:c,display:u}=Ar(l,i),d=e.stockReel??t.stockReel,p=d?Ue(d):t.stockParsed,v=e.store??t.store,f=v?Ue(v):t.storeInfo,g=p?`${p.quantity} ${p.unit}`:a;return e.purchases===void 0&&t.purchases?.length&&console.log(`[ProductsStore] Fusion intelligente : préservation de ${t.purchases.length} purchases pour ${t.productName}`),{...t,$updatedAt:e.$updatedAt,productName:e.productName??t.productName,productType:e.productType??t.productType,isSynced:e.isSynced??t.isSynced,mainId:e.mainId??t.mainId,pFrais:n?.pFrais??t.pFrais,pSurgel:n?.pSurgel??t.pSurgel,status:e.status??t.status,who:e.who??t.who,store:v,stockReel:d,specs:s,purchases:r,previousNames:e.previousNames??t.previousNames,isMerged:e.isMerged??t.isMerged,mergedFrom:e.mergedFrom??t.mergedFrom,mergeDate:e.mergeDate??t.mergeDate,mergeReason:e.mergeReason??t.mergeReason,mergedInto:e.mergedInto??t.mergedInto,totalNeededOverride:e.totalNeededOverride??t.totalNeededOverride,storeInfo:f,stockParsed:p,specsParsed:n,totalNeededArray:l,totalPurchasesArray:i,missingQuantityArray:c,stockOrTotalPurchases:g,displayTotalPurchases:a,displayMissingQuantity:u,displayTotalNeeded:ue(l),totalNeededOverrideParsed:Ue(e.totalNeededOverride??t.totalNeededOverride),displayTotalOverride:(()=>{const S=Ue(e.totalNeededOverride??t.totalNeededOverride);return S?ue([S.totalOverride]):""})()}}class To{#e=A(pe([]));MAX_TOASTS=3;get toasts(){return[...o(this.#e)].sort((t,r)=>r.timestamp-t.timestamp)}create(t){const r=t.id||crypto.randomUUID(),s={id:r,state:t.state,message:t.message,timestamp:Date.now(),source:t.source||"user",timeoutId:void 0,details:t.details,actions:t.actions||[]};return this.#t(s),r}update(t,r){const s=o(this.#e).findIndex(i=>i.id===t);if(s===-1)return;const n=o(this.#e)[s];n.timeoutId&&clearTimeout(n.timeoutId),o(this.#e)[s]={...n,state:r.state||n.state,message:r.message||n.message,source:r.source||n.source,actions:r.actions||n.actions},this.#r(o(this.#e)[s])}async track(t,r){const s=this.create({id:r.id,state:"loading",message:r.loading,source:"user"});try{const n=await t;return this.update(s,{state:"success",message:r.success||"Opération réussie"}),n}catch(n){throw this.update(s,{state:"error",message:r.error||"Erreur lors de l'opération"}),n}}dismiss(t){const r=o(this.#e).findIndex(n=>n.id===t);if(r===-1)return;const s=o(this.#e)[r];s.timeoutId&&clearTimeout(s.timeoutId),o(this.#e).splice(r,1)}dismissAll(){o(this.#e).forEach(t=>{t.timeoutId&&clearTimeout(t.timeoutId)}),h(this.#e,[],!0)}#t(t){if(t.source==="user"){const r=o(this.#e).findIndex(s=>s.source==="user");r>=0?o(this.#e)[r]=t:o(this.#e).push(t)}else{const r=o(this.#e).filter(s=>s.source!=="user");if(r.length>=2){const s=r[0];this.dismiss(s.id)}o(this.#e).push(t)}o(this.#e).length>this.MAX_TOASTS&&o(this.#e).splice(0,o(this.#e).length-this.MAX_TOASTS),this.#r(t)}#r(t){if(t.state!=="success"&&t.state!=="info")return;const r=t.source==="realtime-other"?4e3:2e3;t.timeoutId=setTimeout(()=>{this.dismiss(t.id)},r)}success(t,r){return this.create({state:"success",message:t,details:r})}error(t,r){return this.create({state:"error",message:t,details:r})}warning(t,r){return this.create({state:"warning",message:t,source:r?.source||"system",details:r?.details,actions:r?.actions})}info(t,r){return this.create({state:"info",message:t,source:r?.source||"system",details:r?.details})}loading(t,r){return this.create({state:"loading",message:t,details:r})}}const Ae=new To;class m{constructor(t,r,s){this.method=t,this.attribute=r,s!==void 0&&(Array.isArray(s)?this.values=s:this.values=[s])}toString(){return JSON.stringify({method:this.method,attribute:this.attribute,values:this.values})}}m.equal=(e,t)=>new m("equal",e,t).toString();m.notEqual=(e,t)=>new m("notEqual",e,t).toString();m.lessThan=(e,t)=>new m("lessThan",e,t).toString();m.lessThanEqual=(e,t)=>new m("lessThanEqual",e,t).toString();m.greaterThan=(e,t)=>new m("greaterThan",e,t).toString();m.greaterThanEqual=(e,t)=>new m("greaterThanEqual",e,t).toString();m.isNull=e=>new m("isNull",e).toString();m.isNotNull=e=>new m("isNotNull",e).toString();m.between=(e,t,r)=>new m("between",e,[t,r]).toString();m.startsWith=(e,t)=>new m("startsWith",e,t).toString();m.endsWith=(e,t)=>new m("endsWith",e,t).toString();m.select=e=>new m("select",void 0,e).toString();m.search=(e,t)=>new m("search",e,t).toString();m.orderDesc=e=>new m("orderDesc",e).toString();m.orderAsc=e=>new m("orderAsc",e).toString();m.orderRandom=()=>new m("orderRandom").toString();m.cursorAfter=e=>new m("cursorAfter",void 0,e).toString();m.cursorBefore=e=>new m("cursorBefore",void 0,e).toString();m.limit=e=>new m("limit",void 0,e).toString();m.offset=e=>new m("offset",void 0,e).toString();m.contains=(e,t)=>new m("contains",e,t).toString();m.notContains=(e,t)=>new m("notContains",e,t).toString();m.notSearch=(e,t)=>new m("notSearch",e,t).toString();m.notBetween=(e,t,r)=>new m("notBetween",e,[t,r]).toString();m.notStartsWith=(e,t)=>new m("notStartsWith",e,t).toString();m.notEndsWith=(e,t)=>new m("notEndsWith",e,t).toString();m.createdBefore=e=>m.lessThan("$createdAt",e);m.createdAfter=e=>m.greaterThan("$createdAt",e);m.createdBetween=(e,t)=>m.between("$createdAt",e,t);m.updatedBefore=e=>m.lessThan("$updatedAt",e);m.updatedAfter=e=>m.greaterThan("$updatedAt",e);m.updatedBetween=(e,t)=>m.between("$updatedAt",e,t);m.or=e=>new m("or",void 0,e.map(t=>JSON.parse(t))).toString();m.and=e=>new m("and",void 0,e.map(t=>JSON.parse(t))).toString();m.distanceEqual=(e,t,r,s=!0)=>new m("distanceEqual",e,[[t,r,s]]).toString();m.distanceNotEqual=(e,t,r,s=!0)=>new m("distanceNotEqual",e,[[t,r,s]]).toString();m.distanceGreaterThan=(e,t,r,s=!0)=>new m("distanceGreaterThan",e,[[t,r,s]]).toString();m.distanceLessThan=(e,t,r,s=!0)=>new m("distanceLessThan",e,[[t,r,s]]).toString();m.intersects=(e,t)=>new m("intersects",e,[t]).toString();m.notIntersects=(e,t)=>new m("notIntersects",e,[t]).toString();m.crosses=(e,t)=>new m("crosses",e,[t]).toString();m.notCrosses=(e,t)=>new m("notCrosses",e,[t]).toString();m.overlaps=(e,t)=>new m("overlaps",e,[t]).toString();m.notOverlaps=(e,t)=>new m("notOverlaps",e,[t]).toString();m.touches=(e,t)=>new m("touches",e,[t]).toString();m.notTouches=(e,t)=>new m("notTouches",e,[t]).toString();var ks;(function(e){e[e.NORMAL_CLOSURE=1e3]="NORMAL_CLOSURE",e[e.POLICY_VIOLATION=1008]="POLICY_VIOLATION",e[e.UNKNOWN_ERROR=-1]="UNKNOWN_ERROR"})(ks||(ks={}));var $s;(function(e){e.Equal="equal",e.NotEqual="notEqual",e.GreaterThan="greaterThan",e.GreaterThanEqual="greaterThanEqual",e.LessThan="lessThan",e.LessThanEqual="lessThanEqual",e.Contains="contains",e.IsNull="isNull",e.IsNotNull="isNotNull"})($s||($s={}));var Os;(function(e){e.Totp="totp"})(Os||(Os={}));var Ms;(function(e){e.Email="email",e.Phone="phone",e.Totp="totp",e.Recoverycode="recoverycode"})(Ms||(Ms={}));var qs;(function(e){e.Amazon="amazon",e.Apple="apple",e.Auth0="auth0",e.Authentik="authentik",e.Autodesk="autodesk",e.Bitbucket="bitbucket",e.Bitly="bitly",e.Box="box",e.Dailymotion="dailymotion",e.Discord="discord",e.Disqus="disqus",e.Dropbox="dropbox",e.Etsy="etsy",e.Facebook="facebook",e.Figma="figma",e.Github="github",e.Gitlab="gitlab",e.Google="google",e.Linkedin="linkedin",e.Microsoft="microsoft",e.Notion="notion",e.Oidc="oidc",e.Okta="okta",e.Paypal="paypal",e.PaypalSandbox="paypalSandbox",e.Podio="podio",e.Salesforce="salesforce",e.Slack="slack",e.Spotify="spotify",e.Stripe="stripe",e.Tradeshift="tradeshift",e.TradeshiftBox="tradeshiftBox",e.Twitch="twitch",e.Wordpress="wordpress",e.Yahoo="yahoo",e.Yammer="yammer",e.Yandex="yandex",e.Zoho="zoho",e.Zoom="zoom",e.Mock="mock"})(qs||(qs={}));var Bs;(function(e){e.AvantBrowser="aa",e.AndroidWebViewBeta="an",e.GoogleChrome="ch",e.GoogleChromeIOS="ci",e.GoogleChromeMobile="cm",e.Chromium="cr",e.MozillaFirefox="ff",e.Safari="sf",e.MobileSafari="mf",e.MicrosoftEdge="ps",e.MicrosoftEdgeIOS="oi",e.OperaMini="om",e.Opera="op",e.OperaNext="on"})(Bs||(Bs={}));var js;(function(e){e.AmericanExpress="amex",e.Argencard="argencard",e.Cabal="cabal",e.Cencosud="cencosud",e.DinersClub="diners",e.Discover="discover",e.Elo="elo",e.Hipercard="hipercard",e.JCB="jcb",e.Mastercard="mastercard",e.Naranja="naranja",e.TarjetaShopping="targeta-shopping",e.UnionPay="unionpay",e.Visa="visa",e.MIR="mir",e.Maestro="maestro",e.Rupay="rupay"})(js||(js={}));var Ls;(function(e){e.Afghanistan="af",e.Angola="ao",e.Albania="al",e.Andorra="ad",e.UnitedArabEmirates="ae",e.Argentina="ar",e.Armenia="am",e.AntiguaAndBarbuda="ag",e.Australia="au",e.Austria="at",e.Azerbaijan="az",e.Burundi="bi",e.Belgium="be",e.Benin="bj",e.BurkinaFaso="bf",e.Bangladesh="bd",e.Bulgaria="bg",e.Bahrain="bh",e.Bahamas="bs",e.BosniaAndHerzegovina="ba",e.Belarus="by",e.Belize="bz",e.Bolivia="bo",e.Brazil="br",e.Barbados="bb",e.BruneiDarussalam="bn",e.Bhutan="bt",e.Botswana="bw",e.CentralAfricanRepublic="cf",e.Canada="ca",e.Switzerland="ch",e.Chile="cl",e.China="cn",e.CoteDIvoire="ci",e.Cameroon="cm",e.DemocraticRepublicOfTheCongo="cd",e.RepublicOfTheCongo="cg",e.Colombia="co",e.Comoros="km",e.CapeVerde="cv",e.CostaRica="cr",e.Cuba="cu",e.Cyprus="cy",e.CzechRepublic="cz",e.Germany="de",e.Djibouti="dj",e.Dominica="dm",e.Denmark="dk",e.DominicanRepublic="do",e.Algeria="dz",e.Ecuador="ec",e.Egypt="eg",e.Eritrea="er",e.Spain="es",e.Estonia="ee",e.Ethiopia="et",e.Finland="fi",e.Fiji="fj",e.France="fr",e.MicronesiaFederatedStatesOf="fm",e.Gabon="ga",e.UnitedKingdom="gb",e.Georgia="ge",e.Ghana="gh",e.Guinea="gn",e.Gambia="gm",e.GuineaBissau="gw",e.EquatorialGuinea="gq",e.Greece="gr",e.Grenada="gd",e.Guatemala="gt",e.Guyana="gy",e.Honduras="hn",e.Croatia="hr",e.Haiti="ht",e.Hungary="hu",e.Indonesia="id",e.India="in",e.Ireland="ie",e.IranIslamicRepublicOf="ir",e.Iraq="iq",e.Iceland="is",e.Israel="il",e.Italy="it",e.Jamaica="jm",e.Jordan="jo",e.Japan="jp",e.Kazakhstan="kz",e.Kenya="ke",e.Kyrgyzstan="kg",e.Cambodia="kh",e.Kiribati="ki",e.SaintKittsAndNevis="kn",e.SouthKorea="kr",e.Kuwait="kw",e.LaoPeopleSDemocraticRepublic="la",e.Lebanon="lb",e.Liberia="lr",e.Libya="ly",e.SaintLucia="lc",e.Liechtenstein="li",e.SriLanka="lk",e.Lesotho="ls",e.Lithuania="lt",e.Luxembourg="lu",e.Latvia="lv",e.Morocco="ma",e.Monaco="mc",e.Moldova="md",e.Madagascar="mg",e.Maldives="mv",e.Mexico="mx",e.MarshallIslands="mh",e.NorthMacedonia="mk",e.Mali="ml",e.Malta="mt",e.Myanmar="mm",e.Montenegro="me",e.Mongolia="mn",e.Mozambique="mz",e.Mauritania="mr",e.Mauritius="mu",e.Malawi="mw",e.Malaysia="my",e.Namibia="na",e.Niger="ne",e.Nigeria="ng",e.Nicaragua="ni",e.Netherlands="nl",e.Norway="no",e.Nepal="np",e.Nauru="nr",e.NewZealand="nz",e.Oman="om",e.Pakistan="pk",e.Panama="pa",e.Peru="pe",e.Philippines="ph",e.Palau="pw",e.PapuaNewGuinea="pg",e.Poland="pl",e.FrenchPolynesia="pf",e.NorthKorea="kp",e.Portugal="pt",e.Paraguay="py",e.Qatar="qa",e.Romania="ro",e.Russia="ru",e.Rwanda="rw",e.SaudiArabia="sa",e.Sudan="sd",e.Senegal="sn",e.Singapore="sg",e.SolomonIslands="sb",e.SierraLeone="sl",e.ElSalvador="sv",e.SanMarino="sm",e.Somalia="so",e.Serbia="rs",e.SouthSudan="ss",e.SaoTomeAndPrincipe="st",e.Suriname="sr",e.Slovakia="sk",e.Slovenia="si",e.Sweden="se",e.Eswatini="sz",e.Seychelles="sc",e.Syria="sy",e.Chad="td",e.Togo="tg",e.Thailand="th",e.Tajikistan="tj",e.Turkmenistan="tm",e.TimorLeste="tl",e.Tonga="to",e.TrinidadAndTobago="tt",e.Tunisia="tn",e.Turkey="tr",e.Tuvalu="tv",e.Tanzania="tz",e.Uganda="ug",e.Ukraine="ua",e.Uruguay="uy",e.UnitedStates="us",e.Uzbekistan="uz",e.VaticanCity="va",e.SaintVincentAndTheGrenadines="vc",e.Venezuela="ve",e.Vietnam="vn",e.Vanuatu="vu",e.Samoa="ws",e.Yemen="ye",e.SouthAfrica="za",e.Zambia="zm",e.Zimbabwe="zw"})(Ls||(Ls={}));var Us;(function(e){e.GET="GET",e.POST="POST",e.PUT="PUT",e.PATCH="PATCH",e.DELETE="DELETE",e.OPTIONS="OPTIONS",e.HEAD="HEAD"})(Us||(Us={}));var Hs;(function(e){e.Center="center",e.Topleft="top-left",e.Top="top",e.Topright="top-right",e.Left="left",e.Right="right",e.Bottomleft="bottom-left",e.Bottom="bottom",e.Bottomright="bottom-right"})(Hs||(Hs={}));var zs;(function(e){e.Jpg="jpg",e.Jpeg="jpeg",e.Png="png",e.Webp="webp",e.Heic="heic",e.Avif="avif",e.Gif="gif"})(zs||(zs={}));var Qs;(function(e){e.Http="http",e.Schedule="schedule",e.Event="event"})(Qs||(Qs={}));var Ws;(function(e){e.Waiting="waiting",e.Processing="processing",e.Completed="completed",e.Failed="failed",e.Scheduled="scheduled"})(Ws||(Ws={}));async function Et(){if(!window.AppwriteClient)throw new Error("AppwriteClient non disponible");const e=await window.AppwriteClient.getDatabases(),t=window.AppwriteClient.getConfig();return{databases:e,config:t}}function Wt(){return localStorage.getItem("appwrite-user-name")||""}async function Do(e,t,r=100){try{const{databases:s,config:n}=await Et(),i=await s.listDocuments(n.APPWRITE_CONFIG.databaseId,n.APPWRITE_CONFIG.collections.purchases,[m.greaterThan("$updatedAt",t),m.equal("mainId",e),m.limit(r),m.select(["*","products.$id"])]);return console.log(`[Appwrite Interactions] ${i.documents.length} purchases modifiés chargés`),i.documents}catch(s){return console.error("[Appwrite Interactions] Erreur chargement purchases modifiés:",s),[]}}async function Gn(e,t){const{lastSync:r,limit:s=100}=t;try{const{databases:n,config:i}=await Et();if(!r)return console.log("[Appwrite Interactions] Chargement complet des produits"),(await n.listDocuments(i.APPWRITE_CONFIG.databaseId,i.APPWRITE_CONFIG.collections.products,[m.equal("mainId",e),m.select(["*","purchases.$id","purchases.unit","purchases.quantity","purchases.store","purchases.who","purchases.notes","purchases.price","purchases.status","purchases.deliveryDate","purchases.orderDate","purchases.createdBy","purchases.products.$id"]),m.limit(s)])).documents;const a=await n.listDocuments(i.APPWRITE_CONFIG.databaseId,i.APPWRITE_CONFIG.collections.products,[m.greaterThan("$updatedAt",r),m.equal("mainId",e),m.limit(s),m.select(["*","purchases.$id","purchases.unit","purchases.quantity","purchases.store","purchases.who","purchases.notes","purchases.price","purchases.status","purchases.deliveryDate","purchases.orderDate","purchases.createdBy","purchases.products.$id"])]);return a.documents.length>0&&console.log(`[Appwrite Interactions] ${a.documents.length} produits synchronisés avec leurs purchases`),a.documents}catch(n){console.error(`[Appwrite Interactions] Erreur sync produits avec purchases pour mainId ${e}:`,n);const i=n instanceof Error?n.message:"Erreur lors de la synchronisation";throw new Error(`Échec de la synchronisation: ${i}`)}}async function Kn(e,t,r=!0){const{databases:s,config:n}=await Et();return r&&(t.updatedBy=Wt()),await s.updateDocument(n.APPWRITE_CONFIG.databaseId,n.APPWRITE_CONFIG.collections.products,e,t)}async function Yn(e,t,r=!1){if(!e)throw new Error("ID du produit requis pour la mise à jour de l'override");const s=JSON.stringify(t),n=await Kn(e,{totalNeededOverride:s},r);return console.log(`[Appwrite Interactions] Total override mis à jour pour le produit ${e}:`,t),n}async function Vn(e){if(!e?.length)return[];try{const{databases:t,config:r}=await Et(),s=await t.listDocuments(r.APPWRITE_CONFIG.databaseId,r.APPWRITE_CONFIG.collections.purchases,[m.equal("$id",e),m.select(["*","products.$id"])]);return console.log(`[Appwrite Interactions] ${s.documents.length} purchases chargés avec relations products`),s.documents}catch(t){console.error("[Appwrite Interactions] Erreur chargement purchases avec relations:",t);const r=t instanceof Error?t.message:"Erreur inconnue";throw new Error(`Échec du chargement des purchases: ${r}`)}}function Jn(e,t={}){let r=null;const s=i=>{const{events:a,payload:l}=i;if(!l)return;const c=a.some(f=>f.includes("products.")),u=a.some(f=>f.includes("purchases.")),d=a.some(f=>f.includes(".create")),p=a.some(f=>f.includes(".update")),v=a.some(f=>f.includes(".delete"));if(c){const f=l;f.updatedBy&&f.updatedBy!==Wt()&&(d||p?Ae.info(`${f.updatedBy} a modifié le produit "${f.productName}"`,{source:"realtime-other"}):v&&Ae.info(`${f.updatedBy} a supprimé un produit`,{source:"realtime-other"})),d&&t.onProductCreate?t.onProductCreate(f):p&&t.onProductUpdate?t.onProductUpdate(f):v&&t.onProductDelete&&t.onProductDelete(f.$id)}else if(u){const f=l;if(f.createdBy&&f.createdBy!==Wt()){const g=f.products?.[0]?.productName||"un produit";d&&f.who!==Wt()?Ae.info(`${f.who} a ajouté un achat pour ${g}`,{source:"realtime-other"}):p&&f.who!==Wt()?Ae.info(`${f.who} a modifié un achat pour ${g}`,{source:"realtime-other"}):v&&Ae.info(`${f.who} a supprimé un achat pour ${g}`,{source:"realtime-other"})}d&&t.onPurchaseCreate?t.onPurchaseCreate(f):p&&t.onPurchaseUpdate?t.onPurchaseUpdate(f):v&&t.onPurchaseDelete&&t.onPurchaseDelete(f.$id)}};return(async()=>{try{typeof window<"u"&&window.AppwriteClient&&(await window.AppwriteClient.initializeAppwrite(),r=window.AppwriteClient.subscribeToCollections(["products","purchases"],e,s,{onConnect:()=>{console.log("[Appwrite Interactions] Realtime connecté"),t.onConnect?.()},onDisconnect:()=>{console.log("[Appwrite Interactions] Realtime déconnecté"),t.onDisconnect?.()},onError:i=>{console.error("[Appwrite Interactions] Erreur realtime:",i),t.onError?.(i)}}))}catch(i){console.error("[Appwrite Interactions] Impossible de configurer realtime:",i),t.onError?.(i)}})(),()=>{r&&(r(),r=null)}}async function Xn(e){try{console.log(`[Appwrite Interactions] Chargement des données principales pour mainId: ${e}`);const{databases:t}=await Et(),r=window.AppwriteClient.getConfig(),s=await t.getDocument(r.APPWRITE_CONFIG.databaseId,r.APPWRITE_CONFIG.collections.main,e);return console.log(`[Appwrite Interactions] Données principales chargées pour: ${s.name}`),s}catch(t){return console.error(`[Appwrite Interactions] Erreur chargement données principales pour mainId ${e}:`,t),null}}async function Zn(e,t,r,s){try{console.log(`[Appwrite Interactions] Création du Main document: ${e}`);const{databases:n}=await Et(),i=window.AppwriteClient.getConfig(),l=await(await window.AppwriteClient.getAccount()).get();await n.createDocument(i.APPWRITE_CONFIG.databaseId,i.APPWRITE_CONFIG.collections.main,e,{name:s,createdBy:l.$id,isActive:!0,originalDataHash:t,allDates:r,status:"active",dateStart:r[0]||null,dateEnd:r[r.length-1]||null}),console.log(`[Appwrite Interactions] Main document créé: ${e}`)}catch(n){throw console.error("[Appwrite Interactions] Erreur création Main document:",n),n}}async function Po(e){try{const{databases:t,config:r}=await Et(),s=await t.listDocuments(r.APPWRITE_CONFIG.databaseId,r.APPWRITE_CONFIG.collections.purchases,[m.equal("mainId",e),m.equal("status","expense"),m.limit(1e3)]);return console.log(`[Appwrite Interactions] ${s.documents.length} dépenses globales chargées`),s.documents}catch(t){return console.error("[Appwrite Interactions] Erreur chargement dépenses globales:",t),[]}}const Gs=Object.freeze(Object.defineProperty({__proto__:null,createMainDocument:Zn,loadMainEventData:Xn,loadOrphanPurchases:Po,loadPurchasesListByIds:Vn,loadUpdatedPurchases:Do,subscribeToRealtime:Jn,syncProductsWithPurchases:Gn,updateProduct:Kn,updateTotalOverride:Yn},Symbol.toStringTag,{value:"Module"}));function Ao(e){const r=new Date(e).getHours();return r>=11&&r<=13?"sun":r>=19&&r<=21?"moon":r>=7&&r<=9?"cloud":null}function Ro(e){return{formattedDate:new Date(e).toLocaleDateString("fr-FR",{weekday:"short",day:"numeric"}),timeIcon:Ao(e)}}function Fn(e){const t={};for(const r of e)t[r]=Ro(r);return t}function Io(e,t){if(!e.byDate?.[t])return{requiredQuantities:[],requiredQuantitiesFormatted:"-",stockBalance:[],availableStockQuantities:[],missingStockQuantities:[],availableStockFormatted:"-",missingStockFormatted:"-",hasAvailableStock:!1,hasMissingStock:!1,totalRecipesInRange:0,totalPortionsInRange:0,datesInSelectedRange:[],recipesByDate:new Map};const r=e.byDate[t],s=[t],n=new Map;r.recipes?.length&&n.set(t,r.recipes);const i=r.totalConsolidated||[],a=i.length>0?ue(i):"-",l=Co(e,t,i),c=l.filter(v=>v.q>0),u=new Date().toISOString().split("T")[0],p=t<u?[]:l.filter(v=>v.q<0);return{requiredQuantities:i,requiredQuantitiesFormatted:a,stockBalance:l,availableStockQuantities:c,missingStockQuantities:p,availableStockFormatted:ls(l),missingStockFormatted:ue(p.map(v=>({q:Math.abs(v.q),u:v.u}))),hasAvailableStock:c.length>0,hasMissingStock:p.length>0,totalRecipesInRange:r.recipes?.length||0,totalPortionsInRange:r.totalAssiettes||0,datesInSelectedRange:s,recipesByDate:n}}function Co(e,t,r){let s=[],n="";e.stockParsed?.dateTime&&e.stockParsed.dateTime<=t&&(s=[{q:parseFloat(e.stockParsed.quantity),u:e.stockParsed.unit}],n=e.stockParsed.dateTime);const i=[];if(e.purchases)for(const c of e.purchases)xo(c,t,n)&&i.push({q:c.quantity,u:c.unit});const a=[...s,...i],l=as(a);return Wn(l,r)}function xo(e,t,r=""){if(e.status==="cancelled")return!1;const s=e.deliveryDate||e.$createdAt;return!s||s>t||r&&e.$createdAt<r?!1:s<=t}function No(e,t){const r=e.totalNeededArray||[],s=r.length>0?ue(r):"-",n=ei(e,t[0],t[t.length-1],r),i=n.filter(u=>u.q>0),a=n.filter(u=>u.q<0),l=[...t].sort(),c=new Map;if(e.byDate)for(const[u,d]of Object.entries(e.byDate))d.recipes?.length&&c.set(u,d.recipes);return{requiredQuantities:r,requiredQuantitiesFormatted:s,stockBalance:n,availableStockQuantities:i,missingStockQuantities:a,availableStockFormatted:ls(n),missingStockFormatted:ue(a.map(u=>({q:Math.abs(u.q),u:u.u}))),hasAvailableStock:i.length>0,hasMissingStock:a.length>0,totalRecipesInRange:e.nbRecipes||0,totalPortionsInRange:e.totalAssiettes||0,datesInSelectedRange:l,recipesByDate:c}}function ko(e,t,r){if(!e.byDate)return{requiredQuantities:[],requiredQuantitiesFormatted:"-",stockBalance:[],availableStockQuantities:[],missingStockQuantities:[],availableStockFormatted:"-",missingStockFormatted:"-",hasAvailableStock:!1,hasMissingStock:!1,totalRecipesInRange:0,totalPortionsInRange:0,datesInSelectedRange:[],recipesByDate:new Map};const s=new Date(t),n=new Date(r),i=[],a=new Map,l=new Map;let c=0,u=0;for(const[E,R]of Object.entries(e.byDate)){const I=new Date(E);I>=s&&I<=n&&(i.push(E),c+=R.totalAssiettes||0,R.recipes?.length&&(a.set(E,R.recipes),u+=R.recipes.length),R.totalConsolidated&&R.totalConsolidated.forEach(({q:D,u:y})=>{l.set(y,(l.get(y)||0)+D)}))}const d=Array.from(l.entries()).map(([E,R])=>({q:R,u:E})),p=d.length>0?ue(d):"-",v=ei(e,t,r,d),f=v.filter(E=>E.q>0),g=new Date().toISOString().split("T")[0],b=r<g?[]:v.filter(E=>E.q<0);return{requiredQuantities:d,requiredQuantitiesFormatted:p,stockBalance:v,availableStockQuantities:f,missingStockQuantities:b,availableStockFormatted:ls(v),missingStockFormatted:ue(b.map(E=>({q:Math.abs(E.q),u:E.u}))),hasAvailableStock:f.length>0,hasMissingStock:b.length>0,totalRecipesInRange:u,totalPortionsInRange:c,datesInSelectedRange:i,recipesByDate:a}}function ei(e,t,r,s){let n=[],i="";e.stockParsed?.dateTime&&e.stockParsed.dateTime<=t&&(n=[{q:parseFloat(e.stockParsed.quantity),u:e.stockParsed.unit}],i=e.stockParsed.dateTime);const a=[];if(e.purchases)for(const u of e.purchases)$o(u,t,r,i)&&a.push({q:u.quantity,u:u.unit});const l=[...n,...a],c=as(l);return Wn(c,s)}function $o(e,t,r,s=""){if(e.status==="cancelled")return!1;const n=e.deliveryDate||e.$createdAt;return!n||n>r||s&&e.$createdAt<s?!1:n<=r}async function Oo(e){let t;if(t=await fetch(`/evenements/${e}/metadata.json`),!t.ok)throw new Error(`Impossible de charger les métadonnées Hugo: ${t.status}`);const r=await t.json();if(!r.mainGroup_id||!r.hugoContentHash)throw new Error("Format de métadonnées Hugo invalide");return r}async function Ks(e){const t=await fetch(`/evenements/${e}/ingredients_aw/index.json`);if(!t.ok)throw new Error(`Impossible de charger les données Hugo: ${t.status}`);const r=await t.json();if(!r.mainGroup_id||!r.ingredients)throw new Error("Format de données Hugo invalide");return r}async function Mo(e,t){if(!e)return!0;try{return(await Oo(t)).hugoContentHash!==e}catch(r){return console.warn("Impossible de vérifier le hash Hugo:",r),!1}}function ti(e,t){const r=os(e.byDate),s=Pr(Dr([])),{numeric:n,display:i}=Ar(r,s),a=Object.keys(e.byDate||{}),l=Fn(a);return{$id:`${e.productSemanticKey}`,$updatedAt:void 0,productHugoUuid:e.ingredientHugoUuid,productName:e.ingredientName,productType:e.ingType,pFrais:e.pFrais||!1,pSurgel:e.pSurgel||!1,nbRecipes:e.nbRecipes,totalNeededRaw:e.totalNeededRaw,totalAssiettes:e.totalAssiettes,isSynced:!1,status:"active",who:null,store:"",stockReel:null,previousNames:null,isMerged:!1,mergedFrom:null,mergeDate:null,mergeReason:null,mergedInto:null,totalNeededOverride:null,mainId:t,purchases:[],byDate:e.byDate,storeInfo:null,stockParsed:null,totalNeededArray:r,totalPurchasesArray:s,missingQuantityArray:n,stockOrTotalPurchases:"-",displayTotalNeeded:ue(r),displayTotalPurchases:"-",displayMissingQuantity:i,totalNeededOverrideParsed:null,displayTotalOverride:"",dateDisplayInfo:l}}function qo(e,t){return e.map(r=>ti(r,t))}class Bo{dbName;db=null;version=1;PRODUCTS_STORE="products";METADATA_STORE="metadata";LAST_SYNC_KEY="lastSync";ALL_DATES_KEY="allDates";HUGO_HASH_KEY="hugoContentHash";constructor(t){this.dbName=`products-cache-${t}`}async open(){if(!this.db)return new Promise((t,r)=>{const s=indexedDB.open(this.dbName,this.version);s.onerror=()=>r(s.error),s.onsuccess=()=>{this.db=s.result,console.log(`[IDBCache] Base ouverte: ${this.dbName}`),t()},s.onupgradeneeded=n=>{const i=n.target.result;i.objectStoreNames.contains(this.PRODUCTS_STORE)||(i.createObjectStore(this.PRODUCTS_STORE,{keyPath:"$id"}),console.log("[IDBCache] Object store 'products' créé")),i.objectStoreNames.contains(this.METADATA_STORE)||(i.createObjectStore(this.METADATA_STORE,{keyPath:"key"}),console.log("[IDBCache] Object store 'metadata' créé avec keyPath"))}})}async loadProducts(){if(!this.db)throw new Error("DB non ouverte");return new Promise((t,r)=>{const i=this.db.transaction(this.PRODUCTS_STORE,"readonly").objectStore(this.PRODUCTS_STORE).getAll();i.onsuccess=()=>{const a=new Map;i.result.forEach(l=>{a.set(l.$id,l)}),console.log(`[IDBCache] ${a.size} produits chargés`),t(a)},i.onerror=()=>r(i.error)})}async loadMetadata(){if(!this.db)throw new Error("DB non ouverte");return new Promise((t,r)=>{const i=this.db.transaction(this.METADATA_STORE,"readonly").objectStore(this.METADATA_STORE).getAll();i.onsuccess=()=>{const a=i.result,l={lastSync:null,allDates:[],hugoContentHash:null};a.forEach(c=>{c.key===this.LAST_SYNC_KEY?l.lastSync=c.value:c.key===this.ALL_DATES_KEY?l.allDates=c.value||[]:c.key===this.HUGO_HASH_KEY&&(l.hugoContentHash=c.value)}),console.log(`[IDBCache] Metadata chargées: lastSync=${l.lastSync}, dates=${l.allDates?.length||0}, hash=${l.hugoContentHash}`),t(l)},i.onerror=()=>r(i.error)})}async saveProducts(t){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const n=this.db.transaction(this.PRODUCTS_STORE,"readwrite"),i=n.objectStore(this.PRODUCTS_STORE);i.clear(),t.forEach(a=>{i.put(a)}),n.oncomplete=()=>{console.log(`[IDBCache] ${t.size} produits sauvegardés`),r()},n.onerror=()=>s(n.error)})}async saveMetadata(t){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const n=this.db.transaction(this.METADATA_STORE,"readwrite"),i=n.objectStore(this.METADATA_STORE);i.put({key:this.LAST_SYNC_KEY,value:t.lastSync}),i.put({key:this.ALL_DATES_KEY,value:t.allDates}),t.hugoContentHash!==void 0&&i.put({key:this.HUGO_HASH_KEY,value:t.hugoContentHash}),n.oncomplete=()=>{console.log("[IDBCache] Metadata sauvegardées (objets {key, value})"),r()},n.onerror=()=>s(n.error)})}async updateLastSync(t){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const a=this.db.transaction(this.METADATA_STORE,"readwrite").objectStore(this.METADATA_STORE).put({key:this.LAST_SYNC_KEY,value:t});a.onsuccess=()=>{console.log(`[IDBCache] lastSync mis à jour: ${t}`),r()},a.onerror=()=>s(a.error)})}async updateAllDates(t){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const a=this.db.transaction(this.METADATA_STORE,"readwrite").objectStore(this.METADATA_STORE).put({key:this.ALL_DATES_KEY,value:t});a.onsuccess=()=>{console.log(`[IDBCache] allDates mis à jour: ${t.length} dates`),r()},a.onerror=()=>s(a.error)})}async updateHugoContentHash(t){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const a=this.db.transaction(this.METADATA_STORE,"readwrite").objectStore(this.METADATA_STORE).put({key:this.HUGO_HASH_KEY,value:t});a.onsuccess=()=>{console.log(`[IDBCache] hugoContentHash mis à jour: ${t}`),r()},a.onerror=()=>s(a.error)})}async updateLastHugoMenuUpdate(t){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const a=this.db.transaction(this.METADATA_STORE,"readwrite").objectStore(this.METADATA_STORE).put({key:"lastHugoMenuUpdate",value:t});a.onsuccess=()=>{console.log("[IDBCache] lastHugoMenuUpdate sauvegardé"),r()},a.onerror=()=>s(a.error)})}async upsertProduct(t){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const a=this.db.transaction(this.PRODUCTS_STORE,"readwrite").objectStore(this.PRODUCTS_STORE).put(t);a.onsuccess=()=>r(),a.onerror=()=>s(a.error)})}async deleteProduct(t){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const a=this.db.transaction(this.PRODUCTS_STORE,"readwrite").objectStore(this.PRODUCTS_STORE).delete(t);a.onsuccess=()=>r(),a.onerror=()=>s(a.error)})}async clear(){if(!this.db)throw new Error("DB non ouverte");return new Promise((t,r)=>{const s=this.db.transaction([this.PRODUCTS_STORE,this.METADATA_STORE],"readwrite");s.objectStore(this.PRODUCTS_STORE).clear(),s.objectStore(this.METADATA_STORE).clear(),s.oncomplete=()=>{console.log("[IDBCache] Cache vidé"),t()},s.onerror=()=>r(s.error)})}close(){this.db&&(this.db.close(),this.db=null,console.log("[IDBCache] Connexion fermée"))}}async function jo(e){const t=new Bo(e);return await t.open(),t}function Lo(e){return!!(e.isMerged||e.totalNeededOverride)}function Uo(e,t){if(!e||e.length!==t.length)return!0;for(let r=0;r<e.length;r++){const s=e[r],n=t[r];if(s.q!==n.q||s.u!==n.u)return!0}return!1}async function Ho(e,t){const r={added:[],updated:[],removed:[],mergedProductsUpdated:[],overrideConflicts:[],summary:""},s=new Set;for(const n of t.ingredients){const i=n.productSemanticKey;if(!i){console.warn(`[syncHugoData] Ingrédient sans productSemanticKey ignoré : ${n.ingredientName}`);continue}s.add(i);const a=e.get(i);if(a){if(Uo(a.totalNeededRaw,n.totalNeededRaw)){const c=zo(a,n);if(c&&r.overrideConflicts.push(c),a.isMerged){const u=a.displayTotalNeeded;Ys(a,n),r.mergedProductsUpdated.push({product:a,oldDisplayTotal:u,newDisplayTotal:a.displayTotalNeeded,currentOverride:a.totalNeededOverrideParsed,semanticKey:i})}else Ys(a,n);r.updated.push(i)}e.set(i,a)}else{r.added.push(n);const l=ti(n,t.mainGroup_id);e.set(l.$id,l)}}for(const[n,i]of e)s.has(n)||(r.removed.push(i),!Lo(i)&&!i.purchases?.length&&!i.stockReel&&!i.who?.length&&e.delete(n));return r.overrideConflicts.length>0&&await Qo(r.overrideConflicts),r.summary=Go(r),r}function zo(e,t){if(!e.totalNeededOverride||!e.totalNeededOverrideParsed)return null;const r=os(t.byDate),s=ue(r),n=e.displayTotalNeeded;return n!==s?{product:e,oldDisplayTotal:n,newDisplayTotal:s,currentOverride:e.totalNeededOverrideParsed,semanticKey:e.$id}:null}async function Qo(e){for(const t of e){const r={...t.currentOverride,hasUnresolvedChangedSinceOverride:!0,oldTotalDisplay:t.oldDisplayTotal,newTotalDisplay:t.newDisplayTotal};JSON.stringify(r);try{await Yn(t.product.$id,r,!1)}catch(s){console.error(`Erreur lors de la mise à jour de l'override pour ${t.product.$id}:`,s)}}}function Ys(e,t){e.byDate=t.byDate,e.nbRecipes=t.nbRecipes,e.totalAssiettes=t.totalAssiettes,e.productType=t.ingType,e.pFrais=t.pFrais||!1,e.pSurgel=t.pSurgel||!1,Wo(e)}function Wo(e){e.totalNeededArray=os(e.byDate),e.displayTotalNeeded=ue(e.totalNeededArray);const t=Pr(Dr(e.purchases)),{numeric:r,display:s}=Ar(e.totalNeededArray,t);e.totalPurchasesArray=t,e.missingQuantityArray=r,e.displayMissingQuantity=s;const n=Object.keys(e.byDate||{});e.dateDisplayInfo=Fn(n),e.stockOrTotalPurchases=e.purchases.length>0?e.displayTotalPurchases:e.displayTotalNeeded}function Go(e){const t=[];if((e.added.length>0||e.updated.length>0||e.removed.length>0)&&t.push("Les recettes ou menus ont été modifiés depuis votre dernière consultation: "),e.added.length>0&&t.push(`${e.added.length} nouveau(x) ingrédient(s)`),e.updated.length>0&&t.push(` ${e.updated.length} ingrédient(s) mis à jour`),e.overrideConflicts.length>0&&t.push(`⚠️ ${e.overrideConflicts.length} quantité(s) personnalisée(s) à réviser`),e.mergedProductsUpdated.length>0&&t.push(`🔀 ${e.mergedProductsUpdated.length} produit(s) fusionné(s) modifié(s)`),e.removed.length>0){const r=e.removed.filter(s=>s.purchases?.length||s.stockReel||s.who?.length).length;r>0?t.push(`⚠️ ${r} suppression(s) avec données conservées`):t.push(`${e.removed.length} ingrédient(s) supprimé(s)`)}return t.length>0?t.join(", "):"Aucune modification détectée"}class Ko{isMobileQuery=new po("max-width: 1024px");get isMobile(){return this.isMobileQuery.current}get isDesktop(){return!this.isMobile}userName(){return localStorage.getItem("appwrite-user-name")||""}get toasts(){return Ae.toasts}get toast(){return Ae}#e=A(pe({isOpen:!1,conflicts:[]}));get modalOverride(){return o(this.#e)}set modalOverride(t){h(this.#e,t,!0)}#t=A(pe({isOpen:!1}));get modal(){return o(this.#t)}set modal(t){h(this.#t,t,!0)}#r=A(pe({isRunning:!1,name:"",progress:0}));get backgroundOperation(){return o(this.#r)}set backgroundOperation(t){h(this.#r,t,!0)}}const Yo=new Ko;class zt{#e=A(pe({}));get data(){return o(this.#e)}set data(t){h(this.#e,t,!0)}dateStore;constructor(t,r){this.data=t,this.dateStore=r}update(t){this.data=t}get $id(){return this.data.$id}get productName(){return this.data.productName}get productType(){return this.data.productType}get storeInfo(){return this.data.storeInfo}get who(){return this.data.who}get pFrais(){return this.data.pFrais}get pSurgel(){return this.data.pSurgel}get status(){return this.data.status}get previousNames(){return this.data.previousNames}get purchases(){return this.data.purchases}get totalNeededOverrideParsed(){return this.data.totalNeededOverrideParsed}get displayMissingQuantity(){return this.data.displayMissingQuantity}get missingQuantityArray(){return this.data.missingQuantityArray}get isSynced(){return this.data.isSynced}get byDate(){return this.data.byDate}#t=Q(()=>{const t=this.dateStore.current,r=this.dateStore.dates;let s;if(this.dateStore.isFullRange)s=No(this.data,r),s.datesInSelectedRange&&(s.datesInSelectedRange=s.datesInSelectedRange.filter(n=>this.data.byDate&&this.data.byDate[n]));else if(t.start&&t.end&&t.start===t.end)s=Io(this.data,t.start);else if(t.start&&t.end)s=ko(this.data,t.start,t.end);else return{quantities:[],formattedQuantities:"",nbRecipes:0,totalAssiettes:0,stockResult:[],availableQuantities:[],missingQuantities:[],formattedMissingQuantities:"",formattedAvailableQuantities:"En attente",hasAvailable:!1,hasMissing:!1,concernedDates:[],recipesByDate:new Map};return{quantities:s.requiredQuantities,formattedQuantities:s.requiredQuantitiesFormatted,nbRecipes:s.totalRecipesInRange,totalAssiettes:s.totalPortionsInRange,stockResult:s.stockBalance,availableQuantities:s.availableStockQuantities,missingQuantities:s.missingStockQuantities,formattedMissingQuantities:s.missingStockFormatted,formattedAvailableQuantities:s.availableStockFormatted,hasAvailable:s.hasAvailableStock,hasMissing:s.hasMissingStock,concernedDates:s.datesInSelectedRange,recipesByDate:s.recipesByDate}});get stats(){return o(this.#t)}set stats(t){h(this.#t,t)}}class Vo{#e=A(pe([]));#t=A(null);#r=A(null);constructor(t=[]){h(this.#e,t,!0),this.initializeSmartRange()}get start(){return o(this.#t)}get end(){return o(this.#r)}get dates(){return o(this.#e)}#a=Q(()=>[...o(this.#e)].sort()[0]);get firstAvailableDate(){return o(this.#a)}set firstAvailableDate(t){h(this.#a,t)}#u=Q(()=>[...o(this.#e)].sort()[o(this.#e).length-1]);get lastAvailableDate(){return o(this.#u)}set lastAvailableDate(t){h(this.#u,t)}get current(){return{start:o(this.#t),end:o(this.#r)}}#l=Q(()=>{if(o(this.#e).length===0)return!0;const t=this.lastAvailableDate?new Date(this.lastAvailableDate):new Date;return t.setHours(23,59,59,999),t<new Date});get isEventPassed(){return o(this.#l)}set isEventPassed(t){h(this.#l,t)}#i=Q(()=>{if(o(this.#e).length===0)return!1;const t=new Date;return t.setHours(0,0,0,0),o(this.#e).some(r=>new Date(r)>=t)});get hasUpcomingDates(){return o(this.#i)}set hasUpcomingDates(t){h(this.#i,t)}#o=Q(()=>o(this.#t)===this.firstAvailableDate&&o(this.#r)===this.lastAvailableDate);get isFullRange(){return o(this.#o)}set isFullRange(t){h(this.#o,t)}#d=Q(()=>{if(o(this.#e).length===0)return!1;const t=[...o(this.#e)].sort(),r=new Date;r.setHours(0,0,0,0);const s=t.find(a=>new Date(a)>=r)||null;let n,i;if(s)n=s,i=t[t.length-1];else{const a=t[t.length-1];n=a,i=a}return o(this.#t)===n&&o(this.#r)===i});get isUpcomingRange(){return o(this.#d)}set isUpcomingRange(t){h(this.#d,t)}#c=Q(()=>o(this.#e).length===1);get hasSingleDateEvent(){return o(this.#c)}set hasSingleDateEvent(t){h(this.#c,t)}#f=Q(()=>!!(o(this.#t)&&o(this.#t)===o(this.#r)));get hasSingleDateInRange(){return o(this.#f)}set hasSingleDateInRange(t){h(this.#f,t)}#s=Q(()=>{if(!o(this.#t)||!o(this.#r)||this.isEventPassed)return!1;const t=new Date;return t.setHours(0,0,0,0),new Date(o(this.#t))<t});get hasPastDatesInRange(){return o(this.#s)}set hasPastDatesInRange(t){h(this.#s,t)}setAvailableDates(t){h(this.#e,t,!0),this.initializeSmartRange()}setRange(t,r){if(!t&&!r){h(this.#t,null),h(this.#r,null);return}if(!t||!r){const i=t||r;h(this.#t,i,!0),h(this.#r,i,!0);return}const s=new Date(t)<=new Date(r)?t:r,n=new Date(t)>=new Date(r)?t:r;h(this.#t,s,!0),h(this.#r,n,!0)}selectAll(){o(this.#e).length!==0&&(h(this.#t,o(this.#e)[0],!0),h(this.#r,o(this.#e)[o(this.#e).length-1],!0))}selectUpcoming(){if(o(this.#e).length===0)return;const t=[...o(this.#e)].sort(),r=new Date;r.setHours(0,0,0,0);const s=t.find(n=>new Date(n)>=r)||null;if(s)h(this.#t,s,!0),h(this.#r,t[t.length-1],!0);else{const n=t[t.length-1];h(this.#t,n,!0),h(this.#r,n,!0)}}selectFutureDatesOnly(){const t=new Date;t.setDate(t.getDate()+1),t.setHours(0,0,0,0);const r=o(this.#e).filter(s=>new Date(s)>=t);r.length>0&&(h(this.#t,r[0],!0),h(this.#r,r[r.length-1],!0))}initializeSmartRange(){if(o(this.#e).length===0)return;const t=[...o(this.#e)].sort(),r=this.isEventPassed,s=new Date(t[0])<new Date,n=new Date;let i;r?i=t[0]:s?i=n.toISOString().slice(0,19)+"Z":i=t[0],h(this.#t,i,!0),h(this.#r,t[t.length-1],!0),console.log(`[DateRangeStore] Initialized: ${o(this.#t)} - ${o(this.#r)}`)}}const Vs=1e3;class Jo{#e=new Pt;#t=new Pt;#r=A(null);#a=A(null);#u=A(!1);#l=A(!1);#i=A(null);#o=A(!1);#d=A(!1);#c=A(null);#f=A(null);get currentMainId(){return o(this.#r)}dateStore=new Vo;get dateRange(){return this.dateStore.current}get availableDates(){return this.dateStore.dates}get isEventPassed(){return this.dateStore.isEventPassed}get hasSingleDateEvent(){return this.dateStore.hasSingleDateEvent}get hasSingleDateInRange(){return this.dateStore.hasSingleDateInRange}get hasPastDatesInRange(){return this.dateStore.hasPastDatesInRange}#s=null;#h=null;#p=A(!1);#v=null;#S=A(!1);#E=A();#_=A(pe([]));get hasPendingConflicts(){return o(this.#_).length>0}get pendingConflicts(){return o(this.#_)}#n=A(pe({searchQuery:"",selectedStores:[],selectedWho:[],selectedProductTypes:[],selectedTemperatures:[],groupBy:"productType",sortColumn:"",sortDirection:"asc"}));get filters(){return o(this.#n)}get hasFilters(){return this.filters.searchQuery!==""||this.filters.selectedStores.length>0||this.filters.selectedWho.length>0||this.filters.selectedProductTypes.length>0||this.filters.selectedTemperatures.length>0}get loading(){return o(this.#l)}get error(){return o(this.#i)}get lastSync(){return o(this.#c)}get syncing(){return o(this.#o)}setDateRange(t,r){this.dateStore.setRange(t,r)}isFullRange(){return this.dateStore.isFullRange}initializeDateRange(){this.dateStore.initializeSmartRange()}selectUpcomingDates(){this.dateStore.selectUpcoming()}isUpcomingRange(){return this.dateStore.isUpcomingRange}get firstAvailableDate(){return this.dateStore.firstAvailableDate}get lastAvailableDate(){return this.dateStore.lastAvailableDate}selectFutureDatesOnly(){this.dateStore.selectFutureDatesOnly()}get realtimeConnected(){return o(this.#d)}#g=Q(()=>{const t=Array.from(this.#e.values()).map(r=>r.data);return console.log(`[ProductsStore] enrichedProducts recalculated: ${t.length} products`),t});get enrichedProducts(){return o(this.#g)}set enrichedProducts(t){h(this.#g,t)}#m=Q(()=>{if(console.log("[Store] Filtering products by date range (Map)"),!this.dateRange.start||!this.dateRange.end)return new Map;const t=new Date(this.dateRange.start),r=new Date(this.dateRange.end),s=new Map;for(const[n,i]of this.#e){const a=i.data,l=!a.productHugoUuid;if(!a.byDate&&!l||!So(a,o(this.#n)))continue;let u=!1;a.byDate&&(u=Object.keys(a.byDate).some(d=>{const p=new Date(d);return p>=t&&p<=r})),(u||l)&&s.set(n,i)}return s});get filteredProductsMap(){return o(this.#m)}set filteredProductsMap(t){h(this.#m,t)}#T=Q(()=>({total:this.#e.size,frais:Array.from(this.#e.values()).filter(t=>t.pFrais).length,surgel:Array.from(this.#e.values()).filter(t=>t.pSurgel).length,merged:Array.from(this.#e.values()).filter(t=>t.data.isMerged).length}));get stats(){return o(this.#T)}set stats(t){h(this.#T,t)}#D=Q(()=>{const t=Array.from(this.#e.values()).map(r=>r.storeInfo?.storeName).filter(Boolean);return[...new Set(t)]});get uniqueStores(){return o(this.#D)}set uniqueStores(t){h(this.#D,t)}#P=Q(()=>{const t=Array.from(this.#e.values()).flatMap(r=>r.who||[]);return[...new Set(t)]});get uniqueWho(){return o(this.#P)}set uniqueWho(t){h(this.#P,t)}#A=Q(()=>{const t=Array.from(this.#e.values()).map(r=>r.productType).filter(Boolean);return[...new Set(t)]});get uniqueProductTypes(){return o(this.#A)}set uniqueProductTypes(t){h(this.#A,t)}#R=Q(()=>{const r=Array.from(this.filteredProductsMap.values()).sort((a,l)=>a.$id.localeCompare(l.$id));if(o(this.#n).groupBy==="none")return{"":r};const s=Object.groupBy(r,a=>o(this.#n).groupBy==="store"?a.storeInfo?.storeName||"Non défini":a.productType||"Non défini"),n=Object.keys(s).sort((a,l)=>a===""?1:l===""?-1:a.localeCompare(l)),i={};return n.forEach(a=>{i[a]=s[a]}),i});get groupedFilteredProducts(){return o(this.#R)}set groupedFilteredProducts(t){h(this.#R,t)}async initialize(t,r){if(!t?.trim())throw new Error("mainId invalide fourni");if(o(this.#u)&&o(this.#r)===t){console.log(`[ProductsStore] Déjà initialisé pour mainId: ${t}`);return}console.log(`[ProductsStore] Initialisation avec mainId: ${t}`),h(this.#r,t,!0),h(this.#a,r,!0);try{this.#s=await jo(t)}catch(s){throw console.error("[ProductsStore] Erreur ouverture IndexedDB:",s),new Error("Impossible d'initialiser le cache IndexedDB")}h(this.#i,null);try{if(await this.#k(),this.#e.size===0){console.log("[ProductsStore] Cache vide, chargement depuis Hugo...");let n;n=await Ks(r),console.log(`[ProductsStore] Hugo chargé: ${n.ingredients.length} ingrédients`),h(this.#f,n.hugoContentHash,!0),qo(n.ingredients,t).forEach(l=>{this.#e.set(l.$id,new zt(l,this.dateStore))}),this.dateStore.setAvailableDates([...n.allDates]),await Xn(t)||await Zn(n.mainGroup_id,n.hugoContentHash,n.allDates,n.name),await this.#I()}this.initializeDateRange(),await this.#$(),await this.#G(),h(this.#u,!0);const s=this.#W();this.#h=Jn(t,s),this.#B(),console.log("[ProductsStore] Vérification initiale des changements Hugo..."),await this.#C(),console.log(`[ProductsStore] Initialisation complétée: ${this.#e.size} produits`)}catch(s){const n=s instanceof Error?s.message:"Erreur lors de l'initialisation";throw h(this.#i,n,!0),console.error("[ProductsStore]",n,s),s}}async#k(){if(this.#s)try{const t=await this.#s.loadProducts();t.forEach((s,n)=>{s.status==="isSyncing"&&(s.status="active"),this.#e.set(n,new zt(s,this.dateStore))});const r=await this.#s.loadMetadata();h(this.#c,r.lastSync,!0),this.dateStore.setAvailableDates([...r.allDates]),h(this.#f,r.hugoContentHash||null,!0),console.log(`[ProductsStore] ${t.size} produits chargés du cache IDB, lastSync: ${r.lastSync}`)}catch(t){console.warn("[ProductsStore] Erreur lecture cache IDB, ignoré:",t)}}async#$(){if(o(this.#r)){h(this.#o,!0),console.log(`[ProductsStore] Début syncFromAppwrite pour mainId: ${o(this.#r)}`);try{console.log(`[ProductsStore] Récupération des produits modifiés depuis lastSync: ${o(this.#c)}`);const t=await Gn(o(this.#r),{lastSync:o(this.#c),limit:Vs});if(console.log(`[ProductsStore] ${t.length} produits récupérés depuis Appwrite`),t.forEach(r=>{const s=this.#e.get(r.$id);console.log(`[ProductsStore] Sync produit ${r.$id}: existing=${!!s}, who=${r.who}, store=${r.store}`);const n=this.#x(r,s?.data);n.isSynced=!0,s?s.update(n):this.#e.set(r.$id,new zt(n,this.dateStore))}),o(this.#c)){console.log(`[ProductsStore] Récupération des purchases modifiés depuis lastSync: ${o(this.#c)}`);const{loadUpdatedPurchases:r}=await xs(async()=>{const{loadUpdatedPurchases:n}=await Promise.resolve().then(()=>Gs);return{loadUpdatedPurchases:n}},void 0),s=await r(o(this.#r),o(this.#c),Vs);console.log(`[ProductsStore] ${s.length} purchases modifiés récupérés`),s.forEach(n=>{if(n.status==="expense")this.#t.set(n.$id,n);else if(n.products?.length){const i=n.products.map(a=>typeof a=="string"?a:a.$id);this.#b(i,n)}})}this.#M(),await this.#O(),console.log("[ProductsStore] SyncFromAppwrite terminé avec succès")}catch(t){throw console.error("[ProductsStore] Erreur lors du sync:",t),t}finally{h(this.#o,!1)}}}async#O(){if(this.#s)try{const t=new Map;this.#e.forEach((r,s)=>{const n=Tt(r.data);n.status==="isSyncing"&&(n.status="active"),t.set(s,n)}),await this.#s.saveProducts(t),await this.#s.saveMetadata({lastSync:o(this.#c),allDates:[...this.dateStore.dates],hugoContentHash:o(this.#f)}),console.log("[ProductsStore] Cache IDB persisté")}catch(t){console.error("[ProductsStore] Erreur persist cache IDB:",t)}}async#K(){if(this.#s)try{const t=new Map;this.#e.forEach((r,s)=>{const n=Tt(r.data);n.status==="isSyncing"&&(n.status="active"),t.set(s,n)}),await this.#s.saveProducts(t),await this.#s.updateLastSync(o(this.#c)),console.log("[ProductsStore] Cache IDB persisté")}catch(t){console.error("[ProductsStore] Erreur persist cache IDB:",t)}}async#I(){if(this.#s)try{const t=new Map;this.#e.forEach((r,s)=>{const n=Tt(r.data);n.status==="isSyncing"&&(n.status="active"),t.set(s,n)}),await this.#s.saveProducts(t),await this.#s.updateLastSync(o(this.#c)),await this.#s.updateAllDates([...this.availableDates]),await this.#s.updateHugoContentHash(o(this.#f)),console.log("[ProductsStore] Cache IDB persisté avec métadonnées complètes")}catch(t){console.error("[ProductsStore] Erreur persistance cache complet:",t)}}async#y(t){if(!(!this.#s||t.length===0))try{const r=t.map(s=>this.#e.get(s)?.data).filter(s=>s!=null).map(s=>{const n=Tt(s);return n.status==="isSyncing"&&(n.status="active"),this.#s.upsertProduct(n)});r.length>0&&(await Promise.all(r),console.log(`[ProductsStore] ${r.length} produits affectés persistés`))}catch(r){console.error("[ProductsStore] Erreur persistence produits affectés:",r)}}#M(){h(this.#c,new Date().toISOString(),!0)}async#C(){if(!o(this.#a)||o(this.#l))return!1;try{const t=await Mo(o(this.#f),o(this.#a));return t&&!o(this.#p)&&(console.log(`[ProductsStore] Changement Hugo détecté pour ${o(this.#a)}, analyse approfondie en cours...`),h(this.#p,!0),await this.#q()),h(this.#E,new Date,!0),t}catch(t){return console.warn("[ProductsStore] Erreur lors de la vérification du contenu Hugo:",t),!1}}async#q(){if(!o(this.#a)){console.warn("[ProductsStore] Impossible d'analyser: #hugoMetadata non défini");return}try{console.log("[ProductsStore] Chargement nouveau JSON Hugo...");const t=await Ks(o(this.#a)),r=new Map;this.#e.forEach((i,a)=>r.set(a,i.data));const s=await Ho(r,t);console.log(`[ProductsStore  - hugo change] ${s.summary}`);for(const[i,a]of r){const l=this.#e.get(i);if(l)l.update(a);else{const c=new zt(a,this.dateStore);this.#e.set(i,c),console.log(`[ProductsStore] ✨ Nouveau ProductModel créé : ${i}`)}}const n=[];for(const[i]of this.#e)r.has(i)||n.push(i);for(const i of n)this.#e.delete(i),console.log(`[ProductsStore] 🗑️ ProductModel supprimé : ${i}`);if(console.log(`[ProductsStore] 🔄 Synchronisation terminée : ${r.size} produits synchronisés, ${this.#e.size} ProductModel actifs`),s.overrideConflicts.length>0&&(h(this.#_,s.overrideConflicts,!0),Ae.error(`${s.overrideConflicts.length} quantité(s) personnalisée(s) nécessitent votre attention`,{action:{label:"Réviser",onClick:()=>Yo.modalOverride.isOpen=!0}})),s.mergedProductsUpdated.length>0&&console.log(`[ProductsStore] ⚠️ ${s.mergedProductsUpdated.length} produits fusionnés modifiés`),s.removed.length>0){const i=s.removed.filter(a=>a.purchases?.length||a.stockReel||a.who?.length);i.length>0&&console.log(`[ProductsStore] ℹ️ ${i.length} ingrédients supprimés conservés (données utilisateur)`)}this.dateStore.setAvailableDates([...t.allDates]),h(this.#f,t.hugoContentHash,!0),this.initializeDateRange(),await this.#I(),(s.added.length||s.updated.length||s.removed.length)&&Ae.success(s.summary),h(this.#p,!1)}catch(t){console.error("[ProductsStore] Erreur sync Hugo:",t),Ae.error("Erreur lors de la mise à jour Hugo")}}#B(){this.#v&&clearInterval(this.#v),this.#v=setInterval(async()=>{await this.#C()},6e4)}#j(){this.#v&&(clearInterval(this.#v),this.#v=null)}#x(t,r){return r?ur(t,r):Eo(t)}#Y(t){t.length&&(t.forEach(r=>this.#w(r)),console.log(`[ProductsStore] ${t.length} produits upserted`))}#w(t){const r=this.#e.get(t.$id),s=this.#x(t,r?.data);r?r.update(s):(this.dateStore.dates,this.#e.set(t.$id,new zt(s,this.dateStore)))}#L(t){this.#e.delete(t)}async#U(t){if(!t.products?.length)return console.warn("[ProductsStore] Purchase créé sans products:",t.$id),[];const r=t.products.map(s=>typeof s=="string"?s:s.$id).filter(Boolean);return this.#Q(r,t),r}async#H(t){if(t.products?.length){const r=t.products.map(s=>typeof s=="string"?s:s.$id).filter(Boolean);return this.#b(r,t),r}console.log("[ProductsStore] Purchase update sans products[], rechargement...");try{const[r]=await Vn([t.$id]);if(r?.products?.length){const s=r.products.map(n=>typeof n=="string"?n:n.$id).filter(Boolean);return this.#b(s,r),s}return[]}catch(r){return console.error("[ProductsStore] Erreur rechargement purchase:",r),[]}}async#z(t){const r=Array.from(this.#e.values()).map(s=>s.data).filter(s=>s.purchases?.some(n=>n.$id===t));return r.forEach(s=>{this.#w(s)}),r.map(s=>s.$id)}#Q(t,r){const s=Ns(r),n=[];t.forEach(i=>{const a=this.#e.get(i);if(a){const l=a.data,c=l.purchases||[];if(!c.some(u=>u.$id===s.$id)){const u=ur({...l,purchases:[...c,s],status:"active"},l);n.push(u)}}}),n.forEach(i=>{const a=this.#e.get(i.$id);a&&a.update(i)})}#b(t,r){const s=Ns(r),n=[];t.forEach(i=>{const a=this.#e.get(i);if(a){const l=a.data,c=l.purchases||[],u=c.findIndex(d=>d.$id===s.$id);if(u>=0){const d=[...c];d[u]=s;const p=ur({...l,purchases:d,status:"active"},l);n.push(p)}else{const d=ur({...l,purchases:[...c,r],status:"active"},l);n.push(d)}}}),n.forEach(i=>{const a=this.#e.get(i.$id);a&&a.update(i)})}#W(){return{onProductCreate:t=>{if(this.#w(t),this.#s){const r=this.#e.get(t.$id);r&&this.#s.upsertProduct(Tt(r.data)).catch(s=>console.error("[ProductsStore] Erreur persistence produit:",s))}},onProductUpdate:t=>{if(this.#w(t),this.#s){const r=this.#e.get(t.$id);r&&this.#s.upsertProduct(Tt(r.data)).catch(s=>console.error("[ProductsStore] Erreur persistence produit:",s))}},onProductDelete:t=>{this.#L(t),this.#s&&this.#s.deleteProduct(t).catch(r=>console.error("[ProductsStore] Erreur suppression produit:",r))},onPurchaseCreate:async t=>{if(t.status==="expense"){this.#t.set(t.$id,t);return}const r=await this.#U(t);await this.#y(r)},onPurchaseUpdate:async t=>{if(t.status==="expense"){this.#t.set(t.$id,t);return}this.#t.has(t.$id)&&this.#t.delete(t.$id);const r=await this.#H(t);await this.#y(r)},onPurchaseDelete:async t=>{if(this.#t.has(t)){this.#t.delete(t);return}const r=await this.#z(t);await this.#y(r)},onConnect:()=>{h(this.#d,!0)},onDisconnect:()=>{h(this.#d,!1)},onError:t=>{console.error("[ProductsStore] Erreur realtime:",t)}}}setSearchQuery=yo(t=>{o(this.#n).searchQuery=t},()=>500);toggleProductType(t){const r=o(this.#n).selectedProductTypes.indexOf(t);r>-1?o(this.#n).selectedProductTypes.splice(r,1):o(this.#n).selectedProductTypes.push(t)}toggleTemperature(t){const r=o(this.#n).selectedTemperatures.indexOf(t);r>-1?o(this.#n).selectedTemperatures.splice(r,1):o(this.#n).selectedTemperatures.push(t)}clearTypeAndTemperatureFilters(){o(this.#n).selectedProductTypes=[],o(this.#n).selectedTemperatures=[]}setGroupBy(t){o(this.#n).groupBy=t}toggleStore(t){const r=o(this.#n).selectedStores.indexOf(t);r>-1?o(this.#n).selectedStores.splice(r,1):o(this.#n).selectedStores.push(t)}toggleWho(t){const r=o(this.#n).selectedWho.indexOf(t);r>-1?o(this.#n).selectedWho.splice(r,1):o(this.#n).selectedWho.push(t)}clearStoreFilters(){o(this.#n).selectedStores=[]}clearWhoFilters(){o(this.#n).selectedWho=[]}handleSort(t){o(this.#n).sortColumn===t?o(this.#n).sortDirection=o(this.#n).sortDirection==="asc"?"desc":"asc":(o(this.#n).sortColumn=t,o(this.#n).sortDirection="asc")}clearFilters(){h(this.#n,{searchQuery:"",selectedStores:[],selectedWho:[],selectedProductTypes:[],selectedTemperatures:[],groupBy:"productType",sortColumn:"",sortDirection:"asc"},!0)}sortProducts(t){return o(this.#n).sortColumn?[...t].sort((r,s)=>{let n=r[o(this.#n).sortColumn],i=s[o(this.#n).sortColumn];return o(this.#n).sortColumn==="totalNeededConsolidated"?(n=parseFloat(n)||0,i=parseFloat(i)||0):o(this.#n).sortColumn==="purchases"&&(n=r.purchases?.length||0,i=s.purchases?.length||0),n<i?o(this.#n).sortDirection==="asc"?-1:1:n>i?o(this.#n).sortDirection==="asc"?1:-1:0}):t}getEnrichedProductById(t){return this.#e.get(t)?.data??null}getProductModelById(t){return this.#e.get(t)??null}hasConversions(t){const r=this.#e.get(t)?.data;return r?.byDate?bo(r.byDate):!1}async forceReload(t,r){await this.clearCache(),await this.initialize(t,r)}async clearCache(){this.#e.clear(),h(this.#c,null),this.#s&&await this.#s.clear(),console.log("[ProductsStore] Cache vidé")}setSyncStatus(t,r){const s=r?"isSyncing":"active";t.forEach(n=>{const i=this.#e.get(n);if(i){const a={...i.data,status:s};i.update(a)}}),console.log(`[ProductsStore] Statut de synchronisation mis à jour: ${t.length} produits → ${s}`)}clearSyncStatus(){const t=[];for(const[r,s]of this.#e)s.status==="isSyncing"&&t.push(r);t.length>0&&(this.setSyncStatus(t,!1),console.log(`[ProductsStore] Nettoyage de ${t.length} produits en statut "isSyncing"`))}destroy(){this.#h?.(),this.#h=null,this.#j(),this.#s&&(this.#s.close(),this.#s=null),console.log("[ProductsStore] Ressources nettoyées")}async#G(){if(o(this.#r))try{const{loadOrphanPurchases:t}=await xs(async()=>{const{loadOrphanPurchases:s}=await Promise.resolve().then(()=>Gs);return{loadOrphanPurchases:s}},void 0),r=await t(o(this.#r));r.forEach(s=>{this.#t.set(s.$id,s)}),console.log(`[ProductsStore] ${r.length} dépenses globales chargées`)}catch(t){console.error("[ProductsStore] Erreur chargement dépenses globales:",t)}}#N=Q(()=>{let t=0;const r={},s={},n=[];for(const i of this.#t.values()){const a=i.invoiceTotal||i.price||0;t+=a;const l=i.store||"Non défini";r[l]=(r[l]||0)+a;const c=i.who||"Non défini";s[c]=(s[c]||0)+a,n.push(i)}for(const i of this.#e.values()){const a=i.data;if(a.purchases&&a.purchases.length>0){for(const l of a.purchases)if(l.price){t+=l.price;const c=l.store||"Non défini";r[c]=(r[c]||0)+l.price;const u=l.who||"Non défini";s[u]=(s[u]||0)+l.price;const d={...l,_productName:a.productName};n.push(d)}}}return n.sort((i,a)=>{const l=new Date(i.orderDate||i.$createdAt).getTime();return new Date(a.orderDate||a.$createdAt).getTime()-l}),{totalGlobal:t,byStore:r,byWho:s,allPurchases:n}});get financialStats(){return o(this.#N)}set financialStats(t){h(this.#N,t)}}const Ee=new Jo;function Js(){if(typeof window>"u")throw new Error("getMainIdFromUrl() appelé côté serveur - SSR non supporté");const t=new URLSearchParams(window.location.search).get("listId");if(!t||!t.trim())throw new Error("Paramètre 'listId' manquant ou vide dans l'URL. Format attendu : ?listId=votre-event-id");return t.trim()}function Xo(e){const t=e.substring(0,4),r=e.slice(-10);return`${t}_${r}`}/**
 * @license @lucide/svelte v0.545.0 - ISC
 *
 * ISC License
 * 
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 * 
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 * 
 * ---
 * 
 * The MIT License (MIT) (for portions derived from Feather)
 * 
 * Copyright (c) 2013-2023 Cole Bemis
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
 */const Zo={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};var Fo=La("<svg><!><!></svg>");function at(e,t){me(t,!0);const r=Ge(t,"color",3,"currentColor"),s=Ge(t,"size",3,24),n=Ge(t,"strokeWidth",3,2),i=Ge(t,"absoluteStrokeWidth",3,!1),a=Ge(t,"iconNode",19,()=>[]),l=Ze(t,["$$slots","$$events","$$legacy","name","color","size","strokeWidth","absoluteStrokeWidth","iconNode","children"]);var c=Fo();Rs(c,p=>({...Zo,...l,width:s(),height:s(),stroke:r(),"stroke-width":p,class:["lucide-icon lucide",t.name&&`lucide-${t.name}`,t.class]}),[()=>i()?Number(n())*24/Number(s()):n()]);var u=_(c);dt(u,17,a,Yt,(p,v)=>{var f=Q(()=>Di(o(v),2));let g=()=>o(f)[0],S=()=>o(f)[1];var b=de(),E=G(b);Ga(E,g,!0,(R,I)=>{Rs(R,()=>({...S()}))}),C(p,b)});var d=w(u);Xe(d,()=>t.children??qe),C(e,c),_e()}function el(e,t){me(t,!0);/**
 * @license @lucide/svelte v0.545.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let r=Ze(t,["$$slots","$$events","$$legacy"]);const s=[["path",{d:"m6 9 6 6 6-6"}]];at(e,it({name:"chevron-down"},()=>r,{get iconNode(){return s},children:(n,i)=>{var a=de(),l=G(a);Xe(l,()=>t.children??qe),C(n,a)},$$slots:{default:!0}})),_e()}function tl(e,t){me(t,!0);/**
 * @license @lucide/svelte v0.545.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let r=Ze(t,["$$slots","$$events","$$legacy"]);const s=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56"}]];at(e,it({name:"loader-circle"},()=>r,{get iconNode(){return s},children:(n,i)=>{var a=de(),l=G(a);Xe(l,()=>t.children??qe),C(n,a)},$$slots:{default:!0}})),_e()}function rl(e,t){me(t,!0);/**
 * @license @lucide/svelte v0.545.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let r=Ze(t,["$$slots","$$events","$$legacy"]);const s=[["path",{d:"m10 17 5-5-5-5"}],["path",{d:"M15 12H3"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"}]];at(e,it({name:"log-in"},()=>r,{get iconNode(){return s},children:(n,i)=>{var a=de(),l=G(a);Xe(l,()=>t.children??qe),C(n,a)},$$slots:{default:!0}})),_e()}function sl(e,t){me(t,!0);/**
 * @license @lucide/svelte v0.545.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let r=Ze(t,["$$slots","$$events","$$legacy"]);const s=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401"}]];at(e,it({name:"moon"},()=>r,{get iconNode(){return s},children:(n,i)=>{var a=de(),l=G(a);Xe(l,()=>t.children??qe),C(n,a)},$$slots:{default:!0}})),_e()}function nl(e,t){me(t,!0);/**
 * @license @lucide/svelte v0.545.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let r=Ze(t,["$$slots","$$events","$$legacy"]);const s=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"}],["path",{d:"M21 3v5h-5"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"}],["path",{d:"M8 16H3v5"}]];at(e,it({name:"refresh-cw"},()=>r,{get iconNode(){return s},children:(n,i)=>{var a=de(),l=G(a);Xe(l,()=>t.children??qe),C(n,a)},$$slots:{default:!0}})),_e()}function il(e,t){me(t,!0);/**
 * @license @lucide/svelte v0.545.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let r=Ze(t,["$$slots","$$events","$$legacy"]);const s=[["circle",{cx:"12",cy:"12",r:"4"}],["path",{d:"M12 2v2"}],["path",{d:"M12 20v2"}],["path",{d:"m4.93 4.93 1.41 1.41"}],["path",{d:"m17.66 17.66 1.41 1.41"}],["path",{d:"M2 12h2"}],["path",{d:"M20 12h2"}],["path",{d:"m6.34 17.66-1.41 1.41"}],["path",{d:"m19.07 4.93-1.41 1.41"}]];at(e,it({name:"sun"},()=>r,{get iconNode(){return s},children:(n,i)=>{var a=de(),l=G(a);Xe(l,()=>t.children??qe),C(n,a)},$$slots:{default:!0}})),_e()}function al(e,t){me(t,!0);/**
 * @license @lucide/svelte v0.545.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let r=Ze(t,["$$slots","$$events","$$legacy"]);const s=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"}],["path",{d:"M12 9v4"}],["path",{d:"M12 17h.01"}]];at(e,it({name:"triangle-alert"},()=>r,{get iconNode(){return s},children:(n,i)=>{var a=de(),l=G(a);Xe(l,()=>t.children??qe),C(n,a)},$$slots:{default:!0}})),_e()}function ol(e,t){me(t,!0);/**
 * @license @lucide/svelte v0.545.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let r=Ze(t,["$$slots","$$events","$$legacy"]);const s=[["path",{d:"M18 6 6 18"}],["path",{d:"m6 6 12 12"}]];at(e,it({name:"x"},()=>r,{get iconNode(){return s},children:(n,i)=>{var a=de(),l=G(a);Xe(l,()=>t.children??qe),C(n,a)},$$slots:{default:!0}})),_e()}K(["click"]);K(["click"]);K(["click"]);K(["keydown"]);K(["click"]);K(["click"]);K(["click"]);K(["click"]);K(["keydown","click"]);K(["click"]);K(["click"]);K(["click"]);K(["click"]);K(["click","input"]);K(["click","keydown"]);K(["click"]);K(["click"]);K(["click"]);K(["click"]);ra();var ll=k('<div class="fixed inset-0 flex items-center justify-center"><div class="flex flex-col items-center justify-center gap-4"><div class="loading loading-spinner loading-lg text-primary"></div> <p class="text-base-content/70">Chargement des produits...</p></div></div>');function cl(e){var t=ll();C(e,t)}var ul=k('<div class="alert alert-error shadow-lg"><svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l-2-2m0 0l-2-2m2 2l2-2m-2 2l-2 2m8-8l2 2m0 0l2 2m-2-2l-2-2m2 2l2 2"></path></svg> <div><h3 class="font-bold">Erreur</h3> <div class="text-sm"> </div></div></div>');function dl(e,t){var r=ul(),s=w(_(r),2),n=w(_(s),2),i=_(n);V(()=>q(i,t.message)),C(e,r)}var fl=k('<div class="alert bg-error/20"><div class="flex items-start gap-3"><!> <div class="flex-1"><h3 class="font-bold">Authentification requise</h3> <div class="text-sm"> </div></div></div></div>');function hl(e,t){var r=fl(),s=_(r),n=_(s);al(n,{class:"mt-0.5 h-6 w-6 shrink-0 stroke-current"});var i=w(n,2),a=w(_(i),2),l=_(a);V(()=>q(l,t.message||"Erreur inconnue")),C(e,r)}function pl(e){e.stopPropagation()}var vl=(e,t)=>e.key==="Escape"&&t(),gl=k('<div class="mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded" role="alert"> </div>'),ml=k('<div class="mb-4 p-3 bg-green-100 border border-green-400 text-green-700 rounded" role="status"> </div>'),_l=(e,t)=>h(t,!1),wl=k('<form><div class="mb-4"><label for="forgot-email" class="block text-sm font-medium text-gray-700 mb-2">Email</label> <input id="forgot-email" type="email" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="votre@email.com" required/></div> <button type="submit" class="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50"> </button></form> <div class="mt-4 text-center"><button class="text-blue-600 hover:text-blue-800 text-sm">← Retour à la connexion</button></div>',1),yl=(e,t)=>h(t,!0),bl=(e,t)=>h(t,!1),Sl=k(`<form><div class="mb-4"><label for="login-email" class="block text-sm font-medium text-gray-700 mb-2">Email</label> <input id="login-email" type="email" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="votre@email.com" required/></div> <div class="mb-4"><label for="login-password" class="block text-sm font-medium text-gray-700 mb-2">Mot de passe</label> <input id="login-password" type="password" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="••••••••" required/></div> <button type="submit" class="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50"> </button></form> <div class="mt-4 text-center space-y-2"><button class="text-blue-600 hover:text-blue-800 text-sm">Mot de passe oublié ?</button> <div class="text-sm text-gray-600">Pas encore de compte ? <button class="text-blue-600 hover:text-blue-800 ml-1">S'inscrire</button></div></div>`,1),El=(e,t)=>h(t,!0),Tl=k('<form><div class="mb-4"><label for="register-name" class="block text-sm font-medium text-gray-700 mb-2">Nom</label> <input id="register-name" type="text" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Votre nom" required/></div> <div class="mb-4"><label for="register-email" class="block text-sm font-medium text-gray-700 mb-2">Email</label> <input id="register-email" type="email" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="votre@email.com" required/></div> <div class="mb-4"><label for="register-password" class="block text-sm font-medium text-gray-700 mb-2">Mot de passe</label> <input id="register-password" type="password" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="••••••••" required/></div> <button type="submit" class="w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 transition-colors disabled:opacity-50"> </button></form> <div class="mt-4 text-center text-sm text-gray-600">Déjà un compte ? <button class="text-blue-600 hover:text-blue-800 ml-1">Se connecter</button></div>',1),Dl=k('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4"><div class="flex items-center justify-between p-6 border-b"><h2 id="modal-title" class="text-xl font-semibold text-gray-900"> </h2> <button class="text-gray-400 hover:text-gray-600 transition-colors p-1" aria-label="Fermer la modale"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="p-6"><!> <!> <!></div></div></div>');function Pl(e,t){me(t,!0);let r=Ge(t,"onClose",3,()=>{}),s=Ge(t,"onAuthSuccess",3,()=>{}),n=A(!0),i=A(!1),a=A(""),l=A(""),c=A(""),u=A(""),d=A(""),p=A(""),v=A(""),f=A(""),g=A(!1);function S(){if(typeof window<"u"&&window.AppwriteClient)return window.AppwriteClient;throw new Error("AppwriteClient non disponible")}async function b(L){if(L.preventDefault(),!o(c)||!o(u)){h(a,"Veuillez remplir tous les champs");return}h(i,!0),h(a,"");try{await(await S().getAccount()).createEmailPasswordSession(o(c),o(u)),h(l,"Connexion réussie !"),setTimeout(()=>{s()()},1e3)}catch(B){console.error("Erreur de connexion:",B),h(a,B.message||"Erreur lors de la connexion",!0)}finally{h(i,!1)}}async function E(L){if(L.preventDefault(),!o(d)||!o(p)||!o(v)){h(a,"Veuillez remplir tous les champs");return}h(i,!0),h(a,"");try{const Z=await S().getAccount();await Z.create("unique()",o(p),o(v),o(d)),await Z.createEmailPasswordSession(o(p),o(v)),h(l,"Compte créé et connecté !"),setTimeout(()=>{s()()},1e3)}catch(B){console.error("Erreur d'inscription:",B),h(a,B.message||"Erreur lors de la création du compte",!0)}finally{h(i,!1)}}async function R(L){if(L.preventDefault(),!o(f)){h(a,"Veuillez entrer votre email");return}h(i,!0),h(a,"");try{await(await S().getAccount()).createRecovery(o(f),`${window.location.origin}/reset-password`),h(l,"Email de réinitialisation envoyé !"),setTimeout(()=>{h(g,!1),h(f,"")},2e3)}catch(B){console.error("Erreur mot de passe oublié:",B),h(a,B.message||"Erreur lors de l'envoi de l'email",!0)}finally{h(i,!1)}}function I(){o(i)||r()()}bn(()=>{(o(n)||o(g))&&(h(a,""),h(l,""))});var D=Dl();D.__click=I,D.__keydown=[vl,I];var y=_(D);y.__click=[pl];var T=_(y),x=_(T),$=_(x),re=w(x,2);re.__click=I;var we=w(T,2),j=_(we);{var z=L=>{var B=gl(),Z=_(B);V(()=>q(Z,o(a))),C(L,B)};H(j,L=>{o(a)&&L(z)})}var se=w(j,2);{var Ce=L=>{var B=ml(),Z=_(B);V(()=>q(Z,o(l))),C(L,B)};H(se,L=>{o(l)&&L(Ce)})}var ne=w(se,2);{var fe=L=>{var B=wl(),Z=G(B),ze=_(Z),Fe=w(_(ze),2),he=w(ze,2),Ne=_(he),ye=w(Z,2),be=_(ye);be.__click=[_l,g],V(()=>{Fe.disabled=o(i),he.disabled=o(i),q(Ne,o(i)?"Envoi...":"Envoyer l'email de réinitialisation"),be.disabled=o(i)}),$r("submit",Z,R),lt(Fe,()=>o(f),ke=>h(f,ke)),C(L,B)},xe=L=>{var B=de(),Z=G(B);{var ze=he=>{var Ne=Sl(),ye=G(Ne),be=_(ye),ke=w(_(be),2),Qe=w(be,2),We=w(_(Qe),2),P=w(Qe,2),N=_(P),U=w(ye,2),Y=_(U);Y.__click=[yl,g];var X=w(Y,2),ee=w(_(X));ee.__click=[bl,n],V(()=>{ke.disabled=o(i),We.disabled=o(i),P.disabled=o(i),q(N,o(i)?"Connexion...":"Se connecter"),Y.disabled=o(i),ee.disabled=o(i)}),$r("submit",ye,b),lt(ke,()=>o(c),ie=>h(c,ie)),lt(We,()=>o(u),ie=>h(u,ie)),C(he,Ne)},Fe=he=>{var Ne=Tl(),ye=G(Ne),be=_(ye),ke=w(_(be),2),Qe=w(be,2),We=w(_(Qe),2),P=w(Qe,2),N=w(_(P),2),U=w(P,2),Y=_(U),X=w(ye,2),ee=w(_(X));ee.__click=[El,n],V(()=>{ke.disabled=o(i),We.disabled=o(i),N.disabled=o(i),U.disabled=o(i),q(Y,o(i)?"Création...":"Créer un compte"),ee.disabled=o(i)}),$r("submit",ye,E),lt(ke,()=>o(d),ie=>h(d,ie)),lt(We,()=>o(p),ie=>h(p,ie)),lt(N,()=>o(v),ie=>h(v,ie)),C(he,Ne)};H(Z,he=>{o(n)?he(ze):he(Fe,!1)},!0)}C(L,B)};H(ne,L=>{o(g)?L(fe):L(xe,!1)})}V(()=>{q($,o(g)?"Mot de passe oublié":o(n)?"Connexion":"Inscription"),re.disabled=o(i)}),C(e,D),_e()}K(["click","keydown"]);var Al=(e,t,r,s)=>t(o(r),o(s)),Rl=k('<button class="btn btn-sm btn-primary"> </button>'),Il=(e,t,r)=>t(o(r)),Cl=k('<button class="btn btn-ghost btn-xs btn-square" title="Voir les détails" aria-label="Voir les détails"><!></button>'),xl=(e,t,r)=>t(o(r)),Nl=k('<button class="btn btn-ghost btn-sm btn-circle absolute top-1 right-1" title="Fermer" aria-label="Fermer la notification"><!></button>'),kl=k('<div><div class="flex items-center justify-between gap-2"><div class="flex items-center gap-2"><!> <span class="text-xs"> </span></div> <div class="flex items-center gap-1"><!> <!> <!></div></div></div>'),$l=k("<div></div>");function Ol(e,t){me(t,!0);let r=Ge(t,"position",3,"toast-right toast-bottom"),s=Ge(t,"padding",3,"md");const n=Q(()=>s()==="sm"?"px-2 py-0.5":""),i=Q(()=>Ae.toasts);function a(p){return p==="success"||p==="info"}function l(p){Ae.dismiss(p.id)}function c(p){t.onShowDetails?.({id:p.id,message:p.message,details:p.details})}function u(p,v){v.onClick()}var d=$l();dt(d,21,()=>o(i),p=>p.id,(p,v)=>{var f=kl(),g=_(f),S=_(g),b=_(S);{var E=j=>{tl(j,{class:"h-5 w-5 animate-spin"})};H(b,j=>{o(v).state==="loading"&&j(E)})}var R=w(b,2),I=_(R),D=w(S,2),y=_(D);{var T=j=>{var z=de(),se=G(z);dt(se,17,()=>o(v).actions,Yt,(Ce,ne)=>{var fe=Rl();fe.__click=[Al,u,v,ne];var xe=_(fe);V(()=>q(xe,o(ne).label)),C(Ce,fe)}),C(j,z)};H(y,j=>{o(v).actions&&o(v).actions.length>0&&j(T)})}var x=w(y,2);{var $=j=>{var z=Cl();z.__click=[Il,c,v];var se=_(z);el(se,{class:"h-3 w-3"}),C(j,z)};H(x,j=>{o(v).details&&j($)})}var re=w(x,2);{var we=j=>{var z=Nl();z.__click=[xl,l,v];var se=_(z);ol(se,{class:"h-4 w-4"}),C(j,z)};H(re,j=>{(o(v).state==="error"||o(v).state==="warning"||!a(o(v).state))&&j(we)})}V(()=>{vr(f,1,`alert alert-${o(v).state??""} max-w-sm ${o(n)??""} shadow-lg`),q(I,o(v).message)}),C(p,f)}),V(()=>vr(d,1,`toast ${r()??""} z-50`)),C(e,d),_e()}K(["click"]);var Ml=k('<label class="swap swap-rotate"><input type="checkbox" class="theme-controller" value="another"/> <!> <!></label>');function ql(e){var t=Ml(),r=_(t),s=w(r,2);il(s,{class:"swap-on fill-current"});var n=w(s,2);sl(n,{class:"swap-off fill-current"}),C(e,t)}class Bl{dbName="recipes-cache";db=null;version=1;RECIPES_INDEX_STORE="recipes-index";RECIPES_DETAILS_STORE="recipes-details";METADATA_STORE="metadata";LAST_SYNC_KEY="lastSync";INDEX_HASH_KEY="indexHash";RECIPES_COUNT_KEY="recipesCount";async open(){if(!this.db)return new Promise((t,r)=>{const s=indexedDB.open(this.dbName,this.version);s.onerror=()=>r(s.error),s.onsuccess=()=>{this.db=s.result,console.log(`[RecipesIDBCache] Base ouverte: ${this.dbName}`),t()},s.onupgradeneeded=n=>{const i=n.target.result;i.objectStoreNames.contains(this.RECIPES_INDEX_STORE)||(i.createObjectStore(this.RECIPES_INDEX_STORE,{keyPath:"u"}),console.log("[RecipesIDBCache] Object store 'recipes-index' créé")),i.objectStoreNames.contains(this.RECIPES_DETAILS_STORE)||(i.createObjectStore(this.RECIPES_DETAILS_STORE,{keyPath:"uuid"}),console.log("[RecipesIDBCache] Object store 'recipes-details' créé")),i.objectStoreNames.contains(this.METADATA_STORE)||(i.createObjectStore(this.METADATA_STORE,{keyPath:"key"}),console.log("[RecipesIDBCache] Object store 'metadata' créé"))}})}async loadRecipesIndex(){if(!this.db)throw new Error("DB non ouverte");return new Promise((t,r)=>{const i=this.db.transaction(this.RECIPES_INDEX_STORE,"readonly").objectStore(this.RECIPES_INDEX_STORE).getAll();i.onsuccess=()=>{const a=new Map;i.result.forEach(l=>{a.set(l.u,l)}),console.log(`[RecipesIDBCache] ${a.size} recettes (index) chargées`),t(a)},i.onerror=()=>r(i.error)})}async saveRecipesIndex(t){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const n=this.db.transaction(this.RECIPES_INDEX_STORE,"readwrite"),i=n.objectStore(this.RECIPES_INDEX_STORE);i.clear(),t.forEach(a=>{i.put(a)}),n.oncomplete=()=>{console.log(`[RecipesIDBCache] ${t.size} recettes (index) sauvegardées`),r()},n.onerror=()=>s(n.error)})}async loadRecipeDetail(t){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const a=this.db.transaction(this.RECIPES_DETAILS_STORE,"readonly").objectStore(this.RECIPES_DETAILS_STORE).get(t);a.onsuccess=()=>{const l=a.result;l&&console.log(`[RecipesIDBCache] Détails de ${t} chargés depuis le cache`),r(l||null)},a.onerror=()=>s(a.error)})}async saveRecipeDetail(t){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const a=this.db.transaction(this.RECIPES_DETAILS_STORE,"readwrite").objectStore(this.RECIPES_DETAILS_STORE).put(t);a.onsuccess=()=>{console.log(`[RecipesIDBCache] Détails de ${t.uuid} sauvegardés`),r()},a.onerror=()=>s(a.error)})}async loadAllRecipeDetails(){if(!this.db)throw new Error("DB non ouverte");return new Promise((t,r)=>{const i=this.db.transaction(this.RECIPES_DETAILS_STORE,"readonly").objectStore(this.RECIPES_DETAILS_STORE).getAll();i.onsuccess=()=>{const a=new Map;i.result.forEach(l=>{a.set(l.uuid,l)}),console.log(`[RecipesIDBCache] ${a.size} détails de recettes chargés`),t(a)},i.onerror=()=>r(i.error)})}async deleteRecipeDetail(t){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const a=this.db.transaction(this.RECIPES_DETAILS_STORE,"readwrite").objectStore(this.RECIPES_DETAILS_STORE).delete(t);a.onsuccess=()=>r(),a.onerror=()=>s(a.error)})}async loadMetadata(){if(!this.db)throw new Error("DB non ouverte");return new Promise((t,r)=>{const i=this.db.transaction(this.METADATA_STORE,"readonly").objectStore(this.METADATA_STORE).getAll();i.onsuccess=()=>{const a=i.result,l={lastSync:null,indexHash:null,recipesCount:0};a.forEach(c=>{c.key===this.LAST_SYNC_KEY?l.lastSync=c.value:c.key===this.INDEX_HASH_KEY?l.indexHash=c.value:c.key===this.RECIPES_COUNT_KEY&&(l.recipesCount=c.value)}),console.log(`[RecipesIDBCache] Metadata chargées: count=${l.recipesCount}, hash=${l.indexHash}`),t(l)},i.onerror=()=>r(i.error)})}async saveMetadata(t){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const n=this.db.transaction(this.METADATA_STORE,"readwrite"),i=n.objectStore(this.METADATA_STORE);i.put({key:this.LAST_SYNC_KEY,value:t.lastSync}),i.put({key:this.INDEX_HASH_KEY,value:t.indexHash}),i.put({key:this.RECIPES_COUNT_KEY,value:t.recipesCount}),n.oncomplete=()=>{console.log("[RecipesIDBCache] Metadata sauvegardées"),r()},n.onerror=()=>s(n.error)})}async updateIndexHash(t){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const a=this.db.transaction(this.METADATA_STORE,"readwrite").objectStore(this.METADATA_STORE).put({key:this.INDEX_HASH_KEY,value:t});a.onsuccess=()=>{console.log(`[RecipesIDBCache] indexHash mis à jour: ${t}`),r()},a.onerror=()=>s(a.error)})}async clear(){if(!this.db)throw new Error("DB non ouverte");return new Promise((t,r)=>{const s=this.db.transaction([this.RECIPES_INDEX_STORE,this.RECIPES_DETAILS_STORE,this.METADATA_STORE],"readwrite");s.objectStore(this.RECIPES_INDEX_STORE).clear(),s.objectStore(this.RECIPES_DETAILS_STORE).clear(),s.objectStore(this.METADATA_STORE).clear(),s.oncomplete=()=>{console.log("[RecipesIDBCache] Cache vidé"),t()},s.onerror=()=>r(s.error)})}close(){this.db&&(this.db.close(),this.db=null,console.log("[RecipesIDBCache] Connexion fermée"))}}async function jl(){const e=new Bl;return await e.open(),e}function Ll(e){if(!Array.isArray(e)||e.length<8)throw new Error(`Format d'ingrédient invalide: ${JSON.stringify(e)}`);return{uuid:e[0],originalQuantity:e[1],originalUnit:e[2],normalizedQuantity:e[3],normalizedUnit:e[4],comment:e[5]||"",allergens:Array.isArray(e[6])?e[6]:[],type:e[7]||""}}function Ul(e){if(!e||typeof e!="object")throw new Error("Données de recette invalides");const t=[];return Array.isArray(e.ingredients)&&e.ingredients.forEach(r=>{try{t.push(Ll(r))}catch(s){console.warn("[parseRecipeData] Ingrédient invalide ignoré:",s)}}),{uuid:e.uuid||"",title:e.title||"",plate:e.plate||1,ingredients:t,preparation:e.preparation||""}}const Hl="/api/data.json";class zl{#e=new Pt;#t=new Pt;#r=A(!1);#a=A(null);#u=A(null);#l=A(!1);#i=null;#o=new Set;get loading(){return o(this.#r)}get error(){return o(this.#a)}get lastSync(){return o(this.#u)}get isInitialized(){return o(this.#l)}get recipesIndex(){return Array.from(this.#e.values())}get count(){return this.#e.size}get detailsLoadedCount(){return this.#t.size}async initialize(){if(o(this.#l)){console.log("[RecipesStore] Déjà initialisé");return}console.log("[RecipesStore] Initialisation..."),h(this.#r,!0),h(this.#a,null);try{this.#i=await jl();const t=await this.#i.loadRecipesIndex(),r=await this.#i.loadMetadata();t.size>0&&(console.log(`[RecipesStore] ${t.size} recettes (index) chargées depuis le cache`),this.#e=new Pt(t),h(this.#u,r.lastSync,!0)),await this.#d(),h(this.#l,!0),console.log(`[RecipesStore] Initialisation complétée: ${this.#e.size} recettes`)}catch(t){const r=t instanceof Error?t.message:"Erreur lors de l'initialisation";throw h(this.#a,r,!0),console.error("[RecipesStore]",r,t),t}finally{h(this.#r,!1)}}async#d(){try{console.log("[RecipesStore] Chargement de l'index depuis data.json...");const t=await fetch(Hl);if(!t.ok)throw new Error(`Erreur HTTP: ${t.status}`);const s=(await t.json()).recipes;if(!Array.isArray(s))throw new Error("Format de données invalide: recipes n'est pas un tableau");const n=await this.#c(JSON.stringify(s));if((await this.#i.loadMetadata()).indexHash===n){console.log("[RecipesStore] Index inchangé, utilisation du cache");return}const a=new Map;s.forEach(l=>{a.set(l.u,l)}),this.#e=new Pt(a),h(this.#u,new Date().toISOString(),!0),this.#i&&(await this.#i.saveRecipesIndex(a),await this.#i.saveMetadata({lastSync:o(this.#u),indexHash:n,recipesCount:a.size})),console.log(`[RecipesStore] ${a.size} recettes (index) chargées depuis data.json`)}catch(t){throw console.error("[RecipesStore] Erreur lors du chargement de l'index:",t),t}}async#c(t){const s=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",s);return Array.from(new Uint8Array(n)).map(a=>a.toString(16).padStart(2,"0")).join("")}getRecipeIndexByUuid(t){return this.#e.get(t)||null}searchRecipes(t){if(!t.trim())return this.recipesIndex;const r=t.toLowerCase();return this.recipesIndex.filter(s=>s.n.toLowerCase().includes(r))}getRecipesByType(t){return this.recipesIndex.filter(r=>r.t===t)}get availableTypes(){const t=new Set;return this.recipesIndex.forEach(r=>t.add(r.t)),Array.from(t).sort()}async getRecipeByUuid(t){const r=this.#t.get(t);if(r)return console.log(`[RecipesStore] Détails de ${t} déjà en mémoire`),r;if(this.#o.has(t)){for(console.log(`[RecipesStore] Chargement de ${t} déjà en cours, attente...`);this.#o.has(t);)await new Promise(s=>setTimeout(s,50));return this.#t.get(t)||null}this.#o.add(t);try{if(this.#i){const l=await this.#i.loadRecipeDetail(t);if(l)return this.#t.set(t,l),l}const s=this.#e.get(t);if(!s)return console.warn(`[RecipesStore] Recette ${t} non trouvée dans l'index`),null;console.log(`[RecipesStore] Chargement des détails de ${t} depuis ${s.p}...`);const n=await fetch(s.p);if(!n.ok)throw new Error(`Erreur HTTP: ${n.status}`);const i=await n.json(),a=Ul(i);return this.#t.set(t,a),this.#i&&await this.#i.saveRecipeDetail(a),console.log(`[RecipesStore] Détails de ${t} chargés et mis en cache`),a}catch(s){return console.error(`[RecipesStore] Erreur lors du chargement de ${t}:`,s),null}finally{this.#o.delete(t)}}async preloadRecipes(t){console.log(`[RecipesStore] Préchargement de ${t.length} recettes...`);const r=t.map(s=>this.getRecipeByUuid(s));await Promise.all(r),console.log("[RecipesStore] Préchargement terminé")}async createRecipe(t){throw new Error("createRecipe: Non implémenté - Phase 4")}async updateRecipe(t,r){throw new Error("updateRecipe: Non implémenté - Phase 4")}async deleteRecipe(t){throw new Error("deleteRecipe: Non implémenté - Phase 4")}async forceReloadIndex(){console.log("[RecipesStore] Rechargement forcé de l'index..."),h(this.#r,!0),h(this.#a,null);try{await this.#d(),console.log("[RecipesStore] Rechargement de l'index complété")}catch(t){const r=t instanceof Error?t.message:"Erreur lors du rechargement";throw h(this.#a,r,!0),console.error("[RecipesStore]",r,t),t}finally{h(this.#r,!1)}}async clearCache(){this.#i&&(await this.#i.clear(),console.log("[RecipesStore] Cache vidé")),this.#e.clear(),this.#t.clear(),h(this.#u,null),h(this.#l,!1)}destroy(){this.#i&&(this.#i.close(),this.#i=null),this.#e.clear(),this.#t.clear(),this.#o.clear(),h(this.#l,!1),console.log("[RecipesStore] Ressources nettoyées")}}const $e=new zl;var Ql=k('<div class="alert alert-info"><span>Chargement des recettes...</span></div>'),Wl=k('<div class="alert alert-error"><span> </span></div>'),Gl=k("<option> </option>"),Kl=(e,t,r)=>t(o(r).u),Yl=k('<tr><td class="font-medium"> </td><td><span class="badge badge-sm badge-outline"> </span></td><td><code class="text-xs"> </code></td><td><button class="btn btn-xs btn-primary">Détails</button></td></tr>'),Vl=k('<tr><td colspan="4" class="text-center text-gray-400">Aucune recette trouvée</td></tr>'),Jl=k('<div class="flex h-64 items-center justify-center"><span class="loading loading-spinner loading-lg"></span></div>'),Xl=k('<br/><span class="text-xs italic"> </span>',1),Zl=k('<span class="badge badge-warning badge-xs"> </span>'),Fl=k("<br/> <!>",1),ec=k('<tr><td><code class="text-xs"> </code> <!></td><td> </td><td class="font-medium"> </td><td><span class="badge badge-xs"> </span> <!></td></tr>'),tc=k('<div class="divider">Préparation</div> <div class="prose prose-sm max-w-none"><pre class="text-xs whitespace-pre-wrap"> </pre></div>',1),rc=k('<div class="card bg-base-200 shadow-xl"><div class="card-body"><h3 class="card-title"> </h3> <div class="divider">Informations</div> <div class="grid grid-cols-2 gap-2 text-sm"><div><span class="font-semibold">UUID:</span> <code class="ml-2 text-xs"> </code></div> <div><span class="font-semibold">Couverts:</span> <span class="ml-2"> </span></div></div> <div class="divider"> </div> <div class="max-h-64 overflow-x-auto"><table class="table-xs table"><thead><tr><th>Ingrédient</th><th>Qté Orig.</th><th>Qté Norm.</th><th>Type</th></tr></thead><tbody></tbody></table></div> <!></div></div>'),sc=k('<div class="alert alert-info"><span>Sélectionnez une recette pour voir ses détails</span></div>'),nc=k('<div class="stats mb-4 shadow"><div class="stat"><div class="stat-title">Total Recettes</div> <div class="stat-value"> </div></div> <div class="stat"><div class="stat-title">Détails Chargés</div> <div class="stat-value"> </div></div> <div class="stat"><div class="stat-title">Types</div> <div class="stat-value"> </div></div></div> <div class="grid grid-cols-1 gap-4 lg:grid-cols-2"><div><h2 class="mb-3 text-xl font-semibold">Index des Recettes</h2> <div class="mb-4 flex gap-2"><input type="text" placeholder="Rechercher..." class="input input-bordered flex-1"/> <select class="select select-bordered"><option>Tous types</option><!></select></div> <div class="max-h-[600px] overflow-y-auto"><table class="table-sm table-zebra table"><thead class="bg-base-200 sticky top-0"><tr><th>Nom</th><th>Type</th><th>Couverts</th><th>Action</th></tr></thead><tbody></tbody></table></div> <div class="mt-2 text-sm text-gray-500"> </div></div> <div><h2 class="mb-3 text-xl font-semibold">Détails de la Recette</h2> <!></div></div>',1),ic=k('<div class="container mx-auto p-4"><h1 class="mb-4 text-2xl font-bold">Test RecipesStore</h1> <!></div>');function ac(e,t){me(t,!0);let r=A(""),s=A(""),n=A(null),i=A(!1);const a=Q(()=>{let f=$e.recipesIndex;return o(r).trim()&&(f=$e.searchRecipes(o(r))),o(s)!==""&&(f=f.filter(g=>g.t===o(s))),f}),l=[{value:0,label:"Entrée"},{value:1,label:"Plat"},{value:2,label:"Dessert"}];async function c(f){h(i,!0);try{h(n,await $e.getRecipeByUuid(f),!0)}catch(g){console.error("Erreur de chargement:",g)}finally{h(i,!1)}}is(async()=>{try{await $e.initialize()}catch(f){console.error("Erreur d'initialisation:",f)}});var u=ic(),d=w(_(u),2);{var p=f=>{var g=Ql();C(f,g)},v=f=>{var g=de(),S=G(g);{var b=R=>{var I=Wl(),D=_(I),y=_(D);V(()=>q(y,`Erreur: ${$e.error??""}`)),C(R,I)},E=R=>{var I=nc(),D=G(I),y=_(D),T=w(_(y),2),x=_(T),$=w(y,2),re=w(_($),2),we=_(re),j=w($,2),z=w(_(j),2),se=_(z),Ce=w(D,2),ne=_(Ce),fe=w(_(ne),2),xe=_(fe),L=w(xe,2),B=_(L);B.value=B.__value="";var Z=w(B);dt(Z,17,()=>l,Yt,(P,N)=>{var U=Gl(),Y=_(U),X={};V(()=>{q(Y,o(N).label),X!==(X=o(N).value)&&(U.value=(U.__value=o(N).value)??"")}),C(P,U)});var ze=w(fe,2),Fe=_(ze),he=w(_(Fe));dt(he,21,()=>o(a),P=>P.u,(P,N)=>{var U=Yl(),Y=_(U),X=_(Y),ee=w(Y),ie=_(ee),Rr=_(ie),Mt=w(ee),Ir=_(Mt),sr=_(Ir),nr=w(Mt),Cr=_(nr);Cr.__click=[Kl,c,N],V((qt,xr)=>{q(X,o(N).n),q(Rr,qt),q(sr,xr)},[()=>l.find(qt=>qt.value===o(N).t)?.label||o(N).t,()=>o(N).u.substring(0,6)]),C(P,U)},P=>{var N=Vl();C(P,N)});var Ne=w(ze,2),ye=_(Ne),be=w(ne,2),ke=w(_(be),2);{var Qe=P=>{var N=Jl();C(P,N)},We=P=>{var N=de(),U=G(N);{var Y=ee=>{var ie=rc(),Rr=_(ie),Mt=_(Rr),Ir=_(Mt),sr=w(Mt,4),nr=_(sr),Cr=w(_(nr),2),qt=_(Cr),xr=w(nr,2),si=w(_(xr),2),ni=_(si),cs=w(sr,2),ii=_(cs),us=w(cs,2),ai=_(us),oi=w(_(ai));dt(oi,21,()=>o(n).ingredients,Yt,(Bt,Se)=>{var ir=ec(),ar=_(ir),or=_(ar),ui=_(or),di=w(or,2);{var fi=ot=>{var jt=Xl(),Nr=w(G(jt)),kr=_(Nr);V(()=>q(kr,o(Se).comment)),C(ot,jt)};H(di,ot=>{o(Se).comment&&ot(fi)})}var ds=w(ar),hi=_(ds),fs=w(ds),pi=_(fs),vi=w(fs),hs=_(vi),gi=_(hs),mi=w(hs,2);{var _i=ot=>{var jt=Fl(),Nr=w(G(jt),2);dt(Nr,17,()=>o(Se).allergens,Yt,(kr,wi)=>{var ps=Zl(),yi=_(ps);V(()=>q(yi,o(wi))),C(kr,ps)}),C(ot,jt)};H(mi,ot=>{o(Se).allergens.length>0&&ot(_i)})}V(()=>{q(ui,o(Se).uuid),q(hi,`${o(Se).originalQuantity??""} ${o(Se).originalUnit??""}`),q(pi,`${o(Se).normalizedQuantity??""}
                          ${o(Se).normalizedUnit??""}`),q(gi,o(Se).type)}),C(Bt,ir)});var li=w(us,2);{var ci=Bt=>{var Se=tc(),ir=w(G(Se),2),ar=_(ir),or=_(ar);V(()=>q(or,o(n).preparation)),C(Bt,Se)};H(li,Bt=>{o(n).preparation&&Bt(ci)})}V(()=>{q(Ir,o(n).title),q(qt,o(n).uuid),q(ni,o(n).plate),q(ii,`Ingrédients (${o(n).ingredients.length??""})`)}),C(ee,ie)},X=ee=>{var ie=sc();C(ee,ie)};H(U,ee=>{o(n)?ee(Y):ee(X,!1)},!0)}C(P,N)};H(ke,P=>{o(i)?P(Qe):P(We,!1)})}V(()=>{q(x,$e.count),q(we,$e.detailsLoadedCount),q(se,$e.availableTypes.length),q(ye,`Affichage de ${o(a).length??""} / ${$e.count??""} recettes`)}),lt(xe,()=>o(r),P=>h(r,P)),Fa(L,()=>o(s),P=>h(s,P)),C(R,I)};H(S,R=>{$e.error?R(b):R(E,!1)},!0)}C(f,g)};H(d,f=>{$e.loading?f(p):f(v,!1)})}C(e,u),_e()}K(["click"]);function oc(e,t){h(t,!0)}var lc=k('<div class="text-success flex items-center gap-2"><div class="badge badge-success badge-sm">Temps réel connecté</div></div>'),cc=k('<div class="text-info flex items-center gap-2"><div class="loading loading-spinner loading-xs"></div> <span>Synchronisation...</span></div>'),uc=k('<div class="text-base-content/60"> </div>'),dc=k('<button title="Forcer le rechargement depuis Appwrite"><!></button>'),fc=k('<div><button class="btn btn-primary btn-sm"><!> Se connecter</button></div>'),hc=k('<div class="alert alert-info"><div><svg class="h-6 w-6 shrink-0 stroke-current" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span>Aucun produit trouvé</span></div></div>'),pc=k('<header class="bg-base-300 top-10 z-10 shadow-sm"><div class="container mx-auto px-4 py-2"><div class="flex items-center justify-between"><div><h1 class="text-1xl text-base-content font-bold">Liste de courses</h1></div> <div class="flex items-center gap-4 text-sm"><!> <!> <!> <!> <!> <!></div></div></div></header> <main class="container mx-auto px-4 py-8"><!> <!> <!></main>',1),vc=k('<div class="bg-base-200 min-h-screen"><!>  <!></div> <!>',1);function gc(e,t){me(t,!0);let r,s=A(null),n=A(!0),i=A(!1),a=A(!1);function l(y,T,x){localStorage.setItem("appwrite-user-email",y),localStorage.setItem("appwrite-user-name",T)}async function c(){const y=Js();r=Xo(y);try{if(!window.AppwriteClient)throw new Error("AppwriteClient non disponible");if(!await window.AppwriteClient.isConnectedAppwrite())throw new Error("Veuillez vous connecter pour accéder à la liste des produits.");console.log("[App] Utilisateur connecté, initialisation du store...");const $=await(await window.AppwriteClient.getAccount()).get();l($.email,$.name),await Ee.initialize(r,y)}catch(T){const x=T instanceof Error?T.message:"Erreur lors de l'initialisation";h(s,x,!0),console.error("[App] Erreur initialisation:",T)}finally{h(n,!1)}}is(async()=>{await c()});async function u(){h(a,!1),h(n,!0),h(s,null),await c()}io(()=>{Ee.destroy()});async function d(){if(!(!r||o(i))){h(i,!0);try{const y=Js();await Ee.forceReload(r,y)}catch(y){console.error("[App] Erreur lors du rechargement forcé:",y)}finally{h(i,!1)}}}const p=Q(()=>o(s)||Ee.error),v=Q(()=>o(n)||Ee.loading);var f=vc(),g=G(f),S=_(g);Ol(S,{});var b=w(S,2);{var E=y=>{cl(y)},R=y=>{var T=pc(),x=G(T),$=_(x),re=_($),we=w(_(re),2),j=_(we);{var z=P=>{var N=lc();C(P,N)};H(j,P=>{Ee.realtimeConnected&&P(z)})}var se=w(j,2);{var Ce=P=>{var N=cc();C(P,N)};H(se,P=>{Ee.syncing&&P(Ce)})}var ne=w(se,2);{var fe=P=>{var N=uc(),U=_(N);V(Y=>q(U,`Maj: ${Y??""}`),[()=>new Date(Ee.lastSync).toLocaleTimeString()]),C(P,N)};H(ne,P=>{Ee.lastSync&&P(fe)})}var xe=w(ne,2);ql(xe);var L=w(xe,2);{var B=P=>{var N=dc();let U;N.__click=d;var Y=_(N);nl(Y,{class:"h-4 w-4"}),V(X=>{U=vr(N,1,"btn btn-outline btn-sm",null,U,X),N.disabled=o(i)||Ee.loading},[()=>({loading:o(i)||Ee.loading})]),C(P,N)};H(L,P=>{o(s)||P(B)})}var Z=w(L,2);{var ze=P=>{var N=fc(),U=_(N);U.__click=[oc,a];var Y=_(U);rl(Y,{class:"mr-2 h-4 w-4"}),C(P,N)};H(Z,P=>{o(s)&&P(ze)})}var Fe=w(x,2),he=_(Fe);{var Ne=P=>{hl(P,{get message(){return o(p)}})},ye=P=>{var N=de(),U=G(N);{var Y=X=>{dl(X,{get message(){return o(p)}})};H(U,X=>{o(p)&&X(Y)},!0)}C(P,N)};H(he,P=>{o(s)?P(Ne):P(ye,!1)})}var be=w(he,2);ac(be,{});var ke=w(be,2);{var Qe=P=>{},We=P=>{var N=de(),U=G(N);{var Y=X=>{var ee=hc();C(X,ee)};H(U,X=>{!Ee.loading&&!o(s)&&X(Y)},!0)}C(P,N)};H(ke,P=>{Ee.enrichedProducts.length>0?P(Qe):P(We,!1)})}C(y,T)};H(b,y=>{o(v)?y(E):y(R,!1)})}var I=w(g,2);{var D=y=>{Pl(y,{onClose:()=>h(a,!1),onAuthSuccess:u})};H(I,y=>{o(a)&&y(D)})}C(e,f),_e()}K(["click"]);const ri=document.getElementById("app_products");if(!ri)throw new Error("Élément target non trouvé: #app_products");Ua(gc,{target:ri});
