(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();const Fr=!1;var bt=Array.isArray,Qn=Array.prototype.indexOf,Yt=Array.from,Bt=Object.defineProperty,Ze=Object.getOwnPropertyDescriptor,Xn=Object.prototype,Zn=Array.prototype,es=Object.getPrototypeOf,wr=Object.isExtensible;const ts=()=>{};function rs(e){for(var t=0;t<e.length;t++)e[t]()}function Dr(){var e,t,r=new Promise((n,s)=>{e=n,t=s});return{promise:r,resolve:e,reject:t}}const B=2,Jt=4,Qt=8,Ae=16,he=32,ke=64,Xt=128,X=256,wt=512,F=1024,K=2048,Se=4096,se=8192,Ve=16384,Zt=32768,Et=65536,yr=1<<17,ns=1<<18,We=1<<19,ss=1<<20,Vt=1<<21,Pt=1<<22,xe=1<<23,et=Symbol("$state"),tt=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Lr(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function is(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function as(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function ls(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function os(e){throw new Error("https://svelte.dev/e/effect_orphan")}function us(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function cs(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function fs(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function ds(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function vs(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Ct=1,xt=2,$r=4,hs=8,_s=16,ps=1,gs=2,M=Symbol();function ms(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function ws(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}let ys=!1;function jr(e){return e===this.v}function Ss(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function Ur(e){return!Ss(e,this.v)}let bs=!1,V=null;function $e(e){V=e}function Br(e,t=!1,r){V={p:V,c:null,e:null,s:e,x:null,l:null}}function Vr(e){var t=V,r=t.e;if(r!==null){t.e=null;for(var n of r)ln(n)}return V=t.p,{}}function Wr(){return!0}let Ce=[];function zr(){var e=Ce;Ce=[],rs(e)}function je(e){if(Ce.length===0&&!rt){var t=Ce;queueMicrotask(()=>{t===Ce&&zr()})}Ce.push(e)}function Es(){for(;Ce.length>0;)zr()}const Ps=new WeakMap;function Hr(e){var t=y;if(t===null)return w.f|=xe,e;if((t.f&Zt)===0){if((t.f&Xt)===0)throw!t.parent&&e instanceof Error&&Kr(e),e;t.b.error(e)}else Ue(e,t)}function Ue(e,t){for(;t!==null;){if((t.f&Xt)!==0)try{t.b.error(e);return}catch(r){e=r}t=t.parent}throw e instanceof Error&&Kr(e),e}function Kr(e){const t=Ps.get(e);t&&(Bt(e,"message",{value:t.message}),Bt(e,"stack",{value:t.stack}))}const pt=new Set;let q=null,mt=null,Wt=new Set,ue=[],qt=null,zt=!1,rt=!1;class Q{current=new Map;#e=new Map;#t=new Set;#u=0;#i=null;#l=[];#r=[];#s=[];#n=[];#a=[];#o=[];skipped_effects=new Set;process(t){ue=[],mt=null;var r=Q.apply(this);for(const i of t)this.#f(i);if(this.#u===0){this.#d();var n=this.#r,s=this.#s;this.#r=[],this.#s=[],this.#n=[],mt=this,q=null,Sr(n),Sr(s),mt=null,this.#i?.resolve()}else this.#c(this.#r),this.#c(this.#s),this.#c(this.#n);r();for(const i of this.#l)at(i);this.#l=[]}#f(t){t.f^=F;for(var r=t.first;r!==null;){var n=r.f,s=(n&(he|ke))!==0,i=s&&(n&F)!==0,a=i||(n&se)!==0||this.skipped_effects.has(r);if(!a&&r.fn!==null){s?r.f^=F:(n&Jt)!==0?this.#s.push(r):(n&F)===0&&((n&Pt)!==0&&r.b?.is_pending()?this.#l.push(r):Tt(r)&&((r.f&Ae)!==0&&this.#n.push(r),at(r)));var o=r.first;if(o!==null){r=o;continue}}var l=r.parent;for(r=r.next;r===null&&l!==null;)r=l.next,l=l.parent}}#c(t){for(const r of t)((r.f&K)!==0?this.#a:this.#o).push(r),j(r,F);t.length=0}capture(t,r){this.#e.has(t)||this.#e.set(t,r),this.current.set(t,t.v)}activate(){q=this}deactivate(){q=null}flush(){if(ue.length>0){if(this.activate(),Gr(),q!==null&&q!==this)return}else this.#u===0&&this.#d();this.deactivate();for(const t of Wt)if(Wt.delete(t),t(),q!==null)break}#d(){for(const t of this.#t)t();if(this.#t.clear(),pt.size>1){this.#e.clear();let t=!0;for(const r of pt){if(r===this){t=!1;continue}for(const[n,s]of this.current){if(r.current.has(n))if(t)r.current.set(n,s);else continue;Yr(n)}if(ue.length>0){q=r;const n=Q.apply(r);for(const s of ue)r.#f(s);ue=[],n()}}q=null}pt.delete(this)}increment(){this.#u+=1}decrement(){this.#u-=1;for(const t of this.#a)j(t,K),Ie(t);for(const t of this.#o)j(t,Se),Ie(t);this.flush()}add_callback(t){this.#t.add(t)}settled(){return(this.#i??=Dr()).promise}static ensure(){if(q===null){const t=q=new Q;pt.add(q),rt||Q.enqueue(()=>{q===t&&t.flush()})}return q}static enqueue(t){je(t)}static apply(t){return ts}}function Cs(e){var t=rt;rt=!0;try{for(var r;;){if(Es(),ue.length===0&&(q?.flush(),ue.length===0))return qt=null,r;Gr()}}finally{rt=t}}function Gr(){var e=Le;zt=!0;try{var t=0;for(Cr(!0);ue.length>0;){var r=Q.ensure();if(t++>1e3){var n,s;xs()}r.process(ue),ye.clear()}}finally{zt=!1,Cr(e),qt=null}}function xs(){try{us()}catch(e){Ue(e,qt)}}let Pe=null;function Sr(e){var t=e.length;if(t!==0){for(var r=0;r<t;){var n=e[r++];if((n.f&(Ve|se))===0&&Tt(n)&&(Pe=[],at(n),n.deps===null&&n.first===null&&n.nodes_start===null&&(n.teardown===null&&n.ac===null?fn(n):n.fn=null),Pe?.length>0)){ye.clear();for(const s of Pe)at(s);Pe=[]}}Pe=null}}function Yr(e){if(e.reactions!==null)for(const t of e.reactions){const r=t.f;(r&B)!==0?Yr(t):(r&(Pt|Ae))!==0&&(j(t,K),Ie(t))}}function Ie(e){for(var t=qt=e;t.parent!==null;){t=t.parent;var r=t.f;if(zt&&t===y&&(r&Ae)!==0)return;if((r&(ke|he))!==0){if((r&F)===0)return;t.f^=F}}ue.push(t)}function er(e){let t=0,r=Te(0),n;return()=>{Vs()&&(f(r),on(()=>(t===0&&(n=ut(()=>e(()=>nt(r)))),t+=1,()=>{je(()=>{t-=1,t===0&&(n?.(),n=void 0,nt(r))})})))}}var qs=Et|We|Xt;function Is(e,t,r){new Ts(e,t,r)}class Ts{parent;#e=!1;#t;#u=null;#i;#l;#r;#s=null;#n=null;#a=null;#o=null;#f=0;#c=0;#d=!1;#v=null;#g=()=>{this.#v&&Be(this.#v,this.#f)};#m=er(()=>(this.#v=Te(this.#f),()=>{this.#v=null}));constructor(t,r,n){this.#t=t,this.#i=r,this.#l=n,this.parent=y.b,this.#e=!!this.#i.pending,this.#r=nr(()=>{y.b=this;{try{this.#s=re(()=>n(this.#t))}catch(s){this.error(s)}this.#c>0?this.#_():this.#e=!1}},qs)}#w(){try{this.#s=re(()=>this.#l(this.#t))}catch(t){this.error(t)}this.#e=!1}#y(){const t=this.#i.pending;t&&(this.#n=re(()=>t(this.#t)),Q.enqueue(()=>{this.#s=this.#h(()=>(Q.ensure(),re(()=>this.#l(this.#t)))),this.#c>0?this.#_():(De(this.#n,()=>{this.#n=null}),this.#e=!1)}))}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#i.pending}#h(t){var r=y,n=w,s=V;ce(this.#r),U(this.#r),$e(this.#r.ctx);try{return t()}catch(i){return Hr(i),null}finally{ce(r),U(n),$e(s)}}#_(){const t=this.#i.pending;this.#s!==null&&(this.#o=document.createDocumentFragment(),As(this.#s,this.#o)),this.#n===null&&(this.#n=re(()=>t(this.#t)))}#p(t){if(!this.has_pending_snippet()){this.parent&&this.parent.#p(t);return}this.#c+=t,this.#c===0&&(this.#e=!1,this.#n&&De(this.#n,()=>{this.#n=null}),this.#o&&(this.#t.before(this.#o),this.#o=null),je(()=>{Q.ensure().flush()}))}update_pending_count(t){this.#p(t),this.#f+=t,Wt.add(this.#g)}get_effect_pending(){return this.#m(),f(this.#v)}error(t){var r=this.#i.onerror;let n=this.#i.failed;if(this.#d||!r&&!n)throw t;this.#s&&(Z(this.#s),this.#s=null),this.#n&&(Z(this.#n),this.#n=null),this.#a&&(Z(this.#a),this.#a=null);var s=!1,i=!1;const a=()=>{if(s){ws();return}s=!0,i&&vs(),Q.ensure(),this.#f=0,this.#a!==null&&De(this.#a,()=>{this.#a=null}),this.#e=this.has_pending_snippet(),this.#s=this.#h(()=>(this.#d=!1,re(()=>this.#l(this.#t)))),this.#c>0?this.#_():this.#e=!1};var o=w;try{U(null),i=!0,r?.(t,a),i=!1}catch(l){Ue(l,this.#r&&this.#r.parent)}finally{U(o)}n&&je(()=>{this.#a=this.#h(()=>{this.#d=!0;try{return re(()=>{n(this.#t,()=>t,()=>a)})}catch(l){return Ue(l,this.#r.parent),null}finally{this.#d=!1}})})}}function As(e,t){for(var r=e.nodes_start,n=e.nodes_end;r!==null;){var s=r===n?null:ot(r);t.append(r),r=s}}function ks(e,t,r){const n=tr;if(t.length===0){r(e.map(n));return}var s=q,i=y,a=Rs();Promise.all(t.map(o=>Ns(o))).then(o=>{a();try{r([...e.map(n),...o])}catch(l){(i.f&Ve)===0&&Ue(l,i)}s?.deactivate(),Jr()}).catch(o=>{Ue(o,i)})}function Rs(){var e=y,t=w,r=V,n=q;return function(){ce(e),U(t),$e(r),n?.activate()}}function Jr(){ce(null),U(null),$e(null)}function tr(e){var t=B|K,r=w!==null&&(w.f&B)!==0?w:null;return y===null||r!==null&&(r.f&X)!==0?t|=X:y.f|=We,{ctx:V,deps:null,effects:null,equals:jr,f:t,fn:e,reactions:null,rv:0,v:M,wv:0,parent:r??y,ac:null}}function Ns(e,t){let r=y;r===null&&is();var n=r.b,s=void 0,i=Te(M),a=!w,o=new Map;return Ks(()=>{var l=Dr();s=l.promise;try{Promise.resolve(e()).then(l.resolve,l.reject)}catch(h){l.reject(h)}var u=q,c=n.is_pending();a&&(n.update_pending_count(1),c||(u.increment(),o.get(u)?.reject(tt),o.set(u,l)));const v=(h,_=void 0)=>{c||u.activate(),_?_!==tt&&(i.f|=xe,Be(i,_)):((i.f&xe)!==0&&(i.f^=xe),Be(i,h)),a&&(n.update_pending_count(-1),c||u.decrement()),Jr()};l.promise.then(v,h=>v(null,h||"unknown"))}),an(()=>{for(const l of o.values())l.reject(tt)}),new Promise(l=>{function u(c){function v(){c===s?l(i):u(s)}c.then(v,v)}u(s)})}function ae(e){const t=tr(e);return hn(t),t}function Ms(e){const t=tr(e);return t.equals=Ur,t}function Qr(e){var t=e.effects;if(t!==null){e.effects=null;for(var r=0;r<t.length;r+=1)Z(t[r])}}function Os(e){for(var t=e.parent;t!==null;){if((t.f&B)===0)return t;t=t.parent}return null}function rr(e){var t,r=y;ce(Os(e));try{Qr(e),t=mn(e)}finally{ce(r)}return t}function Xr(e){var t=rr(e);if(e.equals(t)||(e.v=t,e.wv=pn()),!ze){var r=(we||(e.f&X)!==0)&&e.deps!==null?Se:F;j(e,r)}}const ye=new Map;function Te(e,t){var r={f:0,v:e,reactions:null,equals:jr,rv:0,wv:0};return r}function J(e,t){const r=Te(e);return hn(r),r}function Fs(e,t=!1,r=!0){const n=Te(e);return t||(n.equals=Ur),n}function $(e,t,r=!1){w!==null&&(!ne||(w.f&yr)!==0)&&Wr()&&(w.f&(B|Ae|Pt|yr))!==0&&!ve?.includes(e)&&ds();let n=r?Qe(t):t;return Be(e,n)}function Be(e,t){if(!e.equals(t)){var r=e.v;ze?ye.set(e,t):ye.set(e,r),e.v=t;var n=Q.ensure();n.capture(e,r),(e.f&B)!==0&&((e.f&K)!==0&&rr(e),j(e,(e.f&X)===0?F:Se)),e.wv=pn(),Zr(e,K),y!==null&&(y.f&F)!==0&&(y.f&(he|ke))===0&&(Y===null?Js([e]):Y.push(e))}return t}function nt(e){$(e,e.v+1)}function Zr(e,t){var r=e.reactions;if(r!==null)for(var n=r.length,s=0;s<n;s++){var i=r[s],a=i.f,o=(a&K)===0;o&&j(i,t),(a&B)!==0?Zr(i,Se):o&&((a&Ae)!==0&&Pe!==null&&Pe.push(i),Ie(i))}}function Qe(e){if(typeof e!="object"||e===null||et in e)return e;const t=es(e);if(t!==Xn&&t!==Zn)return e;var r=new Map,n=bt(e),s=J(0),i=qe,a=o=>{if(qe===i)return o();var l=w,u=qe;U(null),qr(i);var c=o();return U(l),qr(u),c};return n&&r.set("length",J(e.length)),new Proxy(e,{defineProperty(o,l,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&cs();var c=r.get(l);return c===void 0?c=a(()=>{var v=J(u.value);return r.set(l,v),v}):$(c,u.value,!0),!0},deleteProperty(o,l){var u=r.get(l);if(u===void 0){if(l in o){const c=a(()=>J(M));r.set(l,c),nt(s)}}else $(u,M),nt(s);return!0},get(o,l,u){if(l===et)return e;var c=r.get(l),v=l in o;if(c===void 0&&(!v||Ze(o,l)?.writable)&&(c=a(()=>{var _=Qe(v?o[l]:M),d=J(_);return d}),r.set(l,c)),c!==void 0){var h=f(c);return h===M?void 0:h}return Reflect.get(o,l,u)},getOwnPropertyDescriptor(o,l){var u=Reflect.getOwnPropertyDescriptor(o,l);if(u&&"value"in u){var c=r.get(l);c&&(u.value=f(c))}else if(u===void 0){var v=r.get(l),h=v?.v;if(v!==void 0&&h!==M)return{enumerable:!0,configurable:!0,value:h,writable:!0}}return u},has(o,l){if(l===et)return!0;var u=r.get(l),c=u!==void 0&&u.v!==M||Reflect.has(o,l);if(u!==void 0||y!==null&&(!c||Ze(o,l)?.writable)){u===void 0&&(u=a(()=>{var h=c?Qe(o[l]):M,_=J(h);return _}),r.set(l,u));var v=f(u);if(v===M)return!1}return c},set(o,l,u,c){var v=r.get(l),h=l in o;if(n&&l==="length")for(var _=u;_<v.v;_+=1){var d=r.get(_+"");d!==void 0?$(d,M):_ in o&&(d=a(()=>J(M)),r.set(_+"",d))}if(v===void 0)(!h||Ze(o,l)?.writable)&&(v=a(()=>J(void 0)),$(v,Qe(u)),r.set(l,v));else{h=v.v!==M;var p=a(()=>Qe(u));$(v,p)}var m=Reflect.getOwnPropertyDescriptor(o,l);if(m?.set&&m.set.call(c,u),!h){if(n&&typeof l=="string"){var x=r.get("length"),E=Number(l);Number.isInteger(E)&&E>=x.v&&$(x,E+1)}nt(s)}return!0},ownKeys(o){f(s);var l=Reflect.ownKeys(o).filter(v=>{var h=r.get(v);return h===void 0||h.v!==M});for(var[u,c]of r)c.v!==M&&!(u in o)&&l.push(u);return l},setPrototypeOf(){fs()}})}function br(e){try{if(e!==null&&typeof e=="object"&&et in e)return e[et]}catch{}return e}function Ds(e,t){return Object.is(br(e),br(t))}var Er,en,tn,rn;function Ls(){if(Er===void 0){Er=window,en=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,r=Text.prototype;tn=Ze(t,"firstChild").get,rn=Ze(t,"nextSibling").get,wr(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),wr(r)&&(r.__t=void 0)}}function lt(e=""){return document.createTextNode(e)}function yt(e){return tn.call(e)}function ot(e){return rn.call(e)}function g(e,t){return yt(e)}function gt(e,t=!1){{var r=yt(e);return r instanceof Comment&&r.data===""?ot(r):r}}function C(e,t=1,r=!1){let n=e;for(;t--;)n=ot(n);return n}function $s(e){e.textContent=""}function nn(){return!1}let Pr=!1;function js(){Pr||(Pr=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function It(e){var t=w,r=y;U(null),ce(null);try{return e()}finally{U(t),ce(r)}}function sn(e,t,r,n=r){e.addEventListener(t,()=>It(r));const s=e.__on_r;s?e.__on_r=()=>{s(),n(!0)}:e.__on_r=()=>n(!0),js()}function Us(e){y===null&&w===null&&os(),w!==null&&(w.f&X)!==0&&y===null&&ls(),ze&&as()}function Bs(e,t){var r=t.last;r===null?t.last=t.first=e:(r.next=e,e.prev=r,t.last=e)}function _e(e,t,r,n=!0){var s=y;s!==null&&(s.f&se)!==0&&(e|=se);var i={ctx:V,deps:null,nodes_start:null,nodes_end:null,f:e|K,first:null,fn:t,last:null,next:null,parent:s,b:s&&s.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(r)try{at(i),i.f|=Zt}catch(l){throw Z(i),l}else t!==null&&Ie(i);if(n){var a=i;if(r&&a.deps===null&&a.teardown===null&&a.nodes_start===null&&a.first===a.last&&(a.f&We)===0&&(a=a.first),a!==null&&(a.parent=s,s!==null&&Bs(a,s),w!==null&&(w.f&B)!==0&&(e&ke)===0)){var o=w;(o.effects??=[]).push(a)}}return i}function Vs(){return w!==null&&!ne}function an(e){const t=_e(Qt,null,!1);return j(t,F),t.teardown=e,t}function Ws(e){Us();var t=y.f,r=!w&&(t&he)!==0&&(t&Zt)===0;if(r){var n=V;(n.e??=[]).push(e)}else return ln(e)}function ln(e){return _e(Jt|ss,e,!1)}function zs(e){Q.ensure();const t=_e(ke|We,e,!0);return(r={})=>new Promise(n=>{r.outro?De(t,()=>{Z(t),n(void 0)}):(Z(t),n(void 0))})}function Hs(e){return _e(Jt,e,!1)}function Ks(e){return _e(Pt|We,e,!0)}function on(e,t=0){return _e(Qt|t,e,!0)}function de(e,t=[],r=[]){ks(t,r,n=>{_e(Qt,()=>e(...n.map(f)),!0)})}function nr(e,t=0){var r=_e(Ae|t,e,!0);return r}function re(e,t=!0){return _e(he|We,e,!0,t)}function un(e){var t=e.teardown;if(t!==null){const r=ze,n=w;xr(!0),U(null);try{t.call(null)}finally{xr(r),U(n)}}}function cn(e,t=!1){var r=e.first;for(e.first=e.last=null;r!==null;){const s=r.ac;s!==null&&It(()=>{s.abort(tt)});var n=r.next;(r.f&ke)!==0?r.parent=null:Z(r,t),r=n}}function Gs(e){for(var t=e.first;t!==null;){var r=t.next;(t.f&he)===0&&Z(t),t=r}}function Z(e,t=!0){var r=!1;(t||(e.f&ns)!==0)&&e.nodes_start!==null&&e.nodes_end!==null&&(Ys(e.nodes_start,e.nodes_end),r=!0),cn(e,t&&!r),St(e,0),j(e,Ve);var n=e.transitions;if(n!==null)for(const i of n)i.stop();un(e);var s=e.parent;s!==null&&s.first!==null&&fn(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=e.ac=null}function Ys(e,t){for(;e!==null;){var r=e===t?null:ot(e);e.remove(),e=r}}function fn(e){var t=e.parent,r=e.prev,n=e.next;r!==null&&(r.next=n),n!==null&&(n.prev=r),t!==null&&(t.first===e&&(t.first=n),t.last===e&&(t.last=r))}function De(e,t){var r=[];sr(e,r,!0),dn(r,()=>{Z(e),t&&t()})}function dn(e,t){var r=e.length;if(r>0){var n=()=>--r||t();for(var s of e)s.out(n)}else t()}function sr(e,t,r){if((e.f&se)===0){if(e.f^=se,e.transitions!==null)for(const a of e.transitions)(a.is_global||r)&&t.push(a);for(var n=e.first;n!==null;){var s=n.next,i=(n.f&Et)!==0||(n.f&he)!==0;sr(n,t,i?r:!1),n=s}}}function ir(e){vn(e,!0)}function vn(e,t){if((e.f&se)!==0){e.f^=se,(e.f&F)===0&&(j(e,K),Ie(e));for(var r=e.first;r!==null;){var n=r.next,s=(r.f&Et)!==0||(r.f&he)!==0;vn(r,s?t:!1),r=n}if(e.transitions!==null)for(const i of e.transitions)(i.is_global||t)&&i.in()}}let Le=!1;function Cr(e){Le=e}let ze=!1;function xr(e){ze=e}let w=null,ne=!1;function U(e){w=e}let y=null;function ce(e){y=e}let ve=null;function hn(e){w!==null&&(ve===null?ve=[e]:ve.push(e))}let L=null,H=0,Y=null;function Js(e){Y=e}let _n=1,it=0,qe=it;function qr(e){qe=e}let we=!1;function pn(){return++_n}function Tt(e){var t=e.f;if((t&K)!==0)return!0;if((t&Se)!==0){var r=e.deps,n=(t&X)!==0;if(r!==null){var s,i,a=(t&wt)!==0,o=n&&y!==null&&!we,l=r.length;if((a||o)&&(y===null||(y.f&Ve)===0)){var u=e,c=u.parent;for(s=0;s<l;s++)i=r[s],(a||!i?.reactions?.includes(u))&&(i.reactions??=[]).push(u);a&&(u.f^=wt),o&&c!==null&&(c.f&X)===0&&(u.f^=X)}for(s=0;s<l;s++)if(i=r[s],Tt(i)&&Xr(i),i.wv>e.wv)return!0}(!n||y!==null&&!we)&&j(e,F)}return!1}function gn(e,t,r=!0){var n=e.reactions;if(n!==null&&!ve?.includes(e))for(var s=0;s<n.length;s++){var i=n[s];(i.f&B)!==0?gn(i,t,!1):t===i&&(r?j(i,K):(i.f&F)!==0&&j(i,Se),Ie(i))}}function mn(e){var t=L,r=H,n=Y,s=w,i=we,a=ve,o=V,l=ne,u=qe,c=e.f;L=null,H=0,Y=null,we=(c&X)!==0&&(ne||!Le||w===null),w=(c&(he|ke))===0?e:null,ve=null,$e(e.ctx),ne=!1,qe=++it,e.ac!==null&&(It(()=>{e.ac.abort(tt)}),e.ac=null);try{e.f|=Vt;var v=e.fn,h=v(),_=e.deps;if(L!==null){var d;if(St(e,H),_!==null&&H>0)for(_.length=H+L.length,d=0;d<L.length;d++)_[H+d]=L[d];else e.deps=_=L;if(!we||(c&B)!==0&&e.reactions!==null)for(d=H;d<_.length;d++)(_[d].reactions??=[]).push(e)}else _!==null&&H<_.length&&(St(e,H),_.length=H);if(Wr()&&Y!==null&&!ne&&_!==null&&(e.f&(B|Se|K))===0)for(d=0;d<Y.length;d++)gn(Y[d],e);return s!==null&&s!==e&&(it++,Y!==null&&(n===null?n=Y:n.push(...Y))),(e.f&xe)!==0&&(e.f^=xe),h}catch(p){return Hr(p)}finally{e.f^=Vt,L=t,H=r,Y=n,w=s,we=i,ve=a,$e(o),ne=l,qe=u}}function Qs(e,t){let r=t.reactions;if(r!==null){var n=Qn.call(r,e);if(n!==-1){var s=r.length-1;s===0?r=t.reactions=null:(r[n]=r[s],r.pop())}}r===null&&(t.f&B)!==0&&(L===null||!L.includes(t))&&(j(t,Se),(t.f&(X|wt))===0&&(t.f^=wt),Qr(t),St(t,0))}function St(e,t){var r=e.deps;if(r!==null)for(var n=t;n<r.length;n++)Qs(e,r[n])}function at(e){var t=e.f;if((t&Ve)===0){j(e,F);var r=y,n=Le;y=e,Le=!0;try{(t&Ae)!==0?Gs(e):cn(e),un(e);var s=mn(e);e.teardown=typeof s=="function"?s:null,e.wv=_n;var i;Fr&&bs&&(e.f&K)!==0&&e.deps}finally{Le=n,y=r}}}async function Xs(){await Promise.resolve(),Cs()}function f(e){var t=e.f,r=(t&B)!==0;if(w!==null&&!ne){var n=y!==null&&(y.f&Ve)!==0;if(!n&&!ve?.includes(e)){var s=w.deps;if((w.f&Vt)!==0)e.rv<it&&(e.rv=it,L===null&&s!==null&&s[H]===e?H++:L===null?L=[e]:(!we||!L.includes(e))&&L.push(e));else{(w.deps??=[]).push(e);var i=e.reactions;i===null?e.reactions=[w]:i.includes(w)||i.push(w)}}}else if(r&&e.deps===null&&e.effects===null){var a=e,o=a.parent;o!==null&&(o.f&X)===0&&(a.f^=X)}if(ze){if(ye.has(e))return ye.get(e);if(r){a=e;var l=a.v;return((a.f&F)===0&&a.reactions!==null||wn(a))&&(l=rr(a)),ye.set(a,l),l}}else r&&(a=e,Tt(a)&&Xr(a));if((e.f&xe)!==0)throw e.v;return e.v}function wn(e){if(e.v===M)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(ye.has(t)||(t.f&B)!==0&&wn(t))return!0;return!1}function ut(e){var t=ne;try{return ne=!0,e()}finally{ne=t}}const Zs=-7169;function j(e,t){e.f=e.f&Zs|t}const ei=["touchstart","touchmove"];function ti(e){return ei.includes(e)}const yn=new Set,Ht=new Set;function ri(e,t,r,n={}){function s(i){if(n.capture||Xe.call(t,i),!i.cancelBubble)return It(()=>r?.call(this,i))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?je(()=>{t.addEventListener(e,s,n)}):t.addEventListener(e,s,n),s}function Kt(e,t,r,n={}){var s=ri(t,e,r,n);return()=>{e.removeEventListener(t,s,n)}}function ni(e){for(var t=0;t<e.length;t++)yn.add(e[t]);for(var r of Ht)r(e)}let Ir=null;function Xe(e){var t=this,r=t.ownerDocument,n=e.type,s=e.composedPath?.()||[],i=s[0]||e.target;Ir=e;var a=0,o=Ir===e&&e.__root;if(o){var l=s.indexOf(o);if(l!==-1&&(t===document||t===window)){e.__root=t;return}var u=s.indexOf(t);if(u===-1)return;l<=u&&(a=l)}if(i=s[a]||e.target,i!==t){Bt(e,"currentTarget",{configurable:!0,get(){return i||r}});var c=w,v=y;U(null),ce(null);try{for(var h,_=[];i!==null;){var d=i.assignedSlot||i.parentNode||i.host||null;try{var p=i["__"+n];if(p!=null&&(!i.disabled||e.target===i))if(bt(p)){var[m,...x]=p;m.apply(i,[e,...x])}else p.call(i,e)}catch(E){h?_.push(E):h=E}if(e.cancelBubble||d===t||d===null)break;i=d}if(h){for(let E of _)queueMicrotask(()=>{throw E});throw h}}finally{e.__root=t,delete e.currentTarget,U(c),ce(v)}}}function si(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function Gt(e,t){var r=y;r.nodes_start===null&&(r.nodes_start=e,r.nodes_end=t)}function O(e,t){var r=(t&ps)!==0,n=(t&gs)!==0,s,i=!e.startsWith("<!>");return()=>{s===void 0&&(s=si(i?e:"<!>"+e),r||(s=yt(s)));var a=n||en?document.importNode(s,!0):s.cloneNode(!0);if(r){var o=yt(a),l=a.lastChild;Gt(o,l)}else Gt(a,a);return a}}function Tr(){var e=document.createDocumentFragment(),t=document.createComment(""),r=lt();return e.append(t,r),Gt(t,r),e}function R(e,t){e!==null&&e.before(t)}function D(e,t){var r=t==null?"":typeof t=="object"?t+"":t;r!==(e.__t??=e.nodeValue)&&(e.__t=r,e.nodeValue=r+"")}function ii(e,t){return ai(e,t)}const Fe=new Map;function ai(e,{target:t,anchor:r,props:n={},events:s,context:i,intro:a=!0}){Ls();var o=new Set,l=v=>{for(var h=0;h<v.length;h++){var _=v[h];if(!o.has(_)){o.add(_);var d=ti(_);t.addEventListener(_,Xe,{passive:d});var p=Fe.get(_);p===void 0?(document.addEventListener(_,Xe,{passive:d}),Fe.set(_,1)):Fe.set(_,p+1)}}};l(Yt(yn)),Ht.add(l);var u=void 0,c=zs(()=>{var v=r??t.appendChild(lt());return Is(v,{pending:()=>{}},h=>{if(i){Br({});var _=V;_.c=i}s&&(n.$$events=s),u=e(h,n)||{},i&&Vr()}),()=>{for(var h of o){t.removeEventListener(h,Xe);var _=Fe.get(h);--_===0?(document.removeEventListener(h,Xe),Fe.delete(h)):Fe.set(h,_)}Ht.delete(l),v!==r&&v.parentNode?.removeChild(v)}});return li.set(u,c),u}let li=new WeakMap;function te(e,t,r=!1){var n=e,s=null,i=null,a=M,o=r?Et:0,l=!1;const u=(_,d=!0)=>{l=!0,h(d,_)};var c=null;function v(){c!==null&&(c.lastChild.remove(),n.before(c),c=null);var _=a?s:i,d=a?i:s;_&&ir(_),d&&De(d,()=>{a?i=null:s=null})}const h=(_,d)=>{if(a!==(a=_)){var p=nn(),m=n;if(p&&(c=document.createDocumentFragment(),c.append(m=lt())),a?s??=d&&re(()=>d(m)):i??=d&&re(()=>d(m)),p){var x=q,E=a?s:i,I=a?i:s;E&&x.skipped_effects.delete(E),I&&x.skipped_effects.add(I),x.add_callback(v)}else v()}};nr(()=>{l=!1,t(u),l||h(null,null)},o)}function Ar(e,t){return t}function oi(e,t,r){for(var n=e.items,s=[],i=t.length,a=0;a<i;a++)sr(t[a].e,s,!0);var o=i>0&&s.length===0&&r!==null;if(o){var l=r.parentNode;$s(l),l.append(r),n.clear(),le(e,t[0].prev,t[i-1].next)}dn(s,()=>{for(var u=0;u<i;u++){var c=t[u];o||(n.delete(c.k),le(e,c.prev,c.next)),Z(c.e,!o)}})}function Lt(e,t,r,n,s,i=null){var a=e,o={flags:t,items:new Map,first:null},l=(t&$r)!==0;if(l){var u=e;a=u.appendChild(lt())}var c=null,v=!1,h=new Map,_=Ms(()=>{var x=r();return bt(x)?x:x==null?[]:Yt(x)}),d,p;function m(){ui(p,d,o,h,a,s,t,n,r),i!==null&&(d.length===0?c?ir(c):c=re(()=>i(a)):c!==null&&De(c,()=>{c=null}))}nr(()=>{p??=y,d=f(_);var x=d.length;if(!(v&&x===0)){v=x===0;var E,I,W,k;if(nn()){var b=new Set,P=q;for(I=0;I<x;I+=1){W=d[I],k=n(W,I);var G=o.items.get(k)??h.get(k);G?(t&(Ct|xt))!==0&&Sn(G,W,I,t):(E=bn(null,o,null,null,W,k,I,s,t,r,!0),h.set(k,E)),b.add(k)}for(const[be,Re]of o.items)b.has(be)||P.skipped_effects.add(Re.e);P.add_callback(m)}else m();f(_)}})}function ui(e,t,r,n,s,i,a,o,l){var u=(a&hs)!==0,c=(a&(Ct|xt))!==0,v=t.length,h=r.items,_=r.first,d=_,p,m=null,x,E=[],I=[],W,k,b,P;if(u)for(P=0;P<v;P+=1)W=t[P],k=o(W,P),b=h.get(k),b!==void 0&&(b.a?.measure(),(x??=new Set).add(b));for(P=0;P<v;P+=1){if(W=t[P],k=o(W,P),b=h.get(k),b===void 0){var G=n.get(k);if(G!==void 0){n.delete(k),h.set(k,G);var be=m?m.next:d;le(r,m,G),le(r,G,be),$t(G,be,s),m=G}else{var Re=d?d.e.nodes_start:s;m=bn(Re,r,m,m===null?r.first:m.next,W,k,P,i,a,l)}h.set(k,m),E=[],I=[],d=m.next;continue}if(c&&Sn(b,W,P,a),(b.e.f&se)!==0&&(ir(b.e),u&&(b.a?.unfix(),(x??=new Set).delete(b))),b!==d){if(p!==void 0&&p.has(b)){if(E.length<I.length){var pe=I[0],ie;m=pe.prev;var ct=E[0],ge=E[E.length-1];for(ie=0;ie<E.length;ie+=1)$t(E[ie],pe,s);for(ie=0;ie<I.length;ie+=1)p.delete(I[ie]);le(r,ct.prev,ge.next),le(r,m,ct),le(r,ge,pe),d=pe,m=ge,P-=1,E=[],I=[]}else p.delete(b),$t(b,d,s),le(r,b.prev,b.next),le(r,b,m===null?r.first:m.next),le(r,m,b),m=b;continue}for(E=[],I=[];d!==null&&d.k!==k;)(d.e.f&se)===0&&(p??=new Set).add(d),I.push(d),d=d.next;if(d===null)continue;b=d}E.push(b),m=b,d=b.next}if(d!==null||p!==void 0){for(var Ee=p===void 0?[]:Yt(p);d!==null;)(d.e.f&se)===0&&Ee.push(d),d=d.next;var He=Ee.length;if(He>0){var At=(a&$r)!==0&&v===0?s:null;if(u){for(P=0;P<He;P+=1)Ee[P].a?.measure();for(P=0;P<He;P+=1)Ee[P].a?.fix()}oi(r,Ee,At)}}u&&je(()=>{if(x!==void 0)for(b of x)b.a?.apply()}),e.first=r.first&&r.first.e,e.last=m&&m.e;for(var kt of n.values())Z(kt.e);n.clear()}function Sn(e,t,r,n){(n&Ct)!==0&&Be(e.v,t),(n&xt)!==0?Be(e.i,r):e.i=r}function bn(e,t,r,n,s,i,a,o,l,u,c){var v=(l&Ct)!==0,h=(l&_s)===0,_=v?h?Fs(s,!1,!1):Te(s):s,d=(l&xt)===0?a:Te(a),p={i:d,v:_,k:i,a:null,e:null,prev:r,next:n};try{if(e===null){var m=document.createDocumentFragment();m.append(e=lt())}return p.e=re(()=>o(e,_,d,u),ys),p.e.prev=r&&r.e,p.e.next=n&&n.e,r===null?c||(t.first=p):(r.next=p,r.e.next=p.e),n!==null&&(n.prev=p,n.e.prev=p.e),p}finally{}}function $t(e,t,r){for(var n=e.next?e.next.e.nodes_start:r,s=t?t.e.nodes_start:r,i=e.e.nodes_start;i!==null&&i!==n;){var a=ot(i);s.before(i),i=a}}function le(e,t,r){t===null?e.first=r:(t.next=r,t.e.next=r&&r.e),r!==null&&(r.prev=t,r.e.prev=t&&t.e)}const kr=[...` 	
\r\f \v\uFEFF`];function ci(e,t,r){var n=e==null?"":""+e;if(r){for(var s in r)if(r[s])n=n?n+" "+s:s;else if(n.length)for(var i=s.length,a=0;(a=n.indexOf(s,a))>=0;){var o=a+i;(a===0||kr.includes(n[a-1]))&&(o===n.length||kr.includes(n[o]))?n=(a===0?"":n.substring(0,a))+n.substring(o+1):a=o}}return n===""?null:n}function Rr(e,t,r,n,s,i){var a=e.__className;if(a!==r||a===void 0){var o=ci(r,n,i);o==null?e.removeAttribute("class"):e.className=o,e.__className=r}else if(i&&s!==i)for(var l in i){var u=!!i[l];(s==null||u!==!!s[l])&&e.classList.toggle(l,u)}return i}function En(e,t,r=!1){if(e.multiple){if(t==null)return;if(!bt(t))return ms();for(var n of e.options)n.selected=t.includes(st(n));return}for(n of e.options){var s=st(n);if(Ds(s,t)){n.selected=!0;return}}(!r||t!==void 0)&&(e.selectedIndex=-1)}function fi(e){var t=new MutationObserver(()=>{En(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),an(()=>{t.disconnect()})}function di(e,t,r=t){var n=!0;sn(e,"change",s=>{var i=s?"[selected]":":checked",a;if(e.multiple)a=[].map.call(e.querySelectorAll(i),st);else{var o=e.querySelector(i)??e.querySelector("option:not([disabled])");a=o&&st(o)}r(a)}),Hs(()=>{var s=t();if(En(e,s,n),n&&s===void 0){var i=e.querySelector(":checked");i!==null&&(s=st(i),r(s))}e.__value=s,n=!1}),fi(e)}function st(e){return"__value"in e?e.__value:e.value}function vi(e,t,r=t){var n=new WeakSet;sn(e,"input",async s=>{var i=s?e.defaultValue:e.value;if(i=jt(e)?Ut(i):i,r(i),q!==null&&n.add(q),await Xs(),i!==(i=t())){var a=e.selectionStart,o=e.selectionEnd;e.value=i??"",o!==null&&(e.selectionStart=a,e.selectionEnd=Math.min(o,e.value.length))}}),ut(t)==null&&e.value&&(r(jt(e)?Ut(e.value):e.value),q!==null&&n.add(q)),on(()=>{var s=t();if(e===document.activeElement){var i=mt??q;if(n.has(i))return}jt(e)&&s===Ut(e.value)||e.type==="date"&&!s&&!e.value||s!==e.value&&(e.value=s??"")})}function jt(e){var t=e.type;return t==="number"||t==="range"}function Ut(e){return e===""?null:+e}function hi(e,t,r,n){var s=n,i=!0,a=()=>(i&&(i=!1,s=ut(n)),s),o;o=e[t],o===void 0&&n!==void 0&&(o=a());var l;return l=()=>{var u=e[t];return u===void 0?a():(i=!0,u)},l}function Pn(e){V===null&&Lr(),Ws(()=>{const t=ut(e);if(typeof t=="function")return t})}function _i(e){V===null&&Lr(),Pn(()=>()=>ut(e))}const pi="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(pi);const Cn=typeof window<"u"?window:void 0;function gi(e){let t=e.activeElement;for(;t?.shadowRoot;){const r=t.shadowRoot.activeElement;if(r===t)break;t=r}return t}class mi{#e;#t;constructor(t={}){const{window:r=Cn,document:n=r?.document}=t;r!==void 0&&(this.#e=n,this.#t=er(s=>{const i=Kt(r,"focusin",s),a=Kt(r,"focusout",s);return()=>{i(),a()}}))}get current(){return this.#t?.(),this.#e?gi(this.#e):null}}new mi;function wi(e,t){return e}function yi(e,t){let r=J(null);const n=ae(()=>wi(t));function s(...i){if(f(r))f(r).timeout&&clearTimeout(f(r).timeout);else{let a,o;const l=new Promise((u,c)=>{a=u,o=c});$(r,{timeout:null,runner:null,promise:l,resolve:a,reject:o},!0)}return f(r).runner=async()=>{if(!f(r))return;const a=f(r);$(r,null);try{a.resolve(await e.apply(this,i))}catch(o){a.reject(o)}},f(r).timeout=setTimeout(f(r).runner,f(n)),f(r).promise}return s.cancel=async()=>{(!f(r)||f(r).timeout===null)&&(await new Promise(i=>setTimeout(i,0)),!f(r)||f(r).timeout===null)||(clearTimeout(f(r).timeout),f(r).reject("Cancelled"),$(r,null))},s.runScheduledNow=async()=>{(!f(r)||!f(r).timeout)&&(await new Promise(i=>setTimeout(i,0)),!f(r)||!f(r).timeout)||(clearTimeout(f(r).timeout),f(r).timeout=null,await f(r).runner?.())},Object.defineProperty(s,"pending",{enumerable:!0,get(){return!!f(r)?.timeout}}),s}function Si(e,t){switch(e){case"local":return t.localStorage;case"session":return t.sessionStorage}}function xn(e,t,r,n,s,i){if(e===null||typeof e!="object")return e;const a=Object.getPrototypeOf(e);if(a!==null&&a!==Object.prototype&&!Array.isArray(e))return e;let o=r.get(e);return o||(o=new Proxy(e,{get:(l,u)=>(n?.(),xn(Reflect.get(l,u),t,r,n,s,i)),set:(l,u,c)=>(s?.(),Reflect.set(l,u,c),i(t),!0)}),r.set(e,o)),o}class Nr{#e;#t;#u;#i;#l;#r;#s=new WeakMap;constructor(t,r,n={}){const{storage:s="local",serializer:i={serialize:JSON.stringify,deserialize:JSON.parse},syncTabs:a=!0}=n,o="window"in n?n.window:Cn;if(this.#e=r,this.#t=t,this.#u=i,o===void 0)return;const l=Si(s,o);this.#i=l;const u=l.getItem(t);u!==null?this.#e=this.#a(u):this.#o(r),a&&s==="local"&&(this.#l=er(c=>{this.#r=c;const v=Kt(o,"storage",this.#n);return()=>{v(),this.#r=void 0}}))}get current(){this.#l?.();const t=this.#i?.getItem(this.#t),r=t?this.#a(t):this.#e;return xn(r,r,this.#s,this.#l?.bind(this),this.#r?.bind(this),this.#o.bind(this))}set current(t){this.#o(t),this.#r?.()}#n=t=>{t.key!==this.#t||t.newValue===null||(this.#e=this.#a(t.newValue),this.#r?.())};#a(t){try{return this.#u.deserialize(t)}catch(r){console.error(`Error when parsing "${t}" from persisted store "${this.#t}"`,r);return}}#o(t){try{t!=null&&this.#i?.setItem(this.#t,this.#u.serialize(t))}catch(r){console.error(`Error when writing value from persisted store "${this.#t}" to ${this.#i}`,r)}}}function qn(e="your-main-id"){return typeof window>"u"?e:new URLSearchParams(window.location.search).get("listId")||e}function Mr(e,t){return`${e}_${t}`}const{Query:Je}=window.Appwrite;class bi{currentMainId=qn();statesByMainId=new Map;get productsState(){if(!this.currentMainId)throw new Error("ProductsStore non initialisé");const t=this.statesByMainId.get(this.currentMainId);if(!t)throw new Error(`État non trouvé pour mainId: ${this.currentMainId}`);return t.productsState}get syncState(){if(!this.currentMainId)throw new Error("ProductsStore non initialisé");const t=this.statesByMainId.get(this.currentMainId);if(!t)throw new Error(`État non trouvé pour mainId: ${this.currentMainId}`);return t.syncState}getOrCreateStates(t){let r=this.statesByMainId.get(t);if(r)return r;const n=Mr("products-state",t),s=Mr("products-sync-state",t),i=new Nr(n,{products:[],loading:!1,error:null,syncing:!1,realtimeConnected:!1}),a=new Nr(s,{lastSync:null,mainId:null}),o={productsState:i,syncState:a};return this.statesByMainId.set(t,o),console.log(`[ProductsStore] Nouveaux états créés pour mainId: ${t}`),console.log(`[ProductsStore] Clés de stockage: ${n}, ${s}`),o}#e=J(null);get debouncedSync(){return f(this.#e)}set debouncedSync(t){$(this.#e,t,!0)}unsubscribe=null;get products(){return this.productsState.current.products}get loading(){return this.productsState.current.loading}get error(){return this.productsState.current.error}get syncing(){return this.productsState.current.syncing}get realtimeConnected(){return this.productsState.current.realtimeConnected}get lastSync(){return this.syncState.current.lastSync}get mainId(){return this.syncState.current.mainId}async initialize(t){this.getOrCreateStates(t),this.currentMainId=t,console.log("[ProductsStore] Initialisation avec mainId:",t),console.log("[ProductsStore] Produits dans le cache:",this.productsState.current.products.length),this.syncState.current.mainId===t&&this.productsState.current.products.length>0?(console.log("[ProductsStore] Chargement depuis le cache - produits trouvés:",this.productsState.current.products.length),console.log("[ProductsStore] Exemples de produits du cache:",this.productsState.current.products.slice(0,3).map(r=>({id:r.$id,name:r.productName}))),this.syncInBackground()):(console.log("[ProductsStore] Première connexion ou changement de mainId - raisons:"),console.log("- mainId différent:",this.syncState.current.mainId!==t),console.log("- pas de produits dans le cache:",this.productsState.current.products.length===0),await this.loadFromAppwrite(t)),this.setupRealtime(t)}async loadFromAppwrite(t){this.productsState.current={...this.productsState.current,loading:!0,error:null};try{const r=await window.AppwriteClient.getDatabases(),n=window.AppwriteClient.getConfig(),s=await r.listDocuments(n.APPWRITE_CONFIG.databaseId,n.APPWRITE_CONFIG.collections.products,[Je.equal("mainId",t),Je.limit(5e3)]);this.productsState.current={products:s.documents,loading:!1,error:null,syncing:!1,realtimeConnected:!1},this.updateLastSync(t),console.log(`[ProductsStore] ${s.documents.length} produits chargés`)}catch(r){const n=r instanceof Error?r.message:"Erreur lors du chargement des produits";throw this.productsState.current={...this.productsState.current,loading:!1,error:n},console.error("[ProductsStore] Erreur lors du chargement:",r),r}}async syncInBackground(){if(this.syncState.current.lastSync){this.productsState.current={...this.productsState.current,syncing:!0};try{const t=await window.AppwriteClient.getDatabases(),r=window.AppwriteClient.getConfig(),n=await t.listDocuments(r.APPWRITE_CONFIG.databaseId,r.APPWRITE_CONFIG.collections.products,[Je.greaterThan("$updatedAt",this.syncState.current.lastSync),Je.equal("mainId",this.syncState.current.mainId),Je.limit(1e3)]);if(n.documents.length>0){console.log(`[ProductsStore] ${n.documents.length} produits mis à jour trouvés`);const s=n.documents,i=this.productsState.current.products,a=new Map(s.map(c=>[c.$id,c])),o=i.map(c=>a.has(c.$id)?a.get(c.$id):c),l=new Set(i.map(c=>c.$id)),u=s.filter(c=>!l.has(c.$id));this.productsState.current={...this.productsState.current,products:[...o,...u],syncing:!1},this.updateLastSync(this.syncState.current.mainId)}else console.log("[ProductsStore] Aucune mise à jour trouvée"),this.productsState.current={...this.productsState.current,syncing:!1}}catch(t){console.error("[ProductsStore] Erreur lors de la sync:",t),this.productsState.current={...this.productsState.current,syncing:!1}}}}setupRealtime(t){this.unsubscribe&&this.unsubscribe(),console.log("[ProductsStore] Établissement de la connexion realtime"),this.unsubscribe=window.AppwriteClient.subscribeToCollections(["products"],t,r=>{console.log("[ProductsStore] Événement realtime reçu:",r),this.handleRealtimeEvent(r)},{onConnect:()=>{console.log("[ProductsStore] Connexion realtime établie"),this.productsState.current={...this.productsState.current,realtimeConnected:!0}},onDisconnect:()=>{console.log("[ProductsStore] Connexion realtime perdue"),this.productsState.current={...this.productsState.current,realtimeConnected:!1}},onError:r=>{console.error("[ProductsStore] Erreur realtime:",r)}})}handleRealtimeEvent(t){const{events:r,payload:n}=t;if(!n)return;const s=n,i=r.some(l=>l.includes(".create")),a=r.some(l=>l.includes(".update")),o=r.some(l=>l.includes(".delete"));i?this.handleProductCreate(s):a?this.handleProductUpdate(s):o&&this.handleProductDelete(s.$id),this.debouncedUpdateLastSync()}handleProductCreate(t){this.productsState.current.products.some(n=>n.$id===t.$id)||(console.log("[ProductsStore] Nouveau produit créé:",t.productName),this.productsState.current={...this.productsState.current,products:[...this.productsState.current.products,t]})}handleProductUpdate(t){console.log("[ProductsStore] Produit mis à jour:",t.productName),this.productsState.current={...this.productsState.current,products:this.productsState.current.products.map(r=>r.$id===t.$id?t:r)}}handleProductDelete(t){console.log("[ProductsStore] Produit supprimé:",t),this.productsState.current={...this.productsState.current,products:this.productsState.current.products.filter(r=>r.$id!==t)}}debouncedUpdateLastSync(){if(!this.debouncedSync){const t=yi(()=>{this.updateLastSync(this.syncState.current.mainId)},500);this.debouncedSync=t}this.debouncedSync()}updateLastSync(t){this.syncState.current={lastSync:new Date().toISOString(),mainId:t},console.log("[ProductsStore] lastSync mis à jour:",this.syncState.current.lastSync)}async forceReload(t){await this.loadFromAppwrite(t)}destroy(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null)}clearCache(){if(!this.currentMainId){console.warn("[ProductsStore] Impossible de vider le cache: aucun mainId actuel");return}this.productsState.current={products:[],loading:!1,error:null,syncing:!1,realtimeConnected:!1},this.syncState.current={lastSync:null,mainId:null},console.log(`[ProductsStore] Cache vidé pour mainId: ${this.currentMainId}`)}clearAllCaches(){for(const[t,r]of this.statesByMainId)r.productsState.current={products:[],loading:!1,error:null,syncing:!1,realtimeConnected:!1},r.syncState.current={lastSync:null,mainId:null};console.log("[ProductsStore] Tous les caches ont été vidés")}}const oe=new bi;async function Or(e,t){try{await oe.forceReload(t())}catch(r){console.error("[ProductsComponent] Erreur lors du rechargement:",r)}}function Ei(){oe.clearCache()}var Pi=O('<span class="last-sync svelte-1n46o8q"> </span>'),Ci=O('<option class="svelte-1n46o8q"> </option>'),xi=O('<div class="loading-state svelte-1n46o8q"><div class="spinner svelte-1n46o8q"></div> <p class="svelte-1n46o8q">Chargement des produits...</p></div>'),qi=O('<div class="error-state svelte-1n46o8q"><p class="svelte-1n46o8q"> </p> <button class="svelte-1n46o8q">Réessayer</button></div>'),Ii=(e,t,r)=>{$(t,""),$(r,null)},Ti=O('<p class="svelte-1n46o8q">Aucun produit ne correspond à vos critères</p> <button class="svelte-1n46o8q">Réinitialiser les filtres</button>',1),Ai=O('<p class="svelte-1n46o8q">Aucun produit trouvé</p>'),ki=O('<div class="empty-state svelte-1n46o8q"><!></div>'),Ri=O('<span class="filtered-indicator svelte-1n46o8q"> </span>'),Ni=O('<span class="badge frais svelte-1n46o8q">Frais</span>'),Mi=O('<span class="badge surgele svelte-1n46o8q">Surgelé</span>'),Oi=O('<span class="badge merged svelte-1n46o8q">Fusionné</span>'),Fi=O('<div class="product-info svelte-1n46o8q"><span class="label svelte-1n46o8q">Stock:</span> <span class="value svelte-1n46o8q"> </span></div>'),Di=O('<span class="who-tag svelte-1n46o8q"> </span>'),Li=O('<div class="product-who svelte-1n46o8q"><span class="label svelte-1n46o8q">Pour:</span> <div class="who-tags svelte-1n46o8q"></div></div>'),$i=O('<article class="product-card svelte-1n46o8q"><div class="product-header svelte-1n46o8q"><h3 class="svelte-1n46o8q"> </h3> <span> </span></div> <div class="product-body svelte-1n46o8q"><div class="product-info svelte-1n46o8q"><span class="label svelte-1n46o8q">Type:</span> <span class="value svelte-1n46o8q"> </span></div> <div class="product-badges svelte-1n46o8q"><!> <!> <!></div> <!> <div class="product-stats svelte-1n46o8q"><div class="stat svelte-1n46o8q"><span class="stat-value svelte-1n46o8q"> </span> <span class="stat-label svelte-1n46o8q">recettes</span></div> <div class="stat svelte-1n46o8q"><span class="stat-value svelte-1n46o8q"> </span> <span class="stat-label svelte-1n46o8q">assiettes</span></div></div> <!></div> <div class="product-footer svelte-1n46o8q"><small class="svelte-1n46o8q"> </small></div></article>'),ji=O('<div class="products-stats svelte-1n46o8q"><span class="svelte-1n46o8q"> </span> <!></div> <div class="products-grid svelte-1n46o8q"></div>',1),Ui=O('<div class="products-container svelte-1n46o8q"><header class="products-header svelte-1n46o8q"><div class="header-top svelte-1n46o8q"><h1 class="svelte-1n46o8q">Gestion des Produits</h1> <div class="status-bar svelte-1n46o8q"><span> </span> <!></div></div> <div class="actions-bar svelte-1n46o8q"><div class="search-filters svelte-1n46o8q"><input type="text" placeholder="Rechercher un produit..." class="search-input svelte-1n46o8q"/> <select class="filter-select svelte-1n46o8q"><option class="svelte-1n46o8q">Tous les types</option><!></select></div> <div class="action-buttons svelte-1n46o8q"><button class="svelte-1n46o8q"> </button> <button class="danger svelte-1n46o8q">Vider le cache</button></div></div></header> <main class="products-content svelte-1n46o8q"><!></main></div>');function Bi(e,t){Br(t,!0);let r=hi(t,"mainId",19,qn),n=ae(()=>{const S=oe.products;return console.log("[App.svelte] produits dérivés:",S.length,S.slice(0,3)),S}),s=ae(()=>oe.loading),i=ae(()=>oe.error),a=ae(()=>oe.syncing),o=ae(()=>oe.realtimeConnected),l=ae(()=>oe.lastSync),u=ae(()=>f(a)?"Synchronisation...":f(o)?"En direct":"Hors ligne");Pn(async()=>{console.log("[ProductsComponent] Montage du composant");try{await window.AppwriteClient.initializeAppwrite(),console.log("[ProductsComponent] mainId",r()),await oe.initialize(r())}catch(S){console.error("[ProductsComponent] Erreur lors de l'initialisation:",S)}}),_i(()=>{console.log("[ProductsComponent] Démontage du composant"),oe.destroy()});let c=J(""),v=J(null),h=ae(()=>()=>{let S=f(n);if(f(c).trim()){const N=f(c).toLowerCase();S=S.filter(ee=>ee.productName.toLowerCase().includes(N)||ee.productType.toLowerCase().includes(N))}return f(v)&&(S=S.filter(N=>N.productType===f(v))),S}),_=ae(()=>()=>{const S=new Set(f(n).map(N=>N.productType));return Array.from(S).sort()});var d=Ui(),p=g(d),m=g(p),x=C(g(m),2),E=g(x);let I;var W=g(E),k=C(E,2);{var b=S=>{var N=Pi(),ee=g(N);de(Ke=>D(ee,`Dernière sync: ${Ke??""}`),[()=>new Date(f(l)).toLocaleString("fr-FR")]),R(S,N)};te(k,S=>{f(l)&&S(b)})}var P=C(m,2),G=g(P),be=g(G),Re=C(be,2),pe=g(Re);pe.value=(pe.__value=null)??"";var ie=C(pe);Lt(ie,17,()=>f(_)(),Ar,(S,N)=>{var ee=Ci(),Ke=g(ee),ft={};de(()=>{D(Ke,f(N)),ft!==(ft=f(N))&&(ee.value=(ee.__value=f(N))??"")}),R(S,ee)});var ct=C(G,2),ge=g(ct);ge.__click=[Or,r];var Ee=g(ge),He=C(ge,2);He.__click=[Ei];var At=C(p,2),kt=g(At);{var In=S=>{var N=xi();R(S,N)},Tn=S=>{var N=Tr(),ee=gt(N);{var Ke=Ne=>{var Ge=qi(),dt=g(Ge),Rt=g(dt),Nt=C(dt,2);Nt.__click=[Or,r],de(()=>D(Rt,`❌ Erreur: ${f(i)??""}`)),R(Ne,Ge)},ft=Ne=>{var Ge=Tr(),dt=gt(Ge);{var Rt=Me=>{var Ye=ki(),vt=g(Ye);{var ht=me=>{var Oe=Ti(),Ot=C(gt(Oe),2);Ot.__click=[Ii,c,v],R(me,Oe)},Mt=me=>{var Oe=Ai();R(me,Oe)};te(vt,me=>{f(c)||f(v)?me(ht):me(Mt,!1)})}R(Me,Ye)},Nt=Me=>{var Ye=ji(),vt=gt(Ye),ht=g(vt),Mt=g(ht),me=C(ht,2);{var Oe=fe=>{var A=Ri(),_t=g(A);de(()=>D(_t,`(filtré sur ${f(n).length??""} total)`)),R(fe,A)};te(me,fe=>{(f(c)||f(v))&&fe(Oe)})}var Ot=C(vt,2);Lt(Ot,21,()=>f(h)(),fe=>fe.$id,(fe,A)=>{var _t=$i(),ar=g(_t),lr=g(ar),An=g(lr),or=C(lr,2);let ur;var kn=g(or),cr=C(ar,2),fr=g(cr),Rn=C(g(fr),2),Nn=g(Rn),dr=C(fr,2),vr=g(dr);{var Mn=T=>{var z=Ni();R(T,z)};te(vr,T=>{f(A).pFrais&&T(Mn)})}var hr=C(vr,2);{var On=T=>{var z=Mi();R(T,z)};te(hr,T=>{f(A).pSurgel&&T(On)})}var Fn=C(hr,2);{var Dn=T=>{var z=Oi();R(T,z)};te(Fn,T=>{f(A).isMerged&&T(Dn)})}var _r=C(dr,2);{var Ln=T=>{var z=Fi(),Ft=C(g(z),2),Dt=g(Ft);de(()=>D(Dt,f(A).stockReel)),R(T,z)};te(_r,T=>{f(A).stockReel&&T(Ln)})}var pr=C(_r,2),gr=g(pr),$n=g(gr),jn=g($n),Un=C(gr,2),Bn=g(Un),Vn=g(Bn),Wn=C(pr,2);{var zn=T=>{var z=Li(),Ft=C(g(z),2);Lt(Ft,21,()=>f(A).who,Ar,(Dt,Yn)=>{var mr=Di(),Jn=g(mr);de(()=>D(Jn,f(Yn))),R(Dt,mr)}),R(T,z)};te(Wn,T=>{f(A).who&&f(A).who.length>0&&T(zn)})}var Hn=C(cr,2),Kn=g(Hn),Gn=g(Kn);de((T,z)=>{D(An,f(A).productName),ur=Rr(or,1,"product-status svelte-1n46o8q",null,ur,T),D(kn,f(A).status),D(Nn,f(A).productType),D(jn,f(A).nbRecipes),D(Vn,f(A).totalAssiettes),D(Gn,`Mis à jour: ${z??""}`)},[()=>({active:f(A).status==="active"}),()=>new Date(f(A).$updatedAt).toLocaleDateString("fr-FR")]),R(fe,_t)}),de((fe,A)=>D(Mt,`${fe??""} produit${A??""}`),[()=>f(h)().length,()=>f(h)().length>1?"s":""]),R(Me,Ye)};te(dt,Me=>{f(h)().length===0?Me(Rt):Me(Nt,!1)},!0)}R(Ne,Ge)};te(ee,Ne=>{f(i)?Ne(Ke):Ne(ft,!1)},!0)}R(S,N)};te(kt,S=>{f(s)?S(In):S(Tn,!1)})}de(S=>{I=Rr(E,1,"status-indicator svelte-1n46o8q",null,I,S),D(W,f(u)),ge.disabled=f(s)||f(a),D(Ee,f(s)?"Chargement...":"Recharger")},[()=>({connected:f(o),syncing:f(a)})]),vi(be,()=>f(c),S=>$(c,S)),di(Re,()=>f(v),S=>$(v,S)),R(e,d),Vr()}ni(["click"]);ii(Bi,{target:document.getElementById("app_products")});
