(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();const Fr=!1;var bt=Array.isArray,Qn=Array.prototype.indexOf,Jt=Array.from,Wt=Object.defineProperty,et=Object.getOwnPropertyDescriptor,Xn=Object.prototype,Zn=Array.prototype,es=Object.getPrototypeOf,wr=Object.isExtensible;const ts=()=>{};function rs(e){for(var t=0;t<e.length;t++)e[t]()}function Dr(){var e,t,r=new Promise((n,s)=>{e=n,t=s});return{promise:r,resolve:e,reject:t}}const W=2,Qt=4,Xt=8,Ae=16,he=32,Ie=64,Zt=128,Q=256,mt=512,L=1024,G=2048,ye=4096,ie=8192,ke=16384,er=32768,St=65536,yr=1<<17,ns=1<<18,He=1<<19,ss=1<<20,zt=1<<21,Et=1<<22,qe=1<<23,tt=Symbol("$state"),rt=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Lr(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function is(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function as(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function ls(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function os(e){throw new Error("https://svelte.dev/e/effect_orphan")}function us(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function cs(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function fs(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function ds(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function vs(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Pt=1,qt=2,Mr=4,hs=8,_s=16,ps=1,gs=2,O=Symbol();function ms(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function ws(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}let ys=!1;function jr(e){return e===this.v}function bs(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function $r(e){return!bs(e,this.v)}let Ss=!1,z=null;function Ve(e){z=e}function Ur(e,t=!1,r){z={p:z,c:null,e:null,s:e,x:null,l:null}}function Vr(e){var t=z,r=t.e;if(r!==null){t.e=null;for(var n of r)an(n)}return z=t.p,{}}function Wr(){return!0}let Pe=[];function zr(){var e=Pe;Pe=[],rs(e)}function We(e){if(Pe.length===0&&!nt){var t=Pe;queueMicrotask(()=>{t===Pe&&zr()})}Pe.push(e)}function Es(){for(;Pe.length>0;)zr()}const Ps=new WeakMap;function Br(e){var t=y;if(t===null)return w.f|=qe,e;if((t.f&er)===0){if((t.f&Zt)===0)throw!t.parent&&e instanceof Error&&Hr(e),e;t.b.error(e)}else ze(e,t)}function ze(e,t){for(;t!==null;){if((t.f&Zt)!==0)try{t.b.error(e);return}catch(r){e=r}t=t.parent}throw e instanceof Error&&Hr(e),e}function Hr(e){const t=Ps.get(e);t&&(Wt(e,"message",{value:t.message}),Wt(e,"stack",{value:t.stack}))}const _t=new Set;let C=null,gt=null,Bt=new Set,ue=[],xt=null,Ht=!1,nt=!1;class J{current=new Map;#e=new Map;#t=new Set;#u=0;#i=null;#l=[];#r=[];#s=[];#n=[];#a=[];#o=[];skipped_effects=new Set;process(t){ue=[],gt=null;var r=J.apply(this);for(const i of t)this.#f(i);if(this.#u===0){this.#d();var n=this.#r,s=this.#s;this.#r=[],this.#s=[],this.#n=[],gt=this,C=null,br(n),br(s),gt=null,this.#i?.resolve()}else this.#c(this.#r),this.#c(this.#s),this.#c(this.#n);r();for(const i of this.#l)lt(i);this.#l=[]}#f(t){t.f^=L;for(var r=t.first;r!==null;){var n=r.f,s=(n&(he|Ie))!==0,i=s&&(n&L)!==0,a=i||(n&ie)!==0||this.skipped_effects.has(r);if(!a&&r.fn!==null){s?r.f^=L:(n&Qt)!==0?this.#s.push(r):(n&L)===0&&((n&Et)!==0&&r.b?.is_pending()?this.#l.push(r):At(r)&&((r.f&Ae)!==0&&this.#n.push(r),lt(r)));var o=r.first;if(o!==null){r=o;continue}}var l=r.parent;for(r=r.next;r===null&&l!==null;)r=l.next,l=l.parent}}#c(t){for(const r of t)((r.f&G)!==0?this.#a:this.#o).push(r),U(r,L);t.length=0}capture(t,r){this.#e.has(t)||this.#e.set(t,r),this.current.set(t,t.v)}activate(){C=this}deactivate(){C=null}flush(){if(ue.length>0){if(this.activate(),Gr(),C!==null&&C!==this)return}else this.#u===0&&this.#d();this.deactivate();for(const t of Bt)if(Bt.delete(t),t(),C!==null)break}#d(){for(const t of this.#t)t();if(this.#t.clear(),_t.size>1){this.#e.clear();let t=!0;for(const r of _t){if(r===this){t=!1;continue}for(const[n,s]of this.current){if(r.current.has(n))if(t)r.current.set(n,s);else continue;Yr(n)}if(ue.length>0){C=r;const n=J.apply(r);for(const s of ue)r.#f(s);ue=[],n()}}C=null}_t.delete(this)}increment(){this.#u+=1}decrement(){this.#u-=1;for(const t of this.#a)U(t,G),Ce(t);for(const t of this.#o)U(t,ye),Ce(t);this.flush()}add_callback(t){this.#t.add(t)}settled(){return(this.#i??=Dr()).promise}static ensure(){if(C===null){const t=C=new J;_t.add(C),nt||J.enqueue(()=>{C===t&&t.flush()})}return C}static enqueue(t){We(t)}static apply(t){return ts}}function qs(e){var t=nt;nt=!0;try{for(var r;;){if(Es(),ue.length===0&&(C?.flush(),ue.length===0))return xt=null,r;Gr()}}finally{nt=t}}function Gr(){var e=Ue;Ht=!0;try{var t=0;for(qr(!0);ue.length>0;){var r=J.ensure();if(t++>1e3){var n,s;xs()}r.process(ue),we.clear()}}finally{Ht=!1,qr(e),xt=null}}function xs(){try{us()}catch(e){ze(e,xt)}}let Ee=null;function br(e){var t=e.length;if(t!==0){for(var r=0;r<t;){var n=e[r++];if((n.f&(ke|ie))===0&&At(n)&&(Ee=[],lt(n),n.deps===null&&n.first===null&&n.nodes_start===null&&(n.teardown===null&&n.ac===null?cn(n):n.fn=null),Ee?.length>0)){we.clear();for(const s of Ee)lt(s);Ee=[]}}Ee=null}}function Yr(e){if(e.reactions!==null)for(const t of e.reactions){const r=t.f;(r&W)!==0?Yr(t):(r&(Et|Ae))!==0&&(U(t,G),Ce(t))}}function Ce(e){for(var t=xt=e;t.parent!==null;){t=t.parent;var r=t.f;if(Ht&&t===y&&(r&Ae)!==0)return;if((r&(Ie|he))!==0){if((r&L)===0)return;t.f^=L}}ue.push(t)}function tr(e){let t=0,r=Te(0),n;return()=>{Ws()&&(f(r),ln(()=>(t===0&&(n=It(()=>e(()=>st(r)))),t+=1,()=>{We(()=>{t-=1,t===0&&(n?.(),n=void 0,st(r))})})))}}var Cs=St|He|Zt;function Ts(e,t,r){new As(e,t,r)}class As{parent;#e=!1;#t;#u=null;#i;#l;#r;#s=null;#n=null;#a=null;#o=null;#f=0;#c=0;#d=!1;#v=null;#g=()=>{this.#v&&Be(this.#v,this.#f)};#m=tr(()=>(this.#v=Te(this.#f),()=>{this.#v=null}));constructor(t,r,n){this.#t=t,this.#i=r,this.#l=n,this.parent=y.b,this.#e=!!this.#i.pending,this.#r=nr(()=>{y.b=this;{try{this.#s=ne(()=>n(this.#t))}catch(s){this.error(s)}this.#c>0?this.#_():this.#e=!1}},Cs)}#w(){try{this.#s=ne(()=>this.#l(this.#t))}catch(t){this.error(t)}this.#e=!1}#y(){const t=this.#i.pending;t&&(this.#n=ne(()=>t(this.#t)),J.enqueue(()=>{this.#s=this.#h(()=>(J.ensure(),ne(()=>this.#l(this.#t)))),this.#c>0?this.#_():($e(this.#n,()=>{this.#n=null}),this.#e=!1)}))}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#i.pending}#h(t){var r=y,n=w,s=z;ce(this.#r),V(this.#r),Ve(this.#r.ctx);try{return t()}catch(i){return Br(i),null}finally{ce(r),V(n),Ve(s)}}#_(){const t=this.#i.pending;this.#s!==null&&(this.#o=document.createDocumentFragment(),Is(this.#s,this.#o)),this.#n===null&&(this.#n=ne(()=>t(this.#t)))}#p(t){if(!this.has_pending_snippet()){this.parent&&this.parent.#p(t);return}this.#c+=t,this.#c===0&&(this.#e=!1,this.#n&&$e(this.#n,()=>{this.#n=null}),this.#o&&(this.#t.before(this.#o),this.#o=null),We(()=>{J.ensure().flush()}))}update_pending_count(t){this.#p(t),this.#f+=t,Bt.add(this.#g)}get_effect_pending(){return this.#m(),f(this.#v)}error(t){var r=this.#i.onerror;let n=this.#i.failed;if(this.#d||!r&&!n)throw t;this.#s&&(X(this.#s),this.#s=null),this.#n&&(X(this.#n),this.#n=null),this.#a&&(X(this.#a),this.#a=null);var s=!1,i=!1;const a=()=>{if(s){ws();return}s=!0,i&&vs(),J.ensure(),this.#f=0,this.#a!==null&&$e(this.#a,()=>{this.#a=null}),this.#e=this.has_pending_snippet(),this.#s=this.#h(()=>(this.#d=!1,ne(()=>this.#l(this.#t)))),this.#c>0?this.#_():this.#e=!1};var o=w;try{V(null),i=!0,r?.(t,a),i=!1}catch(l){ze(l,this.#r&&this.#r.parent)}finally{V(o)}n&&We(()=>{this.#a=this.#h(()=>{this.#d=!0;try{return ne(()=>{n(this.#t,()=>t,()=>a)})}catch(l){return ze(l,this.#r.parent),null}finally{this.#d=!1}})})}}function Is(e,t){for(var r=e.nodes_start,n=e.nodes_end;r!==null;){var s=r===n?null:ut(r);t.append(r),r=s}}function ks(e,t,r){const n=Ct;if(t.length===0){r(e.map(n));return}var s=C,i=y,a=Rs();Promise.all(t.map(o=>Ns(o))).then(o=>{a();try{r([...e.map(n),...o])}catch(l){(i.f&ke)===0&&ze(l,i)}s?.deactivate(),Kr()}).catch(o=>{ze(o,i)})}function Rs(){var e=y,t=w,r=z,n=C;return function(){ce(e),V(t),Ve(r),n?.activate()}}function Kr(){ce(null),V(null),Ve(null)}function Ct(e){var t=W|G,r=w!==null&&(w.f&W)!==0?w:null;return y===null||r!==null&&(r.f&Q)!==0?t|=Q:y.f|=He,{ctx:z,deps:null,effects:null,equals:jr,f:t,fn:e,reactions:null,rv:0,v:O,wv:0,parent:r??y,ac:null}}function Ns(e,t){let r=y;r===null&&is();var n=r.b,s=void 0,i=Te(O),a=!w,o=new Map;return Gs(()=>{var l=Dr();s=l.promise;try{Promise.resolve(e()).then(l.resolve,l.reject)}catch(v){l.reject(v)}var u=C,c=n.is_pending();a&&(n.update_pending_count(1),c||(u.increment(),o.get(u)?.reject(rt),o.set(u,l)));const _=(v,h=void 0)=>{c||u.activate(),h?h!==rt&&(i.f|=qe,Be(i,h)):((i.f&qe)!==0&&(i.f^=qe),Be(i,v)),a&&(n.update_pending_count(-1),c||u.decrement()),Kr()};l.promise.then(_,v=>_(null,v||"unknown"))}),sn(()=>{for(const l of o.values())l.reject(rt)}),new Promise(l=>{function u(c){function _(){c===s?l(i):u(s)}c.then(_,_)}u(s)})}function ae(e){const t=Ct(e);return vn(t),t}function Os(e){const t=Ct(e);return t.equals=$r,t}function Jr(e){var t=e.effects;if(t!==null){e.effects=null;for(var r=0;r<t.length;r+=1)X(t[r])}}function Fs(e){for(var t=e.parent;t!==null;){if((t.f&W)===0)return t;t=t.parent}return null}function rr(e){var t,r=y;ce(Fs(e));try{Jr(e),t=gn(e)}finally{ce(r)}return t}function Qr(e){var t=rr(e);if(e.equals(t)||(e.v=t,e.wv=_n()),!Re){var r=(me||(e.f&Q)!==0)&&e.deps!==null?ye:L;U(e,r)}}const we=new Map;function Te(e,t){var r={f:0,v:e,reactions:null,equals:jr,rv:0,wv:0};return r}function K(e,t){const r=Te(e);return vn(r),r}function Ds(e,t=!1,r=!0){const n=Te(e);return t||(n.equals=$r),n}function D(e,t,r=!1){w!==null&&(!se||(w.f&yr)!==0)&&Wr()&&(w.f&(W|Ae|Et|yr))!==0&&!ve?.includes(e)&&ds();let n=r?Xe(t):t;return Be(e,n)}function Be(e,t){if(!e.equals(t)){var r=e.v;Re?we.set(e,t):we.set(e,r),e.v=t;var n=J.ensure();n.capture(e,r),(e.f&W)!==0&&((e.f&G)!==0&&rr(e),U(e,(e.f&Q)===0?L:ye)),e.wv=_n(),Xr(e,G),y!==null&&(y.f&L)!==0&&(y.f&(he|Ie))===0&&(Y===null?Js([e]):Y.push(e))}return t}function st(e){D(e,e.v+1)}function Xr(e,t){var r=e.reactions;if(r!==null)for(var n=r.length,s=0;s<n;s++){var i=r[s],a=i.f,o=(a&G)===0;o&&U(i,t),(a&W)!==0?Xr(i,ye):o&&((a&Ae)!==0&&Ee!==null&&Ee.push(i),Ce(i))}}function Xe(e){if(typeof e!="object"||e===null||tt in e)return e;const t=es(e);if(t!==Xn&&t!==Zn)return e;var r=new Map,n=bt(e),s=K(0),i=xe,a=o=>{if(xe===i)return o();var l=w,u=xe;V(null),Cr(i);var c=o();return V(l),Cr(u),c};return n&&r.set("length",K(e.length)),new Proxy(e,{defineProperty(o,l,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&cs();var c=r.get(l);return c===void 0?c=a(()=>{var _=K(u.value);return r.set(l,_),_}):D(c,u.value,!0),!0},deleteProperty(o,l){var u=r.get(l);if(u===void 0){if(l in o){const c=a(()=>K(O));r.set(l,c),st(s)}}else D(u,O),st(s);return!0},get(o,l,u){if(l===tt)return e;var c=r.get(l),_=l in o;if(c===void 0&&(!_||et(o,l)?.writable)&&(c=a(()=>{var h=Xe(_?o[l]:O),d=K(h);return d}),r.set(l,c)),c!==void 0){var v=f(c);return v===O?void 0:v}return Reflect.get(o,l,u)},getOwnPropertyDescriptor(o,l){var u=Reflect.getOwnPropertyDescriptor(o,l);if(u&&"value"in u){var c=r.get(l);c&&(u.value=f(c))}else if(u===void 0){var _=r.get(l),v=_?.v;if(_!==void 0&&v!==O)return{enumerable:!0,configurable:!0,value:v,writable:!0}}return u},has(o,l){if(l===tt)return!0;var u=r.get(l),c=u!==void 0&&u.v!==O||Reflect.has(o,l);if(u!==void 0||y!==null&&(!c||et(o,l)?.writable)){u===void 0&&(u=a(()=>{var v=c?Xe(o[l]):O,h=K(v);return h}),r.set(l,u));var _=f(u);if(_===O)return!1}return c},set(o,l,u,c){var _=r.get(l),v=l in o;if(n&&l==="length")for(var h=u;h<_.v;h+=1){var d=r.get(h+"");d!==void 0?D(d,O):h in o&&(d=a(()=>K(O)),r.set(h+"",d))}if(_===void 0)(!v||et(o,l)?.writable)&&(_=a(()=>K(void 0)),D(_,Xe(u)),r.set(l,_));else{v=_.v!==O;var p=a(()=>Xe(u));D(_,p)}var m=Reflect.getOwnPropertyDescriptor(o,l);if(m?.set&&m.set.call(c,u),!v){if(n&&typeof l=="string"){var q=r.get("length"),S=Number(l);Number.isInteger(S)&&S>=q.v&&D(q,S+1)}st(s)}return!0},ownKeys(o){f(s);var l=Reflect.ownKeys(o).filter(_=>{var v=r.get(_);return v===void 0||v.v!==O});for(var[u,c]of r)c.v!==O&&!(u in o)&&l.push(u);return l},setPrototypeOf(){fs()}})}function Sr(e){try{if(e!==null&&typeof e=="object"&&tt in e)return e[tt]}catch{}return e}function Ls(e,t){return Object.is(Sr(e),Sr(t))}var Er,Zr,en,tn;function Ms(){if(Er===void 0){Er=window,Zr=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,r=Text.prototype;en=et(t,"firstChild").get,tn=et(t,"nextSibling").get,wr(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),wr(r)&&(r.__t=void 0)}}function ot(e=""){return document.createTextNode(e)}function wt(e){return en.call(e)}function ut(e){return tn.call(e)}function g(e,t){return wt(e)}function pt(e,t=!1){{var r=wt(e);return r instanceof Comment&&r.data===""?ut(r):r}}function x(e,t=1,r=!1){let n=e;for(;t--;)n=ut(n);return n}function js(e){e.textContent=""}function rn(){return!1}let Pr=!1;function $s(){Pr||(Pr=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function Tt(e){var t=w,r=y;V(null),ce(null);try{return e()}finally{V(t),ce(r)}}function nn(e,t,r,n=r){e.addEventListener(t,()=>Tt(r));const s=e.__on_r;s?e.__on_r=()=>{s(),n(!0)}:e.__on_r=()=>n(!0),$s()}function Us(e){y===null&&w===null&&os(),w!==null&&(w.f&Q)!==0&&y===null&&ls(),Re&&as()}function Vs(e,t){var r=t.last;r===null?t.last=t.first=e:(r.next=e,e.prev=r,t.last=e)}function _e(e,t,r,n=!0){var s=y;s!==null&&(s.f&ie)!==0&&(e|=ie);var i={ctx:z,deps:null,nodes_start:null,nodes_end:null,f:e|G,first:null,fn:t,last:null,next:null,parent:s,b:s&&s.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(r)try{lt(i),i.f|=er}catch(l){throw X(i),l}else t!==null&&Ce(i);if(n){var a=i;if(r&&a.deps===null&&a.teardown===null&&a.nodes_start===null&&a.first===a.last&&(a.f&He)===0&&(a=a.first),a!==null&&(a.parent=s,s!==null&&Vs(a,s),w!==null&&(w.f&W)!==0&&(e&Ie)===0)){var o=w;(o.effects??=[]).push(a)}}return i}function Ws(){return w!==null&&!se}function sn(e){const t=_e(Xt,null,!1);return U(t,L),t.teardown=e,t}function zs(e){Us();var t=y.f,r=!w&&(t&he)!==0&&(t&er)===0;if(r){var n=z;(n.e??=[]).push(e)}else return an(e)}function an(e){return _e(Qt|ss,e,!1)}function Bs(e){J.ensure();const t=_e(Ie|He,e,!0);return(r={})=>new Promise(n=>{r.outro?$e(t,()=>{X(t),n(void 0)}):(X(t),n(void 0))})}function Hs(e){return _e(Qt,e,!1)}function Gs(e){return _e(Et|He,e,!0)}function ln(e,t=0){return _e(Xt|t,e,!0)}function de(e,t=[],r=[]){ks(t,r,n=>{_e(Xt,()=>e(...n.map(f)),!0)})}function nr(e,t=0){var r=_e(Ae|t,e,!0);return r}function ne(e,t=!0){return _e(he|He,e,!0,t)}function on(e){var t=e.teardown;if(t!==null){const r=Re,n=w;xr(!0),V(null);try{t.call(null)}finally{xr(r),V(n)}}}function un(e,t=!1){var r=e.first;for(e.first=e.last=null;r!==null;){const s=r.ac;s!==null&&Tt(()=>{s.abort(rt)});var n=r.next;(r.f&Ie)!==0?r.parent=null:X(r,t),r=n}}function Ys(e){for(var t=e.first;t!==null;){var r=t.next;(t.f&he)===0&&X(t),t=r}}function X(e,t=!0){var r=!1;(t||(e.f&ns)!==0)&&e.nodes_start!==null&&e.nodes_end!==null&&(Ks(e.nodes_start,e.nodes_end),r=!0),un(e,t&&!r),yt(e,0),U(e,ke);var n=e.transitions;if(n!==null)for(const i of n)i.stop();on(e);var s=e.parent;s!==null&&s.first!==null&&cn(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=e.ac=null}function Ks(e,t){for(;e!==null;){var r=e===t?null:ut(e);e.remove(),e=r}}function cn(e){var t=e.parent,r=e.prev,n=e.next;r!==null&&(r.next=n),n!==null&&(n.prev=r),t!==null&&(t.first===e&&(t.first=n),t.last===e&&(t.last=r))}function $e(e,t){var r=[];sr(e,r,!0),fn(r,()=>{X(e),t&&t()})}function fn(e,t){var r=e.length;if(r>0){var n=()=>--r||t();for(var s of e)s.out(n)}else t()}function sr(e,t,r){if((e.f&ie)===0){if(e.f^=ie,e.transitions!==null)for(const a of e.transitions)(a.is_global||r)&&t.push(a);for(var n=e.first;n!==null;){var s=n.next,i=(n.f&St)!==0||(n.f&he)!==0;sr(n,t,i?r:!1),n=s}}}function ir(e){dn(e,!0)}function dn(e,t){if((e.f&ie)!==0){e.f^=ie,(e.f&L)===0&&(U(e,G),Ce(e));for(var r=e.first;r!==null;){var n=r.next,s=(r.f&St)!==0||(r.f&he)!==0;dn(r,s?t:!1),r=n}if(e.transitions!==null)for(const i of e.transitions)(i.is_global||t)&&i.in()}}let Ue=!1;function qr(e){Ue=e}let Re=!1;function xr(e){Re=e}let w=null,se=!1;function V(e){w=e}let y=null;function ce(e){y=e}let ve=null;function vn(e){w!==null&&(ve===null?ve=[e]:ve.push(e))}let $=null,H=0,Y=null;function Js(e){Y=e}let hn=1,at=0,xe=at;function Cr(e){xe=e}let me=!1;function _n(){return++hn}function At(e){var t=e.f;if((t&G)!==0)return!0;if((t&ye)!==0){var r=e.deps,n=(t&Q)!==0;if(r!==null){var s,i,a=(t&mt)!==0,o=n&&y!==null&&!me,l=r.length;if((a||o)&&(y===null||(y.f&ke)===0)){var u=e,c=u.parent;for(s=0;s<l;s++)i=r[s],(a||!i?.reactions?.includes(u))&&(i.reactions??=[]).push(u);a&&(u.f^=mt),o&&c!==null&&(c.f&Q)===0&&(u.f^=Q)}for(s=0;s<l;s++)if(i=r[s],At(i)&&Qr(i),i.wv>e.wv)return!0}(!n||y!==null&&!me)&&U(e,L)}return!1}function pn(e,t,r=!0){var n=e.reactions;if(n!==null&&!ve?.includes(e))for(var s=0;s<n.length;s++){var i=n[s];(i.f&W)!==0?pn(i,t,!1):t===i&&(r?U(i,G):(i.f&L)!==0&&U(i,ye),Ce(i))}}function gn(e){var t=$,r=H,n=Y,s=w,i=me,a=ve,o=z,l=se,u=xe,c=e.f;$=null,H=0,Y=null,me=(c&Q)!==0&&(se||!Ue||w===null),w=(c&(he|Ie))===0?e:null,ve=null,Ve(e.ctx),se=!1,xe=++at,e.ac!==null&&(Tt(()=>{e.ac.abort(rt)}),e.ac=null);try{e.f|=zt;var _=e.fn,v=_(),h=e.deps;if($!==null){var d;if(yt(e,H),h!==null&&H>0)for(h.length=H+$.length,d=0;d<$.length;d++)h[H+d]=$[d];else e.deps=h=$;if(!me||(c&W)!==0&&e.reactions!==null)for(d=H;d<h.length;d++)(h[d].reactions??=[]).push(e)}else h!==null&&H<h.length&&(yt(e,H),h.length=H);if(Wr()&&Y!==null&&!se&&h!==null&&(e.f&(W|ye|G))===0)for(d=0;d<Y.length;d++)pn(Y[d],e);return s!==null&&s!==e&&(at++,Y!==null&&(n===null?n=Y:n.push(...Y))),(e.f&qe)!==0&&(e.f^=qe),v}catch(p){return Br(p)}finally{e.f^=zt,$=t,H=r,Y=n,w=s,me=i,ve=a,Ve(o),se=l,xe=u}}function Qs(e,t){let r=t.reactions;if(r!==null){var n=Qn.call(r,e);if(n!==-1){var s=r.length-1;s===0?r=t.reactions=null:(r[n]=r[s],r.pop())}}r===null&&(t.f&W)!==0&&($===null||!$.includes(t))&&(U(t,ye),(t.f&(Q|mt))===0&&(t.f^=mt),Jr(t),yt(t,0))}function yt(e,t){var r=e.deps;if(r!==null)for(var n=t;n<r.length;n++)Qs(e,r[n])}function lt(e){var t=e.f;if((t&ke)===0){U(e,L);var r=y,n=Ue;y=e,Ue=!0;try{(t&Ae)!==0?Ys(e):un(e),on(e);var s=gn(e);e.teardown=typeof s=="function"?s:null,e.wv=hn;var i;Fr&&Ss&&(e.f&G)!==0&&e.deps}finally{Ue=n,y=r}}}async function Xs(){await Promise.resolve(),qs()}function f(e){var t=e.f,r=(t&W)!==0;if(w!==null&&!se){var n=y!==null&&(y.f&ke)!==0;if(!n&&!ve?.includes(e)){var s=w.deps;if((w.f&zt)!==0)e.rv<at&&(e.rv=at,$===null&&s!==null&&s[H]===e?H++:$===null?$=[e]:(!me||!$.includes(e))&&$.push(e));else{(w.deps??=[]).push(e);var i=e.reactions;i===null?e.reactions=[w]:i.includes(w)||i.push(w)}}}else if(r&&e.deps===null&&e.effects===null){var a=e,o=a.parent;o!==null&&(o.f&Q)===0&&(a.f^=Q)}if(Re){if(we.has(e))return we.get(e);if(r){a=e;var l=a.v;return((a.f&L)===0&&a.reactions!==null||mn(a))&&(l=rr(a)),we.set(a,l),l}}else r&&(a=e,At(a)&&Qr(a));if((e.f&qe)!==0)throw e.v;return e.v}function mn(e){if(e.v===O)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(we.has(t)||(t.f&W)!==0&&mn(t))return!0;return!1}function It(e){var t=se;try{return se=!0,e()}finally{se=t}}const Zs=-7169;function U(e,t){e.f=e.f&Zs|t}const ei=["touchstart","touchmove"];function ti(e){return ei.includes(e)}const wn=new Set,Gt=new Set;function ri(e,t,r,n={}){function s(i){if(n.capture||Ze.call(t,i),!i.cancelBubble)return Tt(()=>r?.call(this,i))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?We(()=>{t.addEventListener(e,s,n)}):t.addEventListener(e,s,n),s}function Yt(e,t,r,n={}){var s=ri(t,e,r,n);return()=>{e.removeEventListener(t,s,n)}}function ni(e){for(var t=0;t<e.length;t++)wn.add(e[t]);for(var r of Gt)r(e)}let Tr=null;function Ze(e){var t=this,r=t.ownerDocument,n=e.type,s=e.composedPath?.()||[],i=s[0]||e.target;Tr=e;var a=0,o=Tr===e&&e.__root;if(o){var l=s.indexOf(o);if(l!==-1&&(t===document||t===window)){e.__root=t;return}var u=s.indexOf(t);if(u===-1)return;l<=u&&(a=l)}if(i=s[a]||e.target,i!==t){Wt(e,"currentTarget",{configurable:!0,get(){return i||r}});var c=w,_=y;V(null),ce(null);try{for(var v,h=[];i!==null;){var d=i.assignedSlot||i.parentNode||i.host||null;try{var p=i["__"+n];if(p!=null&&(!i.disabled||e.target===i))if(bt(p)){var[m,...q]=p;m.apply(i,[e,...q])}else p.call(i,e)}catch(S){v?h.push(S):v=S}if(e.cancelBubble||d===t||d===null)break;i=d}if(v){for(let S of h)queueMicrotask(()=>{throw S});throw v}}finally{e.__root=t,delete e.currentTarget,V(c),ce(_)}}}function si(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function Kt(e,t){var r=y;r.nodes_start===null&&(r.nodes_start=e,r.nodes_end=t)}function F(e,t){var r=(t&ps)!==0,n=(t&gs)!==0,s,i=!e.startsWith("<!>");return()=>{s===void 0&&(s=si(i?e:"<!>"+e),r||(s=wt(s)));var a=n||Zr?document.importNode(s,!0):s.cloneNode(!0);if(r){var o=wt(a),l=a.lastChild;Kt(o,l)}else Kt(a,a);return a}}function Ar(){var e=document.createDocumentFragment(),t=document.createComment(""),r=ot();return e.append(t,r),Kt(t,r),e}function R(e,t){e!==null&&e.before(t)}function j(e,t){var r=t==null?"":typeof t=="object"?t+"":t;r!==(e.__t??=e.nodeValue)&&(e.__t=r,e.nodeValue=r+"")}function ii(e,t){return ai(e,t)}const je=new Map;function ai(e,{target:t,anchor:r,props:n={},events:s,context:i,intro:a=!0}){Ms();var o=new Set,l=_=>{for(var v=0;v<_.length;v++){var h=_[v];if(!o.has(h)){o.add(h);var d=ti(h);t.addEventListener(h,Ze,{passive:d});var p=je.get(h);p===void 0?(document.addEventListener(h,Ze,{passive:d}),je.set(h,1)):je.set(h,p+1)}}};l(Jt(wn)),Gt.add(l);var u=void 0,c=Bs(()=>{var _=r??t.appendChild(ot());return Ts(_,{pending:()=>{}},v=>{if(i){Ur({});var h=z;h.c=i}s&&(n.$$events=s),u=e(v,n)||{},i&&Vr()}),()=>{for(var v of o){t.removeEventListener(v,Ze);var h=je.get(v);--h===0?(document.removeEventListener(v,Ze),je.delete(v)):je.set(v,h)}Gt.delete(l),_!==r&&_.parentNode?.removeChild(_)}});return li.set(u,c),u}let li=new WeakMap;function re(e,t,r=!1){var n=e,s=null,i=null,a=O,o=r?St:0,l=!1;const u=(h,d=!0)=>{l=!0,v(d,h)};var c=null;function _(){c!==null&&(c.lastChild.remove(),n.before(c),c=null);var h=a?s:i,d=a?i:s;h&&ir(h),d&&$e(d,()=>{a?i=null:s=null})}const v=(h,d)=>{if(a!==(a=h)){var p=rn(),m=n;if(p&&(c=document.createDocumentFragment(),c.append(m=ot())),a?s??=d&&ne(()=>d(m)):i??=d&&ne(()=>d(m)),p){var q=C,S=a?s:i,T=a?i:s;S&&q.skipped_effects.delete(S),T&&q.skipped_effects.add(T),q.add_callback(_)}else _()}};nr(()=>{l=!1,t(u),l||v(null,null)},o)}function Ir(e,t){return t}function oi(e,t,r){for(var n=e.items,s=[],i=t.length,a=0;a<i;a++)sr(t[a].e,s,!0);var o=i>0&&s.length===0&&r!==null;if(o){var l=r.parentNode;js(l),l.append(r),n.clear(),le(e,t[0].prev,t[i-1].next)}fn(s,()=>{for(var u=0;u<i;u++){var c=t[u];o||(n.delete(c.k),le(e,c.prev,c.next)),X(c.e,!o)}})}function jt(e,t,r,n,s,i=null){var a=e,o={flags:t,items:new Map,first:null},l=(t&Mr)!==0;if(l){var u=e;a=u.appendChild(ot())}var c=null,_=!1,v=new Map,h=Os(()=>{var q=r();return bt(q)?q:q==null?[]:Jt(q)}),d,p;function m(){ui(p,d,o,v,a,s,t,n,r),i!==null&&(d.length===0?c?ir(c):c=ne(()=>i(a)):c!==null&&$e(c,()=>{c=null}))}nr(()=>{p??=y,d=f(h);var q=d.length;if(!(_&&q===0)){_=q===0;var S,T,M,I;if(rn()){var b=new Set,P=C;for(T=0;T<q;T+=1){M=d[T],I=n(M,T);var Z=o.items.get(I)??v.get(I);Z?(t&(Pt|qt))!==0&&yn(Z,M,T,t):(S=bn(null,o,null,null,M,I,T,s,t,r,!0),v.set(I,S)),b.add(I)}for(const[Ne,Oe]of o.items)b.has(Ne)||P.skipped_effects.add(Oe.e);P.add_callback(m)}else m();f(h)}})}function ui(e,t,r,n,s,i,a,o,l){var u=(a&hs)!==0,c=(a&(Pt|qt))!==0,_=t.length,v=r.items,h=r.first,d=h,p,m=null,q,S=[],T=[],M,I,b,P;if(u)for(P=0;P<_;P+=1)M=t[P],I=o(M,P),b=v.get(I),b!==void 0&&(b.a?.measure(),(q??=new Set).add(b));for(P=0;P<_;P+=1){if(M=t[P],I=o(M,P),b=v.get(I),b===void 0){var Z=n.get(I);if(Z!==void 0){n.delete(I),v.set(I,Z);var Ne=m?m.next:d;le(r,m,Z),le(r,Z,Ne),$t(Z,Ne,s),m=Z}else{var Oe=d?d.e.nodes_start:s;m=bn(Oe,r,m,m===null?r.first:m.next,M,I,P,i,a,l)}v.set(I,m),S=[],T=[],d=m.next;continue}if(c&&yn(b,M,P,a),(b.e.f&ie)!==0&&(ir(b.e),u&&(b.a?.unfix(),(q??=new Set).delete(b))),b!==d){if(p!==void 0&&p.has(b)){if(S.length<T.length){var be=T[0],ee;m=be.prev;var Fe=S[0],Ge=S[S.length-1];for(ee=0;ee<S.length;ee+=1)$t(S[ee],be,s);for(ee=0;ee<T.length;ee+=1)p.delete(T[ee]);le(r,Fe.prev,Ge.next),le(r,m,Fe),le(r,Ge,be),d=be,m=Ge,P-=1,S=[],T=[]}else p.delete(b),$t(b,d,s),le(r,b.prev,b.next),le(r,b,m===null?r.first:m.next),le(r,m,b),m=b;continue}for(S=[],T=[];d!==null&&d.k!==I;)(d.e.f&ie)===0&&(p??=new Set).add(d),T.push(d),d=d.next;if(d===null)continue;b=d}S.push(b),m=b,d=b.next}if(d!==null||p!==void 0){for(var Se=p===void 0?[]:Jt(p);d!==null;)(d.e.f&ie)===0&&Se.push(d),d=d.next;var pe=Se.length;if(pe>0){var kt=(a&Mr)!==0&&_===0?s:null;if(u){for(P=0;P<pe;P+=1)Se[P].a?.measure();for(P=0;P<pe;P+=1)Se[P].a?.fix()}oi(r,Se,kt)}}u&&We(()=>{if(q!==void 0)for(b of q)b.a?.apply()}),e.first=r.first&&r.first.e,e.last=m&&m.e;for(var Rt of n.values())X(Rt.e);n.clear()}function yn(e,t,r,n){(n&Pt)!==0&&Be(e.v,t),(n&qt)!==0?Be(e.i,r):e.i=r}function bn(e,t,r,n,s,i,a,o,l,u,c){var _=(l&Pt)!==0,v=(l&_s)===0,h=_?v?Ds(s,!1,!1):Te(s):s,d=(l&qt)===0?a:Te(a),p={i:d,v:h,k:i,a:null,e:null,prev:r,next:n};try{if(e===null){var m=document.createDocumentFragment();m.append(e=ot())}return p.e=ne(()=>o(e,h,d,u),ys),p.e.prev=r&&r.e,p.e.next=n&&n.e,r===null?c||(t.first=p):(r.next=p,r.e.next=p.e),n!==null&&(n.prev=p,n.e.prev=p.e),p}finally{}}function $t(e,t,r){for(var n=e.next?e.next.e.nodes_start:r,s=t?t.e.nodes_start:r,i=e.e.nodes_start;i!==null&&i!==n;){var a=ut(i);s.before(i),i=a}}function le(e,t,r){t===null?e.first=r:(t.next=r,t.e.next=r&&r.e),r!==null&&(r.prev=t,r.e.prev=t&&t.e)}const kr=[...` 	
\r\f \v\uFEFF`];function ci(e,t,r){var n=e==null?"":""+e;if(r){for(var s in r)if(r[s])n=n?n+" "+s:s;else if(n.length)for(var i=s.length,a=0;(a=n.indexOf(s,a))>=0;){var o=a+i;(a===0||kr.includes(n[a-1]))&&(o===n.length||kr.includes(n[o]))?n=(a===0?"":n.substring(0,a))+n.substring(o+1):a=o}}return n===""?null:n}function Rr(e,t,r,n,s,i){var a=e.__className;if(a!==r||a===void 0){var o=ci(r,n,i);o==null?e.removeAttribute("class"):e.className=o,e.__className=r}else if(i&&s!==i)for(var l in i){var u=!!i[l];(s==null||u!==!!s[l])&&e.classList.toggle(l,u)}return i}function Sn(e,t,r=!1){if(e.multiple){if(t==null)return;if(!bt(t))return ms();for(var n of e.options)n.selected=t.includes(it(n));return}for(n of e.options){var s=it(n);if(Ls(s,t)){n.selected=!0;return}}(!r||t!==void 0)&&(e.selectedIndex=-1)}function fi(e){var t=new MutationObserver(()=>{Sn(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),sn(()=>{t.disconnect()})}function di(e,t,r=t){var n=!0;nn(e,"change",s=>{var i=s?"[selected]":":checked",a;if(e.multiple)a=[].map.call(e.querySelectorAll(i),it);else{var o=e.querySelector(i)??e.querySelector("option:not([disabled])");a=o&&it(o)}r(a)}),Hs(()=>{var s=t();if(Sn(e,s,n),n&&s===void 0){var i=e.querySelector(":checked");i!==null&&(s=it(i),r(s))}e.__value=s,n=!1}),fi(e)}function it(e){return"__value"in e?e.__value:e.value}function vi(e,t,r=t){var n=new WeakSet;nn(e,"input",async s=>{var i=s?e.defaultValue:e.value;if(i=Ut(e)?Vt(i):i,r(i),C!==null&&n.add(C),await Xs(),i!==(i=t())){var a=e.selectionStart,o=e.selectionEnd;e.value=i??"",o!==null&&(e.selectionStart=a,e.selectionEnd=Math.min(o,e.value.length))}}),It(t)==null&&e.value&&(r(Ut(e)?Vt(e.value):e.value),C!==null&&n.add(C)),ln(()=>{var s=t();if(e===document.activeElement){var i=gt??C;if(n.has(i))return}Ut(e)&&s===Vt(e.value)||e.type==="date"&&!s&&!e.value||s!==e.value&&(e.value=s??"")})}function Ut(e){var t=e.type;return t==="number"||t==="range"}function Vt(e){return e===""?null:+e}function hi(e,t,r,n){var s=n,i=!0,a=()=>(i&&(i=!1,s=n),s),o;o=e[t],o===void 0&&n!==void 0&&(o=a());var l;l=()=>{var v=e[t];return v===void 0?a():(i=!0,v)};var u=!1,c=Ct(()=>(u=!1,l())),_=y;return(function(v,h){if(arguments.length>0){const d=h?f(c):v;return D(c,d),u=!0,s!==void 0&&(s=d),v}return Re&&u||(_.f&ke)!==0?c.v:f(c)})}function En(e){z===null&&Lr(),zs(()=>{const t=It(e);if(typeof t=="function")return t})}function _i(e){z===null&&Lr(),En(()=>()=>It(e))}const pi="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(pi);const Pn=typeof window<"u"?window:void 0;function gi(e){let t=e.activeElement;for(;t?.shadowRoot;){const r=t.shadowRoot.activeElement;if(r===t)break;t=r}return t}class mi{#e;#t;constructor(t={}){const{window:r=Pn,document:n=r?.document}=t;r!==void 0&&(this.#e=n,this.#t=tr(s=>{const i=Yt(r,"focusin",s),a=Yt(r,"focusout",s);return()=>{i(),a()}}))}get current(){return this.#t?.(),this.#e?gi(this.#e):null}}new mi;function wi(e,t){return e}function yi(e,t){let r=K(null);const n=ae(()=>wi(t));function s(...i){if(f(r))f(r).timeout&&clearTimeout(f(r).timeout);else{let a,o;const l=new Promise((u,c)=>{a=u,o=c});D(r,{timeout:null,runner:null,promise:l,resolve:a,reject:o},!0)}return f(r).runner=async()=>{if(!f(r))return;const a=f(r);D(r,null);try{a.resolve(await e.apply(this,i))}catch(o){a.reject(o)}},f(r).timeout=setTimeout(f(r).runner,f(n)),f(r).promise}return s.cancel=async()=>{(!f(r)||f(r).timeout===null)&&(await new Promise(i=>setTimeout(i,0)),!f(r)||f(r).timeout===null)||(clearTimeout(f(r).timeout),f(r).reject("Cancelled"),D(r,null))},s.runScheduledNow=async()=>{(!f(r)||!f(r).timeout)&&(await new Promise(i=>setTimeout(i,0)),!f(r)||!f(r).timeout)||(clearTimeout(f(r).timeout),f(r).timeout=null,await f(r).runner?.())},Object.defineProperty(s,"pending",{enumerable:!0,get(){return!!f(r)?.timeout}}),s}function bi(e,t){switch(e){case"local":return t.localStorage;case"session":return t.sessionStorage}}function qn(e,t,r,n,s,i){if(e===null||typeof e!="object")return e;const a=Object.getPrototypeOf(e);if(a!==null&&a!==Object.prototype&&!Array.isArray(e))return e;let o=r.get(e);return o||(o=new Proxy(e,{get:(l,u)=>(n?.(),qn(Reflect.get(l,u),t,r,n,s,i)),set:(l,u,c)=>(s?.(),Reflect.set(l,u,c),i(t),!0)}),r.set(e,o)),o}class Nr{#e;#t;#u;#i;#l;#r;#s=new WeakMap;constructor(t,r,n={}){const{storage:s="local",serializer:i={serialize:JSON.stringify,deserialize:JSON.parse},syncTabs:a=!0}=n,o="window"in n?n.window:Pn;if(this.#e=r,this.#t=t,this.#u=i,o===void 0)return;const l=bi(s,o);this.#i=l;const u=l.getItem(t);u!==null?this.#e=this.#a(u):this.#o(r),a&&s==="local"&&(this.#l=tr(c=>{this.#r=c;const _=Yt(o,"storage",this.#n);return()=>{_(),this.#r=void 0}}))}get current(){this.#l?.();const t=this.#i?.getItem(this.#t),r=t?this.#a(t):this.#e;return qn(r,r,this.#s,this.#l?.bind(this),this.#r?.bind(this),this.#o.bind(this))}set current(t){this.#o(t),this.#r?.()}#n=t=>{t.key!==this.#t||t.newValue===null||(this.#e=this.#a(t.newValue),this.#r?.())};#a(t){try{return this.#u.deserialize(t)}catch(r){console.error(`Error when parsing "${t}" from persisted store "${this.#t}"`,r);return}}#o(t){try{t!=null&&this.#i?.setItem(this.#t,this.#u.serialize(t))}catch(r){console.error(`Error when writing value from persisted store "${this.#t}" to ${this.#i}`,r)}}}const{Query:Qe}=window.Appwrite;class Si{productsState=new Nr("products-state",{products:[],loading:!1,error:null,syncing:!1,realtimeConnected:!1});syncState=new Nr("products-sync-state",{lastSync:null,mainId:null});#e=K(null);get debouncedSync(){return f(this.#e)}set debouncedSync(t){D(this.#e,t,!0)}unsubscribe=null;get products(){return this.productsState.current.products}get loading(){return this.productsState.current.loading}get error(){return this.productsState.current.error}get syncing(){return this.productsState.current.syncing}get realtimeConnected(){return this.productsState.current.realtimeConnected}get lastSync(){return this.syncState.current.lastSync}get mainId(){return this.syncState.current.mainId}async initialize(t){this.syncState.current.mainId===t&&this.productsState.current.products.length>0?(console.log("[ProductsStore] Chargement depuis le cache"),this.syncInBackground()):(console.log("[ProductsStore] Première connexion ou changement de mainId"),await this.loadFromAppwrite(t)),this.setupRealtime(t)}async loadFromAppwrite(t){this.productsState.current={...this.productsState.current,loading:!0,error:null};try{const r=await window.AppwriteClient.getDatabases(),n=window.AppwriteClient.getConfig(),s=await r.listDocuments(n.APPWRITE_CONFIG.databaseId,n.APPWRITE_CONFIG.collections.products,[Qe.equal("mainId",t),Qe.limit(5e3)]);this.productsState.current={products:s.documents,loading:!1,error:null,syncing:!1,realtimeConnected:!1},this.updateLastSync(t),console.log(`[ProductsStore] ${s.documents.length} produits chargés`)}catch(r){const n=r instanceof Error?r.message:"Erreur lors du chargement des produits";throw this.productsState.current={...this.productsState.current,loading:!1,error:n},console.error("[ProductsStore] Erreur lors du chargement:",r),r}}async syncInBackground(){if(this.syncState.current.lastSync){this.productsState.current={...this.productsState.current,syncing:!0};try{const t=await window.AppwriteClient.getDatabases(),r=window.AppwriteClient.getConfig(),n=await t.listDocuments(r.APPWRITE_CONFIG.databaseId,r.APPWRITE_CONFIG.collections.products,[Qe.greaterThan("$updatedAt",this.syncState.current.lastSync),Qe.equal("mainId",this.syncState.current.mainId),Qe.limit(1e3)]);if(n.documents.length>0){console.log(`[ProductsStore] ${n.documents.length} produits mis à jour trouvés`);const s=n.documents,i=this.productsState.current.products,a=new Map(s.map(c=>[c.$id,c])),o=i.map(c=>a.has(c.$id)?a.get(c.$id):c),l=new Set(i.map(c=>c.$id)),u=s.filter(c=>!l.has(c.$id));this.productsState.current={...this.productsState.current,products:[...o,...u],syncing:!1},this.updateLastSync(this.syncState.current.mainId)}else console.log("[ProductsStore] Aucune mise à jour trouvée"),this.productsState.current={...this.productsState.current,syncing:!1}}catch(t){console.error("[ProductsStore] Erreur lors de la sync:",t),this.productsState.current={...this.productsState.current,syncing:!1}}}}setupRealtime(t){this.unsubscribe&&this.unsubscribe(),console.log("[ProductsStore] Établissement de la connexion realtime"),this.unsubscribe=window.AppwriteClient.subscribeToCollections(["products"],t,r=>{console.log("[ProductsStore] Événement realtime reçu:",r),this.handleRealtimeEvent(r)},{onConnect:()=>{console.log("[ProductsStore] Connexion realtime établie"),this.productsState.current={...this.productsState.current,realtimeConnected:!0}},onDisconnect:()=>{console.log("[ProductsStore] Connexion realtime perdue"),this.productsState.current={...this.productsState.current,realtimeConnected:!1}},onError:r=>{console.error("[ProductsStore] Erreur realtime:",r)}})}handleRealtimeEvent(t){const{events:r,payload:n}=t;if(!n)return;const s=n,i=r.some(l=>l.includes(".create")),a=r.some(l=>l.includes(".update")),o=r.some(l=>l.includes(".delete"));i?this.handleProductCreate(s):a?this.handleProductUpdate(s):o&&this.handleProductDelete(s.$id),this.debouncedUpdateLastSync()}handleProductCreate(t){this.productsState.current.products.some(n=>n.$id===t.$id)||(console.log("[ProductsStore] Nouveau produit créé:",t.productName),this.productsState.current={...this.productsState.current,products:[...this.productsState.current.products,t]})}handleProductUpdate(t){console.log("[ProductsStore] Produit mis à jour:",t.productName),this.productsState.current={...this.productsState.current,products:this.productsState.current.products.map(r=>r.$id===t.$id?t:r)}}handleProductDelete(t){console.log("[ProductsStore] Produit supprimé:",t),this.productsState.current={...this.productsState.current,products:this.productsState.current.products.filter(r=>r.$id!==t)}}debouncedUpdateLastSync(){if(!this.debouncedSync){const t=yi(()=>{this.updateLastSync(this.syncState.current.mainId)},500);this.debouncedSync=t}this.debouncedSync()}updateLastSync(t){this.syncState.current={lastSync:new Date().toISOString(),mainId:t},console.log("[ProductsStore] lastSync mis à jour:",this.syncState.current.lastSync)}async forceReload(t){await this.loadFromAppwrite(t)}destroy(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null)}clearCache(){this.productsState.current={products:[],loading:!1,error:null,syncing:!1,realtimeConnected:!1},this.syncState.current={lastSync:null,mainId:null}}}const oe=new Si;async function Or(e,t){try{await oe.forceReload(t())}catch(r){console.error("[ProductsComponent] Erreur lors du rechargement:",r)}}function Ei(){oe.clearCache()}var Pi=F('<span class="last-sync svelte-1n46o8q"> </span>'),qi=F('<option class="svelte-1n46o8q"> </option>'),xi=F('<div class="loading-state svelte-1n46o8q"><div class="spinner svelte-1n46o8q"></div> <p class="svelte-1n46o8q">Chargement des produits...</p></div>'),Ci=F('<div class="error-state svelte-1n46o8q"><p class="svelte-1n46o8q"> </p> <button class="svelte-1n46o8q">Réessayer</button></div>'),Ti=(e,t,r)=>{D(t,""),D(r,null)},Ai=F('<p class="svelte-1n46o8q">Aucun produit ne correspond à vos critères</p> <button class="svelte-1n46o8q">Réinitialiser les filtres</button>',1),Ii=F('<p class="svelte-1n46o8q">Aucun produit trouvé</p>'),ki=F('<div class="empty-state svelte-1n46o8q"><!></div>'),Ri=F('<span class="filtered-indicator svelte-1n46o8q"> </span>'),Ni=F('<span class="badge frais svelte-1n46o8q">Frais</span>'),Oi=F('<span class="badge surgele svelte-1n46o8q">Surgelé</span>'),Fi=F('<span class="badge merged svelte-1n46o8q">Fusionné</span>'),Di=F('<div class="product-info svelte-1n46o8q"><span class="label svelte-1n46o8q">Stock:</span> <span class="value svelte-1n46o8q"> </span></div>'),Li=F('<span class="who-tag svelte-1n46o8q"> </span>'),Mi=F('<div class="product-who svelte-1n46o8q"><span class="label svelte-1n46o8q">Pour:</span> <div class="who-tags svelte-1n46o8q"></div></div>'),ji=F('<article class="product-card svelte-1n46o8q"><div class="product-header svelte-1n46o8q"><h3 class="svelte-1n46o8q"> </h3> <span> </span></div> <div class="product-body svelte-1n46o8q"><div class="product-info svelte-1n46o8q"><span class="label svelte-1n46o8q">Type:</span> <span class="value svelte-1n46o8q"> </span></div> <div class="product-badges svelte-1n46o8q"><!> <!> <!></div> <!> <div class="product-stats svelte-1n46o8q"><div class="stat svelte-1n46o8q"><span class="stat-value svelte-1n46o8q"> </span> <span class="stat-label svelte-1n46o8q">recettes</span></div> <div class="stat svelte-1n46o8q"><span class="stat-value svelte-1n46o8q"> </span> <span class="stat-label svelte-1n46o8q">assiettes</span></div></div> <!></div> <div class="product-footer svelte-1n46o8q"><small class="svelte-1n46o8q"> </small></div></article>'),$i=F('<div class="products-stats svelte-1n46o8q"><span class="svelte-1n46o8q"> </span> <!></div> <div class="products-grid svelte-1n46o8q"></div>',1),Ui=F('<div class="products-container svelte-1n46o8q"><header class="products-header svelte-1n46o8q"><div class="header-top svelte-1n46o8q"><h1 class="svelte-1n46o8q">Gestion des Produits</h1> <div class="status-bar svelte-1n46o8q"><span> </span> <!></div></div> <div class="actions-bar svelte-1n46o8q"><div class="search-filters svelte-1n46o8q"><input type="text" placeholder="Rechercher un produit..." class="search-input svelte-1n46o8q"/> <select class="filter-select svelte-1n46o8q"><option class="svelte-1n46o8q">Tous les types</option><!></select></div> <div class="action-buttons svelte-1n46o8q"><button class="svelte-1n46o8q"> </button> <button class="danger svelte-1n46o8q">Vider le cache</button></div></div></header> <main class="products-content svelte-1n46o8q"><!></main></div>');function Vi(e,t){Ur(t,!0);let r=hi(t,"mainId",7,"your-main-id");const s=new URLSearchParams(window.location.search).get("listId");s&&r(s);let i=ae(()=>oe.products),a=ae(()=>oe.loading),o=ae(()=>oe.error),l=ae(()=>oe.syncing),u=ae(()=>oe.realtimeConnected),c=ae(()=>oe.lastSync),_=ae(()=>f(l)?"Synchronisation...":f(u)?"En direct":"Hors ligne");En(async()=>{console.log("[ProductsComponent] Montage du composant");try{await window.AppwriteClient.initializeAppwrite(),console.log("[ProductsComponent] mainId",r()),await oe.initialize(r())}catch(E){console.error("[ProductsComponent] Erreur lors de l'initialisation:",E)}}),_i(()=>{console.log("[ProductsComponent] Démontage du composant"),oe.destroy()});let v=K(""),h=K(null),d=ae(()=>()=>{let E=f(i);if(f(v).trim()){const N=f(v).toLowerCase();E=E.filter(te=>te.productName.toLowerCase().includes(N)||te.productType.toLowerCase().includes(N))}return f(h)&&(E=E.filter(N=>N.productType===f(h))),E}),p=ae(()=>()=>{const E=new Set(f(i).map(N=>N.productType));return Array.from(E).sort()});var m=Ui(),q=g(m),S=g(q),T=x(g(S),2),M=g(T);let I;var b=g(M),P=x(M,2);{var Z=E=>{var N=Pi(),te=g(N);de(Ye=>j(te,`Dernière sync: ${Ye??""}`),[()=>new Date(f(c)).toLocaleString("fr-FR")]),R(E,N)};re(P,E=>{f(c)&&E(Z)})}var Ne=x(S,2),Oe=g(Ne),be=g(Oe),ee=x(be,2),Fe=g(ee);Fe.value=(Fe.__value=null)??"";var Ge=x(Fe);jt(Ge,17,()=>f(p)(),Ir,(E,N)=>{var te=qi(),Ye=g(te),ct={};de(()=>{j(Ye,f(N)),ct!==(ct=f(N))&&(te.value=(te.__value=f(N))??"")}),R(E,te)});var Se=x(Oe,2),pe=g(Se);pe.__click=[Or,r];var kt=g(pe),Rt=x(pe,2);Rt.__click=[Ei];var xn=x(q,2),Cn=g(xn);{var Tn=E=>{var N=xi();R(E,N)},An=E=>{var N=Ar(),te=pt(N);{var Ye=De=>{var Ke=Ci(),ft=g(Ke),Nt=g(ft),Ot=x(ft,2);Ot.__click=[Or,r],de(()=>j(Nt,`❌ Erreur: ${f(o)??""}`)),R(De,Ke)},ct=De=>{var Ke=Ar(),ft=pt(Ke);{var Nt=Le=>{var Je=ki(),dt=g(Je);{var vt=ge=>{var Me=Ai(),Dt=x(pt(Me),2);Dt.__click=[Ti,v,h],R(ge,Me)},Ft=ge=>{var Me=Ii();R(ge,Me)};re(dt,ge=>{f(v)||f(h)?ge(vt):ge(Ft,!1)})}R(Le,Je)},Ot=Le=>{var Je=$i(),dt=pt(Je),vt=g(dt),Ft=g(vt),ge=x(vt,2);{var Me=fe=>{var k=Ri(),ht=g(k);de(()=>j(ht,`(filtré sur ${f(i).length??""} total)`)),R(fe,k)};re(ge,fe=>{(f(v)||f(h))&&fe(Me)})}var Dt=x(dt,2);jt(Dt,21,()=>f(d)(),fe=>fe.$id,(fe,k)=>{var ht=ji(),ar=g(ht),lr=g(ar),In=g(lr),or=x(lr,2);let ur;var kn=g(or),cr=x(ar,2),fr=g(cr),Rn=x(g(fr),2),Nn=g(Rn),dr=x(fr,2),vr=g(dr);{var On=A=>{var B=Ni();R(A,B)};re(vr,A=>{f(k).pFrais&&A(On)})}var hr=x(vr,2);{var Fn=A=>{var B=Oi();R(A,B)};re(hr,A=>{f(k).pSurgel&&A(Fn)})}var Dn=x(hr,2);{var Ln=A=>{var B=Fi();R(A,B)};re(Dn,A=>{f(k).isMerged&&A(Ln)})}var _r=x(dr,2);{var Mn=A=>{var B=Di(),Lt=x(g(B),2),Mt=g(Lt);de(()=>j(Mt,f(k).stockReel)),R(A,B)};re(_r,A=>{f(k).stockReel&&A(Mn)})}var pr=x(_r,2),gr=g(pr),jn=g(gr),$n=g(jn),Un=x(gr,2),Vn=g(Un),Wn=g(Vn),zn=x(pr,2);{var Bn=A=>{var B=Mi(),Lt=x(g(B),2);jt(Lt,21,()=>f(k).who,Ir,(Mt,Kn)=>{var mr=Li(),Jn=g(mr);de(()=>j(Jn,f(Kn))),R(Mt,mr)}),R(A,B)};re(zn,A=>{f(k).who&&f(k).who.length>0&&A(Bn)})}var Hn=x(cr,2),Gn=g(Hn),Yn=g(Gn);de((A,B)=>{j(In,f(k).productName),ur=Rr(or,1,"product-status svelte-1n46o8q",null,ur,A),j(kn,f(k).status),j(Nn,f(k).productType),j($n,f(k).nbRecipes),j(Wn,f(k).totalAssiettes),j(Yn,`Mis à jour: ${B??""}`)},[()=>({active:f(k).status==="active"}),()=>new Date(f(k).$updatedAt).toLocaleDateString("fr-FR")]),R(fe,ht)}),de((fe,k)=>j(Ft,`${fe??""} produit${k??""}`),[()=>f(d)().length,()=>f(d)().length>1?"s":""]),R(Le,Je)};re(ft,Le=>{f(d)().length===0?Le(Nt):Le(Ot,!1)},!0)}R(De,Ke)};re(te,De=>{f(o)?De(Ye):De(ct,!1)},!0)}R(E,N)};re(Cn,E=>{f(a)?E(Tn):E(An,!1)})}de(E=>{I=Rr(M,1,"status-indicator svelte-1n46o8q",null,I,E),j(b,f(_)),pe.disabled=f(a)||f(l),j(kt,f(a)?"Chargement...":"Recharger")},[()=>({connected:f(u),syncing:f(l)})]),vi(be,()=>f(v),E=>D(v,E)),di(ee,()=>f(h),E=>D(h,E)),R(e,m),Vr()}ni(["click"]);ii(Vi,{target:document.getElementById("app_products")});
