import{$ as Xe,u as Ze,a0 as Ge,U as Je}from"./icons.js";import{p as Ke,j as Q,k as L,a2 as l,b as s,V as v,h as n,g as t,W as b,X as g,aa as Ye,a1 as _e,ah as $e,c as ea,d as aa,m as e,u as H,v as h,a3 as ra,q as M,Z as ta,y as O,a0 as fe,a4 as sa,aC as ia,am as na,e as Z,i as G}from"./appwrite.js";import{R as va}from"./RecipeRegimeBadges.js";import{R as da,a as oa}from"./RecipePreparation.js";import{R as la,a as ca}from"./RecipeVariants.js";import{n as ge}from"./index.js";import"./products-display.js";import"./Fieldset.js";import"./SvelteMarkdown.js";var pa=v('<div class="text-base-content/70 text-sm"> <!></div>'),ua=v(`<div class="alert alert-error alert-soft max-md:alert-vertical"><!> <div class="text-sm">Les auteur·ices de la recette ne l'ont <strong>pas testé</strong> </div></div>`);function _a(S,p){let E=Ke(p,"isChecked",3,!1);var f=Q(),B=L(f);{var R=_=>{var A=pa(),C=t(A),U=n(C);{var j=z=>{var V=Ye();b(()=>g(V,`et pour ${p.checkedFor??""} couverts`)),s(z,V)};l(U,z=>{p.checkedFor&&z(j)})}b(()=>g(C,`Cette recette a été testée pour ${p.defaultServings??""} couverts `)),s(_,A)},a=_=>{var A=ua(),C=t(A);Xe(C,{class:"h-5 w-5"});var U=n(C,2),j=n(t(U),2);b(()=>g(j,` pour le
      nombre de couverts indiqué par défaut (${p.defaultServings??""}).`)),s(_,A)};l(B,_=>{E()?_(R):_(a,!1)})}s(S,f)}function ga(S,p){const E=S.target,f=parseInt(E.value);!isNaN(f)&&f>0&&h(p,f,!0)}var fa=(S,p)=>fe(`/recipe/${e(p)?.$id}/duplicate`),ma=(S,p)=>fe(`/recipe/${e(p)?.$id}/edit`),ba=v('<button class="btn btn-primary"><!> Éditer</button>'),xa=v('<div class="flex items-center gap-4"><button class="btn btn-secondary"><!> Créer une version alternative</button> <!></div>'),ha=v('<div class="flex items-center justify-center py-20"><div class="loading loading-spinner loading-lg"></div></div>'),ya=v('<div class="alert alert-error"><div><h3 class="font-bold">Erreur</h3> <div> </div></div></div>'),wa=v("<div><!></div>"),ka=v('<p class="text-base-content/60 text-lg print:text-sm"> </p>'),Ra=v('<div class="mb-2"><span class="badge badge-primary badge-soft"> </span></div>'),Aa=v('<div class="mb-2 flex flex-wrap gap-2 print:hidden"><!> <p class="text-base-content/70 text-base italic"> </p></div>'),Sa=v('<span class="badge badge-warning">Servir Chaud</span>'),Ca=v('<span class="badge badge-info">Servir Froid</span>'),Ia=v('<div class="mb-2"><!></div>'),Ba=v('<span class="badge badge-warning">Avec Cuisson</span>'),ja=v('<span class="badge badge-info">Sans Cuisson</span>'),qa=v('<div class="mb-2"><!></div>'),Da=v('<span class="badge badge-error"> </span>'),Ea=v('<div class="flex w-fit flex-wrap items-center gap-2"><span class="text-base-content/70 font-semibold">Allergenes :</span> <!></div>'),Ua=v('<span class="badge"> </span>'),za=v('<div class="flex flex-wrap gap-2"></div>'),Fa=v('<p class="text-end text-base"> </p>'),Na=v('<div class="mt-8 print:hidden"><!></div>'),Pa=v('<div class="card bg-base-100"><div class="card-body not-md:px-1"><div class="mb-4 print:mb-2"><div class="flex items-center justify-between gap-x-10 gap-y-4"><h1 class="text-primary flex items-center gap-3 print:text-xl"><svg class="me-2 size-9 shrink-0"><use></use></svg> </h1> <!></div> <!></div> <!> <div class="border-base-300 mb-6 border-b pb-4 print:mb-1 print:pb-2"><div class="flex flex-wrap items-center justify-between gap-4"><div class="flex gap-2"><!> <!></div> <!> <!></div></div> <div class="mb-6 flex flex-wrap items-center justify-between gap-6 print:hidden"><div class="flex items-center gap-4"><label for="servings-input" class="flex items-center gap-2 font-medium"><!> Nombre de couverts à servir :</label> <input id="servings-input" type="number" min="1" class="input input-bordered input-primary w-24"/></div> <!></div> <div class="flex justify-between"><p class="print-only font-medium"> </p> <!></div> <div class="mt-8 grid grid-cols-1 gap-8 lg:grid-cols-3 print:mt-2 print:grid-cols-10 print:gap-4" style="break-before: avoid;"><div class=" lg:col-span-1 print:col-span-4"><div class="sticky top-4 print:static"><!></div></div> <div class="lg:col-span-2 print:col-span-6"><!></div></div></div></div> <!> <!>',1),Wa=v('<div class="mx-auto max-w-7xl px-4 py-8"><!></div>');function Ga(S,p){aa(p,!0);const E=u=>{var o=Q(),F=L(o);{var T=N=>{var y=xa(),w=t(y);w.__click=[fa,a];var P=t(w);Ze(P,{size:18});var W=n(w,2);{var I=q=>{var D=ba();D.__click=[ma,a];var X=t(D);Ge(X,{size:18}),s(q,D)};l(W,q=>{(e(a).permissionWrite&&O.userId&&e(a).permissionWrite.includes(O.userId)||e(a).createdBy&&e(a).createdBy===O.userId)&&q(I)})}s(N,y)};l(F,N=>{O.isAuthenticated&&e(a)&&N(T)})}s(u,o)};let f=H(()=>p.params?.uuid),B=M(!0),R=M(null),a=M(null),_=M(4);_e(()=>{e(f)?C(e(f)):(h(R,"UUID de recette manquant"),h(B,!1))});const A=H(()=>{if(!e(a)?.ingredients)return[];const u=new Set;return e(a).ingredients.forEach(o=>{o.allergens&&Array.isArray(o.allergens)&&o.allergens.forEach(F=>u.add(F))}),Array.from(u).sort()});async function C(u){h(B,!0),h(R,null);try{const o=await ra.getRecipeByUuid(u);if(!o){h(R,"Impossible de charger les détails de la recette");return}h(a,o,!0),h(_,o.plate,!0)}catch(o){console.error("Erreur lors du chargement de la recette:",o),h(R,o instanceof Error?o.message:"Erreur lors du chargement",!0)}finally{h(B,!1)}}_e(()=>{ge.setConfig({title:e(a)?.title||"Recette",actions:E})}),$e(()=>{ge.reset()});const U=H(()=>e(a)?na(e(a).typeR,e(a).categories||void 0):{label:"",iconId:"no-cat"});var j=Wa(),z=t(j);{var V=u=>{var o=ha();s(u,o)},me=u=>{var o=Q(),F=L(o);{var T=y=>{var w=ya(),P=t(w),W=n(t(P),2),I=t(W);b(()=>g(I,e(R))),s(y,w)},N=y=>{var w=Q(),P=L(w);{var W=I=>{var q=Pa(),D=L(q),X=t(D),J=t(X),K=t(J),Y=t(K),$=t(Y),be=t($),xe=n($),he=n(Y,2);{var ye=r=>{var i=wa(),c=t(i);va(c,{get regimes(){return e(a).regime},iconOnly:!1}),s(r,i)};l(he,r=>{e(a)?.regime&&e(a).regime.length>0&&r(ye)})}var we=n(K,2);{var ke=r=>{var i=ka(),c=t(i);b(()=>g(c,`une recette de ${e(a).auteur??""}`)),s(r,i)};l(we,r=>{e(a).auteur&&r(ke)})}var ee=n(J,2);{var Re=r=>{var i=Aa(),c=t(i);Z(c,17,()=>e(a).categories,G,(d,m)=>{var ue=Ra(),Qe=t(ue),Te=t(Qe);b(()=>g(Te,e(m))),s(d,ue)});var k=n(c,2),x=t(k);b(()=>g(x,e(a).description)),s(r,i)};l(ee,r=>{(e(a).description||e(a).categories&&e(a).categories.length>0)&&r(Re)})}var ae=n(ee,2),Ae=t(ae),re=t(Ae),te=t(re);{var Se=r=>{var i=Ia(),c=t(i);{var k=d=>{var m=Sa();s(d,m)},x=d=>{var m=Ca();s(d,m)};l(c,d=>{e(a).serveHot?d(k):d(x,!1)})}s(r,i)};l(te,r=>{e(a)?.serveHot!==void 0&&r(Se)})}var Ce=n(te,2);{var Ie=r=>{var i=qa(),c=t(i);{var k=d=>{var m=Ba();s(d,m)},x=d=>{var m=ja();s(d,m)};l(c,d=>{e(a).cuisson?d(k):d(x,!1)})}s(r,i)};l(Ce,r=>{e(a)?.cuisson!==void 0&&r(Ie)})}var se=n(re,2);{var Be=r=>{var i=Ea(),c=n(t(i),2);Z(c,17,()=>e(A),G,(k,x)=>{var d=Da(),m=t(d);b(()=>g(m,e(x))),s(k,d)}),s(r,i)};l(se,r=>{e(A).length>0&&r(Be)})}var je=n(se,2);{var qe=r=>{var i=za();Z(i,21,()=>e(a).materiel,G,(c,k)=>{var x=Ua(),d=t(x);b(()=>g(d,e(k))),s(c,x)}),s(r,i)};l(je,r=>{e(a)?.materiel&&e(a).materiel.length>0&&r(qe)})}var ie=n(ae,2),ne=t(ie),ve=t(ne),De=t(ve);Je(De,{class:"h-5 w-5"});var de=n(ve,2);de.__input=[ga,_];var Ee=n(ne,2);{var Ue=r=>{_a(r,{get isChecked(){return e(a).check},get defaultServings(){return e(a).plate}})};l(Ee,r=>{e(a).check!==void 0&&r(Ue)})}var oe=n(ie,2),le=t(oe),ze=t(le),Fe=n(le,2);{var Ne=r=>{var i=Fa(),c=t(i);b(()=>g(c,e(a).quantite_desc)),s(r,i)};l(Fe,r=>{e(a).quantite_desc&&r(Ne)})}var Pe=n(oe,2),ce=t(Pe),We=t(ce),He=t(We);da(He,{get ingredients(){return e(a).ingredients},get servings(){return e(_)},get defaultServings(){return e(a).plate}});var Le=n(ce,2),Ve=t(Le);{let r=H(()=>e(a).preparation24h||void 0),i=H(()=>e(a).astuces||[]);oa(Ve,{get preparation(){return e(a).preparation},get preparation24h(){return e(r)},get astuces(){return e(i)}})}var pe=n(D,2);{var Me=r=>{var i=Na(),c=t(i);ca(c,{get recipeId(){return e(f)}}),s(r,i)};l(pe,r=>{e(f)&&r(Me)})}var Oe=n(pe,2);la(Oe,{get auteur(){return e(a).auteur},get createdBy(){return e(a).createdBy},get id(){return e(a).$id},get createdAt(){return e(a).$createdAt},get updatedAt(){return e(a).$updatedAt}}),b(()=>{sa(be,"href",`/icons/sprite.svg#${e(U).iconId}`),g(xe,` ${e(a).title??""}`),ia(de,e(_)),g(ze,`Quantité pour ${e(_)??""} couverts`)}),s(I,q)};l(P,I=>{e(a)&&I(W)},!0)}s(y,w)};l(F,y=>{e(R)?y(T):y(N,!1)},!0)}s(u,o)};l(z,u=>{e(B)?u(V):u(me,!1)})}s(S,j),ea()}ta(["click","input"]);export{Ga as default};
