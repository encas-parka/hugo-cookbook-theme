import{j as Ce,W as v,B as i,a1 as Me,v as s,w as ue,x as _e,A as n,Z as be,o as ae,E as P,a as se,g as a,s as ce,u as J,X as y,_ as A,z as ne,Y as M,$ as f,D as $,a2 as Se,a3 as Re,ae as de,ac as Ae,p as Te,b as ye,aa as ze,a9 as Be,af as Pe,ag as Oe}from"./vendor.B7h_mkEd.js";import{B as Le,a as ie,y as he,x as Ee,z as ke}from"./appwrite.5W8SCupm.js";import{S as Ne,X as je,F as Qe,i as He,j as qe,k as Xe,l as Ke,m as Ue,n as We,E as Ye,o as Ze,A as Ge,p as Je,q as Ve,P as $e}from"./icons.DKN5kzXq.js";import{F as le}from"./Fieldset.Dv39p1Lh.js";import{A as et}from"./AutocompleteInput.B3IRzF5J.js";import{B as tt}from"./BadgeList.B_lshh9K.js";import{C as Ie}from"./CheckboxBadge.CBrhHJkp.js";import{R as De}from"./RecipeRegimeBadges.DVWfhtza.js";import{L as at}from"./LeftPanel.CojHg0lY.js";import{r as we}from"./RecipeDataStore.svelte.z7daM122.js";import{n as Fe}from"./index.BUL8Pmq2.js";import"./editor.L4rklAfR.js";import"./markdown.BkFahWn2.js";import"./keyboardNavigation.svelte.ETytoTUJ.js";var rt=v('<div><label class="input input-lg w-full"><!> <input type="text" placeholder="Rechercher... (parmi les titres, auteur·ices, spécialités. Désactive les filtres sélectionnés)"/> <button class="btn btn-circle" title="Effacer la recherche"><!></button></label></div>');function st(x,e){_e(e,!0);let l=Ce(e,"searchQuery",15);var o=rt(),L=n(o),I=n(L);Ne(I,{class:"h-5 w-5 opacity-50"});var E=i(I,2),X=i(E,2);X.__click=function(...K){e.onReset?.apply(this,K)};var Q=n(X);je(Q,{class:"h-5 w-5"}),Me(E,l),s(x,o),ue()}be(["click"]);var nt=v('<div class="flex flex-wrap gap-3"></div>'),it=v('<div class="flex flex-wrap gap-3"></div>'),ot=v('<div class="mb-3"><!></div> <div><div class="mb-2 text-xs font-medium"> </div> <!></div>',1),lt=(x,e)=>e(e().testedStatus="all",!0),ct=(x,e)=>e(e().testedStatus="tested",!0),dt=(x,e)=>e(e().testedStatus="untested",!0),vt=v('<div class="bg-base-100 flex gap-1 rounded-xl p-2 font-semibold"><button type="button" aria-label="Toutes">Toutes</button> <button type="button" aria-label="Testées">Testées</button> <button type="button" aria-label="Non testées">À tester</button></div>'),ut=(x,e)=>e(e().temperature="",!0),_t=(x,e)=>e(e().temperature="Chaud",!0),bt=(x,e)=>e(e().temperature="Froid",!0),gt=v('<div class="bg-base-100 flex gap-1 rounded-xl p-2 font-semibold"><button type="button" aria-label="Indifférent">Indifférent</button> <button type="button" aria-label="Servir chaud">Chaud</button> <button type="button" aria-label="Servir froid">Froid</button></div>'),ft=(x,e)=>e(e().cuisson="",!0),mt=(x,e)=>e(e().cuisson="Oui",!0),pt=(x,e)=>e(e().cuisson="Non",!0),xt=v('<div class="bg-base-100 flex gap-1 rounded-xl p-2 font-semibold"><button type="button" aria-label="Indifférent">Indifférent</button> <button type="button" aria-label="Avec cuisson">Avec</button> <button type="button" aria-label="Sans cuisson">Sans</button></div>'),ht=(x,e)=>e(e().saison="",!0),yt=(x,e)=>e(e().saison="printemps",!0),kt=(x,e)=>e(e().saison="ete",!0),wt=(x,e)=>e(e().saison="automne",!0),Ct=(x,e)=>e(e().saison="hiver",!0),St=v('<div class="bg-base-100 flex flex-wrap gap-1 rounded-xl p-2 font-semibold"><button type="button" aria-label="Indifférent">Toutes</button> <button type="button" aria-label="Printemps">Printemps</button> <button type="button" aria-label="Été">Été</button> <button type="button" aria-label="Automne">Automne</button> <button type="button" aria-label="Hiver">Hiver</button></div>'),Rt=v('<div><div class="mb-4 flex items-center justify-between"><h4 class="text-lg font-bold">Filtres</h4> <button class="btn btn-warning btn-sm"><!> Effacer</button></div> <!> <!> <!> <!> <!> <!> <!></div>');function At(x,e){_e(e,!0);let l=Ce(e,"filters",15),o=Ce(e,"disabled",3,!1);function L(c,p){const d=c.indexOf(p);d===-1?c.push(p):c.splice(d,1),l({...l()})}let I=ce("");function E(c){l().ingredients.includes(c)||(l().ingredients.push(c),l({...l()}))}function X(c,p){const d=l().ingredients.indexOf(c);d!==-1&&(l().ingredients.splice(d,1),l({...l()}))}let Q=J(()=>e.availableIngredients.filter(c=>!l().ingredients.includes(c)));var K=Rt();let ee;var te=n(K),V=i(n(te),2);V.__click=function(...c){e.onReset?.apply(this,c)};var k=n(V);Qe(k,{class:"h-4 w-4"});var O=i(te,2);le(O,{legend:"Catégories",get iconComponent(){return He},children:(c,p)=>{var d=nt();ae(d,21,()=>e.availableCategories,ne,(_,u)=>{{let m=J(()=>l().categories.includes(a(u)));Ie(_,{get checked(){return a(m)},get label(){return a(u)},onchange:()=>L(l().categories,a(u)),get disabled(){return o()}})}}),s(c,d)},$$slots:{default:!0}});var H=i(O,2);le(H,{legend:"Régimes",get iconComponent(){return qe},children:(c,p)=>{var d=it();ae(d,21,()=>e.availableRegimes,ne,(_,u)=>{{let m=J(()=>l().regimes.includes(a(u)));Ie(_,{get checked(){return a(m)},get label(){return a(u)},onchange:()=>L(l().regimes,a(u)),get disabled(){return o()}})}}),s(c,d)},$$slots:{default:!0}});var q=i(H,2);le(q,{legend:"Ingrédients",get iconComponent(){return Xe},children:(c,p)=>{var d=ot(),_=P(d),u=n(_);et(u,{get items(){return a(Q)},onSelect:E,placeholder:"Ajouter un ingrédient...",get disabled(){return o()},minQueryLength:1,get value(){return a(I)},set value(U){se(I,U,!0)}});var m=i(_,2),z=n(m),S=n(z),N=i(z,2);tt(N,{get items(){return l().ingredients},onRemove:X,badgeClass:"badge-success",get disabled(){return o()},itemKey:(U,G)=>U}),y(()=>M(S,`Ingrédients sélectionnés (${l().ingredients.length??""})`)),s(c,d)},$$slots:{default:!0}});var W=i(q,2);le(W,{legend:"Testé",children:(c,p)=>{var d=vt(),_=n(d);_.__click=[lt,l];var u=i(_,2);u.__click=[ct,l];var m=i(u,2);m.__click=[dt,l],y(()=>{A(_,1,`btn btn-sm flex-1 ${l().testedStatus==="all"&&"btn-secondary"}`),A(u,1,`btn btn-sm flex-1 ${l().testedStatus==="tested"&&"btn-success"}`),A(m,1,`btn btn-sm flex-1 ${l().testedStatus==="untested"&&"btn-error"}`)}),s(c,d)},$$slots:{default:!0}});var D=i(W,2);le(D,{legend:"Service",get iconComponent(){return Ke},children:(c,p)=>{var d=gt(),_=n(d);_.__click=[ut,l];var u=i(_,2);u.__click=[_t,l];var m=i(u,2);m.__click=[bt,l],y(()=>{A(_,1,`btn btn-sm flex-1 ${l().temperature===""&&"btn-secondary"}`),A(u,1,`btn btn-sm flex-1 ${l().temperature==="Chaud"&&"btn-error"}`),A(m,1,`btn btn-sm flex-1 ${l().temperature==="Froid"&&"btn-info"}`)}),s(c,d)},$$slots:{default:!0}});var T=i(D,2);le(T,{legend:"Cuisson",get iconComponent(){return Ue},children:(c,p)=>{var d=xt(),_=n(d);_.__click=[ft,l];var u=i(_,2);u.__click=[mt,l];var m=i(u,2);m.__click=[pt,l],y(()=>{A(_,1,`btn btn-sm flex-1 ${l().cuisson===""&&"btn-secondary"}`),A(u,1,`btn btn-sm flex-1 ${l().cuisson==="Oui"&&"btn-warning"}`),A(m,1,`btn btn-sm flex-1 ${l().cuisson==="Non"&&"btn-success"}`)}),s(c,d)},$$slots:{default:!0}});var Z=i(T,2);le(Z,{legend:"Saison",get iconComponent(){return We},children:(c,p)=>{var d=St(),_=n(d);_.__click=[ht,l];var u=i(_,2);u.__click=[yt,l];var m=i(u,2);m.__click=[kt,l];var z=i(m,2);z.__click=[wt,l];var S=i(z,2);S.__click=[Ct,l],y(()=>{A(_,1,`btn btn-sm flex-1 ${l().saison===""&&"btn-secondary"}`),A(u,1,`btn btn-sm flex-1 ${l().saison==="printemps"&&"btn-success"}`),A(m,1,`btn btn-sm flex-1 ${l().saison==="ete"&&"btn-warning"}`),A(z,1,`btn btn-sm flex-1 ${l().saison==="automne"&&"btn-accent"}`),A(S,1,`btn btn-sm flex-1 ${l().saison==="hiver"&&"btn-info"}`)}),s(c,d)},$$slots:{default:!0}}),y(c=>{ee=A(K,1,"mt-16 space-y-4",null,ee,c),V.disabled=o()},[()=>({"opacity-30":o()})]),s(x,K),ue()}be(["click"]);var It=v(`<span class="font-semibold"> </span> correspondent
          aux critères`,1),Dt=v(`<span class="font-semibold"> </span> correspondent
          aux critères`,1),Ft=v('<span class="font-semibold"> </span> correspond aux critères',1),Mt=v('<span class="font-semibold">1 recette</span> correspond aux critères',1),Tt=v('<span class="text-warning"> </span> ne correspond aux critères...',1),zt=v('<span class="text-warning">Aucune recette</span> ne correspond aux critères...',1),Bt=v('<legend class="legend text-base-content/70 ms-4"><!></legend>'),Pt=v('<div class="text-base-content/70 text-base"><!></div>'),Ot=v('<div><span class="text-base-content/60 italic">contient (dans son titre/auteur·ice...) :</span> <span class="font-bold"> </span></div>'),Lt=v('<span class="badge badge-success"> </span>'),Et=v('<span class="badge badge-secondary"> </span>'),Nt=v('<span class="badge badge-error text-white">Servir Chaud</span>'),jt=v('<span class="badge badge-info">Servir Froid</span>'),Qt=v('<span class="badge badge-warning">Avec Cuisson</span>'),Ht=v('<span class="badge badge-success">Sans Cuisson</span>'),qt=v('<span class="badge badge-accent"> </span>'),Xt=v('<span class="badge badge-success"> </span>'),Kt=v('<span class="badge badge-success">Testées</span>'),Ut=v('<span class="badge badge-error">À tester</span>'),Wt=v('<span class="badge badge-warning"> </span>'),Yt=v('<div class="flex flex-wrap gap-2"><!> <!> <!> <!> <!> <!> <!> <!></div> <div class="mt-3 text-end"><button class="btn btn-warning btn-sm"><!> Effacer tous les filtres</button></div>',1),Zt=v('<fieldset class="fieldset border-base-300 relative rounded-lg border-2"><!> <div class="p-4"><!> <!></div></fieldset>');function Gt(x,e){_e(e,!0);const l=J(()=>e.filters.categories.length>0||e.filters.regimes.length>0||e.filters.ingredients.length>0||e.filters.temperature!==""||e.filters.cuisson!==""||e.filters.saison!==""||e.filters.testedStatus!=="all"),o=J(()=>{switch(e.filters.typeR){case"entree":return"entrée";case"plat":return"plat";case"dessert":return"dessert";default:return""}});var L=Zt(),I=n(L);{var E=k=>{var O=Bt(),H=n(O);{var q=D=>{var T=$(),Z=P(T);{var c=d=>{var _=It(),u=P(_),m=n(u);y(()=>M(m,`${e.resultCount??""} ${a(o)??""}s`)),s(d,_)},p=d=>{var _=Dt(),u=P(_),m=n(u);y(()=>M(m,`${e.resultCount??""} recettes`)),s(d,_)};f(Z,d=>{a(o)?d(c):d(p,!1)})}s(D,T)},W=D=>{var T=$(),Z=P(T);{var c=d=>{var _=$(),u=P(_);{var m=S=>{var N=Ft(),U=P(N),G=n(U);y(()=>M(G,`1 ${a(o)??""}`)),s(S,N)},z=S=>{var N=Mt();s(S,N)};f(u,S=>{a(o)?S(m):S(z,!1)})}s(d,_)},p=d=>{var _=$(),u=P(_);{var m=S=>{var N=Tt(),U=P(N),G=n(U);y(()=>M(G,`Aucun ${a(o)??""}`)),s(S,N)},z=S=>{var N=zt();s(S,N)};f(u,S=>{a(o)?S(m):S(z,!1)},!0)}s(d,_)};f(Z,d=>{e.resultCount===1?d(c):d(p,!1)},!0)}s(D,T)};f(H,D=>{e.resultCount>1?D(q):D(W,!1)})}s(k,O)};f(I,k=>{a(l)&&k(E)})}var X=i(I,2),Q=n(X);{var K=k=>{var O=Pt(),H=n(O);{var q=D=>{var T=Se();y(()=>M(T,`${e.resultCount??""} ${a(o)??""}s`)),s(D,T)},W=D=>{var T=Se();y(()=>M(T,`${e.resultCount??""} recettes`)),s(D,T)};f(H,D=>{a(o)?D(q):D(W,!1)})}s(k,O)};f(Q,k=>{a(l)||k(K)})}var ee=i(Q,2);{var te=k=>{var O=Ot(),H=i(n(O),2),q=n(H);y(()=>M(q,e.searchQuery)),s(k,O)},V=k=>{var O=$(),H=P(O);{var q=W=>{var D=Yt(),T=P(D),Z=n(T);ae(Z,17,()=>e.filters.categories,ne,(t,r)=>{var b=Lt(),w=n(b);y(()=>M(w,a(r))),s(t,b)});var c=i(Z,2);ae(c,17,()=>e.filters.regimes,ne,(t,r)=>{var b=Et(),w=n(b);y(()=>M(w,a(r))),s(t,b)});var p=i(c,2);{var d=t=>{var r=Nt();s(t,r)},_=t=>{var r=$(),b=P(r);{var w=C=>{var h=jt();s(C,h)};f(b,C=>{e.filters.temperature==="Froid"&&C(w)},!0)}s(t,r)};f(p,t=>{e.filters.temperature==="Chaud"?t(d):t(_,!1)})}var u=i(p,2);{var m=t=>{var r=Qt();s(t,r)},z=t=>{var r=$(),b=P(r);{var w=C=>{var h=Ht();s(C,h)};f(b,C=>{e.filters.cuisson==="Non"&&C(w)},!0)}s(t,r)};f(u,t=>{e.filters.cuisson==="Oui"?t(m):t(z,!1)})}var S=i(u,2);{var N=t=>{var r=qt(),b=n(r);y(()=>M(b,e.filters.saison)),s(t,r)};f(S,t=>{e.filters.saison&&t(N)})}var U=i(S,2);ae(U,17,()=>e.filters.ingredients,ne,(t,r)=>{var b=Xt(),w=n(b);y(()=>M(w,a(r))),s(t,b)});var G=i(U,2);{var ge=t=>{var r=Kt();s(t,r)},fe=t=>{var r=$(),b=P(r);{var w=C=>{var h=Ut();s(C,h)};f(b,C=>{e.filters.testedStatus==="untested"&&C(w)},!0)}s(t,r)};f(G,t=>{e.filters.testedStatus==="tested"?t(ge):t(fe,!1)})}var me=i(G,2);{var ve=t=>{var r=Wt(),b=n(r);y(()=>M(b,a(o))),s(t,r)};f(me,t=>{e.filters.typeR&&t(ve)})}var pe=i(T,2),g=n(pe);g.__click=function(...t){e.onResetFilters?.apply(this,t)};var R=n(g);Ye(R,{class:"h-4 w-4"}),s(W,D)};f(H,W=>{a(l)&&W(q)},!0)}s(k,O)};f(ee,k=>{e.searchQuery.length>=2?k(te):k(V,!1)})}s(x,L),ue()}be(["click"]);var Jt=(x,e)=>{(x.key==="Enter"||x.key===" ")&&e()},Vt=v('<div class="badge badge-accent badge-outline badge-sm">brouillon</div>'),$t=v('<div class="text-primary bg-base-100 rounded-t-box border-t-base-300 absolute -top-4 left-0 flex max-w-4/5 items-center-safe gap-3 border-t-1 py-0.5 ps-4 pe-6 text-lg font-semibold"><svg class="size-6"><use></use></svg> <!></div> <div class="bg-base-100 rounded-t-box border-base-300 absolute -top-4 right-0 border-t-1 px-1"><!></div>',1),ea=v('<div class="badge badge-accent badge-outline badge-sm">brouillon</div>'),ta=v('<div class="flex gap-4"><div class="text-primary mb-2 inline-flex flex-wrap items-center-safe gap-2 text-lg font-semibold"><div class="items-start-safe inline-flex gap-2"><svg class="mt-0.5 size-6 min-w-6"><use></use></svg> </div> <!></div> <!></div>'),aa=v('<span class="text-primary text-base font-bold"> </span>'),ra=v("<span> </span>"),sa=v("<p> </p>"),na=v("<p> <strong>(non testée)</strong></p>"),ia=v('<span class="badge badge-ghost badge-sm"> </span>'),oa=v('<span class="badge badge-primary badge-soft badge-sm"> </span>'),la=v("<!> <!>",1),ca=v('<span class="badge badge-soft badge-sm badge-error">Servir Chaud</span>'),da=v('<span class="badge badge-soft badge-sm badge-info">Servir Froid</span>'),va=v('<span class="badge badge-soft badge-sm badge-warning">Avec Cuisson</span>'),ua=v('<span class="badge badge-soft badge-sm badge-success">Sans Cuisson</span>'),_a=v('<span class="badge badge-soft badge-accent badge-sm"> </span>'),ba=v("<span> <!></span>"),ga=v('<div class="my-1 text-sm"><span class="font-semibold">Ingrédients :</span> <!></div>'),fa=v('<span class="me-1"> <!></span>'),ma=v('<div class="text-sm"><span class="font-semibold">Matériel :</span> <!></div>'),pa=v('<div role="button" tabindex="0"><!> <div class=" flex flex-wrap items-start justify-between gap-4 @md:my-2"><div class="min-w-72 flex-1"><!> <div class=" flex flex-col"><div><!> <!></div> <div class="text-base-content/60 text-sm"><!></div></div></div> <div class="ms-auto flex flex-col justify-end gap-2"><div class=" flex flex-wrap justify-end gap-1 pt-1"><!></div> <div class="mb-2 flex flex-wrap justify-end gap-1"><!> <!> <!></div></div></div> <!> <!></div>');function xa(x,e){_e(e,!0);let l=Ce(e,"highlightedIngredients",19,()=>[]);function o(){he(`/recipe/${e.recipe.$id}`)}const L=Le(e.recipe.typeR,e.recipe.categories||void 0);var I=pa();I.__click=o,I.__keydown=[Jt,o];var E=n(I);{var X=t=>{var r=$t(),b=P(r),w=n(b),C=n(w),h=i(w),F=i(h);{var j=B=>{var xe=Vt();s(B,xe)};f(F,B=>{e.recipe.draft&&B(j)})}var Y=i(b,2),oe=n(Y);{var re=B=>{De(B,{get regimes(){return e.recipe.regime},iconOnly:!0})};f(oe,B=>{e.recipe.regime&&B(re)})}y(()=>{Re(C,"href",`/icons/sprite.svg#${L.iconId}`),M(h,` ${e.recipe.title??""} `)}),s(t,r)};f(E,t=>{ie.isDesktop&&t(X)})}var Q=i(E,2),K=n(Q),ee=n(K);{var te=t=>{var r=ta(),b=n(r),w=n(b),C=n(w),h=n(C),F=i(C),j=i(w,2);{var Y=B=>{var xe=ea();s(B,xe)};f(j,B=>{e.recipe.draft&&B(Y)})}var oe=i(b,2);{var re=B=>{De(B,{get regimes(){return e.recipe.regime},iconOnly:!0})};f(oe,B=>{e.recipe.regime&&B(re)})}y(()=>{Re(h,"href",`/icons/sprite.svg#${L.iconId}`),M(F,` ${e.recipe.title??""}`)}),s(t,r)};f(ee,t=>{ie.isDesktop||t(te)})}var V=i(ee,2),k=n(V),O=n(k);{var H=t=>{var r=aa(),b=n(r);y(()=>M(b,e.recipe.versionLabel)),s(t,r)};f(O,t=>{e.recipe.versionLabel&&t(H)})}var q=i(O,2);{var W=t=>{var r=ra(),b=n(r);y(()=>{A(r,1,de(e.recipe.auteur===ie.userName?"text-accent font-semibold":"text-base-content/70 ")),M(b,`de ${e.recipe.auteur??""}`)}),s(t,r)};f(q,t=>{e.recipe.auteur&&t(W)})}var D=i(k,2),T=n(D);{var Z=t=>{var r=sa(),b=n(r);y(()=>M(b,`testée pour ${e.recipe.plate??""}
              couverts`)),s(t,r)},c=t=>{var r=na(),b=n(r);y(()=>M(b,`théoriquement pour ${e.recipe.plate??""} couverts `)),s(t,r)};f(T,t=>{e.recipe.check?t(Z):t(c,!1)})}var p=i(K,2),d=n(p),_=n(d);{var u=t=>{var r=la(),b=P(r);{var w=h=>{var F=ia(),j=n(F);y(()=>M(j,e.recipe.region)),s(h,F)};f(b,h=>{e.recipe.region&&h(w)})}var C=i(b,2);ae(C,17,()=>e.recipe.categories,ne,(h,F)=>{var j=oa(),Y=n(j);y(()=>M(Y,a(F))),s(h,j)}),s(t,r)};f(_,t=>{e.recipe.categories&&t(u)})}var m=i(d,2),z=n(m);{var S=t=>{var r=ca();s(t,r)},N=t=>{var r=da();s(t,r)};f(z,t=>{e.recipe.serveHot?t(S):t(N,!1)})}var U=i(z,2);{var G=t=>{var r=va();s(t,r)},ge=t=>{var r=ua();s(t,r)};f(U,t=>{e.recipe.cuisson?t(G):t(ge,!1)})}var fe=i(U,2);{var me=t=>{var r=$(),b=P(r);ae(b,17,()=>e.recipe.saison,ne,(w,C)=>{var h=_a(),F=n(h);y(()=>M(F,a(C))),s(w,h)}),s(t,r)};f(fe,t=>{e.recipe.saison&&t(me)})}var ve=i(Q,2);{var pe=t=>{var r=ga(),b=i(n(r),2);ae(b,17,()=>e.recipe.ingredients,ne,(w,C,h)=>{var F=ba();let j;var Y=n(F),oe=i(Y);{var re=B=>{var xe=Se(",");s(B,xe)};f(oe,B=>{h<e.recipe.ingredients.length-1&&B(re)})}y(B=>{j=A(F,1,"me-1",null,j,B),M(Y,a(C))},[()=>({"font-bold":l().includes(a(C)),underline:l().includes(a(C))})]),s(w,F)}),s(t,r)};f(ve,t=>{e.recipe.ingredients&&e.recipe.ingredients.length>0&&t(pe)})}var g=i(ve,2);{var R=t=>{var r=ma(),b=i(n(r),2);ae(b,17,()=>e.recipe.materiel,ne,(w,C,h)=>{var F=fa(),j=n(F),Y=i(j);{var oe=re=>{var B=Se(",");s(re,B)};f(Y,re=>{h<e.recipe.materiel.length-1&&re(oe)})}y(()=>M(j,a(C))),s(w,F)}),s(t,r)};f(g,t=>{e.recipe.materiel&&e.recipe.materiel.length>0&&t(R)})}y(()=>A(I,1,`card bg-base-100 cursor-pointer p-4 shadow-sm transition-shadow hover:shadow-md ${e.recipe.auteur===ie.userName&&"border-accent/60 border-l-3"}`)),s(x,I),ue()}be(["click","keydown"]);var ha=(x,e)=>e("title"),ya=(x,e)=>e("$createdAt"),ka=(x,e)=>e("$updatedAt"),wa=()=>he("/recipe"),Ca=()=>he("/recipe/my"),Sa=()=>he("/recipe/my/draft"),Ra=v('<fieldset class="fieldset"><legend class="legend label"><!> Filtrer :</legend> <div class="btn-group"><button>Tout</button> <button>Mes recettes</button> <button>Mes brouillons</button></div></fieldset>'),Aa=v('<div class="bg-base-300 rounded-box flex flex-wrap items-center justify-between gap-6 px-6 py-6"><fieldset class="fieldset"><legend class="legend label"><!> Trier par :</legend> <div class="btn-group"><button aria-label="Trier par titre">Titre</button> <button aria-label="Trier par date de création"><!> Date de création</button> <button aria-label="Trier par date de modification"><!> Date de modification</button></div></fieldset> <!></div>');function Ia(x,e){_e(e,!0);const l=c=>e.sortBy!==c?"inactive":e.sortOrder,o=c=>{c==="title"?e.onSortChange("title",e.sortBy==="title"&&e.sortOrder==="asc"?"desc":"asc"):e.sortBy!==c?e.onSortChange(c,"desc"):e.sortOrder==="desc"?e.onSortChange(c,"asc"):e.onSortChange("title","asc")},L=c=>{const p=l(c),d="btn btn-sm btn-primary btn-outline gap-2";return p==="inactive"?`${d}`:p==="asc"?`${d} btn-active`:`${d} btn-active`},I=c=>{const p=l(c);return p==="inactive"?null:p==="asc"?Ge:Je},E=c=>{const p="btn btn-sm btn-secondary";return e.scope===c?`${p}`:`${p} btn-outline`};var X=Aa(),Q=n(X),K=n(Q),ee=n(K);Ze(ee,{class:"inline size-4"});var te=i(K,2),V=n(te);V.__click=[ha,o];var k=i(V,2);k.__click=[ya,o];var O=n(k);{var H=c=>{const p=J(()=>I("$createdAt"));var d=$(),_=P(d);Ae(_,()=>a(p),(u,m)=>{m(u,{size:16})}),s(c,d)};f(O,c=>{I("$createdAt")&&c(H)})}var q=i(k,2);q.__click=[ka,o];var W=n(q);{var D=c=>{const p=J(()=>I("$updatedAt"));var d=$(),_=P(d);Ae(_,()=>a(p),(u,m)=>{m(u,{size:16})}),s(c,d)};f(W,c=>{I("$updatedAt")&&c(D)})}var T=i(Q,2);{var Z=c=>{var p=Ra(),d=n(p),_=n(d);Ve(_,{class:"inline h-4 w-4"});var u=i(d,2),m=n(u);m.__click=[wa];var z=i(m,2);z.__click=[Ca];var S=i(z,2);S.__click=[Sa],y((N,U,G)=>{A(m,1,N),A(z,1,U),A(S,1,G)},[()=>de(E("all")),()=>de(E("mine")),()=>de(E("drafts"))]),s(c,p)};f(T,c=>{ie.isAuthenticated&&c(Z)})}y((c,p,d)=>{A(V,1,c),A(k,1,p),A(q,1,d)},[()=>de(L("title")),()=>de(L("$createdAt")),()=>de(L("$updatedAt"))]),s(x,X),ue()}be(["click"]);const Da=x=>{var e=$(),l=P(e);{var o=L=>{var I=Ma();I.__click=[Fa];var E=n(I);$e(E,{size:18}),s(L,I)};f(l,L=>{ie.isAuthenticated&&L(o)})}s(x,e)};var Fa=()=>he("/recipe/new"),Ma=v('<button class="btn btn-primary"><!> Créer une recette</button>'),Ta=(x,e)=>a(e).typeR="",za=(x,e)=>a(e).typeR="entree",Ba=(x,e)=>a(e).typeR="plat",Pa=(x,e)=>a(e).typeR="dessert",Oa=v('<div class="alert alert-error"><span> </span></div>'),La=v('<div class="py-8 text-center"><span class="loading loading-spinner loading-md"></span></div>'),Ea=v('<div class="py-12 text-center"><p class="text-base-content/60 text-lg">Aucune recette ne correspond aux critères...</p></div>'),Na=v('<div class="my-8 space-y-10"></div> <!> <!>',1),ja=v('<!> <div class="p-4 lg:ml-100"><div class="mx-auto max-w-4xl"><div class="mb-10 space-y-6"><div class="tabs tabs-border tabs-lg mb-6 font-bold"><button>Toutes</button> <button>Entrées</button> <button>Plats</button> <button>Desserts</button></div> <div class="mb-4"><!></div> <div class="mb-6"><!></div> <!></div> <!></div></div> ```',1);function tr(x,e){_e(e,!0);let l=ce(""),o=ce(Te({categories:[],regimes:[],temperature:"",cuisson:"",saison:"",testedStatus:"all",ingredients:[],typeR:"",scope:"all"})),L=20,I=ce(1),E=ce(void 0),X=ce("title"),Q=ce("asc");const K=J(()=>ke.isInitialized?ke.getAllRecipes():[]),ee=J(()=>{const g=new Set;return a(K).forEach(R=>R.categories?.forEach(t=>g.add(t))),Array.from(g).sort()}),te=["vegan","vegetarien","sans-gluten","sans-lactose"],V=J(()=>we.isInitialized?we.ingredientNames:[]),k=J(()=>{if(a(l).length>=2){const g=a(l).toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu,"");return a(K).filter(R=>{const t=R.title.toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu,"").includes(g),r=R.auteur?.toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu,"").includes(g)||!1,b=R.region?.toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu,"").includes(g)||!1,w=!a(o).typeR||R.typeR===a(o).typeR;return(t||r||b)&&w})}return a(K).filter(g=>{const R=!a(o).categories.length||a(o).categories.some(Y=>g.categories?.includes(Y)),t=!a(o).regimes.length||a(o).regimes.some(Y=>g.regime?.includes(Y)),r=!a(o).temperature||g.serveHot===(a(o).temperature==="Chaud"),b=!a(o).cuisson||(a(o).cuisson==="Oui"?g.cuisson===!0:g.cuisson===!1),w=!a(o).saison||g.saison?.includes(a(o).saison),C=a(o).testedStatus==="all"||a(o).testedStatus==="tested"&&g.check||a(o).testedStatus==="untested"&&!g.check,h=!a(o).ingredients.length||a(o).ingredients.every(Y=>g.ingredients?.includes(Y)),F=!a(o).typeR||g.typeR===a(o).typeR;let j=!0;return a(o).scope==="mine"?j=g.createdBy===ie.userId:a(o).scope==="drafts"&&(j=g.createdBy===ie.userId&&g.draft===!0),R&&t&&r&&b&&w&&C&&h&&F&&j})}),O=J(()=>[...a(k)].sort((R,t)=>{if(a(X)==="title")return a(Q)==="asc"?R.title.localeCompare(t.title,"fr"):t.title.localeCompare(R.title,"fr");if(a(X)==="$createdAt"){const r=new Date(t.$createdAt||0).getTime()-new Date(R.$createdAt||0).getTime();return a(Q)==="asc"?-r:r}else{const r=new Date(t.$updatedAt||0).getTime()-new Date(R.$updatedAt||0).getTime();return a(Q)==="asc"?-r:r}})),H=J(()=>a(O).slice(0,a(I)*L)),q=J(()=>a(l).length>=2);function W(){se(l,"")}function D(){se(o,{categories:[],regimes:[],temperature:"",cuisson:"",saison:"",testedStatus:"all",ingredients:[],typeR:"",scope:a(o).scope},!0)}ye(()=>{if(!a(E))return;const g=new IntersectionObserver(R=>{R[0].isIntersecting&&a(H).length<a(k).length&&Pe(I)},{threshold:.1});return g.observe(a(E)),()=>g.disconnect()}),ye(()=>{a(k),a(X),a(Q),se(I,1)}),ye(()=>{const g=Ee.path;g==="/recipe/my/draft"?a(o).scope="drafts":g==="/recipe/my"?a(o).scope="mine":a(o).scope="all"}),ye(()=>{Fe.setConfig({title:a(o).scope==="mine"?"Mes recettes":a(o).scope==="drafts"?"Mes brouillons":"Recettes",actions:Da})}),ze(()=>{Fe.reset()}),Be(async()=>{we.isInitialized||await we.initialize()});var T=ja(),Z=P(T);at(Z,{width:"100",children:(g,R)=>{At(g,{get disabled(){return a(q)},get availableCategories(){return a(ee)},get availableRegimes(){return te},get availableIngredients(){return a(V)},onReset:D,get filters(){return a(o)},set filters(t){se(o,t,!0)}})},$$slots:{default:!0}});var c=i(Z,2),p=n(c),d=n(p),_=n(d),u=n(_);u.__click=[Ta,o];var m=i(u,2);m.__click=[za,o];var z=i(m,2);z.__click=[Ba,o];var S=i(z,2);S.__click=[Pa,o];var N=i(_,2),U=n(N);st(U,{onReset:W,get searchQuery(){return a(l)},set searchQuery(g){se(l,g,!0)}});var G=i(N,2),ge=n(G);Gt(ge,{get searchQuery(){return a(l)},get filters(){return a(o)},get resultCount(){return a(k).length},onResetFilters:D});var fe=i(G,2);Ia(fe,{get sortBy(){return a(X)},get sortOrder(){return a(Q)},onSortChange:(g,R)=>{se(X,g,!0),se(Q,R,!0)},get scope(){return a(o).scope}});var me=i(d,2);{var ve=g=>{var R=Oa(),t=n(R),r=n(t);y(()=>M(r,`Erreur : ${ke.error??""}`)),s(g,R)},pe=g=>{var R=Na(),t=P(R);ae(t,21,()=>a(H),h=>h.$id,(h,F)=>{xa(h,{get recipe(){return a(F)},get highlightedIngredients(){return a(o).ingredients}})});var r=i(t,2);{var b=h=>{var F=La();Oe(F,j=>se(E,j),()=>a(E)),s(h,F)};f(r,h=>{a(H).length<a(k).length&&h(b)})}var w=i(r,2);{var C=h=>{var F=Ea();s(h,F)};f(w,h=>{a(k).length===0&&h(C)})}s(g,R)};f(me,g=>{ke.error?g(ve):g(pe,!1)})}y(()=>{A(u,1,`tab ${a(o).typeR===""?"tab-active":""}`),A(m,1,`tab ${a(o).typeR==="entree"?"tab-active":""}`),A(z,1,`tab ${a(o).typeR==="plat"?"tab-active":""}`),A(S,1,`tab ${a(o).typeR==="dessert"?"tab-active":""}`)}),s(x,T),ue()}be(["click"]);export{tr as default};
