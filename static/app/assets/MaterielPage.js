import{B as ze,d as pe,v as c,m as e,u as p,h as r,ab as Ge,o as t,g as i,K as k,G as ce,w as W,ao as Qe,ap as He,aq as Je,C as xe,x as A,a9 as Ke,b as d,c as ye,I as Fe,ar as Xe,e as he,k as ue,i as Ye,as as Ze,p as se,y as Q,z as be,A as T,T as De,W as qe,ag as $e,j as Ie,a0 as _e,J as Le,D as ea,E as Ne,Y as aa,P as Oe,F as ta}from"./appwrite.js";import{M as ra,b as sa,c as la,n as je,s as ia,a as na}from"./index.js";import{a as We}from"./date-helpers.js";import{a5 as oa,a6 as da,r as va,a7 as ca,k as ua,a8 as ma,a9 as ba,W as Pe,U as Ve,aa as fa,G as Re,ab as Ae,ac as ga,X as _a,w as xa,F as ha,x as pa,c as ya}from"./icons.js";import{C as Ee}from"./CheckboxBadge.js";import"./BadgeList.js";import{F as Te}from"./Fieldset.js";import{L as wa}from"./LeftPanel.js";var Ma=c('<div class="flex items-center gap-1"><!> <span class="max-w-60 truncate"> </span></div>'),ka=c('<div class="flex items-center gap-1"><!> <span> </span></div>'),Ca=c('<div class="badge badge-sm badge-info"> </div>'),Sa=c('<div class="text-base-content/60 line-clamp-1 text-xs"> </div>'),Ia=c("<div> </div>"),za=c('<span class="opacity-50">•</span>'),Da=c('<!> <span class="font-medium"> </span> <span class="opacity-70"> </span>',1),qa=c('<div><div class="text-xs"><span class="text-info font-semibold"> </span> <span class="text-base-content/80 ml-2"></span></div></div>'),Ea=c('<button class="btn btn-ghost btn-xs text-primary" aria-label="Éditer"><!></button>'),Ta=c('<div class="card card-side bg-base-100 border-base-200 hover:border-primary/50 group cursor-pointer border text-left shadow-sm transition-all hover:shadow-md" role="button" tabindex="0"><div class="hidden pl-4 sm:flex sm:items-center"><div><!></div></div> <div class="card-body py-3"><div class="flex flex-col gap-1 sm:flex-row sm:items-center sm:justify-between"><div class="flex min-w-0 flex-col gap-1"><div class="flex flex-wrap items-center gap-x-4 gap-y-0"><div class="flex items-center gap-2"><h3 class="text-primary group-hover:text-primary/80 text-base font-semibold transition-colors"> </h3> <span> </span></div> <div class="text-base-content/80 flex flex-wrap items-center gap-x-2 gap-y-1 text-sm"><!> <!></div></div> <div class="flex flex-wrap items-baseline gap-x-4 gap-y-2"><div class="text-sm font-medium"><span> </span> <span class="text-base-content/60 ml-1 text-xs">disp.</span></div> <!> <!> <!></div></div> <div class="flex flex-col items-start gap-1 sm:items-center"><!></div> <div class="flex items-center justify-end"><!></div></div></div></div>');function Fa(K,a){pe(a,!0);const _=p(()=>{switch(a.materiel.type){case"electronic":return ba;case"manual":return ma;case"cooking":return ua;case"dish":return ca;case"gaz":return va;case"hygiene":return da;default:return oa}}),h=p(()=>{if(!a.materiel||!a.materiel.status)return{label:"Chargement...",badgeClass:"badge-neutral",priority:99};const s=Ze(a.materiel.status);return{ok:{label:s,badgeClass:"badge-success",priority:0},lost:{label:s,badgeClass:"badge-error",priority:4},torepair:{label:s,badgeClass:"badge-warning",priority:1}}[a.materiel.status]||{label:s,badgeClass:"badge-neutral",priority:99}}),o=p(()=>Fe.userId?!!(a.materiel.ownerData?.userId===Fe.userId||a.materiel.ownerData?.teamId):!1),q=p(()=>a.materiel.description?a.materiel.description.length>80?a.materiel.description.substring(0,80)+"...":a.materiel.description:null);var v=Ta();v.__click=()=>e(o)&&a.onEdit?.(a.materiel.$id),v.__keydown=s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),e(o)&&a.onEdit?.(a.materiel.$id))};var C=r(v),S=r(C),y=r(S);{let s=p(()=>Xe(a.materiel.type));Ge(y,()=>e(_),(n,u)=>{u(n,{get class(){return`${e(s)??""} h-6 w-6`}})})}t(S),t(C);var I=i(C,2),D=r(I),E=r(D),X=r(E),H=r(X),F=r(H),L=r(F,!0);t(F);var g=i(F,2),R=r(g,!0);t(g),t(H);var w=i(H,2),x=r(w);{var M=s=>{var n=Ma(),u=r(n);Pe(u,{class:"h-3 w-3"});var z=i(u,2),G=r(z,!0);t(z),t(n),W(()=>A(G,a.materiel.location)),d(s,n)};k(x,s=>{a.materiel.location&&s(M)})}var N=i(x,2);{var J=s=>{var n=ka(),u=r(n);Ve(u,{class:"h-3 w-3"});var z=i(u,2),G=r(z,!0);t(z),t(n),W(()=>A(G,a.materiel.ownerData.teamName)),d(s,n)};k(N,s=>{a.materiel.ownerData?.teamName&&s(J)})}t(w),t(X);var $=i(X,2),Y=r($),ee=r(Y),me=r(ee);t(ee),ce(2),t(Y);var ae=i(Y,2);{var fe=s=>{var n=Ca(),u=r(n);t(n),W(()=>A(u,`${a.materiel.totalLoanedQuantity??""}/${a.materiel.quantity??""} en prêt(s)`)),d(s,n)};k(ae,s=>{a.materiel.totalLoanedQuantity>0&&s(fe)})}var le=i(ae,2);{var B=s=>{var n=Sa(),u=r(n,!0);t(n),W(()=>A(u,e(q))),d(s,n)};k(le,s=>{e(q)&&s(B)})}var U=i(le,2);{var te=s=>{var n=Ia(),u=r(n,!0);t(n),W(()=>{xe(n,1,`badge ${e(h).badgeClass??""} badge-sm gap-1 py-0`),A(u,e(h).label)}),d(s,n)};k(U,s=>{a.materiel.status!=="ok"&&a.materiel.status!=="loan"&&s(te)})}t($),t(E);var ie=i(E,2),ke=r(ie);{var l=s=>{var n=qa(),u=r(n),z=r(u),G=r(z);t(z);var ne=i(z,2);he(ne,21,()=>a.materiel.loanDetails,Ye,(re,oe,Ce)=>{var ge=Da(),we=ue(ge);{var ve=j=>{var Z=za();d(j,Z)};k(we,j=>{Ce>0&&j(ve)})}var m=i(we,2),V=r(m);t(m);var O=i(m,2),de=r(O);t(O),W((j,Z)=>{A(V,`${e(oe).responsibleName??""} (${e(oe).quantity??""})`),A(de,`du ${j??""}
                    au ${Z??""}`)},[()=>We(e(oe).startDate),()=>We(e(oe).endDate)]),d(re,ge)}),t(ne),t(u),t(n),W(()=>A(G,`${a.materiel.loanDetails.length??""} réservation
                ${a.materiel.loanDetails.length>1?"s":""} :`)),d(s,n)};k(ke,s=>{a.materiel.loanDetails.length>0&&s(l)})}t(ie);var b=i(ie,2),f=r(b);{var P=s=>{var n=Ea();n.__click=z=>{z.stopPropagation(),a.onEdit?.(a.materiel.$id)};var u=r(n);fa(u,{class:"h-4 w-4"}),t(n),d(s,n)};k(f,s=>{e(o)&&s(P)})}t(b),t(D),t(I),t(v),W((s,n,u)=>{xe(S,1,`${s??""} rounded-lg p-3`),A(L,a.materiel.name),xe(g,1,`badge ${n??""} badge-soft badge-sm gap-1 py-0`),A(R,u),xe(ee,1,Ke(a.materiel.availableQuantity>0?"text-success":"text-error")),A(me,`${a.materiel.availableQuantity??""}/${a.materiel.quantity??""}`)},[()=>Qe(a.materiel.type),()=>He(a.materiel.type),()=>Je(a.materiel.type).label]),d(K,v),ye()}ze(["click","keydown"]);var Pa=c('<button type="button"><span> </span> <!></button>');function Va(K,a){pe(a,!0);let _=se(a,"selectedValue",15),h=se(a,"color",3,"primary"),o=se(a,"size",3,"sm"),q=se(a,"disabled",3,!1);function v(L){return{xs:"btn-xs",sm:"btn-sm",md:"btn-md",lg:"btn-lg"}[L]||"btn-sm"}const C=p(()=>a.value===_()),S=p(()=>v(o()));function y(){q()||_(a.value)}var I=Pa();let D;I.__click=y;var E=r(I),X=r(E,!0);t(E);var H=i(E,2);{var F=L=>{Re(L,{class:"h-3 w-3"})};k(H,L=>{e(C)&&L(F)})}t(I),W(()=>{D=xe(I,1,`btn ${e(S)??""} flex items-center gap-2 transition-all ${`btn-${h()}`} duration-200 ${e(C)?"":"btn-dash"}`,null,D,{"opacity-50":q(),"cursor-not-allowed":q()}),I.disabled=q(),A(X,a.label)}),d(K,I),ye()}ze(["click"]);var Aa=c('<div class="flex flex-wrap gap-2"></div>');function Be(K,a){pe(a,!0);let _=se(a,"selected",15),h=se(a,"size",3,"sm"),o=se(a,"disabled",3,!1),q=se(a,"color",3,"primary");var v=Aa();he(v,21,()=>a.items,C=>C.id,(C,S)=>{Va(C,{get value(){return e(S).id},get label(){return e(S).label},get color(){return q()},get size(){return h()},get disabled(){return o()},get selectedValue(){return _()},set selectedValue(y){_(y)}})}),t(v),d(K,v),ye()}var La=c('<div class="flex min-w-[200px] flex-1 flex-col gap-1"><span class="label-text-alt text-base-content/70">Status</span> <!></div>'),Na=c('<div class="alert alert-error alert-sm"><span class="text-sm"> </span></div>'),Oa=c('<div class="ms-auto mt-8 flex justify-end gap-2"><button class="btn btn-ghost"><!> Annuler</button> <button class="btn btn-primary"><!> Enregistrer</button></div>'),ja=c(`<div class="space-y-6"><div class="text-lg font-medium">Ajouter du matériel a l'inventaire de <span class="font-bold italic"> </span></div> <div class="space-y-3"><div class="flex flex-wrap gap-x-6 gap-y-4"><label class="input min-w-1/2"><span class="label required"><!> Nom</span> <input type="text" class="grow" placeholder="Ex: Mixeur professionnel" maxlength="100" required aria-required="true"/></label></div> <fieldset class="fieldset bg-base-100"><legend class="fieldset-legend">Description</legend> <textarea class="textarea textarea-bordered w-full" rows="2" placeholder="Décrivez le matériel..." maxlength="500"></textarea></fieldset></div> <div class="flex flex-wrap items-center gap-x-4 gap-y-3"><div class="flex min-w-[200px] flex-1 flex-col gap-1"><span class="label-text-alt text-base-content/70">Type</span> <!></div> <!></div> <div class="flex flex-1 flex-wrap gap-x-6 gap-y-4"><label class="input w-58"><span class="label required"><!>Quantité</span> <input type="number" min="1" required aria-required="true"/></label> <label class="input flex-1"><span class="label"><!>Localisation</span> <input type="text" class="grow" placeholder="où c'est stocker" maxlength="50"/></label></div>  <!></div> <div><!></div>`,1);function Ue(K,a){pe(a,!0);let _=se(a,"showStatus",3,!1),h=se(a,"buttonAction",3,!0),o=Q(be(a.initialValues?.name||"")),q=Q(be(a.initialValues?.description||"")),v=Q(be(a.initialValues?.type||"")),C=Q(be(a.initialValues?.status||"ok")),S=Q(be(a.initialValues?.quantity||1)),y=Q(be(a.initialValues?.location||"")),I=Q(be(a.initialValues?.shareableWith||[])),D=!1,E=Q(null);const X=p(()=>a.ownerId),H=p(()=>[{id:"electronic",label:"Électronique"},{id:"manual",label:"Ustensile"},{id:"tools",label:"Outils"},{id:"dish",label:"Vaisselle"},{id:"cooking",label:"Matériel de Cuisine"},{id:"gaz",label:"Gaz"},{id:"hygiene",label:"Hygiène"},{id:"other",label:"Autre"}]),F=p(()=>[{id:"ok",label:"OK"},{id:"lost",label:"Perdu"},{id:"torepair",label:"À réparer"}]),L=p(()=>e(X)&&a.ownerId?JSON.stringify({teamName:a.ownerName||"",teamId:a.ownerId}):JSON.stringify({teamName:"",teamId:""})),g=p(()=>e(o).trim().length>0&&e(S)>=1&&!D);function R(){if(!e(g))return;const m={name:e(o).trim(),description:e(q).trim()||null,type:e(v)||"other",status:e(C),quantity:e(S),location:e(y).trim()||null,shareableWith:e(I).length>0?e(I):null,owner:e(L)};a.onSubmit?.(m)}function w(){a.onCancel?.()}var x=ja(),M=ue(x),N=r(M),J=i(r(N)),$=r(J,!0);t(J),t(N);var Y=i(N,2),ee=r(Y),me=r(ee),ae=r(me),fe=r(ae);Ae(fe,{class:"h-4 w-4 "}),ce(),t(ae);var le=i(ae,2);qe(le),le.disabled=D,t(me),t(ee);var B=i(ee,2),U=i(r(B),2);$e(U),U.disabled=D,t(B),t(Y);var te=i(Y,2),ie=r(te),ke=i(r(ie),2);Be(ke,{get items(){return e(H)},size:"sm",disabled:D,get selected(){return e(v)},set selected(m){T(v,m,!0)}}),t(ie);var l=i(ie,2);{var b=m=>{var V=La(),O=i(r(V),2);Be(O,{get items(){return e(F)},size:"sm",disabled:D,get selected(){return e(C)},set selected(de){T(C,de,!0)}}),t(V),d(m,V)};k(l,m=>{_()&&m(b)})}t(te);var f=i(te,2),P=r(f),s=r(P),n=r(s);ga(n,{class:"size-4"}),ce(),t(s);var u=i(s,2);qe(u),u.disabled=D,t(P);var z=i(P,2),G=r(z),ne=r(G);Pe(ne,{class:"size-4"}),ce(),t(G);var re=i(G,2);qe(re),re.disabled=D,t(z),t(f);var oe=i(f,2);{var Ce=m=>{var V=Na(),O=r(V),de=r(O,!0);t(O),t(V),W(()=>A(de,e(E))),d(m,V)};k(oe,m=>{e(E)&&m(Ce)})}t(M);var ge=i(M,2),we=r(ge);{var ve=m=>{var V=Oa(),O=r(V);O.__click=w,O.disabled=D;var de=r(O);_a(de,{class:"h-5 w-5"}),ce(),t(O);var j=i(O,2);j.__click=R;var Z=r(j);{var Me=Se=>{Re(Se,{class:"h-5 w-5"})};k(Z,Se=>{Se(Me,!1)})}ce(),t(j),t(V),W(()=>j.disabled=!e(g)),d(m,V)};k(we,m=>{h()&&m(ve)})}t(ge),W(()=>A($,a.ownerName)),De(le,()=>e(o),m=>T(o,m)),De(U,()=>e(q),m=>T(q,m)),De(u,()=>e(S),m=>T(S,m)),De(re,()=>e(y),m=>T(y,m)),d(K,x),ye()}ze(["click"]);var Wa=c('<div><span class="font-semibold">Équipe propriétaire :</span> </div>'),Ba=c('<div class="alert alert-error"><span class="text-sm"> </span></div>'),Ra=c('<div class="alert alert-soft mb-4"><div class="flex items-center gap-2 text-sm"><!> <div><!></div></div></div> <!> <!>',1),Ua=c('<div class="alert alert-warning"><span>Matériel introuvable</span></div>'),Ga=c("<!> <!>",1);function Qa(K,a){pe(a,!0);let _=Q(!1),h=Q(null);const o=p(()=>a.materielId?_e.getMaterielById(a.materielId):null),q=p(()=>!e(o)||e(o).status==="loan"||e(o).status==="reserved"?"ok":e(o).status);function v(){T(h,null)}async function C(y){if(!a.materielId){T(h,"ID du matériel manquant");return}T(_,!0),T(h,null);try{await _e.updateMateriel(a.materielId,{name:y.name,description:y.description||void 0,type:y.type||"other",status:y.status,quantity:y.quantity,location:y.location||void 0}),console.log("[EditMaterielModal] Matériel mis à jour:",a.materielId),a.onSuccess?.(),v(),a.onClose()}catch(I){T(h,I.message||"Erreur lors de la mise à jour du matériel",!0),console.error("[EditMaterielModal] Erreur:",I)}finally{T(_,!1)}}function S(){v(),a.onClose()}ra(K,{get isOpen(){return a.isOpen},onClose:S,children:(y,I)=>{var D=Ga(),E=ue(D);sa(E,{title:"Modifier le matériel",onClose:S});var X=i(E,2);la(X,{children:(H,F)=>{var L=Ie(),g=ue(L);{var R=x=>{var M=Ra(),N=ue(M),J=r(N),$=r(J);Ve($,{class:"h-4 w-4"});var Y=i($,2),ee=r(Y);{var me=B=>{var U=Wa(),te=i(r(U));t(U),W(()=>A(te,` ${e(o).ownerData.teamName??""}`)),d(B,U)};k(ee,B=>{e(o).ownerData?.teamId&&B(me)})}t(Y),t(J),t(N);var ae=i(N,2);{let B=p(()=>({name:e(o).name,description:e(o).description,type:e(o).type,status:e(q),quantity:e(o).quantity,location:e(o).location,shareableWith:e(o).shareableWith}));Ue(ae,{showStatus:!0,get initialValues(){return e(B)},onSubmit:C,onCancel:S})}var fe=i(ae,2);{var le=B=>{var U=Ba(),te=r(U),ie=r(te,!0);t(te),t(U),W(()=>A(ie,e(h))),d(B,U)};k(fe,B=>{e(h)&&B(le)})}d(x,M)},w=x=>{var M=Ua();d(x,M)};k(g,x=>{e(o)?x(R):x(w,!1)})}d(H,L)}}),d(y,D)},$$slots:{default:!0}}),ye()}var Ha=c('<div class="flex flex-wrap gap-3"></div>'),Ja=c('<div class="flex flex-wrap gap-3"></div>'),Ka=c('<div class="flex flex-wrap gap-3"></div>'),Xa=c('<div><div class="mb-4 flex items-center justify-between"><h4 class="text-lg font-bold"><!> Filtres</h4> <button class="btn btn-warning btn-sm"><!> Effacer</button></div> <!> <!> <!></div>');function Ya(K,a){pe(a,!0);let _=se(a,"filters",15),h=se(a,"disabled",3,!1);function o(g,R){const w=g.indexOf(R);w===-1?g.push(R):g.splice(w,1),_({..._()})}function q(g){return{electronic:"Électronique",manual:"Manuel",other:"Autre",tools:"Outils",dish:"Vaisselle",cooking:"Cuisine",gaz:"Gaz",hygiene:"Hygiène"}[g]||g}function v(g){return{ok:"OK",lost:"Perdu",loan:"Utilisé",reserved:"Réservé",torepair:"À réparer"}[g]||g}var C=Xa();let S;var y=r(C),I=r(y),D=r(I);xa(D,{class:"inline size-4 align-baseline"}),ce(),t(I);var E=i(I,2);E.__click=function(...g){a.onReset?.apply(this,g)};var X=r(E);ha(X,{class:"h-4 w-4"}),ce(),t(E),t(y);var H=i(y,2);Te(H,{legend:"Type",get iconComponent(){return Ae},children:(g,R)=>{var w=Ha();he(w,20,()=>a.availableTypes,x=>x,(x,M)=>{{let N=p(()=>_().types.includes(M)),J=p(()=>q(M));Ee(x,{get checked(){return e(N)},get label(){return e(J)},onchange:()=>o(_().types,M),get disabled(){return h()},color:"secondary",size:"md"})}}),t(w),d(g,w)},$$slots:{default:!0}});var F=i(H,2);Te(F,{legend:"Lieu",get iconComponent(){return Pe},children:(g,R)=>{var w=Ja();he(w,20,()=>a.availableLocations,x=>x,(x,M)=>{{let N=p(()=>_().locations.includes(M));Ee(x,{get checked(){return e(N)},get label(){return M},onchange:()=>o(_().locations,M),get disabled(){return h()},color:"secondary",size:"md"})}}),t(w),d(g,w)},$$slots:{default:!0}});var L=i(F,2);Te(L,{legend:"Statut",get iconComponent(){return pa},children:(g,R)=>{var w=Ka();he(w,20,()=>a.availableStatuses,x=>x,(x,M)=>{{let N=p(()=>_().statuses.includes(M)),J=p(()=>v(M));Ee(x,{get checked(){return e(N)},get label(){return e(J)},onchange:()=>o(_().statuses,M),get disabled(){return h()},color:"secondary",size:"md"})}}),t(w),d(g,w)},$$slots:{default:!0}}),t(C),W(()=>{S=xe(C,1,"mt-16 space-y-4",null,S,{"opacity-30":h()}),E.disabled=h()}),d(K,C),ye()}ze(["click"]);var Za=c('<button><!> <span class="badge badge-sm badge-neutral ml-2"> </span></button>'),$a=c('<div class="tabs tabs-border bg-base-200 tabs-lg mb-6 font-semibold"></div>'),et=c('<div class="mb-6 text-end"><button class="btn btn-wide btn-primary"><!> Ajouter du matériel</button></div>'),at=c('<div class="card bg-base-100 mb-6 shadow-lg"><div class="card-body"><!></div></div>'),tt=c('<div class="alert alert-warning"><span>Vous devez être connecté pour voir le matériel.</span></div>'),rt=c('<div class="alert alert-error shadow-lg"><span> </span></div>'),st=c('<div class="alert alert-info"><span>Sélectionnez une équipe pour voir son matériel.</span></div>'),lt=c('<div class="py-12 text-center"><p class="text-base-content/60 mb-4 text-lg">Aucun matériel ne correspond aux critères de filtrage...</p> <button class="btn btn-warning btn-sm">Effacer les filtres</button></div>'),it=c(`<div class="bg-base-200 rounded-box border-base-200 border-2 border-dashed py-20 text-center"><div class="bg-base-200 mb-4 inline-block rounded-full p-4"><!></div> <h3 class="mb-2 text-lg font-bold">Aucun matériel</h3> <p class="text-base-content/60 mb-6">Cette équipe n'a pas encore de matériel.</p></div>`),nt=c('<div class="grid grid-cols-1"></div>'),ot=c('<!> <div class="p-4 lg:ml-100"><div class="mx-auto max-w-7xl px-4 py-8"><!> <!> <!> <!></div></div> <!>',1);function _t(K,a){pe(a,!0);let _=Q(!1),h=Q(null),o=Q(null),q=Q(!1),v=Q(be({types:[],locations:[],statuses:[]}));function C(){T(_,!e(_))}function S(){T(_,!1)}function y(l){T(h,l,!0)}function I(){T(h,null)}async function D(l){try{await _e.createMateriel(l),S(),console.log("[MaterielPage] Matériel créé avec succès")}catch(b){console.error("[MaterielPage] Erreur création:",b)}}function E(){console.log("[MaterielPage] Matériel mis à jour"),I()}const X=["electronic","manual","other","tools","dish","cooking","gaz","hygiene"],H=["ok","lost","loan","reserved","torepair"],F=p(()=>ta.myTeams),L=p(()=>e(o)?e(F).find(l=>l.$id===e(o)):null),g=p(()=>e(o)?_e.materiels.filter(l=>l.ownerData.teamId===e(o)||l.shareableWith?.includes(e(o))):[]),R=p(()=>{const l=e(g),b=new Set;return l.forEach(f=>{f.location&&b.add(f.location)}),Array.from(b).sort()}),w=p(()=>{const l=e(g);return e(v).types.length>0||e(v).locations.length>0||e(v).statuses.length>0?l.filter(f=>{const P=e(v).types.length===0||f.type&&e(v).types.includes(f.type),s=e(v).locations.length===0||f.location&&e(v).locations.includes(f.location),n=e(v).statuses.length===0||e(v).statuses.includes(f.status);return P&&s&&n}):l});function x(){T(v,{types:[],locations:[],statuses:[]},!0)}function M(l){Ne(`/dashboard/materiel/${l}`)}Le(()=>{const l=ea.params.teamId;l&&l!==e(o)?e(F).find(f=>f.$id===l)&&T(o,l,!0):!l&&!e(o)&&!e(q)&&e(F).length>0&&(T(q,!0),Ne(`/dashboard/materiel/${e(F)[0].$id}`))}),Le(()=>{const b=(e(o)?e(F).find(f=>f.$id===e(o)):null)?.name||"Matériel";je.setConfig({title:b})}),aa(()=>{je.reset()});var N=ot(),J=ue(N);wa(J,{width:"100",children:(l,b)=>{Ya(l,{disabled:!1,get availableTypes(){return X},get availableLocations(){return e(R)},get availableStatuses(){return H},onReset:x,get filters(){return e(v)},set filters(f){T(v,f,!0)}})},$$slots:{default:!0}});var $=i(J,2),Y=r($),ee=r(Y);{var me=l=>{var b=$a();he(b,21,()=>e(F),f=>f.$id,(f,P)=>{var s=Za();s.__click=()=>M(e(P).$id);var n=r(s);Ve(n,{class:"mr-2 h-4 w-4"});var u=i(n),z=i(u),G=r(z,!0);t(z),t(s),W(ne=>{xe(s,1,`tab ${e(o)===e(P).$id?"tab-active":""}`),A(u,` ${e(P).name??""} `),A(G,ne)},[()=>_e.materiels.filter(ne=>ne.ownerData.teamId===e(P).$id||ne.shareableWith?.includes(e(P).$id)).length]),d(f,s)}),t(b),d(l,b)};k(ee,l=>{e(F).length>1&&l(me)})}var ae=i(ee,2);{var fe=l=>{var b=et(),f=r(b);f.__click=C;var P=r(f);ya(P,{class:"h-4 w-4"}),ce(),t(f),t(b),d(l,b)};k(ae,l=>{e(_)||l(fe)})}var le=i(ae,2);{var B=l=>{var b=at(),f=r(b),P=r(f);Ue(P,{showStatus:!1,onSubmit:D,onCancel:S,get ownerId(){return e(L).$id},get ownerName(){return e(L).name}}),t(f),t(b),Oe(3,b,()=>ia),d(l,b)};k(le,l=>{e(_)&&e(L)&&l(B)})}var U=i(le,2);{var te=l=>{var b=tt();d(l,b)},ie=l=>{var b=Ie(),f=ue(b);{var P=n=>{var u=rt(),z=r(u),G=r(z,!0);t(z),t(u),W(()=>A(G,_e.error)),d(n,u)},s=n=>{var u=Ie(),z=ue(u);{var G=re=>{var oe=st();d(re,oe)},ne=re=>{var oe=Ie(),Ce=ue(oe);{var ge=ve=>{var m=Ie(),V=ue(m);{var O=j=>{var Z=lt(),Me=i(r(Z),2);Me.__click=x,t(Z),d(j,Z)},de=j=>{var Z=it(),Me=r(Z),Se=r(Me);Ae(Se,{class:"h-8 w-8 opacity-50"}),t(Me),ce(4),t(Z),d(j,Z)};k(V,j=>{e(v).types.length>0||e(v).locations.length>0||e(v).statuses.length>0?j(O):j(de,!1)})}d(ve,m)},we=ve=>{var m=nt();he(m,21,()=>e(w),V=>V.$id,(V,O)=>{Fa(V,{get materiel(){return e(O)},onEdit:de=>y(de)})}),t(m),d(ve,m)};k(Ce,ve=>{e(w).length===0?ve(ge):ve(we,!1)})}d(re,oe)};k(z,re=>{e(o)?re(ne,!1):re(G)},!0)}d(n,u)};k(f,n=>{_e.error?n(P):n(s,!1)},!0)}d(l,b)};k(U,l=>{Fe.isAuthenticated?l(ie,!1):l(te)})}t(Y),t($);var ke=i($,2);{let l=p(()=>e(h)!==null);Qa(ke,{get materielId(){return e(h)},get isOpen(){return e(l)},onClose:I,onSuccess:E})}Oe(3,$,()=>na),d(K,N),ye()}ze(["click"]);export{_t as default};
