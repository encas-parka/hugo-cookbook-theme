var vt=u=>{throw TypeError(u)};var Et=(u,r,l)=>r.has(u)||vt("Cannot "+l);var xe=(u,r,l)=>(Et(u,r,"read from private field"),l?l.call(u):r.get(u)),ut=(u,r,l)=>r.has(u)?vt("Cannot add the same private member more than once"):r instanceof WeakSet?r.add(u):r.set(u,l);import{v as h,h as a,g as i,w as D,x as se,b as o,o as t,y as H,z as xt,m as e,A as f,B as ke,d as be,p as ie,e as He,C as we,u as ve,i as nt,c as _e,D as Xe,E as Re,F as De,G as Y,H as mt,I as L,J as Ne,k as G,K as C,L as Pt,M as ft,j as ce,s as Ke,N as Oe,O as Be,P as wt,t as Mt,Q as At,R as Qe,S as Ze,T as Fe,U as et,V as tt,W as Le,X as It,Y as Tt,Z as je,_ as at,$ as We,a0 as Ge,a1 as $e,a2 as rt,a3 as Ot,a4 as Rt,a5 as Ft}from"./appwrite.js";import{C as kt,P as Lt,E as St,a as qt,L as pt,b as Ye,U as zt,c as Dt,B as Bt,R as Nt,d as Vt,e as Ut,f as jt,g as Wt,X as Ct,A as Gt,h as $t,i as Ht,M as st,j as Kt}from"./icons.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))b(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const n of c.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&b(n)}).observe(document,{childList:!0,subtree:!0});function l(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerPolicy&&(c.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?c.credentials="include":s.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function b(s){if(s.ep)return;s.ep=!0;const c=l(s);fetch(s.href,c)}})();var Yt=h('<div class="alert alert-error max-md:alert-vertical shadow-lg"><!> <div><h3 class="font-bold">Erreur</h3> <div class="text-sm"> </div></div></div>');function bt(u,r){var l=Yt(),b=a(l);kt(b,{class:"h-6 w-6 shrink-0 stroke-current"});var s=i(b,2),c=i(a(s),2),n=a(c,!0);t(c),t(s),t(l),D(()=>se(n,r.message)),o(u,l)}var pe;class Xt{constructor(){ut(this,pe,H(xt({title:""})))}get title(){return e(xe(this,pe)).title||"ENKA Cookbook"}get backAction(){return e(xe(this,pe)).backAction}get actions(){return e(xe(this,pe)).actions}get isLockedByOthers(){return e(xe(this,pe)).isLockedByOthers||!1}get lockedByUserName(){return e(xe(this,pe)).lockedByUserName||""}get hasUnsavedChanges(){return e(xe(this,pe)).hasUnsavedChanges||!1}setConfig(r){f(xe(this,pe),{...r},!0)}reset(){f(xe(this,pe),{title:""},!0)}}pe=new WeakMap;const Te=new Xt;var Jt=h("<button> </button>"),Qt=h('<div class="rounded-box bg-secondary/10 px-4 py-1"><div class="tabs tabs-border justify-center"></div></div>');function _t(u,r){be(r,!0);let l=ie(r,"basePath",3,"/event");const b=[{label:"Éditer l'événement",relativePath:""},{label:"Voir les recettes",relativePath:"recipes"},{label:"Listes des produits",relativePath:"products"},{label:"Affiches",relativePath:"posters"}],s=ve(()=>{const v=Xe.pathname;return v.includes("/recipes")?1:v.includes("/products")?2:v.includes("/posters")?3:0});function c(v){if(!r.eventId)return;const y=b[v].relativePath,k=y?`${l()}/${r.eventId}/${y}`:`${l()}/${r.eventId}`;Re(k)}var n=Qt(),p=a(n);He(p,21,()=>b,nt,(v,y,k)=>{var E=Jt();E.__click=()=>c(k);var _=a(E,!0);t(E),D(()=>{we(E,1,`tab font-semibold ${k===e(s)?"tab-active":""}`),se(_,e(y).label)}),o(v,E)}),t(p),t(n),o(u,n),_e()}ke(["click"]);var Zt=h("<button> </button>"),ea=h('<div class="tabs tabs-lg tabs-border justify-center"></div>');function ht(u,r){be(r,!0);const l=[{label:"Matériel",getPath:()=>s()},{label:"Reservations",getPath:()=>c()}],b=ve(()=>Xe.pathname.includes("/loans")?1:0);function s(){if(r.currentTeamId)return`/dashboard/materiel/${r.currentTeamId}`;const v=De.myTeams;return v.length>0?`/dashboard/materiel/${v[0].$id}`:"/dashboard/materiel"}function c(){if(r.currentTeamId)return`/dashboard/loans/${r.currentTeamId}`;const v=De.myTeams;return v.length>0?`/dashboard/loans/${v[0].$id}`:"/dashboard/loans"}function n(v){const y=l[v].getPath();Re(y)}var p=ea();He(p,21,()=>l,nt,(v,y,k)=>{var E=Zt();E.__click=()=>n(k);var _=a(E,!0);t(E),D(()=>{we(E,1,`tab font-medium ${k===e(b)?"tab-active":""}`),se(_,e(y).label)}),o(v,E)}),t(p),o(u,p),_e()}ke(["click"]);var ta=h('<div class="rounded-box bg-secondary/10 px-4 py-1"><div class="tabs tabs-border justify-center"><button><!> Édition</button> <button><!> Aperçu</button></div></div>');function gt(u,r){be(r,!0);const l=ve(()=>mt.get("mode")||"preview");function b(_){mt.set("mode",_)}var s=ta(),c=a(s),n=a(c);let p;n.__click=()=>b("edit");var v=a(n);Lt(v,{class:"h-4 w-4"}),Y(),t(n);var y=i(n,2);let k;y.__click=()=>b("preview");var E=a(y);St(E,{class:"h-4 w-4"}),Y(),t(y),t(c),t(s),D(()=>{p=we(n,1,"tab gap-2 font-semibold",null,p,{"tab-active":e(l)==="edit"}),k=we(y,1,"tab gap-2 font-semibold",null,k,{"tab-active":e(l)==="preview"})}),o(u,s),_e()}ke(["click"]);var aa=h('<button class="btn btn-ghost not-md:btn-square md:gap-2"><!> <span class="hidden md:inline">Tableau de bord</span></button>'),ra=h('<h1 class="font-family-fredoka truncate text-sm font-bold tracking-wider uppercase opacity-70"> </h1>'),sa=h('<div class="navbar-center absolute left-1/2 -translate-x-1/2 transform"><!></div>'),na=h('<div class="badge badge-warning flex items-center gap-1 py-3 font-medium"><!> <span class="text-xs"> </span></div>'),oa=h('<div class="dropdown dropdown-end"><div tabindex="0" role="button" class="btn btn-ghost btn-circle avatar bg-primary/10 text-primary border-primary/20 border"><div class="flex w-10 items-center justify-center rounded-full text-lg font-bold"> </div></div> <ul class="menu menu-sm dropdown-content bg-base-100 border-base-200 z-1 mt-3 w-56 rounded-xl border p-2 shadow-xl"><li class="border-base-100 mb-1 border-b px-4 py-2"><span class="block truncate p-0 text-xs font-medium italic opacity-60"> </span></li> <li><button class="flex items-center gap-2"><!> Dashboard</button></li> <li><button class="flex items-center gap-2"><!> Équipes</button></li> <li><button class="flex items-center gap-2"><!> Nouvel événement</button></li> <li><button class="flex items-center gap-2"><!> Recettes</button></li> <li><button class="disabled:opacity-50"><!> </button></li> <!> <li class="border-base-100 my-1 border-t"></li> <li><button class="text-error hover:bg-error/10"><!> Se déconnecter</button></li></ul></div>'),ia=h('<button class="btn btn-primary btn-sm shadow-md"><!> Connexion</button>'),la=h('<h1 class="text-center text-sm font-bold tracking-wider uppercase opacity-70"> </h1>'),da=h('<div class="border-base-300 bg-base-100 border-b px-4 py-3"><!></div>'),ca=h('<div><div class="navbar-start w-fit shrink-0 gap-1"><a class="btn btn-ghost btn-circle"><img src="/images/favicon.png" alt="logo" class="h-8 w-8"/></a> <div class=" flex items-center gap-1"><!> <button class="btn btn-ghost not-md:btn-square md:gap-2"><!> <span class="hidden md:inline">Recettes</span></button></div></div> <!> <div class="navbar-end ms-auto w-fit shrink-0 gap-4"><!> <div class="flex items-center gap-2"><!></div> <!></div></div> <!>',1);function va(u,r){be(r,!0);let l=H(!1),b=H(!1);const s=ve(()=>{const g=Xe.pathname,d=Xe.params;return g.includes("/event/")&&d.id?{type:"eventEdit",basePath:"/event",eventId:d.id}:g.includes("/demo/event/")&&d.id?{type:"eventEdit",basePath:"/demo/event",eventId:d.id}:g.includes("/dashboard/materiel/")&&d.teamId?{type:"materiel",teamId:d.teamId}:g.includes("/dashboard/loans/")&&d.teamId?{type:"loans",teamId:d.teamId}:g.includes("/editdocument/")&&d.teamId&&d.docId?{type:"documentEdit",teamId:d.teamId,docId:d.docId}:null});L.isMobile&&L.initializeScrollDirection();function c(){f(l,!1)}async function n(){try{await L.logout(),window.location.href="/"}catch(g){console.error("Erreur lors de la déconnexion:",g)}}function p(){L.authModal.showLogin=!0,L.authModal.isOpen=!0}async function v(){if(L.userId){f(b,!0);try{await Oe.forceReloadAllRecipes(),c()}catch(g){console.error("Erreur lors du rechargement des recettes:",g),alert("Erreur lors du rechargement des recettes")}finally{f(b,!1)}}}function y(g){g.target.closest(".svelte-user-dropdown")||c()}Ne(()=>{if(e(l))return document.addEventListener("click",y),()=>document.removeEventListener("click",y)});var k=ca(),E=G(k),_=a(E),R=a(_),U=i(R,2),$=a(U);{var j=g=>{var d=aa();d.__click=()=>Re("/dashboard");var P=a(d);pt(P,{size:18}),Y(2),t(d),o(g,d)};C($,g=>{L.isAuthenticated&&g(j)})}var I=i($,2);I.__click=()=>Re("/recipe");var w=a(I);qt(w,{size:18}),Y(2),t(I),t(U),t(_);var m=i(_,2);{var z=g=>{var d=sa(),P=a(d);{var Q=N=>{ht(N,{get currentTeamId(){return e(s).teamId}})},ae=N=>{var X=ce(),le=G(X);{var oe=W=>{_t(W,{get eventId(){return e(s).eventId},get basePath(){return e(s).basePath}})},Z=W=>{var de=ce(),q=G(de);{var M=T=>{gt(T,{})},A=T=>{var V=ra(),K=a(V,!0);t(V),D(()=>{ft(V,"title",Te.title),se(K,Te.title)}),o(T,V)};C(q,T=>{e(s)?.type==="documentEdit"?T(M):T(A,!1)},!0)}o(W,de)};C(le,W=>{e(s)?.type==="eventEdit"?W(oe):W(Z,!1)},!0)}o(N,X)};C(P,N=>{e(s)?.type==="materiel"||e(s)?.type==="loans"?N(Q):N(ae,!1)})}t(d),o(g,d)};C(m,g=>{L.isDesktop&&g(z)})}var x=i(m,2),B=a(x);{var ee=g=>{var d=na(),P=a(d);Ye(P,{size:14});var Q=i(P,2),ae=a(Q);t(Q),t(d),D(()=>se(ae,`Édition par ${Te.lockedByUserName??""}`)),o(g,d)};C(B,g=>{Te.isLockedByOthers&&g(ee)})}var te=i(B,2),ue=a(te);{var J=g=>{var d=ce(),P=G(d);Ke(P,()=>Te.actions),o(g,d)};C(ue,g=>{Te.actions&&g(J)})}t(te);var Ce=i(te,2);{var S=g=>{var d=oa(),P=a(d),Q=a(P),ae=a(Q,!0);t(Q),t(P);var N=i(P,2),X=a(N),le=a(X),oe=a(le,!0);t(le),t(X);var Z=i(X,2),W=a(Z);W.__click=()=>Re("/dashboard");var de=a(W);pt(de,{size:16}),Y(),t(W),t(Z);var q=i(Z,2),M=a(q);M.__click=()=>Re("/dashboard/teams");var A=a(M);zt(A,{size:16}),Y(),t(M),t(q);var T=i(q,2),V=a(T);V.__click=()=>Re("/dashboard/eventCreate");var K=a(V);Dt(K,{size:16}),Y(),t(V),t(T);var F=i(T,2),O=a(F);O.__click=()=>Re("/recipe");var re=a(O);Bt(re,{size:16}),Y(),t(O),t(F);var ne=i(F,2),he=a(ne);he.__click=v;var ge=a(he);{let fe=ve(()=>e(b)?"animate-spin":"");Nt(ge,{size:16,get class(){return e(fe)}})}var Ee=i(ge);t(he),t(ne);var Pe=i(ne,2);C(Pe,fe=>{});var Me=i(Pe,4),me=a(Me);me.__click=n;var Ae=a(me);Vt(Ae,{size:16}),Y(),t(me),t(Me),t(N),t(d),D(fe=>{se(ae,fe),se(oe,L.user?.email),he.disabled=e(b),se(Ee,` ${e(b)?"Chargement...":"Recharger les recettes"}`)},[()=>L.user?.name?.charAt(0).toUpperCase()||"U"]),o(g,d)},Ve=g=>{var d=ia();d.__click=p;var P=a(d);Ut(P,{size:16}),Y(),t(d),o(g,d)};C(Ce,g=>{L.isAuthenticated?g(S):g(Ve,!1)})}t(x),t(E);var Se=i(E,2);{var qe=g=>{var d=da(),P=a(d);{var Q=N=>{ht(N,{get currentTeamId(){return e(s).teamId}})},ae=N=>{var X=ce(),le=G(X);{var oe=W=>{_t(W,{get eventId(){return e(s).eventId},get basePath(){return e(s).basePath}})},Z=W=>{var de=ce(),q=G(de);{var M=T=>{gt(T,{})},A=T=>{var V=ce(),K=G(V);{var F=O=>{var re=la(),ne=a(re,!0);t(re),D(()=>se(ne,Te.title)),o(O,re)};C(K,O=>{Te.title&&O(F)},!0)}o(T,V)};C(q,T=>{e(s)?.type==="documentEdit"?T(M):T(A,!1)},!0)}o(W,de)};C(le,W=>{e(s)?.type==="eventEdit"?W(oe):W(Z,!1)},!0)}o(N,X)};C(P,N=>{e(s)?.type==="materiel"||e(s)?.type==="loans"?N(Q):N(ae,!1)})}t(d),o(g,d)};C(Se,g=>{L.isDesktop||g(qe)})}D(g=>{we(E,1,`navbar bg-base-100 border-base-300 sticky top-0 z-1000 min-h-13 border-b px-4 py-0 shadow-sm print:hidden ${(L.isMobile&&"min-h-11")??""} ${(L.isMobile&&!L.headerVisible&&"-translate-y-full")??""} transition-transform duration-300`),ft(R,"href",g)},[()=>Pt("/")]),o(u,k),_e()}ke(["click"]);const ua=u=>u;function ot(u){const r=u-1;return r*r*r+1}function yt(u){const r=typeof u=="string"&&u.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return r?[parseFloat(r[1]),r[2]||"px"]:[u,"px"]}function ma(u,{delay:r=0,duration:l=400,easing:b=ua}={}){const s=+getComputedStyle(u).opacity;return{delay:r,duration:l,easing:b,css:c=>`opacity: ${c*s}`}}function or(u,{delay:r=0,duration:l=400,easing:b=ot,x:s=0,y:c=0,opacity:n=0}={}){const p=getComputedStyle(u),v=+p.opacity,y=p.transform==="none"?"":p.transform,k=v*(1-n),[E,_]=yt(s),[R,U]=yt(c);return{delay:r,duration:l,easing:b,css:($,j)=>`
			transform: ${y} translate(${(1-$)*E}${_}, ${(1-$)*R}${U});
			opacity: ${v-k*j}`}}function fa(u,{delay:r=0,duration:l=400,easing:b=ot,axis:s="y"}={}){const c=getComputedStyle(u),n=+c.opacity,p=s==="y"?"height":"width",v=parseFloat(c[p]),y=s==="y"?["top","bottom"]:["left","right"],k=y.map(I=>`${I[0].toUpperCase()}${I.slice(1)}`),E=parseFloat(c[`padding${k[0]}`]),_=parseFloat(c[`padding${k[1]}`]),R=parseFloat(c[`margin${k[0]}`]),U=parseFloat(c[`margin${k[1]}`]),$=parseFloat(c[`border${k[0]}Width`]),j=parseFloat(c[`border${k[1]}Width`]);return{delay:r,duration:l,easing:b,css:I=>`overflow: hidden;opacity: ${Math.min(I*20,1)*n};${p}: ${I*v}px;padding-${y[0]}: ${I*E}px;padding-${y[1]}: ${I*_}px;margin-${y[0]}: ${I*R}px;margin-${y[1]}: ${I*U}px;border-${y[0]}-width: ${I*$}px;border-${y[1]}-width: ${I*j}px;min-${p}: 0`}}function ir(u,{delay:r=0,duration:l=400,easing:b=ot,start:s=0,opacity:c=0}={}){const n=getComputedStyle(u),p=+n.opacity,v=n.transform==="none"?"":n.transform,y=1-s,k=p*(1-c);return{delay:r,duration:l,easing:b,css:(E,_)=>`
			transform: ${v} scale(${1-y*_});
			opacity: ${p-k*_}
		`}}var pa=h('<button class="btn btn-sm btn-primary"> </button>'),ba=h('<button class="btn btn-ghost btn-xs btn-square" title="Voir les détails" aria-label="Voir les détails"><!></button>'),_a=h('<button class="btn btn-ghost btn-xs btn-circle pe-0" title="Fermer" aria-label="Fermer la notification"><!></button>'),ha=h('<div><div class="flex items-center justify-between gap-4"><div class="flex flex-1 items-center gap-2"><!> <span class="text-sm"> </span></div> <!> <!> <!></div></div>'),ga=h("<div></div>");function ya(u,r){be(r,!0);let l=ie(r,"position",3,"toast-center toast-bottom"),b=ie(r,"padding",3,"sm");const s=ve(()=>b()==="sm"?" py-0.5":"py-1"),c=ve(()=>Be.toasts),n=ve(()=>()=>{const _=new Map;for(const R of e(c)){const U=R.position||l();_.has(U)||_.set(U,[]),_.get(U).push(R)}return _});function p(_){Be.dismiss(_.id)}function v(_){r.onShowDetails?.({id:_.id,message:_.message,details:_.details})}function y(_,R){R.onClick()}var k=ce(),E=G(k);He(E,17,()=>Array.from(e(n)().entries()),([_,R])=>_,(_,R)=>{var U=ve(()=>Mt(e(R),2));let $=()=>e(U)[0],j=()=>e(U)[1];var I=ga();He(I,21,j,w=>w.id,(w,m)=>{var z=ha(),x=a(z),B=a(x),ee=a(B);{var te=d=>{jt(d,{class:"h-5 w-5 animate-spin"})};C(ee,d=>{e(m).state==="loading"&&d(te)})}var ue=i(ee,2),J=a(ue,!0);t(ue),t(B);var Ce=i(B,2);{var S=d=>{var P=ce(),Q=G(P);He(Q,17,()=>e(m).actions,nt,(ae,N)=>{var X=pa();X.__click=()=>y(e(m),e(N));var le=a(X,!0);t(X),D(()=>se(le,e(N).label)),o(ae,X)}),o(d,P)};C(Ce,d=>{e(m).actions&&e(m).actions.length>0&&d(S)})}var Ve=i(Ce,2);{var Se=d=>{var P=ba();P.__click=()=>v(e(m));var Q=a(P);Wt(Q,{class:"h-3 w-3"}),t(P),o(d,P)};C(Ve,d=>{e(m).details&&d(Se)})}var qe=i(Ve,2);{var g=d=>{var P=_a();P.__click=()=>p(e(m));var Q=a(P);Ct(Q,{class:"h-4 w-4"}),t(P),o(d,P)};C(qe,d=>{(e(m).state==="error"||e(m).state==="warning"||e(m).state==="loading")&&d(g)})}t(x),t(z),D(()=>{we(z,1,`alert alert-${e(m).state??""}  ${e(s)??""} shadow-lg`),se(J,e(m).message)}),wt(3,z,()=>fa),o(w,z)}),t(I),D(()=>we(I,1,`toast ${$()??""} z-1050`)),o(_,I)}),o(u,k),_e()}ke(["click"]);var xa=h('<button class="btn btn-primary btn-circle fixed right-6 bottom-6 z-50 rounded-full shadow-lg" aria-label="Retour en haut de page"><!></button>');function wa(u,r){be(r,!0);let l=ve(()=>(At.current||0)>300);function b(){window.scrollTo({top:0,behavior:"smooth"})}var s=ce(),c=G(s);{var n=p=>{var v=xa();v.__click=b;var y=a(v);Gt(y,{class:"h-6 w-6"}),t(v),wt(3,v,()=>ma),o(p,v)};C(c,p=>{e(l)&&p(n)})}o(u,s),_e()}ke(["click"]);function ka(u,r){be(r,!0),_e()}var Ca=h('<div role="dialog" aria-modal="true"><!></div>'),Ea=h('<div class="modal modal-open" style="z-index: 1100"><div class="modal-box max-w-md"><h3 class="text-lg font-bold">Confirmer la fermeture</h3> <p class="py-4"> </p> <div class="modal-action"><button class="btn btn-ghost">Annuler</button> <button class="btn btn-error">Fermer sans sauvegarder</button></div></div></div>'),Pa=h("<div><!></div> <!>",1);function Ma(u,r){be(r,!0);let l=ie(r,"fullscreenOnMobile",3,!0);ie(r,"closeOnBackdropClick",3,!1);let b=ie(r,"hasUnsavedChanges",3,!1),s=ie(r,"confirmCloseMessage",3,"Vous avez des modifications non sauvegardées. Voulez-vous vraiment fermer ?"),c=ie(r,"maxWidth",3,"lg");ie(r,"maxHeight",3,"xl");let n=ie(r,"modalClass",3,"");function p(w,m){return{sm:{"max-w":"max-w-[28rem]","max-h":"max-h-[85dvh]"},lg:{"max-w":"max-w-[64rem]","max-h":"max-h-[85dvh]"},xl:{"max-w":"max-w-[90vw]","max-h":"max-h-[85dvh]"}}[w][m]}let v=H(!1);function y(){b()?f(v,!0):r.onClose()}function k(){f(v,!1),r.onClose()}function E(){f(v,!1)}Ne(()=>{if(!r.isOpen)return;const w=m=>{m.key==="Escape"&&!e(v)&&y()};return window.addEventListener("keydown",w),()=>window.removeEventListener("keydown",w)}),Ne(()=>{if(r.isOpen)return document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}});var _=Pa(),R=G(_),U=a(R);{var $=w=>{var m=Ca(),z=a(m);Ke(z,()=>r.children),t(m),D(x=>we(m,1,`modal-box flex flex-col p-0 ${n()??""} ${l()&&L.isMobile?"fixed inset-0 m-0 h-lvh w-lvw rounded-none":"fixed top-10 m-auto "} ${x??""} ${!(l()&&L.isMobile)&&!n()&&"max-h-[85dvh]"}`),[()=>!(l()&&L.isMobile)&&p(c(),"max-w")]),o(w,m)};C(U,w=>{r.isOpen&&w($)})}t(R);var j=i(R,2);{var I=w=>{var m=Ea(),z=a(m),x=i(a(z),2),B=a(x,!0);t(x);var ee=i(x,2),te=a(ee);te.__click=E;var ue=i(te,2);ue.__click=k,t(ee),t(z),t(m),D(()=>se(B,s())),o(w,m)};C(j,w=>{e(v)&&w(I)})}D(()=>we(R,1,`modal ${(r.isOpen&&"modal-open")??""} `)),o(u,_),_e()}ke(["click"]);var Aa=h('<button class="btn btn-circle btn-ghost btn-sm flex-none" aria-label="Retour"><!></button>'),Ia=h('<button class="btn btn-circle btn-ghost btn-sm flex-none" aria-label="Retour"><!></button>'),Ta=h('<p class="text-base-content/70 truncate text-sm"> </p>'),Oa=h('<div class="flex items-center gap-2 sm:me-10"><!></div>'),Ra=h('<div class="border-base-300 flex-none border-b px-4 py-3"><div class="absolute top-2 right-2"><!></div> <div class="flex flex-wrap items-center gap-2"><div class="flex min-w-0 flex-1 items-center gap-2"><!> <div class="max-w-11/12 min-w-0 flex-1 items-baseline"><h3 class="truncate text-lg font-bold"> </h3> <!></div></div> <!></div></div>');function Fa(u,r){be(r,!0);let l=ie(r,"showBackButton",3,!0);var b=Ra(),s=a(b),c=a(s);{var n=w=>{var m=Aa();m.__click=function(...x){r.onClose?.apply(this,x)};var z=a(m);Ct(z,{class:"h-5 w-5"}),t(m),o(w,m)};C(c,w=>{L.isMobile||w(n)})}t(s);var p=i(s,2),v=a(p),y=a(v);{var k=w=>{var m=Ia();m.__click=function(...x){r.onClose?.apply(this,x)};var z=a(m);$t(z,{class:"h-5 w-5"}),t(m),o(w,m)};C(y,w=>{l()&&L.isMobile&&w(k)})}var E=i(y,2),_=a(E),R=a(_,!0);t(_);var U=i(_,2);{var $=w=>{var m=Ta(),z=a(m,!0);t(m),D(()=>se(z,r.subtitle)),o(w,m)};C(U,w=>{r.subtitle&&w($)})}t(E),t(v);var j=i(v,2);{var I=w=>{var m=Oa(),z=a(m);Ke(z,()=>r.children),t(m),o(w,m)};C(j,w=>{r.children&&w(I)})}t(p),t(b),D(()=>se(R,r.title)),o(u,b),_e()}ke(["click"]);var La=h('<div class="flex-1 overflow-y-auto p-4 sm:p-6 sm:pt-2"><!></div>');function Sa(u,r){var l=La(),b=a(l);Ke(b,()=>r.children),t(l),o(u,l)}var qa=h('<div class="border-base-300 flex-none border-t px-4 py-3"><div class="flex flex-wrap items-center justify-end gap-2"><!></div></div>');function za(u,r){var l=qa(),b=a(l),s=a(b);Ke(s,()=>r.children),t(b),t(l),o(u,l)}var Da=h('<div role="alert" class="alert alert-error max-md:alert-vertical svelte-o861tn"><!> <span> </span></div>'),Ba=h('<div role="alert" class="alert alert-success max-md:alert-vertical svelte-o861tn"><!> <span> </span></div>'),Na=h(`<form id="forgotForm" class="space-y-4 svelte-o861tn"><fieldset class="svelte-o861tn"><label class="input validator required w-full"><!> <input type="email" placeholder="votre@email.com" required aria-required="true"/></label> <span class="validator-hint hidden">Adresse email valide requise</span></fieldset> <div class="alert alert-info alert-soft svelte-o861tn">Un email avec un lien vous sera envoyé pour renouveller votre mot de
            passe.". Pensez à vérifier s'il n'a pas attéri dans votre dossier
            spam.</div></form> <div class="text-center svelte-o861tn"><button class="btn btn-ghost btn-sm">← Retour à la connexion</button></div>`,1),Va=h(`<form id="loginForm" class="space-y-4 svelte-o861tn"><fieldset class="svelte-o861tn"><label class="input validator required w-full"><!> <input type="email" placeholder="votre@email.com" required aria-required="true"/></label> <span class="validator-hint hidden">Adresse email valide requise</span></fieldset> <fieldset class="svelte-o861tn"><label class="input validator required w-full"><!> <input type="password" placeholder="Mot de passe" required aria-required="true"/></label> <span class="validator-hint hidden">Mot de passe requis</span></fieldset></form> <div class="space-y-2 text-center svelte-o861tn"><button class="btn btn-link btn-sm btn-primary svelte-o861tn">Mot de passe oublié ?</button> <div class="text-base-content/70 text-sm svelte-o861tn">Pas encore de compte ? <button class="btn btn-primary btn-sm btn-soft ms-1">S'inscrire</button></div></div>`,1),Ua=h(`<form id="registerForm" class="space-y-4 svelte-o861tn"><fieldset class="svelte-o861tn"><label class="input validator required w-full"><!> <input type="text" placeholder="Votre nom" required aria-required="true" minlength="3" maxlength="25"/></label> <span class="validator-hint hidden">Doit comporter entre 3 et 25 caractères.</span></fieldset> <fieldset class="svelte-o861tn"><label class="input validator required w-full"><!> <input type="email" placeholder="votre@email.com" required aria-required="true"/></label> <span class="validator-hint hidden">Adresse email valide requise</span></fieldset> <fieldset class="svelte-o861tn"><label class="input validator required w-full"><!> <input type="password" placeholder="Mot de passe" required aria-required="true" minlength="8" maxlength="25"/></label> <span class="validator-hint hidden">Doit comporter entre 8 et 25 caractères.</span></fieldset> <fieldset class="svelte-o861tn"><label class="input validator required w-full"><!> <input type="password" placeholder="Confirmer le mot de passe" required aria-required="true" minlength="8" maxlength="25"/></label> <span class="validator-hint hidden">Doit être identique au mot de passe ci-dessus.</span></fieldset> <div class="alert alert-info alert-soft svelte-o861tn">Un email avec un lien vous sera envoyé. Pensez à vérifier s'il n'a
            pas attéri dans votre dossier spam.</div></form> <div class="text-base-content/70 text-center text-sm svelte-o861tn">Déjà un compte ? <button class="btn btn-soft btn-sm btn-primary ms-1">Se connecter</button></div>`,1),ja=h('<div class="space-y-4 py-4 svelte-o861tn"><!> <!> <!></div>'),Wa=h('<span class="loading loading-spinner"></span>'),Ga=h('<button form="forgotForm" type="submit" class="btn btn-primary btn-block"><!></button>'),$a=h('<span class="loading loading-spinner"></span>'),Ha=h('<button form="loginForm" type="submit" class="btn btn-primary btn-block"><!></button>'),Ka=h('<span class="loading loading-spinner"></span>'),Ya=h('<button form="registerForm" type="submit" class="btn btn-success btn-block"><!></button>'),Xa=h("<!> <!> <!>",1);function Ja(u,r){be(r,!0);let l=ie(r,"isOpen",15),b=ie(r,"onAuth_success",3,async()=>{}),s=ie(r,"showLogin",3,!0),c=H(xt(s())),n=H(!1),p=H(""),v=H("");Ne(()=>{l()&&(f(c,s()),f(j,!1))});let y=H(""),k=H(""),E=H(""),_=H(""),R=H(""),U=H(""),$=H(""),j=H(!1),I,w,m;async function z(S){if(S.preventDefault(),!I.checkValidity()){I.reportValidity(),f(p,"Formulaire invalide. Veuillez vérifier les champs.");return}f(p,""),await ee()}async function x(S){if(S.preventDefault(),e(R)!==e(U)){f(p,"Les mots de passe ne correspondent pas.");return}if(!w.checkValidity()){w.reportValidity(),f(p,"Formulaire invalide. Veuillez vérifier les champs.");return}f(p,""),await te()}async function B(S){if(S.preventDefault(),!m.checkValidity()){m.reportValidity(),f(p,"Formulaire invalide. Veuillez vérifier les champs.");return}f(p,""),await ue()}async function ee(){f(n,!0);try{const{account:S}=await tt();await S.createEmailPasswordSession({email:e(y),password:e(k)}),f(v,"Connexion réussie !"),setTimeout(()=>{b()()},1e3)}catch(S){console.error("Erreur de connexion:",S),f(p,S.message||"Erreur lors de la connexion",!0)}finally{f(n,!1)}}async function te(){f(n,!0);try{const{account:S}=await tt();await S.create({userId:"unique()",email:e(_),password:e(R),name:e(E)}),await S.createEmailPasswordSession({email:e(_),password:e(R)}),f(v,"Compte créé et connecté !"),setTimeout(()=>{b()()},1e3)}catch(S){console.error("Erreur d'inscription:",S),f(p,S.message||"Erreur lors de la création du compte",!0)}finally{f(n,!1)}}async function ue(){f(n,!0);try{const{account:S}=await tt();await S.createRecovery({email:e($),url:`${window.location.origin}/#/reset-password`}),f(v,"Email de réinitialisation envoyé !"),setTimeout(()=>{f(j,!1),f($,"")},2e3)}catch(S){console.error("Erreur mot de passe oublié:",S),f(p,S.message||"Erreur lors de l'envoi de l'email",!0)}finally{f(n,!1)}}function J(){e(n)||l(!1)}Ne(()=>{(e(c)||e(j))&&(f(p,""),f(v,""))});function Ce(){return e(j)?"Mot de passe oublié":e(c)?"Connexion":"Inscription"}Ma(u,{get isOpen(){return l()},onClose:J,maxWidth:"sm",children:(S,Ve)=>{var Se=Xa(),qe=G(Se);{let P=ve(Ce);Fa(qe,{get title(){return e(P)},onClose:J})}var g=i(qe,2);Sa(g,{children:(P,Q)=>{var ae=ja(),N=a(ae);{var X=q=>{var M=Da(),A=a(M);kt(A,{class:"h-6 w-6 shrink-0 stroke-current"});var T=i(A,2),V=a(T,!0);t(T),t(M),D(()=>se(V,e(p))),o(q,M)};C(N,q=>{e(p)&&q(X)})}var le=i(N,2);{var oe=q=>{var M=Ba(),A=a(M);Ht(A,{class:"h-6 w-6 shrink-0 stroke-current"});var T=i(A,2),V=a(T,!0);t(T),t(M),D(()=>se(V,e(v))),o(q,M)};C(le,q=>{e(v)&&q(oe)})}var Z=i(le,2);{var W=q=>{var M=Na(),A=G(M),T=a(A),V=a(T),K=a(V);st(K,{class:"h-4 w-4 opacity-50"});var F=i(K,2);Le(F),t(V),Y(2),t(T),Y(2),t(A),Qe(A,ne=>m=ne,()=>m);var O=i(A,2),re=a(O);re.__click=()=>f(j,!1),t(O),D(()=>{F.disabled=e(n),re.disabled=e(n)}),Ze("submit",A,B),Fe(F,()=>e($),ne=>f($,ne)),o(q,M)},de=q=>{var M=ce(),A=G(M);{var T=K=>{var F=Va(),O=G(F),re=a(O),ne=a(re),he=a(ne);st(he,{class:"h-4 w-4 opacity-50"});var ge=i(he,2);Le(ge),t(ne),Y(2),t(re);var Ee=i(re,2),Pe=a(Ee),Me=a(Pe);Ye(Me,{class:"h-4 w-4 opacity-50"});var me=i(Me,2);Le(me),t(Pe),Y(2),t(Ee),t(O),Qe(O,Ie=>I=Ie,()=>I);var Ae=i(O,2),fe=a(Ae);fe.__click=()=>f(j,!0);var Ue=i(fe,2),ze=i(a(Ue));ze.__click=()=>f(c,!1),t(Ue),t(Ae),D(()=>{ge.disabled=e(n),me.disabled=e(n),fe.disabled=e(n),ze.disabled=e(n)}),Ze("submit",O,z),Fe(ge,()=>e(y),Ie=>f(y,Ie)),Fe(me,()=>e(k),Ie=>f(k,Ie)),o(K,F)},V=K=>{var F=Ua(),O=G(F),re=a(O),ne=a(re),he=a(ne);Kt(he,{class:"h-4 w-4 opacity-50"});var ge=i(he,2);Le(ge),t(ne),Y(2),t(re);var Ee=i(re,2),Pe=a(Ee),Me=a(Pe);st(Me,{class:"h-4 w-4 opacity-50"});var me=i(Me,2);Le(me),t(Pe),Y(2),t(Ee);var Ae=i(Ee,2),fe=a(Ae),Ue=a(fe);Ye(Ue,{class:"h-4 w-4 opacity-50"});var ze=i(Ue,2);Le(ze),t(fe),Y(2),t(Ae);var Ie=i(Ae,2),it=a(Ie),lt=a(it);Ye(lt,{class:"h-4 w-4 opacity-50"});var Je=i(lt,2);Le(Je),t(it),Y(2),t(Ie),Y(2),t(O),Qe(O,ye=>w=ye,()=>w);var dt=i(O,2),ct=i(a(dt));ct.__click=()=>f(c,!0),t(dt),D(()=>{ge.disabled=e(n),me.disabled=e(n),ze.disabled=e(n),Je.disabled=e(n),ct.disabled=e(n)}),Ze("submit",O,x),Fe(ge,()=>e(E),ye=>f(E,ye)),Fe(me,()=>e(_),ye=>f(_,ye)),Fe(ze,()=>e(R),ye=>f(R,ye)),Fe(Je,()=>e(U),ye=>f(U,ye)),o(K,F)};C(A,K=>{e(c)?K(T):K(V,!1)},!0)}o(q,M)};C(Z,q=>{e(j)?q(W):q(de,!1)})}t(ae),o(P,ae)}});var d=i(g,2);za(d,{children:(P,Q)=>{var ae=ce(),N=G(ae);{var X=oe=>{var Z=Ga(),W=a(Z);{var de=M=>{var A=Wa();o(M,A)},q=M=>{var A=et("Envoyer l'email de réinitialisation");o(M,A)};C(W,M=>{e(n)?M(de):M(q,!1)})}t(Z),D(()=>Z.disabled=e(n)),o(oe,Z)},le=oe=>{var Z=ce(),W=G(Z);{var de=M=>{var A=Ha(),T=a(A);{var V=F=>{var O=$a();o(F,O)},K=F=>{var O=et("Se connecter");o(F,O)};C(T,F=>{e(n)?F(V):F(K,!1)})}t(A),D(()=>A.disabled=e(n)),o(M,A)},q=M=>{var A=Ya(),T=a(A);{var V=F=>{var O=Ka();o(F,O)},K=F=>{var O=et("Créer un compte");o(F,O)};C(T,F=>{e(n)?F(V):F(K,!1)})}t(A),D(()=>A.disabled=e(n)),o(M,A)};C(W,M=>{e(c)?M(de):M(q,!1)},!0)}o(oe,Z)};C(N,oe=>{e(j)?oe(X):oe(le,!1)})}o(P,ae)}}),o(S,Se)},$$slots:{default:!0}}),_e()}ke(["click"]);var Qa=h('<div class="flex h-[50vh] items-center justify-center"><!></div>'),Za=h('<div class="flex h-[80vh] flex-col items-center justify-center gap-4"><div class="loading loading-spinner loading-lg text-primary"></div> <p class="text-base-content/70 animate-pulse font-medium">Démarrage...</p></div>'),er=h("<!> <!>",1),tr=h('<link rel="preconnect" href="https://fonts.googleapis.com"/> <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""/> <link href="https://fonts.googleapis.com/css2?family=Cherry+Bomb+One&amp;family=Fredoka:wght@300..700&amp;display=swap&amp;family=Sora:wght@100..800&amp;display=swap" rel="stylesheet"/> <!> <div class="bg-base-200 min-h-screen"><!></div> <!> <!> <!> <!>',1);function ar(u,r){be(r,!0);let l=H("BOOTING"),b=H(null);async function s(){try{if(f(l,"BOOTING"),await L.initializeAuth(),f(l,"READY"),L.isAuthenticated){const x=Be.loading("Chargement des données...");Promise.all([Oe.loadCache(),We.loadCache(),Ge.loadCache(),$e.loadCache()]).then(async()=>(Be.update(x,{state:"loading",message:"Mise à jour des données en cours..."}),Promise.all([Oe.syncFromRemote(),We.syncFromRemote(),Ge.syncFromRemote(),De.syncFromRemote(),$e.syncFromRemote()]))).catch(B=>{console.error("[App] Erreur synchro privée:",B)}).then(async()=>{await Promise.all([We.setupRealtime(),Oe.setupRealtime(),Ge.setupRealtime(),De.setupRealtime(),at.initialize(),$e.setupRealtime()]),await je.initialize(),Be.update(x,{state:"success",message:"Données chargées",autoCloseDelay:2e3}),setTimeout(()=>{rt("/dashboard"),rt("/recipe")},3e3)}).catch(B=>{console.error("[App] Erreur setup realtime:",B),Be.update(x,{state:"warning",message:"Mode hors ligne : données mises en cache",autoCloseDelay:5e3})})}else Oe.loadCache().then(()=>Oe.syncFromRemotePublicOnly()).then(()=>Promise.all([Oe.setupRealtime(),je.initialize()])).then(()=>{setTimeout(()=>{rt("/recipe")},2e3)}).catch(x=>{console.error("[App] Erreur synchro publique:",x)})}catch(x){console.error("[App] Erreur fatale d'initialisation:",x),f(b,x.message||"Erreur critique de chargement",!0),f(l,"ERROR")}}let c=H(!1),n=H(!1);function p(){console.log("[App] Nettoyage des stores privés..."),at.destroy(),De.destroy(),We.destroy(),Ge.destroy(),$e.destroy()}Ne(()=>{const x=L.isAuthenticated;e(n)||e(l)!=="BOOTING"&&x!==e(c)&&(f(c,x,!0),x?(console.log("[App] Connexion détectée"),je.destroy()):(console.log("[App] Déconnexion détectée"),p(),je.destroy()),console.log("[App] Changement d'état Auth -> Réinitialisation"),f(n,!0),s().finally(()=>{f(n,!1)}))}),It(()=>{s()}),Tt(()=>{console.log("[App] Destruction de l'application - Nettoyage des stores..."),at.destroy(),De.destroy(),We.destroy(),Oe.destroy(),Ge.destroy(),$e.destroy(),je.destroy()});let v=ve(()=>e(b)||Ot.error);async function y(){L.authModal.isOpen=!1,await L.refreshAuthAfterLogin()}var k=tr(),E=i(G(k),6);va(E,{});var _=i(E,2),R=a(_);{var U=x=>{var B=Qa(),ee=a(B);{let te=ve(()=>e(v)||"Erreur inconnue");bt(ee,{get message(){return e(te)}})}t(B),o(x,B)},$=x=>{var B=ce(),ee=G(B);{var te=J=>{var Ce=Za();o(J,Ce)},ue=J=>{Rt(J,{})};C(ee,J=>{e(l)==="BOOTING"?J(te):J(ue,!1)},!0)}o(x,B)};C(R,x=>{e(l)==="ERROR"?x(U):x($,!1)})}t(_);var j=i(_,2);ya(j,{});var I=i(j,2);wa(I,{});var w=i(I,2);{var m=x=>{var B=er(),ee=G(B);{var te=J=>{bt(J,{get message(){return e(v)}})};C(ee,J=>{e(v)&&J(te)})}var ue=i(ee,2);ka(ue,{}),o(x,B)};C(w,x=>{L.isAuthenticated&&x(m)})}var z=i(w,2);Ja(z,{get showLogin(){return L.authModal.showLogin},onAuth_success:y,get isOpen(){return L.authModal.isOpen},set isOpen(x){L.authModal.isOpen=x}}),o(u,k),_e()}Ft(ar,{target:document.getElementById("app")});export{Ma as M,ma as a,Fa as b,Sa as c,za as d,ir as e,or as f,Te as n,fa as s};
