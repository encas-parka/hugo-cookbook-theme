var vt=v=>{throw TypeError(v)};var Pt=(v,r,d)=>r.has(v)||vt("Cannot "+d);var xe=(v,r,d)=>(Pt(v,r,"read from private field"),d?d.call(v):r.get(v)),ut=(v,r,d)=>r.has(v)?vt("Cannot add the same private member more than once"):r instanceof WeakSet?r.add(v):r.set(v,d);import{v as _,h as a,g as l,w as B,x as ae,b as i,o as t,y as $,z as xt,m as e,A as p,B as ke,d as pe,p as oe,e as je,C as we,u as ve,i as it,c as be,D as Qe,E as wt,F as We,G as X,H as mt,I as L,J as Ve,k as G,K as E,L as ze,M as Te,j as ce,s as Ge,N as Re,O as Ne,P as kt,t as Mt,Q as At,R as et,S as tt,T as Le,U as at,V as rt,W as qe,X as It,Y as Tt,Z as ft,_ as He,$ as Ke,a0 as Ye,a1 as Xe,a2 as st,a3 as Ot,a4 as Rt,a5 as Ft}from"./appwrite.js";import{C as Ct,P as zt,E as Lt,a as qt,L as pt,b as Je,U as St,c as Bt,B as Dt,R as Nt,d as Vt,e as Ut,f as jt,g as Wt,X as Et,A as Gt,h as $t,i as Ht,M as nt,j as Kt}from"./icons.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))b(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const n of c.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&b(n)}).observe(document,{childList:!0,subtree:!0});function d(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerPolicy&&(c.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?c.credentials="include":s.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function b(s){if(s.ep)return;s.ep=!0;const c=d(s);fetch(s.href,c)}})();var Yt=_('<div class="alert alert-error max-md:alert-vertical shadow-lg"><!> <div><h3 class="font-bold">Erreur</h3> <div class="text-sm"> </div></div></div>');function bt(v,r){var d=Yt(),b=a(d);Ct(b,{class:"h-6 w-6 shrink-0 stroke-current"});var s=l(b,2),c=l(a(s),2),n=a(c,!0);t(c),t(s),t(d),B(()=>ae(n,r.message)),i(v,d)}var fe;class Xt{constructor(){ut(this,fe,$(xt({title:""})))}get title(){return e(xe(this,fe)).title||"ENKA Cookbook"}get backAction(){return e(xe(this,fe)).backAction}get actions(){return e(xe(this,fe)).actions}get isLockedByOthers(){return e(xe(this,fe)).isLockedByOthers||!1}get lockedByUserName(){return e(xe(this,fe)).lockedByUserName||""}get hasUnsavedChanges(){return e(xe(this,fe)).hasUnsavedChanges||!1}setConfig(r){p(xe(this,fe),{...r},!0)}reset(){p(xe(this,fe),{title:""},!0)}}fe=new WeakMap;const Oe=new Xt;var Jt=_("<button> </button>"),Qt=_('<div class="rounded-box bg-secondary/10 px-4 py-1"><div class="tabs tabs-border justify-center"></div></div>');function ht(v,r){pe(r,!0);let d=oe(r,"basePath",3,"/event");const b=[{label:"Éditer l'événement",relativePath:""},{label:"Voir les recettes",relativePath:"recipes"},{label:"Listes des produits",relativePath:"products"},{label:"Affiches",relativePath:"posters"}],s=ve(()=>{const u=Qe.pathname;return u.includes("/recipes")?1:u.includes("/products")?2:u.includes("/posters")?3:0});function c(u){if(!r.eventId)return;const x=b[u].relativePath,k=x?`${d()}/${r.eventId}/${x}`:`${d()}/${r.eventId}`;wt(k)}var n=Qt(),f=a(n);je(f,21,()=>b,it,(u,x,k)=>{var C=Jt();C.__click=()=>c(k);var g=a(C,!0);t(C),B(()=>{we(C,1,`tab font-semibold ${k===e(s)?"tab-active":""}`),ae(g,e(x).label)}),i(u,C)}),t(f),t(n),i(v,n),be()}ke(["click"]);var Zt=_("<button> </button>"),ea=_('<div class="tabs tabs-lg tabs-border justify-center"></div>');function _t(v,r){pe(r,!0);const d=[{label:"Matériel",getPath:()=>s()},{label:"Reservations",getPath:()=>c()}],b=ve(()=>Qe.pathname.includes("/loans")?1:0);function s(){if(r.currentTeamId)return`/dashboard/materiel/${r.currentTeamId}`;const u=We.myTeams;return u.length>0?`/dashboard/materiel/${u[0].$id}`:"/dashboard/materiel"}function c(){if(r.currentTeamId)return`/dashboard/loans/${r.currentTeamId}`;const u=We.myTeams;return u.length>0?`/dashboard/loans/${u[0].$id}`:"/dashboard/loans"}function n(u){const x=d[u].getPath();wt(x)}var f=ea();je(f,21,()=>d,it,(u,x,k)=>{var C=Zt();C.__click=()=>n(k);var g=a(C,!0);t(C),B(()=>{we(C,1,`tab font-medium ${k===e(b)?"tab-active":""}`),ae(g,e(x).label)}),i(u,C)}),t(f),i(v,f),be()}ke(["click"]);var ta=_('<div class="rounded-box bg-secondary/10 px-4 py-1"><div class="tabs tabs-border justify-center"><button><!> Édition</button> <button><!> Aperçu</button></div></div>');function gt(v,r){pe(r,!0);const d=ve(()=>mt.get("mode")||"preview");function b(g){mt.set("mode",g)}var s=ta(),c=a(s),n=a(c);let f;n.__click=()=>b("edit");var u=a(n);zt(u,{class:"h-4 w-4"}),X(),t(n);var x=l(n,2);let k;x.__click=()=>b("preview");var C=a(x);Lt(C,{class:"h-4 w-4"}),X(),t(x),t(c),t(s),B(()=>{f=we(n,1,"tab gap-2 font-semibold",null,f,{"tab-active":e(d)==="edit"}),k=we(x,1,"tab gap-2 font-semibold",null,k,{"tab-active":e(d)==="preview"})}),i(v,s),be()}ke(["click"]);var aa=_('<a class="btn btn-ghost not-md:btn-square md:gap-2"><!> <span class="hidden md:inline">Tableau de bord</span></a>'),ra=_('<h1 class="font-family-fredoka truncate text-sm font-bold tracking-wider uppercase opacity-70"> </h1>'),sa=_('<div class="navbar-center absolute left-1/2 -translate-x-1/2 transform"><!></div>'),na=_('<div class="badge badge-warning flex items-center gap-1 py-3 font-medium"><!> <span class="text-xs"> </span></div>'),ia=_('<div class="dropdown dropdown-end"><div tabindex="0" role="button" class="btn btn-ghost btn-circle avatar bg-primary/10 text-primary border-primary/20 border"><div class="flex w-10 items-center justify-center rounded-full text-lg font-bold"> </div></div> <ul class="menu menu-sm dropdown-content bg-base-100 border-base-200 z-1 mt-3 w-56 rounded-xl border p-2 shadow-xl"><li class="border-base-100 mb-1 border-b px-4 py-2"><span class="block truncate p-0 text-xs font-medium italic opacity-60"> </span></li> <li><a class="flex items-center gap-2"><!> Dashboard</a></li> <li><a class="flex items-center gap-2"><!> Équipes</a></li> <li><a class="flex items-center gap-2"><!> Nouvel événement</a></li> <li><a class="flex items-center gap-2"><!> Recettes</a></li> <li><button class="disabled:opacity-50"><!> </button></li> <!> <li class="border-base-100 my-1 border-t"></li> <li><button class="text-error hover:bg-error/10"><!> Se déconnecter</button></li></ul></div>'),oa=_('<button class="btn btn-primary btn-sm shadow-md"><!> Connexion</button>'),la=_('<h1 class="text-center text-sm font-bold tracking-wider uppercase opacity-70"> </h1>'),da=_('<div class="border-base-300 bg-base-100 border-b px-4 py-3"><!></div>'),ca=_('<div><div class="navbar-start w-fit shrink-0 gap-1"><a class="btn btn-ghost btn-circle"><img src="/images/favicon.png" alt="logo" class="h-8 w-8"/></a> <div class=" flex items-center gap-1"><!> <a class="btn btn-ghost not-md:btn-square md:gap-2"><!> <span class="hidden md:inline">Recettes</span></a></div></div> <!> <div class="navbar-end ms-auto w-fit shrink-0 gap-4"><!> <div class="flex items-center gap-2"><!></div> <!></div></div> <!>',1);function va(v,r){pe(r,!0);let d=$(!1),b=$(!1);const s=ve(()=>{const y=Qe.pathname,o=Qe.params;return y.includes("/event/")&&o.id?{type:"eventEdit",basePath:"/event",eventId:o.id}:y.includes("/demo/event/")&&o.id?{type:"eventEdit",basePath:"/demo/event",eventId:o.id}:y.includes("/dashboard/materiel/")&&o.teamId?{type:"materiel",teamId:o.teamId}:y.includes("/dashboard/loans/")&&o.teamId?{type:"loans",teamId:o.teamId}:y.includes("/editdocument/")&&o.teamId&&o.docId?{type:"documentEdit",teamId:o.teamId,docId:o.docId}:null});L.isMobile&&L.initializeScrollDirection();function c(){p(d,!1)}async function n(){try{await L.logout(),window.location.href="/"}catch(y){console.error("Erreur lors de la déconnexion:",y)}}function f(){L.authModal.showLogin=!0,L.authModal.isOpen=!0}async function u(){if(L.userId){p(b,!0);try{await Re.forceReloadAllRecipes(),c()}catch(y){console.error("Erreur lors du rechargement des recettes:",y),alert("Erreur lors du rechargement des recettes")}finally{p(b,!1)}}}function x(y){y.target.closest(".svelte-user-dropdown")||c()}Ve(()=>{if(e(d))return document.addEventListener("click",x),()=>document.removeEventListener("click",x)});var k=ca(),C=G(k),g=a(C),R=a(g),V=l(R,2),W=a(V);{var U=y=>{var o=aa(),P=a(o);pt(P,{size:18}),X(2),t(o),B(K=>Te(o,"href",K),[()=>ze("/#/dashboard")]),i(y,o)};E(W,y=>{L.isAuthenticated&&y(U)})}var I=l(W,2),w=a(I);qt(w,{size:18}),X(2),t(I),t(V),t(g);var m=l(g,2);{var h=y=>{var o=sa(),P=a(o);{var K=D=>{_t(D,{get currentTeamId(){return e(s).teamId}})},ee=D=>{var J=ce(),le=G(J);{var ie=j=>{ht(j,{get eventId(){return e(s).eventId},get basePath(){return e(s).basePath}})},Z=j=>{var de=ce(),S=G(de);{var M=T=>{gt(T,{})},A=T=>{var N=ra(),Y=a(N,!0);t(N),B(()=>{Te(N,"title",Oe.title),ae(Y,Oe.title)}),i(T,N)};E(S,T=>{e(s)?.type==="documentEdit"?T(M):T(A,!1)},!0)}i(j,de)};E(le,j=>{e(s)?.type==="eventEdit"?j(ie):j(Z,!1)},!0)}i(D,J)};E(P,D=>{e(s)?.type==="materiel"||e(s)?.type==="loans"?D(K):D(ee,!1)})}t(o),i(y,o)};E(m,y=>{L.isDesktop&&y(h)})}var F=l(m,2),Q=a(F);{var re=y=>{var o=na(),P=a(o);Je(P,{size:14});var K=l(P,2),ee=a(K);t(K),t(o),B(()=>ae(ee,`Édition par ${Oe.lockedByUserName??""}`)),i(y,o)};E(Q,y=>{Oe.isLockedByOthers&&y(re)})}var ne=l(Q,2),H=a(ne);{var Ce=y=>{var o=ce(),P=G(o);Ge(P,()=>Oe.actions),i(y,o)};E(H,y=>{Oe.actions&&y(Ce)})}t(ne);var Se=l(ne,2);{var q=y=>{var o=ia(),P=a(o),K=a(P),ee=a(K,!0);t(K),t(P);var D=l(P,2),J=a(D),le=a(J),ie=a(le,!0);t(le),t(J);var Z=l(J,2),j=a(Z),de=a(j);pt(de,{size:16}),X(),t(j),t(Z);var S=l(Z,2),M=a(S),A=a(M);St(A,{size:16}),X(),t(M),t(S);var T=l(S,2),N=a(T),Y=a(N);Bt(Y,{size:16}),X(),t(N),t(T);var z=l(T,2),O=a(z),te=a(O);Dt(te,{size:16}),X(),t(O),t(z);var se=l(z,2),he=a(se);he.__click=u;var _e=a(he);{let me=ve(()=>e(b)?"animate-spin":"");Nt(_e,{size:16,get class(){return e(me)}})}var Ee=l(_e);t(he),t(se);var Pe=l(se,2);E(Pe,me=>{});var Me=l(Pe,4),ue=a(Me);ue.__click=n;var Ae=a(ue);Vt(Ae,{size:16}),X(),t(ue),t(Me),t(D),t(o),B((me,Fe,Ie,ge,$e)=>{ae(ee,me),ae(ie,L.user?.email),Te(j,"href",Fe),Te(M,"href",Ie),Te(N,"href",ge),Te(O,"href",$e),he.disabled=e(b),ae(Ee,` ${e(b)?"Chargement...":"Recharger les recettes"}`)},[()=>L.user?.name?.charAt(0).toUpperCase()||"U",()=>ze("/#/dashboard"),()=>ze("/#/dashboard/teams"),()=>ze("/#/dashboard/eventCreate"),()=>ze("/#/recipe")]),i(y,o)},Ue=y=>{var o=oa();o.__click=f;var P=a(o);Ut(P,{size:16}),X(),t(o),i(y,o)};E(Se,y=>{L.isAuthenticated?y(q):y(Ue,!1)})}t(F),t(C);var Be=l(C,2);{var De=y=>{var o=da(),P=a(o);{var K=D=>{_t(D,{get currentTeamId(){return e(s).teamId}})},ee=D=>{var J=ce(),le=G(J);{var ie=j=>{ht(j,{get eventId(){return e(s).eventId},get basePath(){return e(s).basePath}})},Z=j=>{var de=ce(),S=G(de);{var M=T=>{gt(T,{})},A=T=>{var N=ce(),Y=G(N);{var z=O=>{var te=la(),se=a(te,!0);t(te),B(()=>ae(se,Oe.title)),i(O,te)};E(Y,O=>{Oe.title&&O(z)},!0)}i(T,N)};E(S,T=>{e(s)?.type==="documentEdit"?T(M):T(A,!1)},!0)}i(j,de)};E(le,j=>{e(s)?.type==="eventEdit"?j(ie):j(Z,!1)},!0)}i(D,J)};E(P,D=>{e(s)?.type==="materiel"||e(s)?.type==="loans"?D(K):D(ee,!1)})}t(o),i(y,o)};E(Be,y=>{L.isDesktop||y(De)})}B((y,o)=>{we(C,1,`navbar bg-base-100 border-base-300 sticky top-0 z-1000 min-h-13 border-b px-4 py-0 shadow-sm print:hidden ${(L.isMobile&&"min-h-11")??""} ${(L.isMobile&&!L.headerVisible&&"-translate-y-full")??""} transition-transform duration-300`),Te(R,"href",y),Te(I,"href",o)},[()=>ze("/#/"),()=>ze("/#/recipe")]),i(v,k),be()}ke(["click"]);const ua=v=>v;function ot(v){const r=v-1;return r*r*r+1}function yt(v){const r=typeof v=="string"&&v.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return r?[parseFloat(r[1]),r[2]||"px"]:[v,"px"]}function ma(v,{delay:r=0,duration:d=400,easing:b=ua}={}){const s=+getComputedStyle(v).opacity;return{delay:r,duration:d,easing:b,css:c=>`opacity: ${c*s}`}}function ir(v,{delay:r=0,duration:d=400,easing:b=ot,x:s=0,y:c=0,opacity:n=0}={}){const f=getComputedStyle(v),u=+f.opacity,x=f.transform==="none"?"":f.transform,k=u*(1-n),[C,g]=yt(s),[R,V]=yt(c);return{delay:r,duration:d,easing:b,css:(W,U)=>`
			transform: ${x} translate(${(1-W)*C}${g}, ${(1-W)*R}${V});
			opacity: ${u-k*U}`}}function fa(v,{delay:r=0,duration:d=400,easing:b=ot,axis:s="y"}={}){const c=getComputedStyle(v),n=+c.opacity,f=s==="y"?"height":"width",u=parseFloat(c[f]),x=s==="y"?["top","bottom"]:["left","right"],k=x.map(I=>`${I[0].toUpperCase()}${I.slice(1)}`),C=parseFloat(c[`padding${k[0]}`]),g=parseFloat(c[`padding${k[1]}`]),R=parseFloat(c[`margin${k[0]}`]),V=parseFloat(c[`margin${k[1]}`]),W=parseFloat(c[`border${k[0]}Width`]),U=parseFloat(c[`border${k[1]}Width`]);return{delay:r,duration:d,easing:b,css:I=>`overflow: hidden;opacity: ${Math.min(I*20,1)*n};${f}: ${I*u}px;padding-${x[0]}: ${I*C}px;padding-${x[1]}: ${I*g}px;margin-${x[0]}: ${I*R}px;margin-${x[1]}: ${I*V}px;border-${x[0]}-width: ${I*W}px;border-${x[1]}-width: ${I*U}px;min-${f}: 0`}}function or(v,{delay:r=0,duration:d=400,easing:b=ot,start:s=0,opacity:c=0}={}){const n=getComputedStyle(v),f=+n.opacity,u=n.transform==="none"?"":n.transform,x=1-s,k=f*(1-c);return{delay:r,duration:d,easing:b,css:(C,g)=>`
			transform: ${u} scale(${1-x*g});
			opacity: ${f-k*g}
		`}}var pa=_('<button class="btn btn-sm btn-primary"> </button>'),ba=_('<button class="btn btn-ghost btn-xs btn-square" title="Voir les détails" aria-label="Voir les détails"><!></button>'),ha=_('<button class="btn btn-ghost btn-xs btn-circle pe-0" title="Fermer" aria-label="Fermer la notification"><!></button>'),_a=_('<div><div class="flex items-center justify-between gap-4"><div class="flex flex-1 items-center gap-2"><!> <span class="text-sm"> </span></div> <!> <!> <!></div></div>'),ga=_("<div></div>");function ya(v,r){pe(r,!0);let d=oe(r,"position",3,"toast-center toast-bottom"),b=oe(r,"padding",3,"sm");const s=ve(()=>b()==="sm"?" py-0.5":"py-1"),c=ve(()=>Ne.toasts),n=ve(()=>()=>{const g=new Map;for(const R of e(c)){const V=R.position||d();g.has(V)||g.set(V,[]),g.get(V).push(R)}return g});function f(g){Ne.dismiss(g.id)}function u(g){r.onShowDetails?.({id:g.id,message:g.message,details:g.details})}function x(g,R){R.onClick()}var k=ce(),C=G(k);je(C,17,()=>Array.from(e(n)().entries()),([g,R])=>g,(g,R)=>{var V=ve(()=>Mt(e(R),2));let W=()=>e(V)[0],U=()=>e(V)[1];var I=ga();je(I,21,U,w=>w.id,(w,m)=>{var h=_a(),F=a(h),Q=a(F),re=a(Q);{var ne=o=>{jt(o,{class:"h-5 w-5 animate-spin"})};E(re,o=>{e(m).state==="loading"&&o(ne)})}var H=l(re,2),Ce=a(H,!0);t(H),t(Q);var Se=l(Q,2);{var q=o=>{var P=ce(),K=G(P);je(K,17,()=>e(m).actions,it,(ee,D)=>{var J=pa();J.__click=()=>x(e(m),e(D));var le=a(J,!0);t(J),B(()=>ae(le,e(D).label)),i(ee,J)}),i(o,P)};E(Se,o=>{e(m).actions&&e(m).actions.length>0&&o(q)})}var Ue=l(Se,2);{var Be=o=>{var P=ba();P.__click=()=>u(e(m));var K=a(P);Wt(K,{class:"h-3 w-3"}),t(P),i(o,P)};E(Ue,o=>{e(m).details&&o(Be)})}var De=l(Ue,2);{var y=o=>{var P=ha();P.__click=()=>f(e(m));var K=a(P);Et(K,{class:"h-4 w-4"}),t(P),i(o,P)};E(De,o=>{(e(m).state==="error"||e(m).state==="warning"||e(m).state==="loading")&&o(y)})}t(F),t(h),B(()=>{we(h,1,`alert alert-${e(m).state??""}  ${e(s)??""} shadow-lg`),ae(Ce,e(m).message)}),kt(3,h,()=>fa),i(w,h)}),t(I),B(()=>we(I,1,`toast ${W()??""} z-1050`)),i(g,I)}),i(v,k),be()}ke(["click"]);var xa=_('<button class="btn btn-primary btn-circle fixed right-6 bottom-6 z-50 rounded-full shadow-lg" aria-label="Retour en haut de page"><!></button>');function wa(v,r){pe(r,!0);let d=ve(()=>(At.current||0)>300);function b(){window.scrollTo({top:0,behavior:"smooth"})}var s=ce(),c=G(s);{var n=f=>{var u=xa();u.__click=b;var x=a(u);Gt(x,{class:"h-6 w-6"}),t(u),kt(3,u,()=>ma),i(f,u)};E(c,f=>{e(d)&&f(n)})}i(v,s),be()}ke(["click"]);function ka(v,r){pe(r,!0),be()}var Ca=_('<div role="dialog" aria-modal="true"><!></div>'),Ea=_('<div class="modal modal-open" style="z-index: 1100"><div class="modal-box max-w-md"><h3 class="text-lg font-bold">Confirmer la fermeture</h3> <p class="py-4"> </p> <div class="modal-action"><button class="btn btn-ghost">Annuler</button> <button class="btn btn-error">Fermer sans sauvegarder</button></div></div></div>'),Pa=_("<div><!></div> <!>",1);function Ma(v,r){pe(r,!0);let d=oe(r,"fullscreenOnMobile",3,!0);oe(r,"closeOnBackdropClick",3,!1);let b=oe(r,"hasUnsavedChanges",3,!1),s=oe(r,"confirmCloseMessage",3,"Vous avez des modifications non sauvegardées. Voulez-vous vraiment fermer ?"),c=oe(r,"maxWidth",3,"lg");oe(r,"maxHeight",3,"xl");let n=oe(r,"modalClass",3,"");function f(w,m){return{sm:{"max-w":"max-w-[28rem]","max-h":"max-h-[85dvh]"},lg:{"max-w":"max-w-[64rem]","max-h":"max-h-[85dvh]"},xl:{"max-w":"max-w-[90vw]","max-h":"max-h-[85dvh]"}}[w][m]}let u=$(!1);function x(){b()?p(u,!0):r.onClose()}function k(){p(u,!1),r.onClose()}function C(){p(u,!1)}Ve(()=>{if(!r.isOpen)return;const w=m=>{m.key==="Escape"&&!e(u)&&x()};return window.addEventListener("keydown",w),()=>window.removeEventListener("keydown",w)}),Ve(()=>{if(r.isOpen)return document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}});var g=Pa(),R=G(g),V=a(R);{var W=w=>{var m=Ca(),h=a(m);Ge(h,()=>r.children),t(m),B(F=>we(m,1,`modal-box flex flex-col p-0 ${n()??""} ${d()&&L.isMobile?"fixed inset-0 m-0 h-lvh w-lvw rounded-none":"fixed top-10 m-auto "} ${F??""} ${!(d()&&L.isMobile)&&!n()&&"max-h-[85dvh]"}`),[()=>!(d()&&L.isMobile)&&f(c(),"max-w")]),i(w,m)};E(V,w=>{r.isOpen&&w(W)})}t(R);var U=l(R,2);{var I=w=>{var m=Ea(),h=a(m),F=l(a(h),2),Q=a(F,!0);t(F);var re=l(F,2),ne=a(re);ne.__click=C;var H=l(ne,2);H.__click=k,t(re),t(h),t(m),B(()=>ae(Q,s())),i(w,m)};E(U,w=>{e(u)&&w(I)})}B(()=>we(R,1,`modal ${(r.isOpen&&"modal-open")??""} `)),i(v,g),be()}ke(["click"]);var Aa=_('<button class="btn btn-circle btn-ghost btn-sm flex-none" aria-label="Retour"><!></button>'),Ia=_('<button class="btn btn-circle btn-ghost btn-sm flex-none" aria-label="Retour"><!></button>'),Ta=_('<p class="text-base-content/70 truncate text-sm"> </p>'),Oa=_('<div class="flex items-center gap-2 sm:me-10"><!></div>'),Ra=_('<div class="border-base-300 flex-none border-b px-4 py-3"><div class="absolute top-2 right-2"><!></div> <div class="flex flex-wrap items-center gap-2"><div class="flex min-w-0 flex-1 items-center gap-2"><!> <div class="max-w-11/12 min-w-0 flex-1 items-baseline"><h3 class="truncate text-lg font-bold"> </h3> <!></div></div> <!></div></div>');function Fa(v,r){pe(r,!0);let d=oe(r,"showBackButton",3,!0);var b=Ra(),s=a(b),c=a(s);{var n=w=>{var m=Aa();m.__click=function(...F){r.onClose?.apply(this,F)};var h=a(m);Et(h,{class:"h-5 w-5"}),t(m),i(w,m)};E(c,w=>{L.isMobile||w(n)})}t(s);var f=l(s,2),u=a(f),x=a(u);{var k=w=>{var m=Ia();m.__click=function(...F){r.onClose?.apply(this,F)};var h=a(m);$t(h,{class:"h-5 w-5"}),t(m),i(w,m)};E(x,w=>{d()&&L.isMobile&&w(k)})}var C=l(x,2),g=a(C),R=a(g,!0);t(g);var V=l(g,2);{var W=w=>{var m=Ta(),h=a(m,!0);t(m),B(()=>ae(h,r.subtitle)),i(w,m)};E(V,w=>{r.subtitle&&w(W)})}t(C),t(u);var U=l(u,2);{var I=w=>{var m=Oa(),h=a(m);Ge(h,()=>r.children),t(m),i(w,m)};E(U,w=>{r.children&&w(I)})}t(f),t(b),B(()=>ae(R,r.title)),i(v,b),be()}ke(["click"]);var za=_('<div class="flex-1 overflow-y-auto p-4 sm:p-6 sm:pt-2"><!></div>');function La(v,r){var d=za(),b=a(d);Ge(b,()=>r.children),t(d),i(v,d)}var qa=_('<div class="border-base-300 flex-none border-t px-4 py-3"><div class="flex flex-wrap items-center justify-end gap-2"><!></div></div>');function Sa(v,r){var d=qa(),b=a(d),s=a(b);Ge(s,()=>r.children),t(b),t(d),i(v,d)}var Ba=_('<div role="alert" class="alert alert-error max-md:alert-vertical svelte-o861tn"><!> <span> </span></div>'),Da=_('<div role="alert" class="alert alert-success max-md:alert-vertical svelte-o861tn"><!> <span> </span></div>'),Na=_(`<form id="forgotForm" class="space-y-4 svelte-o861tn"><fieldset class="svelte-o861tn"><label class="input validator required w-full"><!> <input type="email" placeholder="votre@email.com" required aria-required="true"/></label> <span class="validator-hint hidden">Adresse email valide requise</span></fieldset> <div class="alert alert-info alert-soft svelte-o861tn">Un email avec un lien vous sera envoyé pour renouveller votre mot de
            passe.". Pensez à vérifier s'il n'a pas attéri dans votre dossier
            spam.</div></form> <div class="text-center svelte-o861tn"><button class="btn btn-ghost btn-sm">← Retour à la connexion</button></div>`,1),Va=_(`<form id="loginForm" class="space-y-4 svelte-o861tn"><fieldset class="svelte-o861tn"><label class="input validator required w-full"><!> <input type="email" placeholder="votre@email.com" required aria-required="true"/></label> <span class="validator-hint hidden">Adresse email valide requise</span></fieldset> <fieldset class="svelte-o861tn"><label class="input validator required w-full"><!> <input type="password" placeholder="Mot de passe" required aria-required="true"/></label> <span class="validator-hint hidden">Mot de passe requis</span></fieldset></form> <div class="space-y-2 text-center svelte-o861tn"><button class="btn btn-link btn-sm btn-primary svelte-o861tn">Mot de passe oublié ?</button> <div class="text-base-content/70 text-sm svelte-o861tn">Pas encore de compte ? <button class="btn btn-primary btn-sm btn-soft ms-1">S'inscrire</button></div></div>`,1),Ua=_(`<form id="registerForm" class="space-y-4 svelte-o861tn"><fieldset class="svelte-o861tn"><label class="input validator required w-full"><!> <input type="text" placeholder="Votre nom" required aria-required="true" minlength="3" maxlength="25"/></label> <span class="validator-hint hidden">Doit comporter entre 3 et 25 caractères.</span></fieldset> <fieldset class="svelte-o861tn"><label class="input validator required w-full"><!> <input type="email" placeholder="votre@email.com" required aria-required="true"/></label> <span class="validator-hint hidden">Adresse email valide requise</span></fieldset> <fieldset class="svelte-o861tn"><label class="input validator required w-full"><!> <input type="password" placeholder="Mot de passe" required aria-required="true" minlength="8" maxlength="25"/></label> <span class="validator-hint hidden">Doit comporter entre 8 et 25 caractères.</span></fieldset> <fieldset class="svelte-o861tn"><label class="input validator required w-full"><!> <input type="password" placeholder="Confirmer le mot de passe" required aria-required="true" minlength="8" maxlength="25"/></label> <span class="validator-hint hidden">Doit être identique au mot de passe ci-dessus.</span></fieldset> <div class="alert alert-info alert-soft svelte-o861tn">Un email avec un lien vous sera envoyé. Pensez à vérifier s'il n'a
            pas attéri dans votre dossier spam.</div></form> <div class="text-base-content/70 text-center text-sm svelte-o861tn">Déjà un compte ? <button class="btn btn-soft btn-sm btn-primary ms-1">Se connecter</button></div>`,1),ja=_('<div class="space-y-4 py-4 svelte-o861tn"><!> <!> <!></div>'),Wa=_('<span class="loading loading-spinner"></span>'),Ga=_('<button form="forgotForm" type="submit" class="btn btn-primary btn-block"><!></button>'),$a=_('<span class="loading loading-spinner"></span>'),Ha=_('<button form="loginForm" type="submit" class="btn btn-primary btn-block"><!></button>'),Ka=_('<span class="loading loading-spinner"></span>'),Ya=_('<button form="registerForm" type="submit" class="btn btn-success btn-block"><!></button>'),Xa=_("<!> <!> <!>",1);function Ja(v,r){pe(r,!0);let d=oe(r,"isOpen",15),b=oe(r,"onAuth_success",3,async()=>{}),s=oe(r,"showLogin",3,!0),c=$(xt(s())),n=$(!1),f=$(""),u=$("");Ve(()=>{d()&&(p(c,s()),p(U,!1))});let x=$(""),k=$(""),C=$(""),g=$(""),R=$(""),V=$(""),W=$(""),U=$(!1),I,w,m;async function h(q){if(q.preventDefault(),!I.checkValidity()){I.reportValidity(),p(f,"Formulaire invalide. Veuillez vérifier les champs.");return}p(f,""),await re()}async function F(q){if(q.preventDefault(),e(R)!==e(V)){p(f,"Les mots de passe ne correspondent pas.");return}if(!w.checkValidity()){w.reportValidity(),p(f,"Formulaire invalide. Veuillez vérifier les champs.");return}p(f,""),await ne()}async function Q(q){if(q.preventDefault(),!m.checkValidity()){m.reportValidity(),p(f,"Formulaire invalide. Veuillez vérifier les champs.");return}p(f,""),await H()}async function re(){p(n,!0);try{const{account:q}=await rt();await q.createEmailPasswordSession({email:e(x),password:e(k)}),p(u,"Connexion réussie !"),setTimeout(()=>{b()()},1e3)}catch(q){console.error("Erreur de connexion:",q),p(f,q.message||"Erreur lors de la connexion",!0)}finally{p(n,!1)}}async function ne(){p(n,!0);try{const{account:q}=await rt();await q.create({userId:"unique()",email:e(g),password:e(R),name:e(C)}),await q.createEmailPasswordSession({email:e(g),password:e(R)}),p(u,"Compte créé et connecté !"),setTimeout(()=>{b()()},1e3)}catch(q){console.error("Erreur d'inscription:",q),p(f,q.message||"Erreur lors de la création du compte",!0)}finally{p(n,!1)}}async function H(){p(n,!0);try{const{account:q}=await rt();await q.createRecovery({email:e(W),url:`${window.location.origin}/#/reset-password`}),p(u,"Email de réinitialisation envoyé !"),setTimeout(()=>{p(U,!1),p(W,"")},2e3)}catch(q){console.error("Erreur mot de passe oublié:",q),p(f,q.message||"Erreur lors de l'envoi de l'email",!0)}finally{p(n,!1)}}function Ce(){e(n)||d(!1)}Ve(()=>{(e(c)||e(U))&&(p(f,""),p(u,""))});function Se(){return e(U)?"Mot de passe oublié":e(c)?"Connexion":"Inscription"}Ma(v,{get isOpen(){return d()},onClose:Ce,maxWidth:"sm",children:(q,Ue)=>{var Be=Xa(),De=G(Be);{let P=ve(Se);Fa(De,{get title(){return e(P)},onClose:Ce})}var y=l(De,2);La(y,{children:(P,K)=>{var ee=ja(),D=a(ee);{var J=S=>{var M=Ba(),A=a(M);Ct(A,{class:"h-6 w-6 shrink-0 stroke-current"});var T=l(A,2),N=a(T,!0);t(T),t(M),B(()=>ae(N,e(f))),i(S,M)};E(D,S=>{e(f)&&S(J)})}var le=l(D,2);{var ie=S=>{var M=Da(),A=a(M);Ht(A,{class:"h-6 w-6 shrink-0 stroke-current"});var T=l(A,2),N=a(T,!0);t(T),t(M),B(()=>ae(N,e(u))),i(S,M)};E(le,S=>{e(u)&&S(ie)})}var Z=l(le,2);{var j=S=>{var M=Na(),A=G(M),T=a(A),N=a(T),Y=a(N);nt(Y,{class:"h-4 w-4 opacity-50"});var z=l(Y,2);qe(z),t(N),X(2),t(T),X(2),t(A),et(A,se=>m=se,()=>m);var O=l(A,2),te=a(O);te.__click=()=>p(U,!1),t(O),B(()=>{z.disabled=e(n),te.disabled=e(n)}),tt("submit",A,Q),Le(z,()=>e(W),se=>p(W,se)),i(S,M)},de=S=>{var M=ce(),A=G(M);{var T=Y=>{var z=Va(),O=G(z),te=a(O),se=a(te),he=a(se);nt(he,{class:"h-4 w-4 opacity-50"});var _e=l(he,2);qe(_e),t(se),X(2),t(te);var Ee=l(te,2),Pe=a(Ee),Me=a(Pe);Je(Me,{class:"h-4 w-4 opacity-50"});var ue=l(Me,2);qe(ue),t(Pe),X(2),t(Ee),t(O),et(O,ge=>I=ge,()=>I);var Ae=l(O,2),me=a(Ae);me.__click=()=>p(U,!0);var Fe=l(me,2),Ie=l(a(Fe));Ie.__click=()=>p(c,!1),t(Fe),t(Ae),B(()=>{_e.disabled=e(n),ue.disabled=e(n),me.disabled=e(n),Ie.disabled=e(n)}),tt("submit",O,h),Le(_e,()=>e(x),ge=>p(x,ge)),Le(ue,()=>e(k),ge=>p(k,ge)),i(Y,z)},N=Y=>{var z=Ua(),O=G(z),te=a(O),se=a(te),he=a(se);Kt(he,{class:"h-4 w-4 opacity-50"});var _e=l(he,2);qe(_e),t(se),X(2),t(te);var Ee=l(te,2),Pe=a(Ee),Me=a(Pe);nt(Me,{class:"h-4 w-4 opacity-50"});var ue=l(Me,2);qe(ue),t(Pe),X(2),t(Ee);var Ae=l(Ee,2),me=a(Ae),Fe=a(me);Je(Fe,{class:"h-4 w-4 opacity-50"});var Ie=l(Fe,2);qe(Ie),t(me),X(2),t(Ae);var ge=l(Ae,2),$e=a(ge),lt=a($e);Je(lt,{class:"h-4 w-4 opacity-50"});var Ze=l(lt,2);qe(Ze),t($e),X(2),t(ge),X(2),t(O),et(O,ye=>w=ye,()=>w);var dt=l(O,2),ct=l(a(dt));ct.__click=()=>p(c,!0),t(dt),B(()=>{_e.disabled=e(n),ue.disabled=e(n),Ie.disabled=e(n),Ze.disabled=e(n),ct.disabled=e(n)}),tt("submit",O,F),Le(_e,()=>e(C),ye=>p(C,ye)),Le(ue,()=>e(g),ye=>p(g,ye)),Le(Ie,()=>e(R),ye=>p(R,ye)),Le(Ze,()=>e(V),ye=>p(V,ye)),i(Y,z)};E(A,Y=>{e(c)?Y(T):Y(N,!1)},!0)}i(S,M)};E(Z,S=>{e(U)?S(j):S(de,!1)})}t(ee),i(P,ee)}});var o=l(y,2);Sa(o,{children:(P,K)=>{var ee=ce(),D=G(ee);{var J=ie=>{var Z=Ga(),j=a(Z);{var de=M=>{var A=Wa();i(M,A)},S=M=>{var A=at("Envoyer l'email de réinitialisation");i(M,A)};E(j,M=>{e(n)?M(de):M(S,!1)})}t(Z),B(()=>Z.disabled=e(n)),i(ie,Z)},le=ie=>{var Z=ce(),j=G(Z);{var de=M=>{var A=Ha(),T=a(A);{var N=z=>{var O=$a();i(z,O)},Y=z=>{var O=at("Se connecter");i(z,O)};E(T,z=>{e(n)?z(N):z(Y,!1)})}t(A),B(()=>A.disabled=e(n)),i(M,A)},S=M=>{var A=Ya(),T=a(A);{var N=z=>{var O=Ka();i(z,O)},Y=z=>{var O=at("Créer un compte");i(z,O)};E(T,z=>{e(n)?z(N):z(Y,!1)})}t(A),B(()=>A.disabled=e(n)),i(M,A)};E(j,M=>{e(c)?M(de):M(S,!1)},!0)}i(ie,Z)};E(D,ie=>{e(U)?ie(J):ie(le,!1)})}i(P,ee)}}),i(q,Be)},$$slots:{default:!0}}),be()}ke(["click"]);var Qa=_('<div class="flex h-[50vh] items-center justify-center"><!></div>'),Za=_('<div class="flex h-[80vh] flex-col items-center justify-center gap-4"><div class="loading loading-spinner loading-lg text-primary"></div> <p class="text-base-content/70 animate-pulse font-medium">Démarrage...</p></div>'),er=_("<!> <!>",1),tr=_('<link rel="preconnect" href="https://fonts.googleapis.com"/> <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""/> <link href="https://fonts.googleapis.com/css2?family=Cherry+Bomb+One&amp;family=Fredoka:wght@300..700&amp;display=swap&amp;family=Sora:wght@100..800&amp;display=swap" rel="stylesheet"/> <!> <div class="bg-base-200 min-h-screen"><!></div> <!> <!> <!> <!>',1);function ar(v,r){pe(r,!0);let d=$("BOOTING"),b=$(null);async function s(){try{if(p(d,"BOOTING"),await L.initializeAuth(),p(d,"READY"),L.isAuthenticated){const h=Ne.loading("Chargement des données...");Promise.all([Re.loadCache(),He.loadCache(),Ke.loadCache(),Ye.loadCache()]).then(async()=>(Ne.update(h,{state:"loading",message:"Mise à jour des données en cours..."}),Promise.all([Re.syncFromRemote(),He.syncFromRemote(),Ke.syncFromRemote(),We.syncFromRemote(),Ye.syncFromRemote()]))).then(async()=>{await Promise.all([He.setupRealtime(),Re.setupRealtime(),Ke.setupRealtime(),We.setupRealtime(),ft.initialize(),Ye.setupRealtime()]),await Xe.initialize(),Ne.update(h,{state:"success",message:"Données synchronisées",autoCloseDelay:2e3}),setTimeout(()=>{st("/dashboard"),st("/recipe")},3e3)}).catch(F=>{console.error("[App] Erreur synchro privée:",F),Ne.update(h,{state:"warning",message:"Mode hors ligne : données mises en cache",autoCloseDelay:5e3}),Xe.initialize().catch(console.error)})}else Re.loadCache().then(()=>Re.syncFromRemotePublicOnly()).then(()=>Promise.all([Re.setupRealtime(),Xe.initialize()])).then(()=>{setTimeout(()=>{st("/recipe")},2e3)}).catch(h=>{console.error("[App] Erreur synchro publique:",h)})}catch(h){console.error("[App] Erreur fatale d'initialisation:",h),p(b,h.message||"Erreur critique de chargement",!0),p(d,"ERROR")}}let c=$(!1),n=$(!1);Ve(()=>{const h=L.isAuthenticated;e(n)||e(d)!=="BOOTING"&&h!==e(c)&&(p(c,h,!0),console.log("[App] Changement d'état Auth détecté -> Rechargement"),p(n,!0),s().finally(()=>{p(n,!1)}))}),It(()=>{s()}),Tt(()=>{console.log("[App] Destruction de l'application - Nettoyage des stores..."),ft.destroy(),We.destroy(),He.destroy(),Re.destroy(),Ke.destroy(),Ye.destroy(),Xe.destroy()});let f=ve(()=>e(b)||Ot.error);async function u(){L.authModal.isOpen=!1,await L.refreshAuthAfterLogin()}var x=tr(),k=l(G(x),6);va(k,{});var C=l(k,2),g=a(C);{var R=h=>{var F=Qa(),Q=a(F);{let re=ve(()=>e(f)||"Erreur inconnue");bt(Q,{get message(){return e(re)}})}t(F),i(h,F)},V=h=>{var F=ce(),Q=G(F);{var re=H=>{var Ce=Za();i(H,Ce)},ne=H=>{Rt(H,{base:"#"})};E(Q,H=>{e(d)==="BOOTING"?H(re):H(ne,!1)},!0)}i(h,F)};E(g,h=>{e(d)==="ERROR"?h(R):h(V,!1)})}t(C);var W=l(C,2);ya(W,{});var U=l(W,2);wa(U,{});var I=l(U,2);{var w=h=>{var F=er(),Q=G(F);{var re=H=>{bt(H,{get message(){return e(f)}})};E(Q,H=>{e(f)&&H(re)})}var ne=l(Q,2);ka(ne,{}),i(h,F)};E(I,h=>{L.isAuthenticated&&h(w)})}var m=l(I,2);Ja(m,{get showLogin(){return L.authModal.showLogin},onAuth_success:u,get isOpen(){return L.authModal.isOpen},set isOpen(h){L.authModal.isOpen=h}}),i(v,x),be()}Ft(ar,{target:document.getElementById("app")});export{Ma as M,ir as a,Fa as b,La as c,Sa as d,or as e,ma as f,Oe as n,fa as s};
