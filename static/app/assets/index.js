var vt=u=>{throw TypeError(u)};var At=(u,r,s)=>r.has(u)||vt("Cannot "+s);var ke=(u,r,s)=>(At(u,r,"read from private field"),s?s.call(u):r.get(u)),ut=(u,r,s)=>r.has(u)?vt("Cannot add the same private member more than once"):r instanceof WeakSet?r.add(u):r.set(u,s);import{v as g,h as a,g as d,w as B,x as re,b as i,o as t,y as K,z as xt,m as e,A as m,B as Ae,d as be,p as de,e as Ge,C as Ee,u as ue,i as it,c as _e,D as Ze,E as wt,F as je,G as Z,H as mt,I as z,J as He,k as j,K as C,L as ze,M as Re,j as oe,s as Ye,N as Ne,O as Ue,P as Ct,t as It,Q as Pt,R as tt,S as at,T as qe,U as Ve,V as rt,W as Be,X as Lt,Y as Ot,Z as ft,_ as $e,$ as Ke,a0 as Xe,a1 as Je,a2 as st,a3 as Mt,a4 as Tt,a5 as Rt}from"./appwrite.js";import{C as kt,P as Ft,E as Dt,a as St,L as pt,b as Qe,U as zt,c as qt,B as Bt,R as Nt,d as Ut,e as Vt,f as Ht,g as Gt,X as Et,A as jt,h as Yt,i as Wt,M as nt,j as $t}from"./icons.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))h(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const o of c.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&h(o)}).observe(document,{childList:!0,subtree:!0});function s(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerPolicy&&(c.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?c.credentials="include":n.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function h(n){if(n.ep)return;n.ep=!0;const c=s(n);fetch(n.href,c)}})();var Kt=g('<div class="alert alert-error max-md:alert-vertical shadow-lg"><!> <div><h3 class="font-bold">Erreur</h3> <div class="text-sm"> </div></div></div>');function bt(u,r){var s=Kt(),h=a(s);kt(h,{class:"h-6 w-6 shrink-0 stroke-current"});var n=d(h,2),c=d(a(n),2),o=a(c,!0);t(c),t(n),t(s),B(()=>re(o,r.message)),i(u,s)}var pe;class Xt{constructor(){ut(this,pe,K(xt({title:""})))}get title(){return e(ke(this,pe)).title||"ENKA Cookbook"}get backAction(){return e(ke(this,pe)).backAction}get actions(){return e(ke(this,pe)).actions}get isLockedByOthers(){return e(ke(this,pe)).isLockedByOthers||!1}get lockedByUserName(){return e(ke(this,pe)).lockedByUserName||""}get hasUnsavedChanges(){return e(ke(this,pe)).hasUnsavedChanges||!1}setConfig(r){m(ke(this,pe),{...r},!0)}reset(){m(ke(this,pe),{title:""},!0)}}pe=new WeakMap;const Fe=new Xt;var Jt=g("<button> </button>"),Qt=g('<div class="rounded-box bg-secondary/10 px-4 py-1"><div class="tabs tabs-border justify-center"></div></div>');function _t(u,r){be(r,!0);let s=de(r,"basePath",3,"/dashboard/eventEdit");const h=[{label:"Éditer l'événement",relativePath:""},{label:"Voir les recettes",relativePath:"recipes"},{label:"Listes des produits",relativePath:"products"},{label:"Affiches",relativePath:"posters"}],n=ue(()=>{const v=Ze.pathname;return v.includes(`${s()}/recipes/`)?1:v.includes(`${s()}/products/`)?2:v.includes(`${s()}/posters/`)?3:(v.includes(s())&&r.eventId&&new RegExp(`${s()}/${r.eventId}(/?$)`).test(v),0)});function c(v){if(!r.eventId)return;const x=h[v].relativePath,k=x?`${s()}/${x}/${r.eventId}`:`${s()}/${r.eventId}`;wt(k)}var o=Qt(),p=a(o);Ge(p,21,()=>h,it,(v,x,k)=>{var E=Jt();E.__click=()=>c(k);var y=a(E,!0);t(E),B(()=>{Ee(E,1,`tab font-semibold ${k===e(n)?"tab-active":""}`),re(y,e(x).label)}),i(v,E)}),t(p),t(o),i(u,o),_e()}Ae(["click"]);var Zt=g("<button> </button>"),ea=g('<div class="tabs tabs-lg tabs-border justify-center"></div>');function ht(u,r){be(r,!0);const s=[{label:"Matériel",getPath:()=>n()},{label:"Reservations",getPath:()=>c()}],h=ue(()=>Ze.pathname.includes("/loans")?1:0);function n(){if(r.currentTeamId)return`/dashboard/materiel/${r.currentTeamId}`;const v=je.myTeams;return v.length>0?`/dashboard/materiel/${v[0].$id}`:"/dashboard/materiel"}function c(){if(r.currentTeamId)return`/dashboard/loans/${r.currentTeamId}`;const v=je.myTeams;return v.length>0?`/dashboard/loans/${v[0].$id}`:"/dashboard/loans"}function o(v){const x=s[v].getPath();wt(x)}var p=ea();Ge(p,21,()=>s,it,(v,x,k)=>{var E=Zt();E.__click=()=>o(k);var y=a(E,!0);t(E),B(()=>{Ee(E,1,`tab font-medium ${k===e(h)?"tab-active":""}`),re(y,e(x).label)}),i(v,E)}),t(p),i(u,p),_e()}Ae(["click"]);var ta=g('<div class="rounded-box bg-secondary/10 px-4 py-1"><div class="tabs tabs-border justify-center"><button><!> Édition</button> <button><!> Aperçu</button></div></div>');function gt(u,r){be(r,!0);const s=ue(()=>mt.get("mode")||"preview");function h(y){mt.set("mode",y)}var n=ta(),c=a(n),o=a(c);let p;o.__click=()=>h("edit");var v=a(o);Ft(v,{class:"h-4 w-4"}),Z(),t(o);var x=d(o,2);let k;x.__click=()=>h("preview");var E=a(x);Dt(E,{class:"h-4 w-4"}),Z(),t(x),t(c),t(n),B(()=>{p=Ee(o,1,"tab gap-2 font-semibold",null,p,{"tab-active":e(s)==="edit"}),k=Ee(x,1,"tab gap-2 font-semibold",null,k,{"tab-active":e(s)==="preview"})}),i(u,n),_e()}Ae(["click"]);var aa=g('<a class="btn btn-ghost not-md:btn-square md:gap-2"><!> <span class="hidden md:inline">Tableau de bord</span></a>'),ra=g('<h1 class="font-family-fredoka truncate text-sm font-bold tracking-wider uppercase opacity-70"> </h1>'),sa=g('<div class="navbar-center absolute left-1/2 -translate-x-1/2 transform"><!></div>'),na=g('<div class="badge badge-warning flex items-center gap-1 py-3 font-medium"><!> <span class="text-xs"> </span></div>'),ia=g('<div class="dropdown dropdown-end"><div tabindex="0" role="button" class="btn btn-ghost btn-circle avatar bg-primary/10 text-primary border-primary/20 border"><div class="flex w-10 items-center justify-center rounded-full text-lg font-bold"> </div></div> <ul class="menu menu-sm dropdown-content bg-base-100 border-base-200 z-1 mt-3 w-56 rounded-xl border p-2 shadow-xl"><li class="border-base-100 mb-1 border-b px-4 py-2"><span class="block truncate p-0 text-xs font-medium italic opacity-60"> </span></li> <li><a class="flex items-center gap-2"><!> Dashboard</a></li> <li><a class="flex items-center gap-2"><!> Équipes</a></li> <li><a class="flex items-center gap-2"><!> Nouvel événement</a></li> <li><a class="flex items-center gap-2"><!> Recettes</a></li> <li><button class="disabled:opacity-50"><!> </button></li> <!> <li class="border-base-100 my-1 border-t"></li> <li><button class="text-error hover:bg-error/10"><!> Se déconnecter</button></li></ul></div>'),oa=g('<button class="btn btn-primary btn-sm shadow-md"><!> Connexion</button>'),la=g('<h1 class="text-center text-sm font-bold tracking-wider uppercase opacity-70"> </h1>'),da=g('<div class="border-base-300 bg-base-100 border-b px-4 py-3"><!></div>'),ca=g('<div><div class="navbar-start w-fit shrink-0 gap-1"><a class="btn btn-ghost btn-circle"><img src="images/favicon.png" alt="logo" class="h-8 w-8"/></a> <div class=" flex items-center gap-1"><!> <a class="btn btn-ghost not-md:btn-square md:gap-2"><!> <span class="hidden md:inline">Recettes</span></a></div></div> <!> <div class="navbar-end ms-auto w-fit shrink-0 gap-4"><!> <div class="flex items-center gap-2"><!></div> <!></div></div> <!>',1);function va(u,r){be(r,!0);let s=K(!1),h=K(!1);const n=ue(()=>{const _=Ze.pathname,l=Ze.params;return _.includes("/dashboard/eventEdit/")&&l.id?{type:"eventEdit",basePath:"/dashboard/eventEdit",eventId:l.id}:_.includes("/demo/event/")&&l.id?{type:"eventEdit",basePath:"/demo/event",eventId:l.id}:_.includes("/dashboard/materiel/")&&l.teamId?{type:"materiel",teamId:l.teamId}:_.includes("/dashboard/loans/")&&l.teamId?{type:"loans",teamId:l.teamId}:_.includes("/editdocument/")&&l.teamId&&l.docId?{type:"documentEdit",teamId:l.teamId,docId:l.docId}:null});z.isMobile&&z.initializeScrollDirection();function c(){m(s,!1)}async function o(){try{await z.logout(),window.location.href="/"}catch(_){console.error("Erreur lors de la déconnexion:",_)}}function p(){z.authModal.showLogin=!0,z.authModal.isOpen=!0}async function v(){if(z.userId){m(h,!0);try{await Ne.forceReloadAllRecipes(),c()}catch(_){console.error("Erreur lors du rechargement des recettes:",_),alert("Erreur lors du rechargement des recettes")}finally{m(h,!1)}}}function x(_){_.target.closest(".svelte-user-dropdown")||c()}He(()=>{if(e(s))return document.addEventListener("click",x),()=>document.removeEventListener("click",x)});var k=ca(),E=j(k),y=a(E),T=a(y),U=d(T,2),Y=a(U);{var V=_=>{var l=aa(),A=a(l);pt(A,{size:18}),Z(2),t(l),B(W=>Re(l,"href",W),[()=>ze("#/dashboard")]),i(_,l)};C(Y,_=>{z.isAuthenticated&&_(V)})}var L=d(Y,2),w=a(L);St(w,{size:18}),Z(2),t(L),t(U),t(y);var f=d(y,2);{var b=_=>{var l=sa(),A=a(l);{var W=D=>{ht(D,{get currentTeamId(){return e(n).teamId}})},H=D=>{var $=oe(),ne=j($);{var ee=G=>{_t(G,{get eventId(){return e(n).eventId},get basePath(){return e(n).basePath}})},J=G=>{var ve=oe(),q=j(ve);{var I=O=>{gt(O,{})},P=O=>{var N=ra(),Q=a(N,!0);t(N),B(()=>{Re(N,"title",Fe.title),re(Q,Fe.title)}),i(O,N)};C(q,O=>{e(n)?.type==="documentEdit"?O(I):O(P,!1)},!0)}i(G,ve)};C(ne,G=>{e(n)?.type==="eventEdit"?G(ee):G(J,!1)},!0)}i(D,$)};C(A,D=>{e(n)?.type==="materiel"||e(n)?.type==="loans"?D(W):D(H,!1)})}t(l),i(_,l)};C(f,_=>{z.isDesktop&&_(b)})}var R=d(f,2),te=a(R);{var se=_=>{var l=na(),A=a(l);Qe(A,{size:14});var W=d(A,2),H=a(W);t(W),t(l),B(()=>re(H,`Édition par ${Fe.lockedByUserName??""}`)),i(_,l)};C(te,_=>{Fe.isLockedByOthers&&_(se)})}var le=d(te,2),X=a(le);{var he=_=>{var l=oe(),A=j(l);Ye(A,()=>Fe.actions),i(_,l)};C(X,_=>{Fe.actions&&_(he)})}t(le);var we=d(le,2);{var F=_=>{var l=ia(),A=a(l),W=a(A),H=a(W,!0);t(W),t(A);var D=d(A,2),$=a(D),ne=a($),ee=a(ne,!0);t(ne),t($);var J=d($,2),G=a(J),ve=a(G);pt(ve,{size:16}),Z(),t(G),t(J);var q=d(J,2),I=a(q),P=a(I);zt(P,{size:16}),Z(),t(I),t(q);var O=d(q,2),N=a(O),Q=a(N);qt(Q,{size:16}),Z(),t(N),t(O);var S=d(O,2),M=a(S),ae=a(M);Bt(ae,{size:16}),Z(),t(M),t(S);var ie=d(S,2),ge=a(ie);ge.__click=v;var ye=a(ge);{let fe=ue(()=>e(h)?"animate-spin":"");Nt(ye,{size:16,get class(){return e(fe)}})}var Pe=d(ye);t(ge),t(ie);var Le=d(ie,2);C(Le,fe=>{});var Oe=d(Le,4),me=a(Oe);me.__click=o;var Me=a(me);Ut(Me,{size:16}),Z(),t(me),t(Oe),t(D),t(l),B((fe,Se,Te,xe,We)=>{re(H,fe),re(ee,z.user?.email),Re(G,"href",Se),Re(I,"href",Te),Re(N,"href",xe),Re(M,"href",We),ge.disabled=e(h),re(Pe,` ${e(h)?"Chargement...":"Recharger les recettes"}`)},[()=>z.user?.name?.charAt(0).toUpperCase()||"U",()=>ze("#/dashboard"),()=>ze("#/dashboard/teams"),()=>ze("#/dashboard/eventCreate"),()=>ze("#/recipe")]),i(_,l)},De=_=>{var l=oa();l.__click=p;var A=a(l);Vt(A,{size:16}),Z(),t(l),i(_,l)};C(we,_=>{z.isAuthenticated?_(F):_(De,!1)})}t(R),t(E);var Ie=d(E,2);{var ce=_=>{var l=da(),A=a(l);{var W=D=>{ht(D,{get currentTeamId(){return e(n).teamId}})},H=D=>{var $=oe(),ne=j($);{var ee=G=>{_t(G,{get eventId(){return e(n).eventId},get basePath(){return e(n).basePath}})},J=G=>{var ve=oe(),q=j(ve);{var I=O=>{gt(O,{})},P=O=>{var N=oe(),Q=j(N);{var S=M=>{var ae=la(),ie=a(ae,!0);t(ae),B(()=>re(ie,Fe.title)),i(M,ae)};C(Q,M=>{Fe.title&&M(S)},!0)}i(O,N)};C(q,O=>{e(n)?.type==="documentEdit"?O(I):O(P,!1)},!0)}i(G,ve)};C(ne,G=>{e(n)?.type==="eventEdit"?G(ee):G(J,!1)},!0)}i(D,$)};C(A,D=>{e(n)?.type==="materiel"||e(n)?.type==="loans"?D(W):D(H,!1)})}t(l),i(_,l)};C(Ie,_=>{z.isDesktop||_(ce)})}B((_,l)=>{Ee(E,1,`navbar bg-base-100 border-base-300 sticky top-0 z-1000 min-h-13 border-b px-4 py-0 shadow-sm print:hidden ${(z.isMobile&&"min-h-11")??""} ${(z.isMobile&&!z.headerVisible&&"-translate-y-full")??""} transition-transform duration-300`),Re(T,"href",_),Re(L,"href",l)},[()=>ze("#/"),()=>ze("#/recipe")]),i(u,k),_e()}Ae(["click"]);const ua=u=>u;function ot(u){const r=u-1;return r*r*r+1}function yt(u){const r=typeof u=="string"&&u.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return r?[parseFloat(r[1]),r[2]||"px"]:[u,"px"]}function ma(u,{delay:r=0,duration:s=400,easing:h=ua}={}){const n=+getComputedStyle(u).opacity;return{delay:r,duration:s,easing:h,css:c=>`opacity: ${c*n}`}}function ir(u,{delay:r=0,duration:s=400,easing:h=ot,x:n=0,y:c=0,opacity:o=0}={}){const p=getComputedStyle(u),v=+p.opacity,x=p.transform==="none"?"":p.transform,k=v*(1-o),[E,y]=yt(n),[T,U]=yt(c);return{delay:r,duration:s,easing:h,css:(Y,V)=>`
			transform: ${x} translate(${(1-Y)*E}${y}, ${(1-Y)*T}${U});
			opacity: ${v-k*V}`}}function fa(u,{delay:r=0,duration:s=400,easing:h=ot,axis:n="y"}={}){const c=getComputedStyle(u),o=+c.opacity,p=n==="y"?"height":"width",v=parseFloat(c[p]),x=n==="y"?["top","bottom"]:["left","right"],k=x.map(L=>`${L[0].toUpperCase()}${L.slice(1)}`),E=parseFloat(c[`padding${k[0]}`]),y=parseFloat(c[`padding${k[1]}`]),T=parseFloat(c[`margin${k[0]}`]),U=parseFloat(c[`margin${k[1]}`]),Y=parseFloat(c[`border${k[0]}Width`]),V=parseFloat(c[`border${k[1]}Width`]);return{delay:r,duration:s,easing:h,css:L=>`overflow: hidden;opacity: ${Math.min(L*20,1)*o};${p}: ${L*v}px;padding-${x[0]}: ${L*E}px;padding-${x[1]}: ${L*y}px;margin-${x[0]}: ${L*T}px;margin-${x[1]}: ${L*U}px;border-${x[0]}-width: ${L*Y}px;border-${x[1]}-width: ${L*V}px;min-${p}: 0`}}function or(u,{delay:r=0,duration:s=400,easing:h=ot,start:n=0,opacity:c=0}={}){const o=getComputedStyle(u),p=+o.opacity,v=o.transform==="none"?"":o.transform,x=1-n,k=p*(1-c);return{delay:r,duration:s,easing:h,css:(E,y)=>`
			transform: ${v} scale(${1-x*y});
			opacity: ${p-k*y}
		`}}var pa=g('<button class="btn btn-sm btn-primary"> </button>'),ba=g('<button class="btn btn-ghost btn-xs btn-square" title="Voir les détails" aria-label="Voir les détails"><!></button>'),_a=g('<button class="btn btn-ghost btn-xs btn-circle pe-0" title="Fermer" aria-label="Fermer la notification"><!></button>'),ha=g('<div><div class="flex items-center justify-between gap-4"><div class="flex flex-1 items-center gap-2"><!> <span class="text-sm"> </span></div> <!> <!> <!></div></div>'),ga=g("<div></div>");function ya(u,r){be(r,!0);let s=de(r,"position",3,"toast-center toast-bottom"),h=de(r,"padding",3,"sm");const n=ue(()=>h()==="sm"?" py-0.5":"py-1"),c=ue(()=>Ue.toasts),o=ue(()=>()=>{const y=new Map;for(const T of e(c)){const U=T.position||s();y.has(U)||y.set(U,[]),y.get(U).push(T)}return y});function p(y){Ue.dismiss(y.id)}function v(y){r.onShowDetails?.({id:y.id,message:y.message,details:y.details})}function x(y,T){T.onClick()}var k=oe(),E=j(k);Ge(E,17,()=>Array.from(e(o)().entries()),([y,T])=>y,(y,T)=>{var U=ue(()=>It(e(T),2));let Y=()=>e(U)[0],V=()=>e(U)[1];var L=ga();Ge(L,21,V,w=>w.id,(w,f)=>{var b=ha(),R=a(b),te=a(R),se=a(te);{var le=l=>{Ht(l,{class:"h-5 w-5 animate-spin"})};C(se,l=>{e(f).state==="loading"&&l(le)})}var X=d(se,2),he=a(X,!0);t(X),t(te);var we=d(te,2);{var F=l=>{var A=oe(),W=j(A);Ge(W,17,()=>e(f).actions,it,(H,D)=>{var $=pa();$.__click=()=>x(e(f),e(D));var ne=a($,!0);t($),B(()=>re(ne,e(D).label)),i(H,$)}),i(l,A)};C(we,l=>{e(f).actions&&e(f).actions.length>0&&l(F)})}var De=d(we,2);{var Ie=l=>{var A=ba();A.__click=()=>v(e(f));var W=a(A);Gt(W,{class:"h-3 w-3"}),t(A),i(l,A)};C(De,l=>{e(f).details&&l(Ie)})}var ce=d(De,2);{var _=l=>{var A=_a();A.__click=()=>p(e(f));var W=a(A);Et(W,{class:"h-4 w-4"}),t(A),i(l,A)};C(ce,l=>{(e(f).state==="error"||e(f).state==="warning"||e(f).state==="loading")&&l(_)})}t(R),t(b),B(()=>{Ee(b,1,`alert alert-${e(f).state??""}  ${e(n)??""} shadow-lg`),re(he,e(f).message)}),Ct(3,b,()=>fa),i(w,b)}),t(L),B(()=>Ee(L,1,`toast ${Y()??""} z-1050`)),i(y,L)}),i(u,k),_e()}Ae(["click"]);var xa=g('<button class="btn btn-primary btn-circle fixed right-6 bottom-6 z-50 rounded-full shadow-lg" aria-label="Retour en haut de page"><!></button>');function wa(u,r){be(r,!0);let s=ue(()=>(Pt.current||0)>300);function h(){window.scrollTo({top:0,behavior:"smooth"})}var n=oe(),c=j(n);{var o=p=>{var v=xa();v.__click=h;var x=a(v);jt(x,{class:"h-6 w-6"}),t(v),Ct(3,v,()=>ma),i(p,v)};C(c,p=>{e(s)&&p(o)})}i(u,n),_e()}Ae(["click"]);function Ca(u,r){be(r,!0),_e()}var ka=g('<div role="dialog" aria-modal="true"><!></div>'),Ea=g('<div class="modal modal-open" style="z-index: 1100"><div class="modal-box max-w-md"><h3 class="text-lg font-bold">Confirmer la fermeture</h3> <p class="py-4"> </p> <div class="modal-action"><button class="btn btn-ghost">Annuler</button> <button class="btn btn-error">Fermer sans sauvegarder</button></div></div></div>'),Aa=g("<div><!></div> <!>",1);function Ia(u,r){be(r,!0);let s=de(r,"fullscreenOnMobile",3,!0);de(r,"closeOnBackdropClick",3,!1);let h=de(r,"hasUnsavedChanges",3,!1),n=de(r,"confirmCloseMessage",3,"Vous avez des modifications non sauvegardées. Voulez-vous vraiment fermer ?"),c=de(r,"maxWidth",3,"lg");de(r,"maxHeight",3,"xl");let o=de(r,"modalClass",3,"");function p(w,f){return{sm:{"max-w":"max-w-[28rem]","max-h":"max-h-[85dvh]"},lg:{"max-w":"max-w-[64rem]","max-h":"max-h-[85dvh]"},xl:{"max-w":"max-w-[90vw]","max-h":"max-h-[85dvh]"}}[w][f]}let v=K(!1);function x(){h()?m(v,!0):r.onClose()}function k(){m(v,!1),r.onClose()}function E(){m(v,!1)}He(()=>{if(!r.isOpen)return;const w=f=>{f.key==="Escape"&&!e(v)&&x()};return window.addEventListener("keydown",w),()=>window.removeEventListener("keydown",w)}),He(()=>{if(r.isOpen)return document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}});var y=Aa(),T=j(y),U=a(T);{var Y=w=>{var f=ka(),b=a(f);Ye(b,()=>r.children),t(f),B(R=>Ee(f,1,`modal-box flex flex-col p-0 ${o()??""} ${s()&&z.isMobile?"fixed inset-0 m-0 h-lvh w-lvw rounded-none":"fixed top-10 m-auto "} ${R??""} ${!(s()&&z.isMobile)&&!o()&&"max-h-[85dvh]"}`),[()=>!(s()&&z.isMobile)&&p(c(),"max-w")]),i(w,f)};C(U,w=>{r.isOpen&&w(Y)})}t(T);var V=d(T,2);{var L=w=>{var f=Ea(),b=a(f),R=d(a(b),2),te=a(R,!0);t(R);var se=d(R,2),le=a(se);le.__click=E;var X=d(le,2);X.__click=k,t(se),t(b),t(f),B(()=>re(te,n())),i(w,f)};C(V,w=>{e(v)&&w(L)})}B(()=>Ee(T,1,`modal ${(r.isOpen&&"modal-open")??""} `)),i(u,y),_e()}Ae(["click"]);var Pa=g('<button class="btn btn-circle btn-ghost btn-sm flex-none" aria-label="Retour"><!></button>'),La=g('<button class="btn btn-circle btn-ghost btn-sm flex-none" aria-label="Retour"><!></button>'),Oa=g('<p class="text-base-content/70 truncate text-sm"> </p>'),Ma=g('<div class="flex items-center gap-2 sm:me-10"><!></div>'),Ta=g('<div class="border-base-300 flex-none border-b px-4 py-3"><div class="absolute top-2 right-2"><!></div> <div class="flex flex-wrap items-center gap-2"><div class="flex min-w-0 flex-1 items-center gap-2"><!> <div class="max-w-11/12 min-w-0 flex-1 items-baseline"><h3 class="truncate text-lg font-bold"> </h3> <!></div></div> <!></div></div>');function Ra(u,r){be(r,!0);let s=de(r,"showBackButton",3,!0);var h=Ta(),n=a(h),c=a(n);{var o=w=>{var f=Pa();f.__click=function(...R){r.onClose?.apply(this,R)};var b=a(f);Et(b,{class:"h-5 w-5"}),t(f),i(w,f)};C(c,w=>{z.isMobile||w(o)})}t(n);var p=d(n,2),v=a(p),x=a(v);{var k=w=>{var f=La();f.__click=function(...R){r.onClose?.apply(this,R)};var b=a(f);Yt(b,{class:"h-5 w-5"}),t(f),i(w,f)};C(x,w=>{s()&&z.isMobile&&w(k)})}var E=d(x,2),y=a(E),T=a(y,!0);t(y);var U=d(y,2);{var Y=w=>{var f=Oa(),b=a(f,!0);t(f),B(()=>re(b,r.subtitle)),i(w,f)};C(U,w=>{r.subtitle&&w(Y)})}t(E),t(v);var V=d(v,2);{var L=w=>{var f=Ma(),b=a(f);Ye(b,()=>r.children),t(f),i(w,f)};C(V,w=>{r.children&&w(L)})}t(p),t(h),B(()=>re(T,r.title)),i(u,h),_e()}Ae(["click"]);var Fa=g('<div class="flex-1 overflow-y-auto p-4 sm:p-6 sm:pt-2"><!></div>');function Da(u,r){var s=Fa(),h=a(s);Ye(h,()=>r.children),t(s),i(u,s)}var Sa=g('<div class="border-base-300 flex-none border-t px-4 py-3"><div class="flex flex-wrap items-center justify-end gap-2"><!></div></div>');function za(u,r){var s=Sa(),h=a(s),n=a(h);Ye(n,()=>r.children),t(h),t(s),i(u,s)}var qa=g('<div role="alert" class="alert alert-error max-md:alert-vertical svelte-o861tn"><!> <span> </span></div>'),Ba=g('<div role="alert" class="alert alert-success max-md:alert-vertical svelte-o861tn"><!> <span> </span></div>'),Na=g(`<form id="forgotForm" class="space-y-4 svelte-o861tn"><fieldset class="svelte-o861tn"><label class="input validator w-full required"><!> <input type="email" placeholder="votre@email.com" required aria-required="true"/></label> <span class="validator-hint hidden">Adresse email valide requise</span></fieldset> <div class="alert alert-info alert-soft svelte-o861tn">Un email avec un lien vous sera envoyé pour renouveller votre mot de
            passe.". Pensez à vérifier s'il n'a pas attéri dans votre dossier
            spam.</div></form> <div class="text-center svelte-o861tn"><button class="btn btn-ghost btn-sm">← Retour à la connexion</button></div>`,1),Ua=g(`<form id="loginForm" class="space-y-4 svelte-o861tn"><fieldset class="svelte-o861tn"><label class="input validator w-full required"><!> <input type="email" placeholder="votre@email.com" required aria-required="true"/></label> <span class="validator-hint hidden">Adresse email valide requise</span></fieldset> <fieldset class="svelte-o861tn"><label class="input validator w-full required"><!> <input type="password" placeholder="Mot de passe" required aria-required="true"/></label> <span class="validator-hint hidden">Mot de passe requis</span></fieldset></form> <div class="space-y-2 text-center svelte-o861tn"><button class="btn btn-link btn-sm btn-primary svelte-o861tn">Mot de passe oublié ?</button> <div class="text-base-content/70 text-sm svelte-o861tn">Pas encore de compte ? <button class="btn btn-primary btn-sm btn-soft ms-1">S'inscrire</button></div></div>`,1),Va=g(`<form id="registerForm" class="space-y-4 svelte-o861tn"><fieldset class="svelte-o861tn"><label class="input validator w-full required"><!> <input type="text" placeholder="Votre nom" required aria-required="true" minlength="3" maxlength="25"/></label> <span class="validator-hint hidden">Doit comporter entre 3 et 25 caractères.</span></fieldset> <fieldset class="svelte-o861tn"><label class="input validator w-full required"><!> <input type="email" placeholder="votre@email.com" required aria-required="true"/></label> <span class="validator-hint hidden">Adresse email valide requise</span></fieldset> <fieldset class="svelte-o861tn"><label class="input validator w-full required"><!> <input type="password" placeholder="Mot de passe" required aria-required="true" minlength="8" maxlength="25"/></label> <span class="validator-hint hidden">Doit comporter entre 8 et 25 caractères.</span></fieldset> <fieldset class="svelte-o861tn"><label class="input validator w-full required"><!> <input type="password" placeholder="Confirmer le mot de passe" required aria-required="true" minlength="8" maxlength="25"/></label> <span class="validator-hint hidden">Doit être identique au mot de passe ci-dessus.</span></fieldset> <div class="alert alert-info alert-soft svelte-o861tn">Un email avec un lien vous sera envoyé. Pensez à vérifier s'il n'a
            pas attéri dans votre dossier spam.</div></form> <div class="text-base-content/70 text-center text-sm svelte-o861tn">Déjà un compte ? <button class="btn btn-soft btn-sm btn-primary ms-1">Se connecter</button></div>`,1),Ha=g('<div class="space-y-4 py-4 svelte-o861tn"><!> <!> <!></div>'),Ga=g('<span class="loading loading-spinner"></span>'),ja=g('<button form="forgotForm" type="submit" class="btn btn-primary btn-block"><!></button>'),Ya=g('<span class="loading loading-spinner"></span>'),Wa=g('<button form="loginForm" type="submit" class="btn btn-primary btn-block"><!></button>'),$a=g('<span class="loading loading-spinner"></span>'),Ka=g('<button form="registerForm" type="submit" class="btn btn-success btn-block"><!></button>'),Xa=g("<!> <!> <!>",1);function Ja(u,r){be(r,!0);let s=de(r,"isOpen",15),h=de(r,"onAuth_success",3,async()=>{}),n=de(r,"showLogin",3,!0),c=K(xt(n())),o=K(!1),p=K(""),v=K("");He(()=>{s()&&(m(c,n()),m(V,!1))});let x=K(""),k=K(""),E=K(""),y=K(""),T=K(""),U=K(""),Y=K(""),V=K(!1),L,w,f;async function b(F){if(F.preventDefault(),!L.checkValidity()){L.reportValidity(),m(p,"Formulaire invalide. Veuillez vérifier les champs.");return}m(p,""),await se()}async function R(F){if(F.preventDefault(),e(T)!==e(U)){m(p,"Les mots de passe ne correspondent pas.");return}if(!w.checkValidity()){w.reportValidity(),m(p,"Formulaire invalide. Veuillez vérifier les champs.");return}m(p,""),await le()}async function te(F){if(F.preventDefault(),!f.checkValidity()){f.reportValidity(),m(p,"Formulaire invalide. Veuillez vérifier les champs.");return}m(p,""),await X()}async function se(){m(o,!0);try{const{account:F}=await rt();await F.createEmailPasswordSession({email:e(x),password:e(k)}),m(v,"Connexion réussie !"),setTimeout(()=>{h()()},1e3)}catch(F){console.error("Erreur de connexion:",F),m(p,F.message||"Erreur lors de la connexion",!0)}finally{m(o,!1)}}async function le(){m(o,!0);try{const{account:F}=await rt();await F.create({userId:"unique()",email:e(y),password:e(T),name:e(E)}),await F.createEmailPasswordSession({email:e(y),password:e(T)}),m(v,"Compte créé et connecté !"),setTimeout(()=>{h()()},1e3)}catch(F){console.error("Erreur d'inscription:",F),m(p,F.message||"Erreur lors de la création du compte",!0)}finally{m(o,!1)}}async function X(){m(o,!0);try{const{account:F}=await rt();await F.createRecovery({email:e(Y),url:`${window.location.origin}/#/reset-password`}),m(v,"Email de réinitialisation envoyé !"),setTimeout(()=>{m(V,!1),m(Y,"")},2e3)}catch(F){console.error("Erreur mot de passe oublié:",F),m(p,F.message||"Erreur lors de l'envoi de l'email",!0)}finally{m(o,!1)}}function he(){e(o)||s(!1)}He(()=>{(e(c)||e(V))&&(m(p,""),m(v,""))});function we(){return e(V)?"Mot de passe oublié":e(c)?"Connexion":"Inscription"}Ia(u,{get isOpen(){return s()},onClose:he,maxWidth:"sm",children:(F,De)=>{var Ie=Xa(),ce=j(Ie);{let A=ue(we);Ra(ce,{get title(){return e(A)},onClose:he})}var _=d(ce,2);Da(_,{children:(A,W)=>{var H=Ha(),D=a(H);{var $=q=>{var I=qa(),P=a(I);kt(P,{class:"h-6 w-6 shrink-0 stroke-current"});var O=d(P,2),N=a(O,!0);t(O),t(I),B(()=>re(N,e(p))),i(q,I)};C(D,q=>{e(p)&&q($)})}var ne=d(D,2);{var ee=q=>{var I=Ba(),P=a(I);Wt(P,{class:"h-6 w-6 shrink-0 stroke-current"});var O=d(P,2),N=a(O,!0);t(O),t(I),B(()=>re(N,e(v))),i(q,I)};C(ne,q=>{e(v)&&q(ee)})}var J=d(ne,2);{var G=q=>{var I=Na(),P=j(I),O=a(P),N=a(O),Q=a(N);nt(Q,{class:"h-4 w-4 opacity-50"});var S=d(Q,2);Be(S),t(N),Z(2),t(O),Z(2),t(P),tt(P,ie=>f=ie,()=>f);var M=d(P,2),ae=a(M);ae.__click=()=>m(V,!1),t(M),B(()=>{S.disabled=e(o),ae.disabled=e(o)}),at("submit",P,te),qe(S,()=>e(Y),ie=>m(Y,ie)),i(q,I)},ve=q=>{var I=oe(),P=j(I);{var O=Q=>{var S=Ua(),M=j(S),ae=a(M),ie=a(ae),ge=a(ie);nt(ge,{class:"h-4 w-4 opacity-50"});var ye=d(ge,2);Be(ye),t(ie),Z(2),t(ae);var Pe=d(ae,2),Le=a(Pe),Oe=a(Le);Qe(Oe,{class:"h-4 w-4 opacity-50"});var me=d(Oe,2);Be(me),t(Le),Z(2),t(Pe),t(M),tt(M,xe=>L=xe,()=>L);var Me=d(M,2),fe=a(Me);fe.__click=()=>m(V,!0);var Se=d(fe,2),Te=d(a(Se));Te.__click=()=>m(c,!1),t(Se),t(Me),B(()=>{ye.disabled=e(o),me.disabled=e(o),fe.disabled=e(o),Te.disabled=e(o)}),at("submit",M,b),qe(ye,()=>e(x),xe=>m(x,xe)),qe(me,()=>e(k),xe=>m(k,xe)),i(Q,S)},N=Q=>{var S=Va(),M=j(S),ae=a(M),ie=a(ae),ge=a(ie);$t(ge,{class:"h-4 w-4 opacity-50"});var ye=d(ge,2);Be(ye),t(ie),Z(2),t(ae);var Pe=d(ae,2),Le=a(Pe),Oe=a(Le);nt(Oe,{class:"h-4 w-4 opacity-50"});var me=d(Oe,2);Be(me),t(Le),Z(2),t(Pe);var Me=d(Pe,2),fe=a(Me),Se=a(fe);Qe(Se,{class:"h-4 w-4 opacity-50"});var Te=d(Se,2);Be(Te),t(fe),Z(2),t(Me);var xe=d(Me,2),We=a(xe),lt=a(We);Qe(lt,{class:"h-4 w-4 opacity-50"});var et=d(lt,2);Be(et),t(We),Z(2),t(xe),Z(2),t(M),tt(M,Ce=>w=Ce,()=>w);var dt=d(M,2),ct=d(a(dt));ct.__click=()=>m(c,!0),t(dt),B(()=>{ye.disabled=e(o),me.disabled=e(o),Te.disabled=e(o),et.disabled=e(o),ct.disabled=e(o)}),at("submit",M,R),qe(ye,()=>e(E),Ce=>m(E,Ce)),qe(me,()=>e(y),Ce=>m(y,Ce)),qe(Te,()=>e(T),Ce=>m(T,Ce)),qe(et,()=>e(U),Ce=>m(U,Ce)),i(Q,S)};C(P,Q=>{e(c)?Q(O):Q(N,!1)},!0)}i(q,I)};C(J,q=>{e(V)?q(G):q(ve,!1)})}t(H),i(A,H)}});var l=d(_,2);za(l,{children:(A,W)=>{var H=oe(),D=j(H);{var $=ee=>{var J=ja(),G=a(J);{var ve=I=>{var P=Ga();i(I,P)},q=I=>{var P=Ve("Envoyer l'email de réinitialisation");i(I,P)};C(G,I=>{e(o)?I(ve):I(q,!1)})}t(J),B(()=>J.disabled=e(o)),i(ee,J)},ne=ee=>{var J=oe(),G=j(J);{var ve=I=>{var P=Wa(),O=a(P);{var N=S=>{var M=Ya();i(S,M)},Q=S=>{var M=Ve("Se connecter");i(S,M)};C(O,S=>{e(o)?S(N):S(Q,!1)})}t(P),B(()=>P.disabled=e(o)),i(I,P)},q=I=>{var P=Ka(),O=a(P);{var N=S=>{var M=$a();i(S,M)},Q=S=>{var M=Ve("Créer un compte");i(S,M)};C(O,S=>{e(o)?S(N):S(Q,!1)})}t(P),B(()=>P.disabled=e(o)),i(I,P)};C(G,I=>{e(c)?I(ve):I(q,!1)},!0)}i(ee,J)};C(D,ee=>{e(V)?ee($):ee(ne,!1)})}i(A,H)}}),i(F,Ie)},$$slots:{default:!0}}),_e()}Ae(["click"]);var Qa=g('<div class="flex h-[50vh] items-center justify-center"><!></div>'),Za=g('<div class="flex h-[80vh] flex-col items-center justify-center gap-4"><div class="loading loading-spinner loading-lg text-primary"></div> <p class="text-base-content/70 animate-pulse font-medium"><!></p></div>'),er=g("<!> <!>",1),tr=g('<link rel="preconnect" href="https://fonts.googleapis.com"/> <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""/> <link href="https://fonts.googleapis.com/css2?family=Cherry+Bomb+One&amp;family=Fredoka:wght@300..700&amp;display=swap&amp;family=Sora:wght@100..800&amp;display=swap" rel="stylesheet"/> <!> <div class="bg-base-200 min-h-screen"><!></div> <!> <!> <!> <!>',1);function ar(u,r){be(r,!0);let s=K("BOOTING"),h=K(null);async function n(){try{if(m(s,"BOOTING"),await z.initializeAuth(),z.isAuthenticated){m(s,"LOADING_PRIVATE_CACHE");const b=Ue.loading("Chargement des données...");await Promise.all([$e.loadCache(),Ne.loadCache(),Ke.loadCache(),Xe.loadCache()]),m(s,"READY_WITH_CACHE"),Ue.update(b,{state:"loading",message:"Mise à jour des données en cours..."}),Promise.all([$e.syncFromRemote(),Ne.syncFromRemote(),Ke.syncFromRemote(),je.syncFromRemote(),Xe.syncFromRemote()]).then(async()=>{await Promise.all([$e.setupRealtime(),Ne.setupRealtime(),Ke.setupRealtime(),je.setupRealtime(),ft.initialize(),Xe.setupRealtime()]),await Je.initialize(),m(s,"READY_FULLY_SYNCED"),Ue.dismiss(b),setTimeout(()=>{st("/dashboard"),st("/recipe")},3e3)}).catch(R=>{console.error("[App] Erreur synchro distante:",R),Ue.update(b,{state:"warning",message:"Mode hors ligne : données mises en cache",autoCloseDelay:5e3}),Je.initialize().catch(console.error)})}else m(s,"LOADING_PUBLIC_CACHE"),await Ne.loadCache(),m(s,"READY_WITH_CACHE"),Promise.all([Ne.syncFromRemotePublicOnly(),Je.initialize()]).then(()=>{m(s,"READY_FULLY_SYNCED"),setTimeout(()=>{st("/recipe")},2e3)}).catch(b=>{console.error("[App] Erreur synchro recettes:",b)})}catch(b){console.error("[App] Erreur fatale d'initialisation:",b),m(h,b.message||"Erreur critique de chargement",!0),m(s,"ERROR")}}let c=K(!1),o=K(!1);He(()=>{const b=z.isAuthenticated;e(o)||e(s)!=="BOOTING"&&e(s)!=="LOADING_PRIVATE_CACHE"&&e(s)!=="LOADING_PUBLIC_CACHE"&&b!==e(c)&&(m(c,b,!0),console.log("[App] Changement d'état Auth détecté -> Rechargement"),m(o,!0),n().finally(()=>{m(o,!1)}))}),Lt(()=>{n();const b=document.getElementById("app");b&&b.classList.add("svelte-ready")}),Ot(()=>{console.log("[App] Destruction de l'application - Nettoyage des stores..."),ft.destroy(),je.destroy(),$e.destroy(),Ne.destroy(),Ke.destroy(),Xe.destroy(),Je.destroy()});let p=ue(()=>e(h)||Mt.error);async function v(){z.authModal.isOpen=!1,await z.refreshAuthAfterLogin()}var x=tr(),k=d(j(x),6);va(k,{});var E=d(k,2),y=a(E);{var T=b=>{var R=Qa(),te=a(R);{let se=ue(()=>e(p)||"Erreur inconnue");bt(te,{get message(){return e(se)}})}t(R),i(b,R)},U=b=>{var R=oe(),te=j(R);{var se=X=>{var he=Za(),we=d(a(he),2),F=a(we);{var De=ce=>{var _=Ve("Démarrage...");i(ce,_)},Ie=ce=>{var _=oe(),l=j(_);{var A=H=>{var D=Ve("Chargement des données en cache...");i(H,D)},W=H=>{var D=oe(),$=j(D);{var ne=ee=>{var J=Ve("Préparation de la cuisine...");i(ee,J)};C($,ee=>{e(s)==="LOADING_PUBLIC_CACHE"&&ee(ne)},!0)}i(H,D)};C(l,H=>{e(s)==="LOADING_PRIVATE_CACHE"?H(A):H(W,!1)},!0)}i(ce,_)};C(F,ce=>{e(s)==="BOOTING"?ce(De):ce(Ie,!1)})}t(we),t(he),i(X,he)},le=X=>{Tt(X,{base:"#"})};C(te,X=>{e(s)==="BOOTING"||e(s)==="LOADING_PRIVATE_CACHE"||e(s)==="LOADING_PUBLIC_CACHE"?X(se):X(le,!1)},!0)}i(b,R)};C(y,b=>{e(s)==="ERROR"?b(T):b(U,!1)})}t(E);var Y=d(E,2);ya(Y,{});var V=d(Y,2);wa(V,{});var L=d(V,2);{var w=b=>{var R=er(),te=j(R);{var se=X=>{bt(X,{get message(){return e(p)}})};C(te,X=>{e(p)&&X(se)})}var le=d(te,2);Ca(le,{}),i(b,R)};C(L,b=>{z.isAuthenticated&&e(s)==="READY"&&b(w)})}var f=d(L,2);Ja(f,{get showLogin(){return z.authModal.showLogin},onAuth_success:v,get isOpen(){return z.authModal.isOpen},set isOpen(b){z.authModal.isOpen=b}}),i(u,x),_e()}Rt(ar,{target:document.getElementById("app")});export{Ia as M,ir as a,Ra as b,Da as c,za as d,or as e,ma as f,Fe as n,fa as s};
