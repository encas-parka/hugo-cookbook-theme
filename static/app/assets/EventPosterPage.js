import{B as Ne,d as He,y as Q,z as Ee,j as Ie,k as oe,K as M,b as f,c as Ue,v,h as i,o as n,g as s,m as t,u as U,aC as vt,W as ue,R as $e,A as u,S as et,T as Ve,w as Z,C as $,a6 as we,x as ie,e as Se,ag as nt,G as Y,U as gt,i as qe,M as bt,aE as Fe,N as Le,p as Me,al as ye,n as Ae,b2 as mt,b3 as _t,ah as pt,X as ht,$ as Te,D as ze,J as it,Y as xt,b4 as rt,I as fe,P as yt,aG as ot,aH as wt}from"./appwrite.js";import{n as st,a as kt}from"./index.js";import{L as Dt}from"./LeftPanel.js";import{E as Rt}from"./EventInvitationAlert.js";import{ba as lt,y as ft,bb as Et,E as St,c as It,aw as Ct,aj as zt,ai as Tt,a4 as ct,ap as Bt,aq as At,T as dt,x as Pt,a0 as Vt}from"./icons.js";import{F as Pe}from"./Fieldset.js";import{C as qt}from"./ConfirmModal.js";var Ht=v('<div class="mx-auto mb-2 max-w-sm"><label class="input input-sm w-full"><input type="text" class="grow text-center"/></label></div>'),Ut=v('<button type="button"> </button>'),jt=v('<div class="mx-auto mt-2 max-w-sm"><textarea class="textarea textarea-bordered textarea-xs w-full text-center" rows="2" placeholder="Ajouter une description..."></textarea></div>'),Mt=v('<span class="no-print opacity-50">(Cliquez pour ajouter une description)</span>'),Ft=v('<div class="flex items-center justify-center gap-2 px-4"><button type="button"><!></button> <button class="no-print btn btn-ghost btn-circle btn-xs hover:bg-error/10 hover:text-error opacity-0 transition-opacity group-hover/desc:opacity-100" title="Masquer la description"><!></button></div>'),Lt=v('<div class="description-container group/desc relative mx-auto max-w-xl text-center"><!></div>'),Nt=v("<span> </span>"),Kt=v('<div class="mt-3 flex flex-wrap justify-center gap-2"></div>'),Ot=v('<div class="text-xs"><span class="text-[0.6rem] font-bold tracking-widest uppercase">Attention:</span> <span> </span></div>'),Gt=v(`<div class="mx-auto mt-1 max-w-sm"><textarea class="textarea textarea-bordered textarea-xs w-full text-center" rows="3" placeholder="Liste d'ingrédients séparés par des virgules..."></textarea> <p class="mt-1 text-[0.5rem] tracking-tighter uppercase opacity-50">Entrée pour valider · Maj+Entrée pour nouvelle ligne</p></div>`),Jt=v('<button type="button"> </button>'),Qt=v('<div class="text-xs"><span class="text-[0.6rem] font-bold tracking-widest uppercase">Ingrédients:</span> <!></div>'),Wt=v('<div class="recipe-container mb-6 svelte-ryaxea"><div class="recipe-actions no-print flex gap-1 svelte-ryaxea"><button class="btn btn-ghost btn-circle hover:bg-error/10 hover:text-error transition-colors" title="Masquer la recette"><!></button></div> <div class="recipe-content bg-transparent p-0 text-center"><!> <!> <!> <div class="mt-3 space-y-1 text-black"><!> <!></div></div></div>');function Xt(ke,e){He(e,!0);let r=Q(void 0),ee=Q(void 0),x=Q(void 0),L=Q(Ee(e.name)),q=Q(!1),A=Q(!1),ne=Q(""),K=Q("");function se(){u(L,e.name,!0),e.onStartEdit(e.recipeKey),setTimeout(()=>{t(r)?.focus(),t(r)?.select()},0)}function te(){e.onUpdateName(e.recipeKey,t(L)),e.onFinishEdit()}function _e(l){l.key==="Enter"?te():l.key==="Escape"&&(u(L,e.name,!0),e.onFinishEdit())}function ve(){u(ne,t(I).join(", "),!0),u(q,!0),setTimeout(()=>{t(ee)?.focus()},0)}function he(){if(!t(q))return;const l=t(ne).split(/[,;\n]/),y=Array.from(new Set(l.map(h=>h.trim()).filter(h=>h.length>0).map(h=>h.toLowerCase().replace(/\b\w/g,C=>C.toUpperCase()))));e.onUpdateIngredients(e.recipeKey,y),u(q,!1)}function ge(l){l.key==="Enter"&&!l.shiftKey?(l.preventDefault(),he()):l.key==="Escape"&&u(q,!1)}function le(){u(K,t(D),!0),u(A,!0),setTimeout(()=>{t(x)?.focus()},0)}function ce(){t(A)&&(e.onUpdateDescription(e.recipeKey,t(K).trim()),u(A,!1))}function xe(l){l.key==="Enter"&&!l.shiftKey?(l.preventDefault(),ce()):l.key==="Escape"&&u(A,!1)}let D=U(()=>e.customDescription??e.recipeData?.description??""),I=U(()=>e.customIngredients?e.customIngredients:e.recipeData?.ingredients?e.recipeData.ingredients.map(l=>l.name):[]),W=U(()=>{if(!e.recipeData?.ingredients)return[];const l=new vt;return e.recipeData.ingredients.forEach(y=>{y.allergens?.forEach(h=>l.add(h))}),Array.from(l)}),X=U(()=>e.recipeData?.regime?e.recipeData.regime:[]);function ae(l){return`font-size: ${["1.5rem","2rem","2.5rem","3.2rem"][l]||"2.5rem"}`}function re(l){return`font-size: ${["0.7rem","0.85rem","1rem","1.2rem"][l]||"1rem"}`}var R=Ie(),J=oe(R);{var E=l=>{var y=Wt(),h=i(y),C=i(h);C.__click=()=>e.onToggle(e.recipeKey);var j=i(C);lt(j,{}),n(C),n(h);var N=s(h,2),p=i(N);{var V=d=>{var c=Ht(),m=i(c),_=i(m);ue(_),_.__keydown=_e,$e(_,S=>u(r,S),()=>t(r)),n(m),n(c),et("blur",_,te),Ve(_,()=>t(L),S=>u(L,S)),f(d,c)},F=d=>{var c=Ut();let m;c.__click=se;var _=i(c,!0);n(c),Z(S=>{m=$(c,1,"recipe-title mb-2 block w-full border-none bg-transparent p-0 text-center text-lg text-black transition-colors hover:bg-black/5 svelte-ryaxea",null,m,{"cursor-pointer":!e.isEditing,"montserrat-font":e.config.fontRecettes==="montserrat-font","playfair-display":e.config.fontRecettes==="playfair-display","oswald-font":e.config.fontRecettes==="oswald-font","quicksand-font":e.config.fontRecettes==="quicksand-font","dancing-script":e.config.fontRecettes==="dancing-script","pacifico-regular":e.config.fontRecettes==="pacifico-regular","caveat-font":e.config.fontRecettes==="caveat-font","gluten-font":e.config.fontRecettes==="gluten-font","font-bold":e.config.boldRecettes,italic:e.config.italicRecettes}),we(c,S),ie(_,e.name)},[()=>ae(e.config.fontSizeRecettes)]),f(d,c)};M(p,d=>{e.isEditing?d(V):d(F,!1)})}var O=s(p,2);{var a=d=>{var c=Lt(),m=i(c);{var _=P=>{var T=jt(),B=i(T);nt(B),B.__keydown=xe,$e(B,G=>u(x,G),()=>t(x)),n(T),et("blur",B,ce),Ve(B,()=>t(K),G=>u(K,G)),f(P,T)},S=P=>{var T=Ft(),B=i(T);let G;B.__click=le;var be=i(B);{var de=me=>{var Re=gt();Z(()=>ie(Re,t(D))),f(me,Re)},pe=me=>{var Re=Mt();f(me,Re)};M(be,me=>{t(D)?me(de):me(pe,!1)})}n(B);var De=s(B,2);De.__click=()=>e.onToggleDescription(e.recipeKey);var Ce=i(De);lt(Ce,{class:"h-3 w-3 opacity-50"}),n(De),n(T),Z(me=>{G=$(B,1,"recipe-description block border-none bg-transparent p-0 text-sm text-black opacity-90 transition-colors hover:bg-black/5 svelte-ryaxea",null,G,{"cursor-pointer":!t(A),"montserrat-font":e.config.fontDesc==="montserrat-font","playfair-display":e.config.fontDesc==="playfair-display","oswald-font":e.config.fontDesc==="oswald-font","quicksand-font":e.config.fontDesc==="quicksand-font","dancing-script":e.config.fontDesc==="dancing-script","pacifico-regular":e.config.fontDesc==="pacifico-regular","caveat-font":e.config.fontDesc==="caveat-font","gluten-font":e.config.fontDesc==="gluten-font","font-bold":e.config.boldDesc,italic:e.config.italicDesc}),we(B,me)},[()=>re(e.config.fontSizeDesc)]),f(P,T)};M(m,P=>{t(A)?P(_):P(S,!1)})}n(c),f(d,c)};M(O,d=>{(e.config.showDescription||t(A))&&(e.descriptionVisible||t(A))&&d(a)})}var o=s(O,2);{var g=d=>{var c=Kt();Se(c,20,()=>t(X),m=>m,(m,_)=>{var S=Nt();let P;var T=i(S,!0);n(S),Z(B=>{P=$(S,1,`border-black
              bg-transparent
              font-medium
              text-black`,null,P,{"montserrat-font":e.config.fontRegimes==="montserrat-font","playfair-display":e.config.fontRegimes==="playfair-display","oswald-font":e.config.fontRegimes==="oswald-font","quicksand-font":e.config.fontRegimes==="quicksand-font","dancing-script":e.config.fontRegimes==="dancing-script","pacifico-regular":e.config.fontRegimes==="pacifico-regular","caveat-font":e.config.fontRegimes==="caveat-font","gluten-font":e.config.fontRegimes==="gluten-font","font-bold":e.config.boldRegimes,italic:e.config.italicRegimes}),we(S,B),ie(T,_)},[()=>re(e.config.fontSizeRegimes)]),f(m,S)}),n(c),f(d,c)};M(o,d=>{e.config.showRegimes&&t(X).length>0&&d(g)})}var k=s(o,2),z=i(k);{var H=d=>{var c=Ot(),m=s(i(c),2);let _;var S=i(m,!0);n(m),n(c),Z((P,T)=>{we(m,P),_=$(m,1,"opacity-80",null,_,{"montserrat-font":e.config.fontAlert==="montserrat-font","playfair-display":e.config.fontAlert==="playfair-display","oswald-font":e.config.fontAlert==="oswald-font","quicksand-font":e.config.fontAlert==="quicksand-font","dancing-script":e.config.fontAlert==="dancing-script","pacifico-regular":e.config.fontAlert==="pacifico-regular","caveat-font":e.config.fontAlert==="caveat-font","gluten-font":e.config.fontAlert==="gluten-font","font-bold":e.config.boldAlert,italic:e.config.italicAlert}),ie(S,T)},[()=>re(e.config.fontSizeAlert),()=>t(W).join(", ")]),f(d,c)};M(z,d=>{e.config.showAllergens&&t(W).length>0&&d(H)})}var w=s(z,2);{var b=d=>{var c=Qt(),m=s(i(c),2);{var _=P=>{var T=Gt(),B=i(T);nt(B),B.__keydown=ge,$e(B,G=>u(ee,G),()=>t(ee)),Y(2),n(T),et("blur",B,he),Ve(B,()=>t(ne),G=>u(ne,G)),f(P,T)},S=P=>{var T=Jt();let B;T.__click=ve;var G=i(T,!0);n(T),Z((be,de)=>{B=$(T,1,"mx-auto block border-none bg-transparent p-0 text-xs font-normal capitalize decoration-dotted opacity-80 transition-colors hover:bg-black/5 hover:underline",null,B,{"cursor-pointer":!t(q),"montserrat-font":e.config.fontIng==="montserrat-font","playfair-display":e.config.fontIng==="playfair-display","oswald-font":e.config.fontIng==="oswald-font","quicksand-font":e.config.fontIng==="quicksand-font","dancing-script":e.config.fontIng==="dancing-script","pacifico-regular":e.config.fontIng==="pacifico-regular","caveat-font":e.config.fontIng==="caveat-font","gluten-font":e.config.fontIng==="gluten-font","font-bold":e.config.boldIng,italic:e.config.italicIng}),we(T,be),ie(G,de)},[()=>re(e.config.fontSizeIng),()=>t(I).join(", ")]),f(P,T)};M(m,P=>{t(q)?P(_):P(S,!1)})}n(c),f(d,c)};M(w,d=>{e.config.showIngredients&&(t(I).length>0||t(q))&&d(b)})}n(k),n(N),n(y),f(l,y)};M(J,l=>{e.visible&&l(E)})}f(ke,R),Ue()}Ne(["click","keydown"]);var Yt=v("<div> </div>"),Zt=v("<p> </p>"),$t=v("<p> </p>"),ea=v('<div class="separator mx-auto my-6 w-48 border-t border-black opacity-20 svelte-dikxtg"></div>'),ta=v('<div class="mb-8 text-center"><!> <!> <!></div>'),aa=v("<h3> </h3>"),na=v('<div class="category-block mb-10 svelte-dikxtg"><!> <div class="recipes-grid avoid-break-inside"></div></div>'),ia=v("<div> </div>"),ra=v('<div><div class="group absolute top-4 right-4 print:hidden"><button class="btn btn-circle opacity-60 transition-opacity hover:opacity-100" title="Imprimer cette page"><!></button></div> <div><!> <!> <!> <div><!></div></div></div>'),oa=v('<button class="btn btn-secondary btn-outline flex h-auto max-w-20 flex-col py-3" title="Afficher la recette"><!> <span> </span></button>'),sa=v('<button class="btn btn-secondary btn-outline flex h-auto flex-col py-3" title="Afficher la description"><!> <span><span class="font-bold italic">Desc:</span> </span></button>'),la=v("<!> <!>",1),ca=v('<div class="grid grid-cols-[1fr_auto] items-start gap-4 md:p-2 svelte-dikxtg"><div class="flex flex-col items-end gap-8 svelte-dikxtg"></div> <div class="m-auto flex flex-col gap-4 print:hidden svelte-dikxtg"></div></div>');function da(ke,e){He(e,!0);let r=Ee({}),ee=Ee({}),x=Ee({});function L(D,I){r[D]=I}function q(D,I){ee[D]=I}function A(D){const I=x[D]??!0;x[D]=!I}let ne=U(()=>e.date.toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long",year:"numeric"})),K=U(()=>{const D=new Fe;return e.meals.forEach(I=>{I.recipes.forEach(W=>{const X=W.typeR||"autre";D.has(X)||D.set(X,[]),D.get(X).push({...W,mealId:I.id,guests:I.guests})})}),D}),se=["entree","plat","dessert"],te=U(()=>Array.from(t(K).keys()).sort((I,W)=>{const X=se.indexOf(I),ae=se.indexOf(W);return X!==-1&&ae!==-1?X-ae:X!==-1?-1:ae!==-1?1:I.localeCompare(W)}));function _e(D){return{entree:"Entrée",plat:"Plat",dessert:"Dessert",autre:"Autre"}[D]||D}function ve(D){return`font-size: ${["1.5rem","2rem","2.5rem","3.2rem"][D]||"2.5rem"}`}function he(D){return`font-size: ${["1.3rem","1.7rem","2rem","2.5rem"][D]||"2.5rem"}`}let ge=U(()=>e.config.catPageBreak?t(te).map((D,I)=>({categories:[D],isFirst:I===0,isLast:I===t(te).length-1})):[{categories:t(te),isFirst:!0,isLast:!0}]);var le=ca(),ce=i(le);Se(ce,21,()=>t(ge),qe,(D,I,W)=>{const X=U(()=>W===0?e.sectionId:`${e.sectionId}-page-${W}`);var ae=ra(),re=i(ae),R=i(re);R.__click=()=>e.onPrintThis(W===0?e.sectionId:`${e.sectionId}-page-${W}`);var J=i(R);ft(J,{class:"h-4 w-4"}),n(R),n(re);var E=s(re,2);let l;var y=i(E);{var h=a=>{var o=Yt();let g;var k=i(o,!0);n(o),Z(z=>{g=$(o,1,"mb-8 text-center",null,g,{"montserrat-font":e.config.fontTop==="montserrat-font","playfair-display":e.config.fontTop==="playfair-display","oswald-font":e.config.fontTop==="oswald-font","quicksand-font":e.config.fontTop==="quicksand-font","dancing-script":e.config.fontTop==="dancing-script","pacifico-regular":e.config.fontTop==="pacifico-regular","caveat-font":e.config.fontTop==="caveat-font","gluten-font":e.config.fontTop==="gluten-font","font-bold":e.config.boldTop,italic:e.config.italicTop}),we(o,z),ie(k,e.config.messageTop)},[()=>he(e.config.fontSizeTop)]),f(a,o)};M(y,a=>{e.config.messageTop&&(t(I).isFirst||e.config.dateByPageBreak)&&a(h)})}var C=s(y,2);{var j=a=>{var o=ta(),g=i(o);{var k=d=>{var c=Zt();let m;var _=i(c,!0);n(c),Z(S=>{m=$(c,1,"m-0 text-center text-3xl",null,m,{"montserrat-font":e.config.fontDate==="montserrat-font","gluten-font":e.config.fontDate==="gluten-font","pacifico-regular":e.config.fontDate==="pacifico-regular","font-bold":e.config.boldDate,italic:e.config.italicDate}),we(c,S),ie(_,t(ne))},[()=>ve(e.config.fontSizeDate)]),f(d,c)};M(g,d=>{e.config.showDate&&d(k)})}var z=s(g,2);{var H=d=>{var c=$t();let m;var _=i(c,!0);n(c),Z(S=>{m=$(c,1,"m-0 text-center text-3xl",null,m,{"montserrat-font":e.config.fontHoraire==="montserrat-font","playfair-display":e.config.fontHoraire==="playfair-display","oswald-font":e.config.fontHoraire==="oswald-font","quicksand-font":e.config.fontHoraire==="quicksand-font","dancing-script":e.config.fontHoraire==="dancing-script","pacifico-regular":e.config.fontHoraire==="pacifico-regular","caveat-font":e.config.fontHoraire==="caveat-font","gluten-font":e.config.fontHoraire==="gluten-font","font-bold":e.config.boldHoraire,italic:e.config.italicHoraire}),we(c,S),ie(_,e.horaire)},[()=>ve(e.config.fontSizeHoraire)]),f(d,c)};M(z,d=>{e.config.showHoraire&&d(H)})}var w=s(z,2);{var b=d=>{var c=ea();f(d,c)};M(w,d=>{(e.config.showHoraire||e.config.showDate)&&d(b)})}n(o),f(a,o)};M(C,a=>{(t(I).isFirst||e.config.dateByPageBreak)&&a(j)})}var N=s(C,2);Se(N,16,()=>t(I).categories,a=>a,(a,o)=>{var g=na(),k=i(g);{var z=w=>{var b=aa();let d;var c=i(b,!0);n(b),Z((m,_)=>{d=$(b,1,"mb-6 text-center text-xl tracking-widest uppercase opacity-60",null,d,{"montserrat-font":e.config.fontCat==="montserrat-font","playfair-display":e.config.fontCat==="playfair-display","oswald-font":e.config.fontCat==="oswald-font","quicksand-font":e.config.fontCat==="quicksand-font","dancing-script":e.config.fontCat==="dancing-script","pacifico-regular":e.config.fontCat==="pacifico-regular","caveat-font":e.config.fontCat==="caveat-font","gluten-font":e.config.fontCat==="gluten-font","font-bold":e.config.boldCat,italic:e.config.italicCat}),we(b,m),ie(c,_)},[()=>ve(e.config.fontSizeCat),()=>_e(o)]),f(w,b)};M(k,w=>{e.config.showCategories&&w(z)})}var H=s(k,2);Se(H,21,()=>t(K).get(o)??[],w=>w.recipeUuid,(w,b)=>{const d=U(()=>`${e.dateKey}${e.horaire}_${t(b).recipeUuid}`),c=U(()=>e.recipeVisibility[t(d)]??!0),m=U(()=>e.recipeNames[t(d)]||Le.getRecipeIndexByUuid(t(b).recipeUuid)?.title||t(b).recipeUuid),_=U(()=>e.recipesDetails.find(G=>G.$id===t(b).recipeUuid)||null),S=U(()=>x[t(d)]??!0);var P=Ie(),T=oe(P);{var B=G=>{{let be=U(()=>r[t(d)]||null),de=U(()=>ee[t(d)]||null),pe=U(()=>e.editingRecipe===t(d));Xt(G,{get recipeKey(){return t(d)},get recipeUuid(){return t(b).recipeUuid},get plates(){return t(b).plates},get typeR(){return t(b).typeR},get category(){return o},get config(){return e.config},get visible(){return t(c)},get name(){return t(m)},get recipeData(){return t(_)},get customIngredients(){return t(be)},get customDescription(){return t(de)},get descriptionVisible(){return t(S)},get isEditing(){return t(pe)},get onToggle(){return e.onToggleRecipe},get onStartEdit(){return e.onStartEditRecipe},get onFinishEdit(){return e.onFinishEditRecipe},get onUpdateName(){return e.onUpdateRecipeName},onUpdateIngredients:L,onUpdateDescription:q,onToggleDescription:A})}};M(T,G=>{t(c)&&G(B)})}f(w,P)}),n(H),n(g),f(a,g)});var p=s(N,2);let V;var F=i(p);{var O=a=>{var o=ia();let g;var k=i(o,!0);n(o),Z(z=>{g=$(o,1,"text-center opacity-60",null,g,{"montserrat-font":e.config.fontBottom==="montserrat-font","playfair-display":e.config.fontBottom==="playfair-display","oswald-font":e.config.fontBottom==="oswald-font","quicksand-font":e.config.fontBottom==="quicksand-font","dancing-script":e.config.fontBottom==="dancing-script","pacifico-regular":e.config.fontBottom==="pacifico-regular","caveat-font":e.config.fontBottom==="caveat-font","gluten-font":e.config.fontBottom==="gluten-font","font-bold":e.config.boldBottom,italic:e.config.italicBottom}),we(o,z),ie(k,e.config.messageBottom)},[()=>he(e.config.fontSizeBottom)]),f(a,o)};M(F,a=>{e.config.messageBottom&&a(O)})}n(p),n(E),n(ae),Z(()=>{bt(ae,"id",t(X)),$(ae,1,`meal-poster-section relative flex max-w-svw bg-white
        shadow-2xl transition-shadow ${e.currentPrintTarget!==null&&e.currentPrintTarget!==t(X)&&"no-print"}`,"svelte-dikxtg"),l=$(E,1,"poster-content text-black svelte-dikxtg",null,l,{"centered-content":e.config.centerVertical}),V=$(p,1,"pt-8",null,V,{"mt-auto":!e.config.centerVertical})}),f(D,ae)}),n(ce);var xe=s(ce,2);Se(xe,21,()=>t(te),qe,(D,I)=>{var W=Ie(),X=oe(W);Se(X,17,()=>t(K).get(t(I))??[],qe,(ae,re)=>{const R=U(()=>`${e.dateKey}${e.horaire}_${t(re).recipeUuid}`),J=U(()=>e.recipeVisibility[t(R)]??!0),E=U(()=>x[t(R)]??!0),l=U(()=>e.getRecipeName(t(R),Le.getRecipeIndexByUuid(t(re).recipeUuid)?.title||"Recette"));var y=la(),h=oe(y);{var C=p=>{var V=oa();V.__click=()=>e.onToggleRecipe(t(R));var F=i(V);Et(F,{class:"size-5"});var O=s(F,2),a=i(O,!0);n(O),n(V),Z(()=>ie(a,t(l))),f(p,V)};M(h,p=>{t(J)||p(C)})}var j=s(h,2);{var N=p=>{var V=sa();V.__click=()=>A(t(R));var F=i(V);St(F,{class:"size-5"});var O=s(F,2),a=s(i(O));n(O),n(V),Z(()=>ie(a,` ${t(l)??""}`)),f(p,V)};M(j,p=>{t(J)&&!t(E)&&p(N)})}f(ae,y)}),f(D,W)}),n(xe),n(le),f(ke,le),Ue()}Ne(["click"]);var fa=v('<div class="bg-base-200 flex-1 overflow-auto p-4 print:m-0 print:overflow-visible print:p-0"><div class="mx-auto max-w-5xl print:m-0 print:w-full print:max-w-none"></div></div>');function ua(ke,e){He(e,!0);let r=U(()=>{const L=[];return e.groupedMeals.forEach((q,A)=>{q.forEach((ne,K)=>{L.push({dateKey:A,date:new Date(A),horaire:K,meals:ne})})}),L.sort((q,A)=>q.date.getTime()-A.date.getTime())});var ee=fa(),x=i(ee);Se(x,21,()=>t(r),L=>L.dateKey+L.horaire,(L,q)=>{const A=U(()=>`affiche${t(q).dateKey}${t(q).horaire}`);da(L,{get sectionId(){return t(A)},get dateKey(){return t(q).dateKey},get date(){return t(q).date},get horaire(){return t(q).horaire},get meals(){return t(q).meals},get config(){return e.config},get currentPrintTarget(){return e.currentPrintTarget},get recipesDetails(){return e.recipesDetails},get recipeVisibility(){return e.recipeVisibility},get recipeNames(){return e.recipeNames},get editingRecipe(){return e.editingRecipe},get onPrintThis(){return e.printThis},get onToggleRecipe(){return e.toggleRecipeVisibility},get onStartEditRecipe(){return e.startEditingRecipe},get onFinishEditRecipe(){return e.finishEditingRecipe},get onUpdateRecipeName(){return e.updateRecipeName},get getRecipeName(){return e.getRecipeName}})}),n(x),n(ee),f(ke,ee),Ue()}var va=v('<div class="flex flex-wrap gap-x-4 gap-y-1"><label class="label cursor-pointer justify-start gap-3"><input type="checkbox" class="checkbox checkbox-primary"/> <span class="label-text">Date</span></label> <label class="label cursor-pointer justify-start gap-3"><input type="checkbox" class="checkbox checkbox-primary"/> <span class="label-text">Horaire</span></label> <label class="label cursor-pointer justify-start gap-3"><input type="checkbox" class="checkbox checkbox-primary"/> <span class="label-text">Description</span></label> <label class="label cursor-pointer justify-start gap-3"><input type="checkbox" class="checkbox checkbox-primary"/> <span class="label-text">Catégories</span></label></div> <fieldset class="fieldset my-2"><div class="flex flex-wrap gap-x-4 gap-y-1"><label class="label cursor-pointer justify-start gap-3"><input type="checkbox" class="checkbox checkbox-primary"/> <span class="label-text">Régimes</span></label> <label class="label cursor-pointer justify-start gap-3"><input type="checkbox" class="checkbox checkbox-primary"/> <span class="label-text">Allergènes</span></label> <label class="label cursor-pointer justify-start gap-3"><input type="checkbox" class="checkbox checkbox-primary"/> <span class="label-text">Liste Ingrédients</span></label></div></fieldset>',1),ga=v('<div><label class="label cursor-pointer justify-start gap-3"><input type="checkbox" class="checkbox checkbox-primary"/> <span class="label-text">Date en haut de chaque page</span></label></div>'),ba=v('<div class="mb-4"><label class="label cursor-pointer justify-start gap-3"><input type="checkbox" class="checkbox checkbox-primary"/> <span class="label-text text-wrap">Nouvelle page par catégorie (entrée/plat/dessert)</span></label></div> <!> <div><label class="label cursor-pointer justify-start gap-3"><input type="checkbox" class="checkbox checkbox-primary"/> <span class="label-text">Centrer le contenu sur la page</span></label></div>',1),ma=v('<fieldset class="fieldset w-full"><legend class="fieldset-legend text-xs opacity-60">Message en haut de chaque fiche</legend> <label class="input input-sm w-full"><input type="text" class="grow" placeholder="Ajouter un message en haut..."/></label></fieldset> <fieldset class="fieldset w-full"><legend class="fieldset-legend text-xs opacity-60">Message en bas de chaque fiche</legend> <label class="input input-sm w-full"><input type="text" class="grow" placeholder="Ajouter un message en bas..."/></label></fieldset>',1),_a=v("<div></div>"),pa=v('<div class="border-base-content/5 bg-base-200/30 rounded-xl border p-3"><div class="mb-2 flex items-center justify-between"><span class="text-xs font-bold uppercase opacity-60"> </span> <div class="flex items-center gap-1"><div class="mr-2 flex gap-0.5"><button title="Gras"><!></button> <button title="Italique"><!></button></div> <button class="btn btn-ghost btn-xs btn-square font-bold">A-</button> <div class="flex gap-0.5"></div> <button class="btn btn-ghost btn-xs btn-square font-bold">A+</button></div></div> <select class="select select-sm select-bordered w-full"><option>Montserrat (Standard)</option><option>Playfair (Élégant)</option><option>Oswald (Bistro/Impact)</option><option>Quicksand (Moderne)</option><option>Dancing Script (Cursive)</option><option>Pacifico (Script)</option><option>Caveat (Manuscrit)</option><option>Gluten (Funky)</option></select></div>'),ha=v('<div class="space-y-4"><!> <!> <!> <!> <!> <!> <!> <!> <!> <!></div>'),xa=v('<div class="text-base-content/50 py-2 text-center text-sm italic">Aucune version archivée</div>'),ya=v('<div><div class="flex flex-col"><span class="text-sm font-medium"> </span> <span class="text-base-content/50 flex items-center gap-1 text-xs"><!> </span></div> <div class="flex gap-2"><button class="btn btn-ghost btn-xs btn-square" title="Charger cette version"><!></button> <button class="btn btn-ghost text-error btn-xs btn-square" title="Supprimer"><!></button></div></div>'),wa=v('<div class="space-y-4"><div class="max-h-60 space-y-2 overflow-y-auto pr-1"><!></div> <button class="btn btn-outline btn-block gap-2 border-dashed"><!> Créer une nouvelle version</button> <p class="text-center text-[10px] opacity-40">Maximum 3 versions sauvegardées</p></div>'),ka=v(`<div class="modal modal-open"><div class="modal-box"><h3 class="text-warning flex items-center gap-2 text-lg font-bold"><!> Limite atteinte</h3> <p class="py-4">Vous avez atteint la limite de <strong>3 versions sauvegardées</strong>.</p> <p class="mb-4 text-sm opacity-80">Veuillez supprimer une version existante avant d'en créer une nouvelle.</p> <div class="modal-action"><button class="btn">Fermer</button></div></div> <button class="modal-backdrop">close</button></div>`),Da=v(`<div class="modal modal-open"><div class="modal-box border-warning/20 border"><div class="text-warning mb-4 flex items-center gap-3"><!> <h3 class="text-lg font-bold">Sauvegarde locale</h3></div> <p class="py-4">Cette configuration sera enregistrée <strong>uniquement sur ce navigateur</strong>.</p> <div class="bg-warning/5 border-warning/10 space-y-2 rounded-lg border p-4 text-sm"><p>⚠️ <strong>Attention :</strong></p> <ul class="list-disc pl-5 opacity-80"><li>Elle ne sera pas visible sur vos autres appareils.</li> <li>Elle sera perdue si vous videz le cache ou les données du site dans
            votre navigateur.</li></ul></div> <div class="modal-action"><button class="btn btn-ghost">Annuler</button> <button class="btn btn-warning gap-2"><!> Confirmer la sauvegarde</button></div></div> <button class="modal-backdrop" aria-label="Fermer">close</button></div>`),Ra=v(`<div class="bg-base-200 h-full w-full space-y-6 pt-10 sm:pt-16"><!> <!> <!> <!> <!> <div class="px-4 pb-10"><button class="btn btn-primary btn-block gap-2 shadow-lg"><!> Sauvegarder l'état actuel</button> <p class="mt-2 text-center text-[10px] opacity-40">Mémoire locale uniquement</p></div></div> <!> <!> <!>`,1);function Ea(ke,e){He(e,!0);let r=Me(e,"config",15),ee=Me(e,"versions",19,()=>[]),x=Me(e,"activeVersionId",3,null);Me(e,"disabled",3,!1);let L=Q(!1),q=Q(!1),A=Q(null);function ne(){u(L,!1),e.onSave?.()}function K(){if(ee().length>=3){u(q,!0);return}e.onCreateVersion?.()}var se=Ra(),te=oe(se),_e=i(te);Pe(_e,{legend:"Éléments à afficher",children:(R,J)=>{var E=va(),l=oe(E),y=i(l),h=i(y);ue(h),Y(2),n(y);var C=s(y,2),j=i(C);ue(j),Y(2),n(C);var N=s(C,2),p=i(N);ue(p),Y(2),n(N);var V=s(N,2),F=i(V);ue(F),Y(2),n(V),n(l);var O=s(l,2),a=i(O),o=i(a),g=i(o);ue(g),Y(2),n(o);var k=s(o,2),z=i(k);ue(z),Y(2),n(k);var H=s(k,2),w=i(H);ue(w),Y(2),n(H),n(a),n(O),ye(h,()=>r().showDate,b=>r(r().showDate=b,!0)),ye(j,()=>r().showHoraire,b=>r(r().showHoraire=b,!0)),ye(p,()=>r().showDescription,b=>r(r().showDescription=b,!0)),ye(F,()=>r().showCategories,b=>r(r().showCategories=b,!0)),ye(g,()=>r().showRegimes,b=>r(r().showRegimes=b,!0)),ye(z,()=>r().showAllergens,b=>r(r().showAllergens=b,!0)),ye(w,()=>r().showIngredients,b=>r(r().showIngredients=b,!0)),f(R,E)},$$slots:{default:!0}});var ve=s(_e,2);Pe(ve,{legend:"Options d'impression",children:(R,J)=>{var E=ba(),l=oe(E),y=i(l),h=i(y);ue(h),Y(2),n(y),n(l);var C=s(l,2);{var j=F=>{var O=ga(),a=i(O),o=i(a);ue(o),Y(2),n(a),n(O),ye(o,()=>r().dateByPageBreak,g=>r(r().dateByPageBreak=g,!0)),f(F,O)};M(C,F=>{r().catPageBreak&&F(j)})}var N=s(C,2),p=i(N),V=i(p);ue(V),Y(2),n(p),n(N),ye(h,()=>r().catPageBreak,F=>r(r().catPageBreak=F,!0)),ye(V,()=>r().centerVertical,F=>r(r().centerVertical=F,!0)),f(R,E)},$$slots:{default:!0}});var he=s(ve,2);Pe(he,{legend:"Messages personnalisés",children:(R,J)=>{var E=ma(),l=oe(E),y=s(i(l),2),h=i(y);ue(h),n(y),n(l);var C=s(l,2),j=s(i(C),2),N=i(j);ue(N),n(j),n(C),Ve(h,()=>r().messageTop,p=>r(r().messageTop=p,!0)),Ve(N,()=>r().messageBottom,p=>r(r().messageBottom=p,!0)),f(R,E)},$$slots:{default:!0}});var ge=s(he,2);Pe(ge,{legend:"Personnalisation des textes",children:(R,J)=>{var E=ha();{const a=(o,g=Ae,k=Ae,z=Ae,H=Ae,w=Ae,b)=>{let d=mt(()=>_t(b?.(),!0));var c=Ie(),m=oe(c);{var _=S=>{var P=pa(),T=i(P),B=i(T),G=i(B,!0);n(B);var be=s(B,2),de=i(be),pe=i(de);pe.__click=()=>r(r()[H()]=!r()[H()],!0);var De=i(pe);Bt(De,{class:"size-3"}),n(pe);var Ce=s(pe,2);Ce.__click=()=>r(r()[w()]=!r()[w()],!0);var me=i(Ce);At(me,{class:"size-3"}),n(Ce),n(de);var Re=s(de,2);Re.__click=()=>r(r()[z()]=Math.max(0,r()[z()]-1),!0);var Be=s(Re,2);Se(Be,20,()=>[0,1,2,3],qe,(Ze,ut)=>{var at=_a();Z(()=>$(at,1,`h-1 w-2 rounded-full transition-colors ${r()[z()]>=ut?"bg-secondary":"bg-base-content/10"}`)),f(Ze,at)}),n(Be);var je=s(Be,2);je.__click=()=>r(r()[z()]=Math.min(3,r()[z()]+1),!0),n(be),n(T);var Ke=s(T,2),Oe=i(Ke);Oe.value=Oe.__value="montserrat-font";var Ge=s(Oe);Ge.value=Ge.__value="playfair-display";var Je=s(Ge);Je.value=Je.__value="oswald-font";var Qe=s(Je);Qe.value=Qe.__value="quicksand-font";var We=s(Qe);We.value=We.__value="dancing-script";var Xe=s(We);Xe.value=Xe.__value="pacifico-regular";var Ye=s(Xe);Ye.value=Ye.__value="caveat-font";var tt=s(Ye);tt.value=tt.__value="gluten-font",n(Ke),n(P),Z(()=>{ie(G,g()),$(pe,1,`btn btn-xs btn-square ${(r()[H()]&&"btn-secondary")??""}`),$(Ce,1,`btn btn-xs btn-square ${(r()[w()]&&"btn-secondary")??""}`),Re.disabled=r()[z()]===0,je.disabled=r()[z()]===3}),pt(Ke,()=>r()[k()],Ze=>r(r()[k()]=Ze,!0)),f(S,P)};M(m,S=>{t(d)&&S(_)})}f(o,c)};var l=i(E);a(l,()=>"Date",()=>"fontDate",()=>"fontSizeDate",()=>"boldDate",()=>"italicDate",()=>r().showDate);var y=s(l,2);a(y,()=>"Horaire",()=>"fontHoraire",()=>"fontSizeHoraire",()=>"boldHoraire",()=>"italicHoraire",()=>r().showHoraire);var h=s(y,2);a(h,()=>"Catégories",()=>"fontCat",()=>"fontSizeCat",()=>"boldCat",()=>"italicCat",()=>r().showCategories);var C=s(h,2);a(C,()=>"Titre Recettes",()=>"fontRecettes",()=>"fontSizeRecettes",()=>"boldRecettes",()=>"italicRecettes",()=>!0);var j=s(C,2);a(j,()=>"Description",()=>"fontDesc",()=>"fontSizeDesc",()=>"boldDesc",()=>"italicDesc",()=>r().showDescription);var N=s(j,2);a(N,()=>"Régimes",()=>"fontRegimes",()=>"fontSizeRegimes",()=>"boldRegimes",()=>"italicRegimes",()=>r().showRegimes);var p=s(N,2);a(p,()=>"Ingrédients",()=>"fontIng",()=>"fontSizeIng",()=>"boldIng",()=>"italicIng",()=>r().showIngredients);var V=s(p,2);a(V,()=>"Allergènes",()=>"fontAlert",()=>"fontSizeAlert",()=>"boldAlert",()=>"italicAlert",()=>r().showAllergens);var F=s(V,2);a(F,()=>"Message Haut",()=>"fontTop",()=>"fontSizeTop",()=>"boldTop",()=>"italicTop",()=>!!r().messageTop);var O=s(F,2);a(O,()=>"Message Bas",()=>"fontBottom",()=>"fontSizeBottom",()=>"boldBottom",()=>"italicBottom",()=>!!r().messageBottom),n(E)}f(R,E)},$$slots:{default:!0}});var le=s(ge,2);Pe(le,{legend:"Mes Versions",children:(R,J)=>{var E=wa(),l=i(E),y=i(l);{var h=p=>{var V=xa();f(p,V)},C=p=>{var V=Ie(),F=oe(V);Se(F,17,ee,qe,(O,a)=>{var o=ya(),g=i(o),k=i(g),z=i(k,!0);n(k);var H=s(k,2),w=i(H);Ct(w,{class:"size-3"});var b=s(w);n(H),n(g);var d=s(g,2),c=i(d);c.__click=()=>e.onLoadVersion?.(t(a));var m=i(c);zt(m,{class:"size-4"}),n(c);var _=s(c,2);_.__click=()=>u(A,t(a).id,!0);var S=i(_);Tt(S,{class:"size-4"}),n(_),n(d),n(o),Z(P=>{$(o,1,`flex items-center justify-between rounded-lg border p-3 transition-all ${x()===t(a).id?"bg-secondary/30 border-secondary/30":"bg-base-100/50 hover:bg-base-100 hover:border-base-300 border-transparent"}`),ie(z,t(a).name),ie(b,` ${P??""}`)},[()=>new Date(t(a).createdAt).toLocaleDateString()]),f(O,o)}),f(p,V)};M(y,p=>{ee().length===0?p(h):p(C,!1)})}n(l);var j=s(l,2);j.__click=K;var N=i(j);It(N,{class:"size-4"}),Y(),n(j),Y(2),n(E),f(R,E)},$$slots:{default:!0}});var ce=s(le,2),xe=i(ce);xe.__click=()=>u(L,!0);var D=i(xe);ct(D,{class:"size-5"}),Y(),n(xe),Y(2),n(ce),n(te);var I=s(te,2);{var W=R=>{var J=ka(),E=i(J),l=i(E),y=i(l);dt(y,{class:"size-6"}),Y(),n(l);var h=s(l,6),C=i(h);C.__click=()=>u(q,!1),n(h),n(E);var j=s(E,2);j.__click=()=>u(q,!1),n(J),f(R,J)};M(I,R=>{t(q)&&R(W)})}var X=s(I,2);{let R=U(()=>!!t(A));qt(X,{title:"Supprimer la version",message:"Êtes-vous sûr de vouloir supprimer cette version ? Cette action est irréversible.",variant:"danger",confirmLabel:"Supprimer",get isOpen(){return t(R)},onConfirm:()=>{t(A)&&(e.onDeleteVersion?.(t(A)),u(A,null))},onCancel:()=>u(A,null)})}var ae=s(X,2);{var re=R=>{var J=Da(),E=i(J),l=i(E),y=i(l);dt(y,{class:"size-8"}),Y(2),n(l);var h=s(l,6),C=i(h);C.__click=()=>u(L,!1);var j=s(C,2);j.__click=ne;var N=i(j);ct(N,{class:"size-4"}),Y(),n(j),n(h),n(E);var p=s(E,2);p.__click=()=>u(L,!1),n(J),f(R,J)};M(ae,R=>{t(L)&&R(re)})}f(ke,se),Ue()}Ne(["click"]);var Sa=v('<button class="btn btn-primary btn-sm gap-2"><!> Imprimer tout</button>'),Ia=v('<div class="flex min-h-[60vh] items-center justify-center"><div class="loading loading-spinner loading-lg text-primary"></div></div>'),Ca=v('<div class="container mx-auto p-4"><div class="alert alert-error max-md:alert-vertical"><!> <span> </span></div></div>'),za=v('<div class="flex min-h-[60vh] items-center justify-center"><div class="alert alert-info alert-vertical"><!> <p class="text-lg">Aucune recette pour le moment</p></div></div>'),Ta=v('<!> <div class="bg-base-200 min-h-screen print:h-auto print:min-h-0"><div class="mx-auto px-4 py-4 print:hidden"><!></div> <div><!></div></div>',1);function ja(ke,e){He(e,!0);const r=a=>{var o=Sa();o.__click=E;var g=i(o);ft(g,{class:"h-5 w-5"}),Y(),n(o),f(a,o)};let ee=U(()=>ze.params.id),x=U(()=>t(ee)&&Te.getEventById(t(ee))),L=Q(!1),q=Q(null),A=Q(Ee([])),ne=Q(!1),K=Q(Ee({showDate:!0,showHoraire:!0,showDescription:!1,showCategories:!0,showRecipes:!0,showRegimes:!1,showAllergens:!1,showIngredients:!1,catPageBreak:!1,dateByPageBreak:!1,messageTop:"",fontTop:"montserrat-font",fontSizeTop:1,boldTop:!1,italicTop:!1,messageBottom:"",fontBottom:"montserrat-font",fontSizeBottom:1,boldBottom:!1,italicBottom:!1,fontDate:"montserrat-font",fontSizeDate:1,boldDate:!1,italicDate:!1,fontHoraire:"montserrat-font",fontSizeHoraire:1,boldHoraire:!1,italicHoraire:!1,fontCat:"montserrat-font",fontSizeCat:1,boldCat:!1,italicCat:!1,fontRecettes:"pacifico-regular",fontSizeRecettes:2,boldRecettes:!1,italicRecettes:!1,fontDesc:"montserrat-font",fontSizeDesc:1,boldDesc:!1,italicDesc:!1,fontRegimes:"montserrat-font",fontSizeRegimes:1,boldRegimes:!1,italicRegimes:!1,fontAlert:"montserrat-font",fontSizeAlert:1,boldAlert:!1,italicAlert:!1,fontIng:"montserrat-font",fontSizeIng:1,boldIng:!1,italicIng:!1,centerVertical:!0})),se=Q(Ee([])),te=Q(null),_e=Q(null),ve=Q(!1);const he=U(()=>{if(!t(x))return!1;const a=fe.userId||"";return t(x).createdBy===a||wt(t(x).$id)?!0:t(x).contributors?.find(g=>g.id===a)?.status==="accepted"});let ge=Ee({}),le=Ee({}),ce=Q(null),xe=U(()=>{if(!t(x)?.meals)return new Fe;const a=new Fe;return t(x).meals.forEach(o=>{const g=new Date(o.date),k=g.toISOString().split("T")[0],z=g.getHours(),H=z<12?"Petit-déjeuner":z<14?"Déjeuner":z<18?"Goûter":"Dîner";a.has(k)||a.set(k,new Fe);const w=a.get(k);w.has(H)||w.set(H,[]),w.get(H).push(o)}),a});ht(()=>{(async()=>{if(!t(x)){u(L,!0);try{await Te.fetchEvent(ze.params.id)}catch(a){u(q,a instanceof Error?a.message:"Erreur de chargement",!0)}finally{u(L,!1)}}await D()})()});async function D(){try{const a=await Te.loadPosterConfig(ze.params.id);a&&(console.log("[EventPoster] Configuration chargée depuis le cache"),a.current?(u(K,{...t(K),...a.current},!0),u(se,a.versions||[],!0)):(u(K,{...t(K),...a},!0),u(se,[],!0)))}catch(a){console.error("[EventPoster] Erreur chargement config cache:",a)}}async function I(){try{await Te.savePosterConfig(ze.params.id,ot(t(K))),fe.toast.success("Configuration sauvegardée",{details:"Les réglages courants sont enregistrés localement."})}catch(a){console.error("[EventPoster] Erreur sauvegarde config cache:",a),fe.toast.error("Erreur de sauvegarde",{details:"Impossible d'enregistrer la configuration localement."})}}async function W(){try{const a=new Date,g=`Version du ${new Intl.DateTimeFormat("fr-FR",{dateStyle:"short",timeStyle:"short"}).format(a)}`,k=await Te.createPosterVersion(ze.params.id,ot(t(K)),g);await D(),k&&u(te,k.id,!0),fe.toast.success("Version créée",{details:"Une nouvelle version de la configuration a été archivée."})}catch(a){console.error("[EventPoster] Erreur création version:",a),fe.toast.error("Erreur de création",{details:a.message||"Impossible de créer une nouvelle version."})}}async function X(a){try{await Te.deletePosterVersion(ze.params.id,a),u(se,t(se).filter(o=>o.id!==a),!0),t(te)===a&&u(te,null),fe.toast.success("Version supprimée",{details:"La version archivée a été supprimée."})}catch(o){console.error("[EventPoster] Erreur suppression version:",o),fe.toast.error("Erreur de suppression",{details:"Impossible de supprimer la version."})}}function ae(a){u(K,{...t(K),...a.config},!0),u(te,a.id,!0),fe.toast.info("Version chargée",{details:`La configuration "${a.name}" a été appliquée.`})}it(()=>{if(!t(x)||t(L))return;if(!(t(x).meals&&t(x).meals.some(o=>o.recipes&&o.recipes.length>0))){u(ne,!1);return}t(A).length===0&&!t(ne)&&re().then(()=>{R()})});async function re(){if(!t(x)?.meals)return;const a=t(x).meals.flatMap(o=>o.recipes.map(g=>g.recipeUuid));if(a.length===0){u(ne,!1);return}u(ne,!0);try{console.log(`[EventPoster] Loading ${a.length} recipes (bulk mode)...`);const o=await Le.getRecipesByUuidsBulk(a);u(A,Array.from(o.values()).filter(g=>g!==null),!0),console.log(`[EventPoster] Loaded ${t(A).length}/${a.length} recipes in bulk`),console.log("[EventPoster] Recipe IDs:",t(A).map(g=>g.$id))}catch(o){console.error("Erreur lors du chargement des recettes:",o)}finally{u(ne,!1)}}function R(){t(x)?.meals&&t(x).meals.forEach(a=>{const o=new Date(a.date),g=o.toISOString().split("T")[0],k=o.getHours(),z=k<12?"Petit-déjeuner":k<14?"Déjeuner":k<18?"Goûter":"Dîner",H=`${g}${z}`;a.recipes.forEach(w=>{const b=`${H}_${w.recipeUuid}`;ge[b]=!0;const d=Le.getRecipeIndexByUuid(w.recipeUuid);le[b]=d?.title||w.recipeUuid})})}async function J(a){u(_e,a,!0),await rt(),setTimeout(()=>{window.print(),u(_e,null)},400)}async function E(){u(_e,null),await rt(),setTimeout(()=>{window.print()},400)}function l(a){ge[a]=!ge[a],ge[a]||console.log("to-implement")}function y(a){u(ce,a,!0)}function h(){u(ce,null)}function C(a,o){le[a]=o}function j(a,o){return le[a]||o}async function N(a){if(!(!ze.params.id||!fe.userId))try{u(ve,!0);const o=a?"accepted":"declined";await Te.updateContributorStatus(ze.params.id,fe.userId,o),fe.toast.success(a?"Invitation acceptée":"Invitation déclinée")}catch(o){console.error("Erreur réponse invitation:",o),fe.toast.error("Erreur lors de la réponse")}finally{u(ve,!1)}}it(()=>{t(x)&&st.setConfig({title:`Affiches : ${t(x).name}`,actions:r})}),xt(()=>{st.reset()});var p=Ie(),V=oe(p);{var F=a=>{var o=Ia();f(a,o)},O=a=>{var o=Ie(),g=oe(o);{var k=H=>{var w=Ca(),b=i(w),d=i(b);Pt(d,{class:"h-6 w-6 shrink-0"});var c=s(d,2),m=i(c,!0);n(c),n(b),n(w),Z(()=>ie(m,t(q))),f(H,w)},z=H=>{var w=Ie(),b=oe(w);{var d=m=>{var _=za(),S=i(_),P=i(S);Vt(P,{}),Y(2),n(S),n(_),f(m,_)},c=m=>{var _=Ie(),S=oe(_);{var P=T=>{var B=Ta(),G=oe(B);Dt(G,{bgClass:"bg-base-200",width:"120",children:(me,Re)=>{{let Be=U(()=>!t(he));Ea(me,{get versions(){return t(se)},get activeVersionId(){return t(te)},onSave:I,onCreateVersion:W,onDeleteVersion:X,onLoadVersion:ae,get disabled(){return t(Be)},get config(){return t(K)},set config(je){u(K,je,!0)}})}},$$slots:{default:!0}});var be=s(G,2),de=i(be),pe=i(de);Rt(pe,{get currentEvent(){return t(x)},get isBusy(){return t(ve)},onRespond:N}),n(de);var De=s(de,2),Ce=i(De);ua(Ce,{get event(){return t(x)},get groupedMeals(){return t(xe)},get config(){return t(K)},get currentPrintTarget(){return t(_e)},get recipesDetails(){return t(A)},get recipeVisibility(){return ge},get recipeNames(){return le},get editingRecipe(){return t(ce)},printThis:J,toggleRecipeVisibility:l,startEditingRecipe:y,finishEditingRecipe:h,updateRecipeName:C,getRecipeName:j}),n(De),n(be),Z(()=>$(De,1,`print:m-0 print:p-0 ${fe.isDesktop?"ml-80":""}`)),yt(3,be,()=>kt),f(T,B)};M(S,T=>{t(x)&&T(P)},!0)}f(m,_)};M(b,m=>{!t(x)||t(x).meals&&t(x).meals.length>0&&t(x).meals.every(_=>!_.recipes||_.recipes.length===0)?m(d):m(c,!1)},!0)}f(H,w)};M(g,H=>{t(q)?H(k):H(z,!1)},!0)}f(a,o)};M(V,a=>{t(L)?a(F):a(O,!1)})}f(ke,p),Ue()}Ne(["click"]);export{ja as default};
