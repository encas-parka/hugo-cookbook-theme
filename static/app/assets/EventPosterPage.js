import{B as Ke,d as Ue,p as Fe,v as b,k as oe,h as i,W as ve,G,o as a,g as o,ak as ke,b as f,K as j,T as Ve,n as Pe,j as Ce,m as t,aP as vt,e as Se,A as u,y as W,w as Z,C as $,x as ne,i as qe,u as U,c as He,aQ as gt,af as bt,z as Ie,aR as mt,R as $e,S as et,a6 as Re,ae as nt,U as _t,M as pt,aS as Le,N as Ne,X as ht,at as xt,au as yt,D as De,_ as ze,J as it,Y as wt,aT as rt,E as kt,I as ue,P as Dt,as as ot}from"./appwrite.js";import{n as st,f as Rt}from"./index.js";import{E as Et}from"./EventInvitationAlert.js";import{F as Ae}from"./Fieldset.js";import{C as St}from"./ConfirmModal.js";import{c as It,an as Ct,al as Tt,ak as zt,a4 as lt,aQ as Bt,aR as Pt,T as ct,aS as dt,y as ft,aT as At,E as Vt,x as qt,_ as Ut}from"./icons.js";import{L as Ht}from"./LeftPanel.js";var jt=b('<div class="flex flex-wrap gap-x-4 gap-y-1"><label class="label cursor-pointer justify-start gap-3"><input type="checkbox" class="checkbox checkbox-primary"/> <span class="label-text">Date</span></label> <label class="label cursor-pointer justify-start gap-3"><input type="checkbox" class="checkbox checkbox-primary"/> <span class="label-text">Horaire</span></label> <label class="label cursor-pointer justify-start gap-3"><input type="checkbox" class="checkbox checkbox-primary"/> <span class="label-text">Description</span></label> <label class="label cursor-pointer justify-start gap-3"><input type="checkbox" class="checkbox checkbox-primary"/> <span class="label-text">Catégories</span></label></div> <fieldset class="fieldset my-2"><div class="flex flex-wrap gap-x-4 gap-y-1"><label class="label cursor-pointer justify-start gap-3"><input type="checkbox" class="checkbox checkbox-primary"/> <span class="label-text">Régimes</span></label> <label class="label cursor-pointer justify-start gap-3"><input type="checkbox" class="checkbox checkbox-primary"/> <span class="label-text">Allergènes</span></label> <label class="label cursor-pointer justify-start gap-3"><input type="checkbox" class="checkbox checkbox-primary"/> <span class="label-text">Liste Ingrédients</span></label></div></fieldset>',1),Mt=b('<div><label class="label cursor-pointer justify-start gap-3"><input type="checkbox" class="checkbox checkbox-primary"/> <span class="label-text">Date en haut de chaque page</span></label></div>'),Ft=b('<div class="mb-4"><label class="label cursor-pointer justify-start gap-3"><input type="checkbox" class="checkbox checkbox-primary"/> <span class="label-text text-wrap">Nouvelle page par catégorie (entrée/plat/dessert)</span></label></div> <!> <div><label class="label cursor-pointer justify-start gap-3"><input type="checkbox" class="checkbox checkbox-primary"/> <span class="label-text">Centrer le contenu sur la page</span></label></div>',1),Lt=b('<fieldset class="fieldset w-full"><legend class="fieldset-legend text-xs opacity-60">Message en haut de chaque fiche</legend> <label class="input input-sm w-full"><input type="text" class="grow" placeholder="Ajouter un message en haut..."/></label></fieldset> <fieldset class="fieldset w-full"><legend class="fieldset-legend text-xs opacity-60">Message en bas de chaque fiche</legend> <label class="input input-sm w-full"><input type="text" class="grow" placeholder="Ajouter un message en bas..."/></label></fieldset>',1),Nt=b("<div></div>"),Kt=b('<div class="border-base-content/5 bg-base-200/30 rounded-xl border p-3"><div class="mb-2 flex items-center justify-between"><span class="text-xs font-bold uppercase opacity-60"> </span> <div class="flex items-center gap-1"><div class="mr-2 flex gap-0.5"><button title="Gras"><!></button> <button title="Italique"><!></button></div> <button class="btn btn-ghost btn-xs btn-square font-bold">A-</button> <div class="flex gap-0.5"></div> <button class="btn btn-ghost btn-xs btn-square font-bold">A+</button></div></div> <select class="select select-sm select-bordered w-full"><option>Montserrat (Standard)</option><option>Playfair (Élégant)</option><option>Oswald (Bistro/Impact)</option><option>Quicksand (Moderne)</option><option>Dancing Script (Cursive)</option><option>Pacifico (Script)</option><option>Caveat (Manuscrit)</option><option>Gluten (Funky)</option></select></div>'),Ot=b('<div class="space-y-4"><!> <!> <!> <!> <!> <!> <!> <!> <!> <!></div>'),Qt=b('<div class="text-base-content/50 py-2 text-center text-sm italic">Aucune version archivée</div>'),Jt=b('<div><div class="flex flex-col"><span class="text-sm font-medium"> </span> <span class="text-base-content/50 flex items-center gap-1 text-xs"><!> </span></div> <div class="flex gap-2"><button class="btn btn-ghost btn-xs btn-square" title="Charger cette version"><!></button> <button class="btn btn-ghost text-error btn-xs btn-square" title="Supprimer"><!></button></div></div>'),Wt=b('<div class="space-y-4"><div class="max-h-60 space-y-2 overflow-y-auto pr-1"><!></div> <button class="btn btn-outline btn-block gap-2 border-dashed"><!> Créer une nouvelle version</button> <p class="text-center text-[10px] opacity-40">Maximum 3 versions sauvegardées</p></div>'),Xt=b(`<div class="modal modal-open"><div class="modal-box"><h3 class="text-warning flex items-center gap-2 text-lg font-bold"><!> Limite atteinte</h3> <p class="py-4">Vous avez atteint la limite de <strong>3 versions sauvegardées</strong>.</p> <p class="mb-4 text-sm opacity-80">Veuillez supprimer une version existante avant d'en créer une nouvelle.</p> <div class="modal-action"><button class="btn">Fermer</button></div></div> <button class="modal-backdrop">close</button></div>`),Yt=b(`<div class="modal modal-open"><div class="modal-box border-warning/20 border"><div class="text-warning mb-4 flex items-center gap-3"><!> <h3 class="text-lg font-bold">Sauvegarde locale</h3></div> <p class="py-4">Cette configuration sera enregistrée <strong>uniquement sur ce navigateur</strong>.</p> <div class="bg-warning/5 border-warning/10 space-y-2 rounded-lg border p-4 text-sm"><p>⚠️ <strong>Attention :</strong></p> <ul class="list-disc pl-5 opacity-80"><li>Elle ne sera pas visible sur vos autres appareils.</li> <li>Elle sera perdue si vous videz le cache ou les données du site dans
            votre navigateur.</li></ul></div> <div class="modal-action"><button class="btn btn-ghost">Annuler</button> <button class="btn btn-warning gap-2"><!> Confirmer la sauvegarde</button></div></div> <button class="modal-backdrop" aria-label="Fermer">close</button></div>`),Gt=b(`<div class="bg-base-200 h-full w-full space-y-6 pt-10 sm:pt-16"><!> <!> <!> <!> <!> <div class="px-4 pb-10"><button class="btn btn-primary btn-block gap-2 shadow-lg"><!> Sauvegarder l'état actuel</button> <p class="mt-2 text-center text-[10px] opacity-40">Mémoire locale uniquement</p></div></div> <!> <!> <!>`,1);function Zt(Ee,e){Ue(e,!0);let r=Fe(e,"config",15),h=Fe(e,"versions",19,()=>[]),ie=Fe(e,"activeVersionId",3,null);Fe(e,"disabled",3,!1);let M=W(!1),q=W(!1),A=W(null);function ae(){u(M,!1),e.onSave?.()}function N(){if(h().length>=3){u(q,!0);return}e.onCreateVersion?.()}var se=Gt(),ee=oe(se),_e=i(ee);Ae(_e,{legend:"Éléments à afficher",children:(E,J)=>{var S=jt(),l=oe(S),D=i(l),x=i(D);ve(x),G(2),a(D);var z=o(D,2),H=i(z);ve(H),G(2),a(z);var L=o(z,2),y=i(L);ve(y),G(2),a(L);var V=o(L,2),F=i(V);ve(F),G(2),a(V),a(l);var O=o(l,2),g=i(O),n=i(g),s=i(n);ve(s),G(2),a(n);var m=o(n,2),w=i(m);ve(w),G(2),a(m);var K=o(m,2),I=i(K);ve(I),G(2),a(K),a(g),a(O),ke(x,()=>r().showDate,v=>r(r().showDate=v,!0)),ke(H,()=>r().showHoraire,v=>r(r().showHoraire=v,!0)),ke(y,()=>r().showDescription,v=>r(r().showDescription=v,!0)),ke(F,()=>r().showCategories,v=>r(r().showCategories=v,!0)),ke(s,()=>r().showRegimes,v=>r(r().showRegimes=v,!0)),ke(w,()=>r().showAllergens,v=>r(r().showAllergens=v,!0)),ke(I,()=>r().showIngredients,v=>r(r().showIngredients=v,!0)),f(E,S)},$$slots:{default:!0}});var ge=o(_e,2);Ae(ge,{legend:"Options d'impression",children:(E,J)=>{var S=Ft(),l=oe(S),D=i(l),x=i(D);ve(x),G(2),a(D),a(l);var z=o(l,2);{var H=F=>{var O=Mt(),g=i(O),n=i(g);ve(n),G(2),a(g),a(O),ke(n,()=>r().dateByPageBreak,s=>r(r().dateByPageBreak=s,!0)),f(F,O)};j(z,F=>{r().catPageBreak&&F(H)})}var L=o(z,2),y=i(L),V=i(y);ve(V),G(2),a(y),a(L),ke(x,()=>r().catPageBreak,F=>r(r().catPageBreak=F,!0)),ke(V,()=>r().centerVertical,F=>r(r().centerVertical=F,!0)),f(E,S)},$$slots:{default:!0}});var he=o(ge,2);Ae(he,{legend:"Messages personnalisés",children:(E,J)=>{var S=Lt(),l=oe(S),D=o(i(l),2),x=i(D);ve(x),a(D),a(l);var z=o(l,2),H=o(i(z),2),L=i(H);ve(L),a(H),a(z),Ve(x,()=>r().messageTop,y=>r(r().messageTop=y,!0)),Ve(L,()=>r().messageBottom,y=>r(r().messageBottom=y,!0)),f(E,S)},$$slots:{default:!0}});var be=o(he,2);Ae(be,{legend:"Personnalisation des textes",children:(E,J)=>{var S=Ot();{const g=(n,s=Pe,m=Pe,w=Pe,K=Pe,I=Pe,v)=>{let d=vt(()=>gt(v?.(),!0));var c=Ce(),k=oe(c);{var _=p=>{var B=Kt(),P=i(B),T=i(P),Q=i(T,!0);a(T);var pe=o(T,2),de=i(pe),fe=i(de);fe.__click=()=>r(r()[K()]=!r()[K()],!0);var Te=i(fe);Bt(Te,{class:"size-3"}),a(fe);var ye=o(fe,2);ye.__click=()=>r(r()[I()]=!r()[I()],!0);var me=i(ye);Pt(me,{class:"size-3"}),a(ye),a(de);var we=o(de,2);we.__click=()=>r(r()[w()]=Math.max(0,r()[w()]-1),!0);var je=o(we,2);Se(je,20,()=>[0,1,2,3],qe,(Ze,ut)=>{var at=Nt();Z(()=>$(at,1,`h-1 w-2 rounded-full transition-colors ${r()[w()]>=ut?"bg-secondary":"bg-base-content/10"}`)),f(Ze,at)}),a(je);var Me=o(je,2);Me.__click=()=>r(r()[w()]=Math.min(3,r()[w()]+1),!0),a(pe),a(P);var Be=o(P,2),Oe=i(Be);Oe.value=Oe.__value="montserrat-font";var Qe=o(Oe);Qe.value=Qe.__value="playfair-display";var Je=o(Qe);Je.value=Je.__value="oswald-font";var We=o(Je);We.value=We.__value="quicksand-font";var Xe=o(We);Xe.value=Xe.__value="dancing-script";var Ye=o(Xe);Ye.value=Ye.__value="pacifico-regular";var Ge=o(Ye);Ge.value=Ge.__value="caveat-font";var tt=o(Ge);tt.value=tt.__value="gluten-font",a(Be),a(B),Z(()=>{ne(Q,s()),$(fe,1,`btn btn-xs btn-square ${(r()[K()]&&"btn-secondary")??""}`),$(ye,1,`btn btn-xs btn-square ${(r()[I()]&&"btn-secondary")??""}`),we.disabled=r()[w()]===0,Me.disabled=r()[w()]===3}),bt(Be,()=>r()[m()],Ze=>r(r()[m()]=Ze,!0)),f(p,B)};j(k,p=>{t(d)&&p(_)})}f(n,c)};var l=i(S);g(l,()=>"Date",()=>"fontDate",()=>"fontSizeDate",()=>"boldDate",()=>"italicDate",()=>r().showDate);var D=o(l,2);g(D,()=>"Horaire",()=>"fontHoraire",()=>"fontSizeHoraire",()=>"boldHoraire",()=>"italicHoraire",()=>r().showHoraire);var x=o(D,2);g(x,()=>"Catégories",()=>"fontCat",()=>"fontSizeCat",()=>"boldCat",()=>"italicCat",()=>r().showCategories);var z=o(x,2);g(z,()=>"Titre Recettes",()=>"fontRecettes",()=>"fontSizeRecettes",()=>"boldRecettes",()=>"italicRecettes",()=>!0);var H=o(z,2);g(H,()=>"Description",()=>"fontDesc",()=>"fontSizeDesc",()=>"boldDesc",()=>"italicDesc",()=>r().showDescription);var L=o(H,2);g(L,()=>"Régimes",()=>"fontRegimes",()=>"fontSizeRegimes",()=>"boldRegimes",()=>"italicRegimes",()=>r().showRegimes);var y=o(L,2);g(y,()=>"Ingrédients",()=>"fontIng",()=>"fontSizeIng",()=>"boldIng",()=>"italicIng",()=>r().showIngredients);var V=o(y,2);g(V,()=>"Allergènes",()=>"fontAlert",()=>"fontSizeAlert",()=>"boldAlert",()=>"italicAlert",()=>r().showAllergens);var F=o(V,2);g(F,()=>"Message Haut",()=>"fontTop",()=>"fontSizeTop",()=>"boldTop",()=>"italicTop",()=>!!r().messageTop);var O=o(F,2);g(O,()=>"Message Bas",()=>"fontBottom",()=>"fontSizeBottom",()=>"boldBottom",()=>"italicBottom",()=>!!r().messageBottom),a(S)}f(E,S)},$$slots:{default:!0}});var le=o(be,2);Ae(le,{legend:"Mes Versions",children:(E,J)=>{var S=Wt(),l=i(S),D=i(l);{var x=y=>{var V=Qt();f(y,V)},z=y=>{var V=Ce(),F=oe(V);Se(F,17,h,qe,(O,g)=>{var n=Jt(),s=i(n),m=i(s),w=i(m,!0);a(m);var K=o(m,2),I=i(K);Ct(I,{class:"size-3"});var v=o(I);a(K),a(s);var d=o(s,2),c=i(d);c.__click=()=>e.onLoadVersion?.(t(g));var k=i(c);Tt(k,{class:"size-4"}),a(c);var _=o(c,2);_.__click=()=>u(A,t(g).id,!0);var p=i(_);zt(p,{class:"size-4"}),a(_),a(d),a(n),Z(B=>{$(n,1,`flex items-center justify-between rounded-lg border p-3 transition-all ${ie()===t(g).id?"bg-secondary/30 border-secondary/30":"bg-base-100/50 hover:bg-base-100 hover:border-base-300 border-transparent"}`),ne(w,t(g).name),ne(v,` ${B??""}`)},[()=>new Date(t(g).createdAt).toLocaleDateString()]),f(O,n)}),f(y,V)};j(D,y=>{h().length===0?y(x):y(z,!1)})}a(l);var H=o(l,2);H.__click=N;var L=i(H);It(L,{class:"size-4"}),G(),a(H),G(2),a(S),f(E,S)},$$slots:{default:!0}});var ce=o(le,2),xe=i(ce);xe.__click=()=>u(M,!0);var R=i(xe);lt(R,{class:"size-5"}),G(),a(xe),G(2),a(ce),a(ee);var C=o(ee,2);{var X=E=>{var J=Xt(),S=i(J),l=i(S),D=i(l);ct(D,{class:"size-6"}),G(),a(l);var x=o(l,6),z=i(x);z.__click=()=>u(q,!1),a(x),a(S);var H=o(S,2);H.__click=()=>u(q,!1),a(J),f(E,J)};j(C,E=>{t(q)&&E(X)})}var Y=o(C,2);{let E=U(()=>!!t(A));St(Y,{title:"Supprimer la version",message:"Êtes-vous sûr de vouloir supprimer cette version ? Cette action est irréversible.",variant:"danger",confirmLabel:"Supprimer",get isOpen(){return t(E)},onConfirm:()=>{t(A)&&(e.onDeleteVersion?.(t(A)),u(A,null))},onCancel:()=>u(A,null)})}var te=o(Y,2);{var re=E=>{var J=Yt(),S=i(J),l=i(S),D=i(l);ct(D,{class:"size-8"}),G(2),a(l);var x=o(l,6),z=i(x);z.__click=()=>u(M,!1);var H=o(z,2);H.__click=ae;var L=i(H);lt(L,{class:"size-4"}),G(),a(H),a(x),a(S);var y=o(S,2);y.__click=()=>u(M,!1),a(J),f(E,J)};j(te,E=>{t(M)&&E(re)})}f(Ee,se),He()}Ke(["click"]);var $t=b('<div class="mx-auto mb-2 max-w-sm"><label class="input input-sm w-full"><input type="text" class="grow text-center"/></label></div>'),ea=b('<button type="button"> </button>'),ta=b('<div class="mx-auto mt-2 max-w-sm"><textarea class="textarea textarea-bordered textarea-xs w-full text-center" rows="2" placeholder="Ajouter une description..."></textarea></div>'),aa=b('<span class="no-print opacity-50">(Cliquez pour ajouter une description)</span>'),na=b('<div class="flex items-center justify-center gap-2 px-4"><button type="button"><!></button> <button class="no-print btn btn-ghost btn-circle btn-xs hover:bg-error/10 hover:text-error opacity-0 transition-opacity group-hover/desc:opacity-100" title="Masquer la description"><!></button></div>'),ia=b('<div class="description-container group/desc relative mx-auto max-w-xl text-center"><!></div>'),ra=b("<span> </span>"),oa=b('<div class="mt-3 flex flex-wrap justify-center gap-2"></div>'),sa=b('<div class="text-xs"><span class="text-[0.6rem] font-bold tracking-widest uppercase">Attention:</span> <span> </span></div>'),la=b(`<div class="mx-auto mt-1 max-w-sm"><textarea class="textarea textarea-bordered textarea-xs w-full text-center" rows="3" placeholder="Liste d'ingrédients séparés par des virgules..."></textarea> <p class="mt-1 text-[0.5rem] tracking-tighter uppercase opacity-50">Entrée pour valider · Maj+Entrée pour nouvelle ligne</p></div>`),ca=b('<button type="button"> </button>'),da=b('<div class="text-xs"><span class="text-[0.6rem] font-bold tracking-widest uppercase">Ingrédients:</span> <!></div>'),fa=b('<div class="recipe-container mb-6 svelte-ryaxea"><div class="recipe-actions no-print flex gap-1 svelte-ryaxea"><button class="btn btn-ghost btn-circle hover:bg-error/10 hover:text-error transition-colors" title="Masquer la recette"><!></button></div> <div class="recipe-content bg-transparent p-0 text-center"><!> <!> <!> <div class="mt-3 space-y-1 text-black"><!> <!></div></div></div>');function ua(Ee,e){Ue(e,!0);let r=W(void 0),h=W(void 0),ie=W(void 0),M=W(Ie(e.name)),q=W(!1),A=W(!1),ae=W(""),N=W("");function se(){u(M,e.name,!0),e.onStartEdit(e.recipeKey),setTimeout(()=>{t(r)?.focus(),t(r)?.select()},0)}function ee(){e.onUpdateName(e.recipeKey,t(M)),e.onFinishEdit()}function _e(l){l.key==="Enter"?ee():l.key==="Escape"&&(u(M,e.name,!0),e.onFinishEdit())}function ge(){u(ae,t(C).join(", "),!0),u(q,!0),setTimeout(()=>{t(h)?.focus()},0)}function he(){if(!t(q))return;const l=t(ae).split(/[,;\n]/),D=Array.from(new Set(l.map(x=>x.trim()).filter(x=>x.length>0).map(x=>x.toLowerCase().replace(/\b\w/g,z=>z.toUpperCase()))));e.onUpdateIngredients(e.recipeKey,D),u(q,!1)}function be(l){l.key==="Enter"&&!l.shiftKey?(l.preventDefault(),he()):l.key==="Escape"&&u(q,!1)}function le(){u(N,t(R),!0),u(A,!0),setTimeout(()=>{t(ie)?.focus()},0)}function ce(){t(A)&&(e.onUpdateDescription(e.recipeKey,t(N).trim()),u(A,!1))}function xe(l){l.key==="Enter"&&!l.shiftKey?(l.preventDefault(),ce()):l.key==="Escape"&&u(A,!1)}let R=U(()=>e.customDescription??e.recipeData?.description??""),C=U(()=>e.customIngredients?e.customIngredients:e.recipeData?.ingredients?e.recipeData.ingredients.map(l=>l.name):[]),X=U(()=>{if(!e.recipeData?.ingredients)return[];const l=new mt;return e.recipeData.ingredients.forEach(D=>{D.allergens?.forEach(x=>l.add(x))}),Array.from(l)}),Y=U(()=>e.recipeData?.regime?e.recipeData.regime:[]);function te(l){return`font-size: ${["1.5rem","2rem","2.5rem","3.2rem"][l]||"2.5rem"}`}function re(l){return`font-size: ${["0.7rem","0.85rem","1rem","1.2rem"][l]||"1rem"}`}var E=Ce(),J=oe(E);{var S=l=>{var D=fa(),x=i(D),z=i(x);z.__click=()=>e.onToggle(e.recipeKey);var H=i(z);dt(H,{}),a(z),a(x);var L=o(x,2),y=i(L);{var V=d=>{var c=$t(),k=i(c),_=i(k);ve(_),_.__keydown=_e,$e(_,p=>u(r,p),()=>t(r)),a(k),a(c),et("blur",_,ee),Ve(_,()=>t(M),p=>u(M,p)),f(d,c)},F=d=>{var c=ea();let k;c.__click=se;var _=i(c,!0);a(c),Z(p=>{k=$(c,1,"recipe-title mb-2 block w-full border-none bg-transparent p-0 text-center text-lg text-black transition-colors hover:bg-black/5 svelte-ryaxea",null,k,{"cursor-pointer":!e.isEditing,"montserrat-font":e.config.fontRecettes==="montserrat-font","playfair-display":e.config.fontRecettes==="playfair-display","oswald-font":e.config.fontRecettes==="oswald-font","quicksand-font":e.config.fontRecettes==="quicksand-font","dancing-script":e.config.fontRecettes==="dancing-script","pacifico-regular":e.config.fontRecettes==="pacifico-regular","caveat-font":e.config.fontRecettes==="caveat-font","gluten-font":e.config.fontRecettes==="gluten-font","font-bold":e.config.boldRecettes,italic:e.config.italicRecettes}),Re(c,p),ne(_,e.name)},[()=>te(e.config.fontSizeRecettes)]),f(d,c)};j(y,d=>{e.isEditing?d(V):d(F,!1)})}var O=o(y,2);{var g=d=>{var c=ia(),k=i(c);{var _=B=>{var P=ta(),T=i(P);nt(T),T.__keydown=xe,$e(T,Q=>u(ie,Q),()=>t(ie)),a(P),et("blur",T,ce),Ve(T,()=>t(N),Q=>u(N,Q)),f(B,P)},p=B=>{var P=na(),T=i(P);let Q;T.__click=le;var pe=i(T);{var de=me=>{var we=_t();Z(()=>ne(we,t(R))),f(me,we)},fe=me=>{var we=aa();f(me,we)};j(pe,me=>{t(R)?me(de):me(fe,!1)})}a(T);var Te=o(T,2);Te.__click=()=>e.onToggleDescription(e.recipeKey);var ye=i(Te);dt(ye,{class:"h-3 w-3 opacity-50"}),a(Te),a(P),Z(me=>{Q=$(T,1,"recipe-description block border-none bg-transparent p-0 text-sm text-black opacity-90 transition-colors hover:bg-black/5 svelte-ryaxea",null,Q,{"cursor-pointer":!t(A),"montserrat-font":e.config.fontDesc==="montserrat-font","playfair-display":e.config.fontDesc==="playfair-display","oswald-font":e.config.fontDesc==="oswald-font","quicksand-font":e.config.fontDesc==="quicksand-font","dancing-script":e.config.fontDesc==="dancing-script","pacifico-regular":e.config.fontDesc==="pacifico-regular","caveat-font":e.config.fontDesc==="caveat-font","gluten-font":e.config.fontDesc==="gluten-font","font-bold":e.config.boldDesc,italic:e.config.italicDesc}),Re(T,me)},[()=>re(e.config.fontSizeDesc)]),f(B,P)};j(k,B=>{t(A)?B(_):B(p,!1)})}a(c),f(d,c)};j(O,d=>{(e.config.showDescription||t(A))&&(e.descriptionVisible||t(A))&&d(g)})}var n=o(O,2);{var s=d=>{var c=oa();Se(c,20,()=>t(Y),k=>k,(k,_)=>{var p=ra();let B;var P=i(p,!0);a(p),Z(T=>{B=$(p,1,`border-black
              bg-transparent
              font-medium
              text-black`,null,B,{"montserrat-font":e.config.fontRegimes==="montserrat-font","playfair-display":e.config.fontRegimes==="playfair-display","oswald-font":e.config.fontRegimes==="oswald-font","quicksand-font":e.config.fontRegimes==="quicksand-font","dancing-script":e.config.fontRegimes==="dancing-script","pacifico-regular":e.config.fontRegimes==="pacifico-regular","caveat-font":e.config.fontRegimes==="caveat-font","gluten-font":e.config.fontRegimes==="gluten-font","font-bold":e.config.boldRegimes,italic:e.config.italicRegimes}),Re(p,T),ne(P,_)},[()=>re(e.config.fontSizeRegimes)]),f(k,p)}),a(c),f(d,c)};j(n,d=>{e.config.showRegimes&&t(Y).length>0&&d(s)})}var m=o(n,2),w=i(m);{var K=d=>{var c=sa(),k=o(i(c),2);let _;var p=i(k,!0);a(k),a(c),Z((B,P)=>{Re(k,B),_=$(k,1,"opacity-80",null,_,{"montserrat-font":e.config.fontAlert==="montserrat-font","playfair-display":e.config.fontAlert==="playfair-display","oswald-font":e.config.fontAlert==="oswald-font","quicksand-font":e.config.fontAlert==="quicksand-font","dancing-script":e.config.fontAlert==="dancing-script","pacifico-regular":e.config.fontAlert==="pacifico-regular","caveat-font":e.config.fontAlert==="caveat-font","gluten-font":e.config.fontAlert==="gluten-font","font-bold":e.config.boldAlert,italic:e.config.italicAlert}),ne(p,P)},[()=>re(e.config.fontSizeAlert),()=>t(X).join(", ")]),f(d,c)};j(w,d=>{e.config.showAllergens&&t(X).length>0&&d(K)})}var I=o(w,2);{var v=d=>{var c=da(),k=o(i(c),2);{var _=B=>{var P=la(),T=i(P);nt(T),T.__keydown=be,$e(T,Q=>u(h,Q),()=>t(h)),G(2),a(P),et("blur",T,he),Ve(T,()=>t(ae),Q=>u(ae,Q)),f(B,P)},p=B=>{var P=ca();let T;P.__click=ge;var Q=i(P,!0);a(P),Z((pe,de)=>{T=$(P,1,"mx-auto block border-none bg-transparent p-0 text-xs font-normal capitalize decoration-dotted opacity-80 transition-colors hover:bg-black/5 hover:underline",null,T,{"cursor-pointer":!t(q),"montserrat-font":e.config.fontIng==="montserrat-font","playfair-display":e.config.fontIng==="playfair-display","oswald-font":e.config.fontIng==="oswald-font","quicksand-font":e.config.fontIng==="quicksand-font","dancing-script":e.config.fontIng==="dancing-script","pacifico-regular":e.config.fontIng==="pacifico-regular","caveat-font":e.config.fontIng==="caveat-font","gluten-font":e.config.fontIng==="gluten-font","font-bold":e.config.boldIng,italic:e.config.italicIng}),Re(P,pe),ne(Q,de)},[()=>re(e.config.fontSizeIng),()=>t(C).join(", ")]),f(B,P)};j(k,B=>{t(q)?B(_):B(p,!1)})}a(c),f(d,c)};j(I,d=>{e.config.showIngredients&&(t(C).length>0||t(q))&&d(v)})}a(m),a(L),a(D),f(l,D)};j(J,l=>{e.visible&&l(S)})}f(Ee,E),He()}Ke(["click","keydown"]);var va=b("<div> </div>"),ga=b("<p> </p>"),ba=b("<p> </p>"),ma=b('<div class="separator mx-auto my-6 w-48 border-t border-black opacity-20 svelte-dikxtg"></div>'),_a=b('<div class="mb-8 text-center"><!> <!> <!></div>'),pa=b("<h3> </h3>"),ha=b('<div class="category-block mb-10 svelte-dikxtg"><!> <div class="recipes-grid avoid-break-inside"></div></div>'),xa=b("<div> </div>"),ya=b('<div><div class="group absolute top-4 right-4 print:hidden"><button class="btn btn-circle opacity-60 transition-opacity hover:opacity-100" title="Imprimer cette page"><!></button></div> <div><!> <!> <!> <div><!></div></div></div>'),wa=b('<button class="btn btn-secondary btn-outline flex h-auto max-w-20 flex-col py-3" title="Afficher la recette"><!> <span> </span></button>'),ka=b('<button class="btn btn-secondary btn-outline flex h-auto flex-col py-3" title="Afficher la description"><!> <span><span class="font-bold italic">Desc:</span> </span></button>'),Da=b("<!> <!>",1),Ra=b('<div class="grid grid-cols-[1fr_auto] items-start gap-4 md:p-2 svelte-dikxtg"><div class="flex flex-col items-end gap-8 svelte-dikxtg"></div> <div class="m-auto flex flex-col gap-4 print:hidden svelte-dikxtg"></div></div>');function Ea(Ee,e){Ue(e,!0);let r=Ie({}),h=Ie({}),ie=Ie({});function M(R,C){r[R]=C}function q(R,C){h[R]=C}function A(R){const C=ie[R]??!0;ie[R]=!C}let ae=U(()=>e.date.toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long",year:"numeric"})),N=U(()=>{const R=new Le;return e.meals.forEach(C=>{C.recipes.forEach(X=>{const Y=X.typeR||"autre";R.has(Y)||R.set(Y,[]),R.get(Y).push({...X,mealId:C.id,guests:C.guests})})}),R}),se=["entree","plat","dessert"],ee=U(()=>Array.from(t(N).keys()).sort((C,X)=>{const Y=se.indexOf(C),te=se.indexOf(X);return Y!==-1&&te!==-1?Y-te:Y!==-1?-1:te!==-1?1:C.localeCompare(X)}));function _e(R){return{entree:"Entrée",plat:"Plat",dessert:"Dessert",autre:"Autre"}[R]||R}function ge(R){return`font-size: ${["1.5rem","2rem","2.5rem","3.2rem"][R]||"2.5rem"}`}function he(R){return`font-size: ${["1.3rem","1.7rem","2rem","2.5rem"][R]||"2.5rem"}`}let be=U(()=>e.config.catPageBreak?t(ee).map((R,C)=>({categories:[R],isFirst:C===0,isLast:C===t(ee).length-1})):[{categories:t(ee),isFirst:!0,isLast:!0}]);var le=Ra(),ce=i(le);Se(ce,21,()=>t(be),qe,(R,C,X)=>{const Y=U(()=>X===0?e.sectionId:`${e.sectionId}-page-${X}`);var te=ya(),re=i(te),E=i(re);E.__click=()=>e.onPrintThis(X===0?e.sectionId:`${e.sectionId}-page-${X}`);var J=i(E);ft(J,{class:"h-4 w-4"}),a(E),a(re);var S=o(re,2);let l;var D=i(S);{var x=g=>{var n=va();let s;var m=i(n,!0);a(n),Z(w=>{s=$(n,1,"mb-8 text-center",null,s,{"montserrat-font":e.config.fontTop==="montserrat-font","playfair-display":e.config.fontTop==="playfair-display","oswald-font":e.config.fontTop==="oswald-font","quicksand-font":e.config.fontTop==="quicksand-font","dancing-script":e.config.fontTop==="dancing-script","pacifico-regular":e.config.fontTop==="pacifico-regular","caveat-font":e.config.fontTop==="caveat-font","gluten-font":e.config.fontTop==="gluten-font","font-bold":e.config.boldTop,italic:e.config.italicTop}),Re(n,w),ne(m,e.config.messageTop)},[()=>he(e.config.fontSizeTop)]),f(g,n)};j(D,g=>{e.config.messageTop&&(t(C).isFirst||e.config.dateByPageBreak)&&g(x)})}var z=o(D,2);{var H=g=>{var n=_a(),s=i(n);{var m=d=>{var c=ga();let k;var _=i(c,!0);a(c),Z(p=>{k=$(c,1,"m-0 text-center text-3xl",null,k,{"montserrat-font":e.config.fontDate==="montserrat-font","gluten-font":e.config.fontDate==="gluten-font","pacifico-regular":e.config.fontDate==="pacifico-regular","font-bold":e.config.boldDate,italic:e.config.italicDate}),Re(c,p),ne(_,t(ae))},[()=>ge(e.config.fontSizeDate)]),f(d,c)};j(s,d=>{e.config.showDate&&d(m)})}var w=o(s,2);{var K=d=>{var c=ba();let k;var _=i(c,!0);a(c),Z(p=>{k=$(c,1,"m-0 text-center text-3xl",null,k,{"montserrat-font":e.config.fontHoraire==="montserrat-font","playfair-display":e.config.fontHoraire==="playfair-display","oswald-font":e.config.fontHoraire==="oswald-font","quicksand-font":e.config.fontHoraire==="quicksand-font","dancing-script":e.config.fontHoraire==="dancing-script","pacifico-regular":e.config.fontHoraire==="pacifico-regular","caveat-font":e.config.fontHoraire==="caveat-font","gluten-font":e.config.fontHoraire==="gluten-font","font-bold":e.config.boldHoraire,italic:e.config.italicHoraire}),Re(c,p),ne(_,e.horaire)},[()=>ge(e.config.fontSizeHoraire)]),f(d,c)};j(w,d=>{e.config.showHoraire&&d(K)})}var I=o(w,2);{var v=d=>{var c=ma();f(d,c)};j(I,d=>{(e.config.showHoraire||e.config.showDate)&&d(v)})}a(n),f(g,n)};j(z,g=>{(t(C).isFirst||e.config.dateByPageBreak)&&g(H)})}var L=o(z,2);Se(L,16,()=>t(C).categories,g=>g,(g,n)=>{var s=ha(),m=i(s);{var w=I=>{var v=pa();let d;var c=i(v,!0);a(v),Z((k,_)=>{d=$(v,1,"mb-6 text-center text-xl tracking-widest uppercase opacity-60",null,d,{"montserrat-font":e.config.fontCat==="montserrat-font","playfair-display":e.config.fontCat==="playfair-display","oswald-font":e.config.fontCat==="oswald-font","quicksand-font":e.config.fontCat==="quicksand-font","dancing-script":e.config.fontCat==="dancing-script","pacifico-regular":e.config.fontCat==="pacifico-regular","caveat-font":e.config.fontCat==="caveat-font","gluten-font":e.config.fontCat==="gluten-font","font-bold":e.config.boldCat,italic:e.config.italicCat}),Re(v,k),ne(c,_)},[()=>ge(e.config.fontSizeCat),()=>_e(n)]),f(I,v)};j(m,I=>{e.config.showCategories&&I(w)})}var K=o(m,2);Se(K,21,()=>t(N).get(n)??[],I=>I.recipeUuid,(I,v)=>{const d=U(()=>`${e.dateKey}${e.horaire}_${t(v).recipeUuid}`),c=U(()=>e.recipeVisibility[t(d)]??!0),k=U(()=>e.recipeNames[t(d)]||Ne.getRecipeIndexByUuid(t(v).recipeUuid)?.title||t(v).recipeUuid),_=U(()=>e.recipesDetails.find(Q=>Q.$id===t(v).recipeUuid)||null),p=U(()=>ie[t(d)]??!0);var B=Ce(),P=oe(B);{var T=Q=>{{let pe=U(()=>r[t(d)]||null),de=U(()=>h[t(d)]||null),fe=U(()=>e.editingRecipe===t(d));ua(Q,{get recipeKey(){return t(d)},get recipeUuid(){return t(v).recipeUuid},get plates(){return t(v).plates},get typeR(){return t(v).typeR},get category(){return n},get config(){return e.config},get visible(){return t(c)},get name(){return t(k)},get recipeData(){return t(_)},get customIngredients(){return t(pe)},get customDescription(){return t(de)},get descriptionVisible(){return t(p)},get isEditing(){return t(fe)},get onToggle(){return e.onToggleRecipe},get onStartEdit(){return e.onStartEditRecipe},get onFinishEdit(){return e.onFinishEditRecipe},get onUpdateName(){return e.onUpdateRecipeName},onUpdateIngredients:M,onUpdateDescription:q,onToggleDescription:A})}};j(P,Q=>{t(c)&&Q(T)})}f(I,B)}),a(K),a(s),f(g,s)});var y=o(L,2);let V;var F=i(y);{var O=g=>{var n=xa();let s;var m=i(n,!0);a(n),Z(w=>{s=$(n,1,"text-center opacity-60",null,s,{"montserrat-font":e.config.fontBottom==="montserrat-font","playfair-display":e.config.fontBottom==="playfair-display","oswald-font":e.config.fontBottom==="oswald-font","quicksand-font":e.config.fontBottom==="quicksand-font","dancing-script":e.config.fontBottom==="dancing-script","pacifico-regular":e.config.fontBottom==="pacifico-regular","caveat-font":e.config.fontBottom==="caveat-font","gluten-font":e.config.fontBottom==="gluten-font","font-bold":e.config.boldBottom,italic:e.config.italicBottom}),Re(n,w),ne(m,e.config.messageBottom)},[()=>he(e.config.fontSizeBottom)]),f(g,n)};j(F,g=>{e.config.messageBottom&&g(O)})}a(y),a(S),a(te),Z(()=>{pt(te,"id",t(Y)),$(te,1,`meal-poster-section relative flex max-w-svw bg-white
        shadow-2xl transition-shadow ${e.currentPrintTarget!==null&&e.currentPrintTarget!==t(Y)&&"no-print"}`,"svelte-dikxtg"),l=$(S,1,"poster-content text-black svelte-dikxtg",null,l,{"centered-content":e.config.centerVertical}),V=$(y,1,"pt-8",null,V,{"mt-auto":!e.config.centerVertical})}),f(R,te)}),a(ce);var xe=o(ce,2);Se(xe,21,()=>t(ee),qe,(R,C)=>{var X=Ce(),Y=oe(X);Se(Y,17,()=>t(N).get(t(C))??[],qe,(te,re)=>{const E=U(()=>`${e.dateKey}${e.horaire}_${t(re).recipeUuid}`),J=U(()=>e.recipeVisibility[t(E)]??!0),S=U(()=>ie[t(E)]??!0),l=U(()=>e.getRecipeName(t(E),Ne.getRecipeIndexByUuid(t(re).recipeUuid)?.title||"Recette"));var D=Da(),x=oe(D);{var z=y=>{var V=wa();V.__click=()=>e.onToggleRecipe(t(E));var F=i(V);At(F,{class:"size-5"});var O=o(F,2),g=i(O,!0);a(O),a(V),Z(()=>ne(g,t(l))),f(y,V)};j(x,y=>{t(J)||y(z)})}var H=o(x,2);{var L=y=>{var V=ka();V.__click=()=>A(t(E));var F=i(V);Vt(F,{class:"size-5"});var O=o(F,2),g=o(i(O));a(O),a(V),Z(()=>ne(g,` ${t(l)??""}`)),f(y,V)};j(H,y=>{t(J)&&!t(S)&&y(L)})}f(te,D)}),f(R,X)}),a(xe),a(le),f(Ee,le),He()}Ke(["click"]);var Sa=b('<div class="bg-base-200 flex-1 overflow-auto p-4 print:m-0 print:overflow-visible print:p-0"><div class="mx-auto max-w-5xl print:m-0 print:w-full print:max-w-none"></div></div>');function Ia(Ee,e){Ue(e,!0);let r=U(()=>{const M=[];return e.groupedMeals.forEach((q,A)=>{q.forEach((ae,N)=>{M.push({dateKey:A,date:new Date(A),horaire:N,meals:ae})})}),M.sort((q,A)=>q.date.getTime()-A.date.getTime())});var h=Sa(),ie=i(h);Se(ie,21,()=>t(r),M=>M.dateKey+M.horaire,(M,q)=>{const A=U(()=>`affiche${t(q).dateKey}${t(q).horaire}`);Ea(M,{get sectionId(){return t(A)},get dateKey(){return t(q).dateKey},get date(){return t(q).date},get horaire(){return t(q).horaire},get meals(){return t(q).meals},get config(){return e.config},get currentPrintTarget(){return e.currentPrintTarget},get recipesDetails(){return e.recipesDetails},get recipeVisibility(){return e.recipeVisibility},get recipeNames(){return e.recipeNames},get editingRecipe(){return e.editingRecipe},get onPrintThis(){return e.printThis},get onToggleRecipe(){return e.toggleRecipeVisibility},get onStartEditRecipe(){return e.startEditingRecipe},get onFinishEditRecipe(){return e.finishEditingRecipe},get onUpdateRecipeName(){return e.updateRecipeName},get getRecipeName(){return e.getRecipeName}})}),a(ie),a(h),f(Ee,h),He()}var Ca=b('<button class="btn btn-primary btn-sm gap-2"><!> Imprimer tout</button>'),Ta=b('<div class="flex min-h-[60vh] items-center justify-center"><div class="loading loading-spinner loading-lg text-primary"></div></div>'),za=b('<div class="container mx-auto p-4"><div class="alert alert-error max-md:alert-vertical"><!> <span> </span></div></div>'),Ba=b('<div class="flex min-h-[60vh] items-center justify-center"><div class="alert alert-info alert-vertical"><!> <p class="text-lg">Aucune recette pour le moment</p></div></div>'),Pa=b('<!> <div class="bg-base-200 min-h-screen print:h-auto print:min-h-0"><div class="mx-auto px-4 py-4 print:hidden"><!></div> <div><!></div></div>',1);function Fa(Ee,e){Ue(e,!0);const r=n=>{var s=Ca();s.__click=S;var m=i(s);ft(m,{class:"h-5 w-5"}),G(),a(s),f(n,s)};let h=U(()=>ze.getEventById(De.params.id));const ie=U(()=>t(h)?.status==="local"?"/demo/event":"/dashboard/eventEdit");let M=W(!1),q=W(null),A=W(Ie([])),ae=W(!1),N=W(Ie({showDate:!0,showHoraire:!0,showDescription:!1,showCategories:!0,showRecipes:!0,showRegimes:!1,showAllergens:!1,showIngredients:!1,catPageBreak:!1,dateByPageBreak:!1,messageTop:"",fontTop:"montserrat-font",fontSizeTop:1,boldTop:!1,italicTop:!1,messageBottom:"",fontBottom:"montserrat-font",fontSizeBottom:1,boldBottom:!1,italicBottom:!1,fontDate:"montserrat-font",fontSizeDate:1,boldDate:!1,italicDate:!1,fontHoraire:"montserrat-font",fontSizeHoraire:1,boldHoraire:!1,italicHoraire:!1,fontCat:"montserrat-font",fontSizeCat:1,boldCat:!1,italicCat:!1,fontRecettes:"pacifico-regular",fontSizeRecettes:2,boldRecettes:!1,italicRecettes:!1,fontDesc:"montserrat-font",fontSizeDesc:1,boldDesc:!1,italicDesc:!1,fontRegimes:"montserrat-font",fontSizeRegimes:1,boldRegimes:!1,italicRegimes:!1,fontAlert:"montserrat-font",fontSizeAlert:1,boldAlert:!1,italicAlert:!1,fontIng:"montserrat-font",fontSizeIng:1,boldIng:!1,italicIng:!1,centerVertical:!0})),se=W(Ie([])),ee=W(null),_e=W(null),ge=W(!1);const he=U(()=>{if(!t(h))return!1;const n=ue.userId||"";return t(h).createdBy===n?!0:t(h).contributors?.find(m=>m.id===n)?.status==="accepted"});let be=Ie({}),le=Ie({}),ce=W(null),xe=U(()=>{if(!t(h)?.meals)return new Le;const n=new Le;return t(h).meals.forEach(s=>{const m=new Date(s.date),w=m.toISOString().split("T")[0],K=m.getHours(),I=K<12?"Petit-déjeuner":K<14?"Déjeuner":K<18?"Goûter":"Dîner";n.has(w)||n.set(w,new Le);const v=n.get(w);v.has(I)||v.set(I,[]),v.get(I).push(s)}),n});ht(()=>{(async()=>{if(await xt(),!await yt(De.params.id)){u(q,"Événement non trouvé"),u(M,!1);return}if(!t(h)){u(M,!0);try{await ze.fetchEvent(De.params.id)}catch(s){u(q,s instanceof Error?s.message:"Erreur de chargement",!0)}finally{u(M,!1)}}await R()})()});async function R(){try{const n=await ze.loadPosterConfig(De.params.id);n&&(console.log("[EventPoster] Configuration chargée depuis le cache"),n.current?(u(N,{...t(N),...n.current},!0),u(se,n.versions||[],!0)):(u(N,{...t(N),...n},!0),u(se,[],!0)))}catch(n){console.error("[EventPoster] Erreur chargement config cache:",n)}}async function C(){try{await ze.savePosterConfig(De.params.id,ot(t(N))),ue.toast.success("Configuration sauvegardée",{details:"Les réglages courants sont enregistrés localement."})}catch(n){console.error("[EventPoster] Erreur sauvegarde config cache:",n),ue.toast.error("Erreur de sauvegarde",{details:"Impossible d'enregistrer la configuration localement."})}}async function X(){try{const n=new Date,m=`Version du ${new Intl.DateTimeFormat("fr-FR",{dateStyle:"short",timeStyle:"short"}).format(n)}`,w=await ze.createPosterVersion(De.params.id,ot(t(N)),m);await R(),w&&u(ee,w.id,!0),ue.toast.success("Version créée",{details:"Une nouvelle version de la configuration a été archivée."})}catch(n){console.error("[EventPoster] Erreur création version:",n),ue.toast.error("Erreur de création",{details:n.message||"Impossible de créer une nouvelle version."})}}async function Y(n){try{await ze.deletePosterVersion(De.params.id,n),u(se,t(se).filter(s=>s.id!==n),!0),t(ee)===n&&u(ee,null),ue.toast.success("Version supprimée",{details:"La version archivée a été supprimée."})}catch(s){console.error("[EventPoster] Erreur suppression version:",s),ue.toast.error("Erreur de suppression",{details:"Impossible de supprimer la version."})}}function te(n){u(N,{...t(N),...n.config},!0),u(ee,n.id,!0),ue.toast.info("Version chargée",{details:`La configuration "${n.name}" a été appliquée.`})}it(()=>{if(!t(h)||t(M))return;if(!(t(h).meals&&t(h).meals.some(s=>s.recipes&&s.recipes.length>0))){u(ae,!1);return}t(A).length===0&&!t(ae)&&re().then(()=>{E()})});async function re(){if(!t(h)?.meals)return;const n=t(h).meals.flatMap(s=>s.recipes.map(m=>m.recipeUuid));if(n.length===0){u(ae,!1);return}u(ae,!0);try{console.log(`[EventPoster] Loading ${n.length} recipes (bulk mode)...`);const s=await Ne.getRecipesByUuidsBulk(n);u(A,Array.from(s.values()).filter(m=>m!==null),!0),console.log(`[EventPoster] Loaded ${t(A).length}/${n.length} recipes in bulk`),console.log("[EventPoster] Recipe IDs:",t(A).map(m=>m.$id))}catch(s){console.error("Erreur lors du chargement des recettes:",s)}finally{u(ae,!1)}}function E(){t(h)?.meals&&t(h).meals.forEach(n=>{const s=new Date(n.date),m=s.toISOString().split("T")[0],w=s.getHours(),K=w<12?"Petit-déjeuner":w<14?"Déjeuner":w<18?"Goûter":"Dîner",I=`${m}${K}`;n.recipes.forEach(v=>{const d=`${I}_${v.recipeUuid}`;be[d]=!0;const c=Ne.getRecipeIndexByUuid(v.recipeUuid);le[d]=c?.title||v.recipeUuid})})}async function J(n){u(_e,n,!0),await rt(),setTimeout(()=>{window.print(),u(_e,null)},400)}async function S(){u(_e,null),await rt(),setTimeout(()=>{window.print()},400)}function l(n){be[n]=!be[n],be[n]||console.log("to-implement")}function D(n){u(ce,n,!0)}function x(){u(ce,null)}function z(n,s){le[n]=s}function H(n,s){return le[n]||s}function L(){kt(`${t(ie)}/${De.params.id}`)}async function y(n){if(!(!De.params.id||!ue.userId))try{u(ge,!0);const s=n?"accepted":"declined";await ze.updateContributorStatus(De.params.id,ue.userId,s),ue.toast.success(n?"Invitation acceptée":"Invitation déclinée")}catch(s){console.error("Erreur réponse invitation:",s),ue.toast.error("Erreur lors de la réponse")}finally{u(ge,!1)}}it(()=>{t(h)&&st.setConfig({title:`Affiches : ${t(h).name}`,backAction:L,actions:r})}),wt(()=>{st.reset()});var V=Ce(),F=oe(V);{var O=n=>{var s=Ta();f(n,s)},g=n=>{var s=Ce(),m=oe(s);{var w=I=>{var v=za(),d=i(v),c=i(d);qt(c,{class:"h-6 w-6 shrink-0"});var k=o(c,2),_=i(k,!0);a(k),a(d),a(v),Z(()=>ne(_,t(q))),f(I,v)},K=I=>{var v=Ce(),d=oe(v);{var c=_=>{var p=Ba(),B=i(p),P=i(B);Ut(P,{}),G(2),a(B),a(p),f(_,p)},k=_=>{var p=Ce(),B=oe(p);{var P=T=>{var Q=Pa(),pe=oe(Q);Ht(pe,{bgClass:"bg-base-200",width:"120",children:(we,je)=>{{let Me=U(()=>!t(he));Zt(we,{get versions(){return t(se)},get activeVersionId(){return t(ee)},onSave:C,onCreateVersion:X,onDeleteVersion:Y,onLoadVersion:te,get disabled(){return t(Me)},get config(){return t(N)},set config(Be){u(N,Be,!0)}})}},$$slots:{default:!0}});var de=o(pe,2),fe=i(de),Te=i(fe);Et(Te,{get currentEvent(){return t(h)},get isBusy(){return t(ge)},onRespond:y}),a(fe);var ye=o(fe,2),me=i(ye);Ia(me,{get event(){return t(h)},get groupedMeals(){return t(xe)},get config(){return t(N)},get currentPrintTarget(){return t(_e)},get recipesDetails(){return t(A)},get recipeVisibility(){return be},get recipeNames(){return le},get editingRecipe(){return t(ce)},printThis:J,toggleRecipeVisibility:l,startEditingRecipe:D,finishEditingRecipe:x,updateRecipeName:z,getRecipeName:H}),a(ye),a(de),Z(()=>$(ye,1,`print:m-0 print:p-0 ${ue.isDesktop?"ml-80":""}`)),Dt(3,de,()=>Rt),f(T,Q)};j(B,T=>{t(h)&&T(P)},!0)}f(_,p)};j(d,_=>{!t(h)||t(h).meals&&t(h).meals.length>0&&t(h).meals.every(p=>!p.recipes||p.recipes.length===0)?_(c):_(k,!1)},!0)}f(I,v)};j(m,I=>{t(q)?I(w):I(K,!1)},!0)}f(n,s)};j(F,n=>{t(M)?n(O):n(g,!1)})}f(Ee,V),He()}Ke(["click"]);export{Fa as default};
