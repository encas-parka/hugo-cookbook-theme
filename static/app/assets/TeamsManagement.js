import{B as H,d as N,v,h as r,o as t,g as c,K as w,m as o,u as q,w as G,x as D,b as i,c as W,I as O,G as X,F as j,J as ee,Y as ae,k as L,y as R,P as te,A as B,j as Y,e as re}from"./appwrite.js";import{U as $,Z as se,d as ne,c as oe}from"./icons.js";import{C as ie,T as de}from"./CreateTeamModal.js";import{n as Z,a as le}from"./index.js";import"./ConfirmModal.js";import"./InfoCollapse.js";var ve=v('<p class="text-base-content/70 mb-2 line-clamp-2 text-sm"> </p>'),ce=v('<div class="badge badge-warning badge-sm gap-1"> </div>'),me=v(`<button class="btn btn-ghost btn-xs text-error" title="Quitter l'équipe"><!> Quitter</button>`),ue=v("<span></span>"),be=v('<div class="card bg-base-100 border-base-200 hover:border-primary/50 group cursor-pointer border text-left shadow-xl transition-all hover:shadow-2xl" role="button" tabindex="0"><div class="card-body"><div class="mb-2 flex items-start justify-between"><h3 class="card-title group-hover:text-primary text-lg transition-colors"> </h3></div> <!> <div class="text-base-content/70 mt-2 flex items-center gap-4 text-sm"><div class="flex items-center gap-1"><!> <span> </span></div> <!></div> <div class="card-actions mt-4 justify-between"><!> <span class="text-primary flex items-center gap-1 text-xs font-semibold opacity-0 transition-opacity group-hover:opacity-100">Gérer <!></span></div></div></div>');function fe(Q,s){N(s,!0);const A=q(()=>{const e=O.userId;return e&&s.team.members.find(l=>l.id===e)?.roles?.[0]||null}),g=q(()=>s.team.members.filter(e=>e.confirmed)),_=q(()=>s.team.members.filter(e=>!e.confirmed).length),k=q(()=>s.team.prefs?.description),V=q(()=>{const e=s.team.members.find(a=>a.id===O.userId);return e&&e.confirmed});async function S(){const e=s.team.members.find(a=>a.id===O.userId);e&&e.roles?.[0]!=="owner"&&await j.removeMember(s.teamId,e.$id)}var b=be();b.__click=()=>s.onClick(s.team.$id),b.__keydown=e=>{(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),s.onClick(s.team.$id))};var U=r(b),x=r(U),p=r(x),E=r(p,!0);t(p),t(x);var P=c(x,2);{var F=e=>{var a=ve(),l=r(a,!0);t(a),G(()=>D(l,o(k))),i(e,a)};w(P,e=>{o(k)&&e(F)})}var h=c(P,2),C=r(h),n=r(C);$(n,{class:"h-4 w-4"});var d=c(n,2),T=r(d);t(d),t(C);var J=c(C,2);{var K=e=>{var a=ce(),l=r(a);t(a),G(()=>D(l,`${o(_)??""} invitation${o(_)>1?"s":""}`)),i(e,a)};w(J,e=>{o(A)==="owner"&&o(_)>0&&e(K)})}t(h);var m=c(h,2),u=r(m);{var y=e=>{var a=me();a.__click=M=>{M.stopPropagation(),S()};var l=r(a);ne(l,{class:"h-4 w-4"}),X(),t(a),i(e,a)},I=e=>{var a=ue();i(e,a)};w(u,e=>{o(V)&&o(A)!=="owner"?e(y):e(I,!1)})}var z=c(u,2),f=c(r(z));se(f,{class:"h-4 w-4"}),t(z),t(m),t(U),t(b),G(()=>{D(E,s.team.name),D(T,`${o(g).length??""} membre${o(g).length>1?"s":""}`)}),i(Q,b),W()}H(["click","keydown"]);var _e=v('<button class="btn btn-primary btn-sm"><!> Créer une équipe</button>'),pe=v('<div class="alert alert-warning"><span>Vous devez être connecté pour voir vos équipes</span></div>'),ge=v('<div class="alert alert-error shadow-lg"><span> </span></div>'),xe=v(`<div class="bg-base-200 rounded-box border-base-200 border-2 border-dashed py-20 text-center"><div class="bg-base-200 mb-4 inline-block rounded-full p-4"><!></div> <h3 class="mb-2 text-lg font-bold">Aucune équipe</h3> <p class="text-base-content/60 mb-6">Vous n'avez pas encore créé ou rejoint d'équipe.</p> <button class="btn btn-primary btn-sm">Créer ma première équipe</button></div>`),he=v('<div class="grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3"></div>'),ye=v('<div class="mx-auto max-w-7xl px-4 py-8"><!></div> <!> <!>',1);function qe(Q,s){N(s,!0);const A=n=>{var d=_e();d.__click=S;var T=r(d);oe(T,{class:"h-4 w-4"}),X(),t(d),i(n,d)};let g=R(!1),_=R(null);function k(n){B(_,n,!0)}function V(){B(_,null)}function S(){B(g,!0)}function b(){B(g,!1)}function U(n){b(),k(n)}ee(()=>{Z.setConfig({title:"Équipes",actions:A})}),ae(()=>{Z.reset()});var x=ye(),p=L(x),E=r(p);{var P=n=>{var d=pe();i(n,d)},F=n=>{var d=Y(),T=L(d);{var J=m=>{var u=ge(),y=r(u),I=r(y,!0);t(y),t(u),G(()=>D(I,j.error)),i(m,u)},K=m=>{var u=Y(),y=L(u);{var I=f=>{var e=xe(),a=r(e),l=r(a);$(l,{class:"h-8 w-8 opacity-50"}),t(a);var M=c(a,6);M.__click=S,t(e),i(f,e)},z=f=>{var e=he();re(e,21,()=>j.teams,a=>a.$id,(a,l)=>{fe(a,{get team(){return o(l)},get teamId(){return o(l).$id},onClick:M=>k(M)})}),t(e),i(f,e)};w(y,f=>{j.count===0?f(I):f(z,!1)},!0)}i(m,u)};w(T,m=>{j.error?m(J):m(K,!1)},!0)}i(n,d)};w(E,n=>{O.isAuthenticated?n(F,!1):n(P)})}t(p);var h=c(p,2);ie(h,{get isOpen(){return o(g)},onClose:b,onSuccess:U});var C=c(h,2);de(C,{get teamId(){return o(_)},onClose:V}),te(3,p,()=>le),i(Q,x),W()}H(["click"]);export{qe as default};
