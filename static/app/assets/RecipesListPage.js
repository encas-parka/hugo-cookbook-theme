import{d as xe,p as De,v as u,g as c,h as o,T as Qe,b as s,c as ye,B as we,W as He,o as i,e as oe,i as le,k as L,A as de,y as _e,m as t,u as Z,w,x as z,C as I,G as $,K as m,j as ee,U as Fe,I as ve,E as Re,M as Me,a9 as ge,aa as qe,ab as Te,z as Ke,J as Ae,ac as Ue,D as Xe,Y as Ge,X as Je,N as ce,P as ze,R as We}from"./appwrite.js";import{S as Ye,X as Ve,F as Ze,o as $e,p as et,q as tt,r as at,s as rt,t as st,u as nt,v as it,A as ot,l as lt,w as dt,c as ct}from"./icons.js";import{F as be}from"./Fieldset.js";import{A as vt}from"./AutocompleteInput.js";import{B as ut}from"./BadgeList.js";import{C as Be}from"./CheckboxBadge.js";import{R as Pe}from"./RecipeRegimeBadges.js";import{L as bt}from"./LeftPanel.js";import{r as Ie}from"./RecipeDataStore.svelte.js";import{n as Oe,a as Le}from"./index.js";import"./keyboardNavigation.svelte.js";var _t=u('<div><label class="input input-lg w-full"><!> <input type="text" placeholder="Rechercher... (parmi les titres, auteur·ices, spécialités. Désactive les filtres sélectionnés)"/> <button class="btn btn-circle" title="Effacer la recherche"><!></button></label></div>');function gt(te,a){xe(a,!0);let n=De(a,"searchQuery",15);var d=_t(),E=o(d),S=o(E);Ye(S,{class:"h-5 w-5 opacity-50"});var j=c(S,2);He(j);var q=c(j,2);q.__click=function(...K){a.onReset?.apply(this,K)};var Q=o(q);Ve(Q,{class:"h-5 w-5"}),i(q),i(E),i(d),Qe(j,n),s(te,d),ye()}we(["click"]);var ft=u('<div class="flex flex-wrap gap-3"></div>'),mt=u('<div class="flex flex-wrap gap-3"></div>'),pt=u('<div class="mb-3"><!></div> <div><div class="mb-2 text-xs font-medium"> </div> <!></div>',1),ht=u('<div class="bg-base-100 flex gap-1 rounded-xl p-2 font-semibold"><button type="button" aria-label="Toutes">Toutes</button> <button type="button" aria-label="Testées">Testées</button> <button type="button" aria-label="Non testées">À tester</button></div>'),xt=u('<div class="bg-base-100 flex gap-1 rounded-xl p-2 font-semibold"><button type="button" aria-label="Indifférent">Indifférent</button> <button type="button" aria-label="Servir chaud">Chaud</button> <button type="button" aria-label="Servir froid">Froid</button></div>'),yt=u('<div class="bg-base-100 flex gap-1 rounded-xl p-2 font-semibold"><button type="button" aria-label="Indifférent">Indifférent</button> <button type="button" aria-label="Avec cuisson">Avec</button> <button type="button" aria-label="Sans cuisson">Sans</button></div>'),wt=u('<div class="bg-base-100 flex flex-wrap gap-1 rounded-xl p-2 font-semibold"><button type="button" aria-label="Indifférent">Toutes</button> <button type="button" aria-label="Printemps">Printemps</button> <button type="button" aria-label="Été">Été</button> <button type="button" aria-label="Automne">Automne</button> <button type="button" aria-label="Hiver">Hiver</button></div>'),Ct=u('<div><div class="mb-4 flex items-center justify-between"><h4 class="text-lg font-bold">Filtres</h4> <button class="btn btn-warning btn-sm"><!> Effacer</button></div> <!> <!> <!> <!> <!> <!> <!></div>');function kt(te,a){xe(a,!0);let n=De(a,"filters",15),d=De(a,"disabled",3,!1);function E(v,h){const l=v.indexOf(h);l===-1?v.push(h):v.splice(l,1),n({...n()})}let S=_e("");function j(v){n().ingredients.includes(v)||(n().ingredients.push(v),n({...n()}))}function q(v,h){const l=n().ingredients.indexOf(v);l!==-1&&(n().ingredients.splice(l,1),n({...n()}))}let Q=Z(()=>a.availableIngredients.filter(v=>!n().ingredients.includes(v)));var K=Ct();let ne;var re=o(K),W=c(o(re),2);W.__click=function(...v){a.onReset?.apply(this,v)};var C=o(W);Ze(C,{class:"h-4 w-4"}),$(),i(W),i(re);var B=c(re,2);be(B,{legend:"Catégories",get iconComponent(){return $e},children:(v,h)=>{var l=ft();oe(l,21,()=>a.availableCategories,le,(g,_)=>{{let p=Z(()=>n().categories.includes(t(_)));Be(g,{get checked(){return t(p)},get label(){return t(_)},onchange:()=>E(n().categories,t(_)),get disabled(){return d()}})}}),i(l),s(v,l)},$$slots:{default:!0}});var U=c(B,2);be(U,{legend:"Régimes",get iconComponent(){return et},children:(v,h)=>{var l=mt();oe(l,21,()=>a.availableRegimes,le,(g,_)=>{{let p=Z(()=>n().regimes.includes(t(_)));Be(g,{get checked(){return t(p)},get label(){return t(_)},onchange:()=>E(n().regimes,t(_)),get disabled(){return d()}})}}),i(l),s(v,l)},$$slots:{default:!0}});var X=c(U,2);be(X,{legend:"Ingrédients",get iconComponent(){return tt},children:(v,h)=>{var l=pt(),g=L(l),_=o(g);vt(_,{get items(){return t(Q)},onSelect:j,placeholder:"Ajouter un ingrédient...",get disabled(){return d()},minQueryLength:1,get value(){return t(S)},set value(G){de(S,G,!0)}}),i(g);var p=c(g,2),P=o(p),R=o(P);i(P);var H=c(P,2);ut(H,{get items(){return n().ingredients},onRemove:q,badgeClass:"badge-success",get disabled(){return d()},itemKey:(G,V)=>G}),i(p),w(()=>z(R,`Ingrédients sélectionnés (${n().ingredients.length??""})`)),s(v,l)},$$slots:{default:!0}});var J=c(X,2);be(J,{legend:"Testé",children:(v,h)=>{var l=ht(),g=o(l);g.__click=()=>n(n().testedStatus="all",!0);var _=c(g,2);_.__click=()=>n(n().testedStatus="tested",!0);var p=c(_,2);p.__click=()=>n(n().testedStatus="untested",!0),i(l),w(()=>{I(g,1,`btn btn-sm flex-1 ${n().testedStatus==="all"&&"btn-secondary"}`),I(_,1,`btn btn-sm flex-1 ${n().testedStatus==="tested"&&"btn-success"}`),I(p,1,`btn btn-sm flex-1 ${n().testedStatus==="untested"&&"btn-error"}`)}),s(v,l)},$$slots:{default:!0}});var D=c(J,2);be(D,{legend:"Service",get iconComponent(){return at},children:(v,h)=>{var l=xt(),g=o(l);g.__click=()=>n(n().temperature="",!0);var _=c(g,2);_.__click=()=>n(n().temperature="Chaud",!0);var p=c(_,2);p.__click=()=>n(n().temperature="Froid",!0),i(l),w(()=>{I(g,1,`btn btn-sm flex-1 ${n().temperature===""&&"btn-secondary"}`),I(_,1,`btn btn-sm flex-1 ${n().temperature==="Chaud"&&"btn-error"}`),I(p,1,`btn btn-sm flex-1 ${n().temperature==="Froid"&&"btn-info"}`)}),s(v,l)},$$slots:{default:!0}});var M=c(D,2);be(M,{legend:"Cuisson",get iconComponent(){return rt},children:(v,h)=>{var l=yt(),g=o(l);g.__click=()=>n(n().cuisson="",!0);var _=c(g,2);_.__click=()=>n(n().cuisson="Oui",!0);var p=c(_,2);p.__click=()=>n(n().cuisson="Non",!0),i(l),w(()=>{I(g,1,`btn btn-sm flex-1 ${n().cuisson===""&&"btn-secondary"}`),I(_,1,`btn btn-sm flex-1 ${n().cuisson==="Oui"&&"btn-warning"}`),I(p,1,`btn btn-sm flex-1 ${n().cuisson==="Non"&&"btn-success"}`)}),s(v,l)},$$slots:{default:!0}});var Y=c(M,2);be(Y,{legend:"Saison",get iconComponent(){return st},children:(v,h)=>{var l=wt(),g=o(l);g.__click=()=>n(n().saison="",!0);var _=c(g,2);_.__click=()=>n(n().saison="printemps",!0);var p=c(_,2);p.__click=()=>n(n().saison="ete",!0);var P=c(p,2);P.__click=()=>n(n().saison="automne",!0);var R=c(P,2);R.__click=()=>n(n().saison="hiver",!0),i(l),w(()=>{I(g,1,`btn btn-sm flex-1 ${n().saison===""&&"btn-secondary"}`),I(_,1,`btn btn-sm flex-1 ${n().saison==="printemps"&&"btn-success"}`),I(p,1,`btn btn-sm flex-1 ${n().saison==="ete"&&"btn-warning"}`),I(P,1,`btn btn-sm flex-1 ${n().saison==="automne"&&"btn-accent"}`),I(R,1,`btn btn-sm flex-1 ${n().saison==="hiver"&&"btn-info"}`)}),s(v,l)},$$slots:{default:!0}}),i(K),w(()=>{ne=I(K,1,"mt-13 space-y-4 sm:mt-16",null,ne,{"opacity-30":d()}),W.disabled=d()}),s(te,K),ye()}we(["click"]);var St=u(`<span class="font-semibold"> </span> correspondent
          aux critères`,1),Rt=u(`<span class="font-semibold"> </span> correspondent
          aux critères`,1),At=u('<span class="font-semibold"> </span> correspond aux critères',1),It=u('<span class="font-semibold">1 recette</span> correspond aux critères',1),Dt=u('<span class="text-warning"> </span> ne correspond aux critères...',1),Ft=u('<span class="text-warning">Aucune recette</span> ne correspond aux critères...',1),Mt=u('<legend class="legend text-base-content/70 ms-4"><!></legend>'),Tt=u('<div class="text-base-content/70 text-base"><!></div>'),zt=u('<div><span class="text-base-content/60 italic">contient (dans son titre/auteur·ice...) :</span> <span class="font-bold"> </span></div>'),Bt=u('<span class="badge badge-success"> </span>'),Pt=u('<span class="badge badge-secondary"> </span>'),Ot=u('<span class="badge badge-error text-white">Servir Chaud</span>'),Lt=u('<span class="badge badge-info">Servir Froid</span>'),Nt=u('<span class="badge badge-warning">Avec Cuisson</span>'),Et=u('<span class="badge badge-success">Sans Cuisson</span>'),jt=u('<span class="badge badge-accent"> </span>'),Qt=u('<span class="badge badge-success"> </span>'),Ht=u('<span class="badge badge-success">Testées</span>'),qt=u('<span class="badge badge-error">À tester</span>'),Kt=u('<span class="badge badge-warning"> </span>'),Ut=u('<div class="flex flex-wrap gap-2"><!> <!> <!> <!> <!> <!> <!> <!></div> <div class="mt-3 text-end"><button class="btn btn-warning btn-sm"><!> Effacer tous les filtres</button></div>',1),Xt=u('<fieldset class="fieldset border-base-300 relative rounded-lg border-2"><!> <div class="p-4"><!> <!></div></fieldset>');function Gt(te,a){xe(a,!0);const n=Z(()=>a.filters.categories.length>0||a.filters.regimes.length>0||a.filters.ingredients.length>0||a.filters.temperature!==""||a.filters.cuisson!==""||a.filters.saison!==""||a.filters.testedStatus!=="all"),d=Z(()=>{switch(a.filters.typeR){case"entree":return"entrée";case"plat":return"plat";case"dessert":return"dessert";default:return""}});var E=Xt(),S=o(E);{var j=C=>{var B=Mt(),U=o(B);{var X=D=>{var M=ee(),Y=L(M);{var v=l=>{var g=St(),_=L(g),p=o(_);i(_),$(),w(()=>z(p,`${a.resultCount??""} ${t(d)??""}s`)),s(l,g)},h=l=>{var g=Rt(),_=L(g),p=o(_);i(_),$(),w(()=>z(p,`${a.resultCount??""} recettes`)),s(l,g)};m(Y,l=>{t(d)?l(v):l(h,!1)})}s(D,M)},J=D=>{var M=ee(),Y=L(M);{var v=l=>{var g=ee(),_=L(g);{var p=R=>{var H=At(),G=L(H),V=o(G);i(G),$(),w(()=>z(V,`1 ${t(d)??""}`)),s(R,H)},P=R=>{var H=It();$(),s(R,H)};m(_,R=>{t(d)?R(p):R(P,!1)})}s(l,g)},h=l=>{var g=ee(),_=L(g);{var p=R=>{var H=Dt(),G=L(H),V=o(G);i(G),$(),w(()=>z(V,`Aucun ${t(d)??""}`)),s(R,H)},P=R=>{var H=Ft();$(),s(R,H)};m(_,R=>{t(d)?R(p):R(P,!1)},!0)}s(l,g)};m(Y,l=>{a.resultCount===1?l(v):l(h,!1)},!0)}s(D,M)};m(U,D=>{a.resultCount>1?D(X):D(J,!1)})}i(B),s(C,B)};m(S,C=>{t(n)&&C(j)})}var q=c(S,2),Q=o(q);{var K=C=>{var B=Tt(),U=o(B);{var X=D=>{var M=Fe();w(()=>z(M,`${a.resultCount??""} ${t(d)??""}s`)),s(D,M)},J=D=>{var M=Fe();w(()=>z(M,`${a.resultCount??""} recettes`)),s(D,M)};m(U,D=>{t(d)?D(X):D(J,!1)})}i(B),s(C,B)};m(Q,C=>{t(n)||C(K)})}var ne=c(Q,2);{var re=C=>{var B=zt(),U=c(o(B),2),X=o(U,!0);i(U),i(B),w(()=>z(X,a.searchQuery)),s(C,B)},W=C=>{var B=ee(),U=L(B);{var X=J=>{var D=Ut(),M=L(D),Y=o(M);oe(Y,17,()=>a.filters.categories,le,(e,r)=>{var b=Bt(),x=o(b,!0);i(b),w(()=>z(x,t(r))),s(e,b)});var v=c(Y,2);oe(v,17,()=>a.filters.regimes,le,(e,r)=>{var b=Pt(),x=o(b,!0);i(b),w(()=>z(x,t(r))),s(e,b)});var h=c(v,2);{var l=e=>{var r=Ot();s(e,r)},g=e=>{var r=ee(),b=L(r);{var x=y=>{var k=Lt();s(y,k)};m(b,y=>{a.filters.temperature==="Froid"&&y(x)},!0)}s(e,r)};m(h,e=>{a.filters.temperature==="Chaud"?e(l):e(g,!1)})}var _=c(h,2);{var p=e=>{var r=Nt();s(e,r)},P=e=>{var r=ee(),b=L(r);{var x=y=>{var k=Et();s(y,k)};m(b,y=>{a.filters.cuisson==="Non"&&y(x)},!0)}s(e,r)};m(_,e=>{a.filters.cuisson==="Oui"?e(p):e(P,!1)})}var R=c(_,2);{var H=e=>{var r=jt(),b=o(r,!0);i(r),w(()=>z(b,a.filters.saison)),s(e,r)};m(R,e=>{a.filters.saison&&e(H)})}var G=c(R,2);oe(G,17,()=>a.filters.ingredients,le,(e,r)=>{var b=Qt(),x=o(b,!0);i(b),w(()=>z(x,t(r))),s(e,b)});var V=c(G,2);{var Ce=e=>{var r=Ht();s(e,r)},ke=e=>{var r=ee(),b=L(r);{var x=y=>{var k=qt();s(y,k)};m(b,y=>{a.filters.testedStatus==="untested"&&y(x)},!0)}s(e,r)};m(V,e=>{a.filters.testedStatus==="tested"?e(Ce):e(ke,!1)})}var Se=c(V,2);{var fe=e=>{var r=Kt(),b=o(r,!0);i(r),w(()=>z(b,t(d))),s(e,r)};m(Se,e=>{a.filters.typeR&&e(fe)})}i(M);var me=c(M,2),f=o(me);f.__click=function(...e){a.onResetFilters?.apply(this,e)};var A=o(f);nt(A,{class:"h-4 w-4"}),$(),i(f),i(me),s(J,D)};m(U,J=>{t(n)&&J(X)},!0)}s(C,B)};m(ne,C=>{a.searchQuery.length>=2?C(re):C(W,!1)})}i(q),i(E),s(te,E),ye()}we(["click"]);var Jt=u('<div class="badge badge-accent badge-outline badge-sm">brouillon</div>'),Wt=u('<h3 class="text-primary bg-base-100 rounded-t-box border-t-base-300 absolute -top-4 left-0 flex max-w-4/5 items-center-safe gap-3 border-t py-0.5 ps-4 pe-6"><svg class="inline size-6 shrink-0"><use></use></svg> <!></h3> <div class="bg-base-100 rounded-t-box border-base-300 absolute -top-4 right-0 border-t-1 px-1"><!></div>',1),Yt=u('<div class="badge badge-accent badge-outline badge-sm">brouillon</div>'),Vt=u('<div class="flex gap-4"><div class="text-primary mb-2 inline-flex flex-wrap items-center-safe gap-2 text-lg font-semibold"><div class="items-start-safe inline-flex gap-2"><svg class="mt-0.5 size-6 min-w-6"><use></use></svg> </div> <!></div> <!></div>'),Zt=u('<span class="text-primary text-base font-bold"> </span>'),$t=u("<span> </span>"),ea=u("<p> </p>"),ta=u("<p> <strong>(non testée)</strong></p>"),aa=u('<span class="badge badge-ghost"> </span>'),ra=u('<span class="badge badge-primary badge-soft"> </span>'),sa=u("<!> <!>",1),na=u('<span class="badge badge-soft badge-error">Servir Chaud</span>'),ia=u('<span class="badge badge-soft badge-info">Servir Froid</span>'),oa=u('<span class="badge badge-soft badge-warning">Avec Cuisson</span>'),la=u('<span class="badge badge-soft badge-success">Sans Cuisson</span>'),da=u('<span class="badge badge-soft badge-accent"> </span>'),ca=u("<span> <!></span>"),va=u('<div class="my-1 text-sm"><span class="font-semibold">Ingrédients :</span> <!></div>'),ua=u('<span class="me-1"> <!></span>'),ba=u('<div class="text-sm"><span class="font-semibold">Matériel :</span> <!></div>'),_a=u('<div role="button" tabindex="0"><!> <div class=" flex flex-wrap items-center justify-between gap-4 @md:my-2"><div class="min-w-72 flex-1"><!> <div class=" flex flex-col"><div><!> <!></div> <div class="text-base-content/60 text-sm"><!></div></div></div> <div class="ms-auto flex flex-col justify-end gap-2"><div class=" flex flex-wrap justify-end gap-1 pt-1"><!></div> <div class="mb-2 flex flex-wrap justify-end gap-1"><!> <!> <!></div></div></div> <!> <!></div>');function ga(te,a){xe(a,!0);let n=De(a,"highlightedIngredients",19,()=>[]);function d(){Re(`/recipe/${a.recipe.$id}`)}const E=Z(()=>qe(a.recipe.typeR,a.recipe.categories||void 0));var S=_a();S.__click=d,S.__keydown=e=>{(e.key==="Enter"||e.key===" ")&&d()};var j=o(S);{var q=e=>{var r=Wt(),b=L(r),x=o(b),y=o(x);i(x);var k=c(x),T=c(k);{var N=F=>{var ue=Jt();s(F,ue)};m(T,F=>{a.recipe.draft&&F(N)})}i(b);var O=c(b,2),se=o(O);{var ae=F=>{Pe(F,{get regimes(){return a.recipe.regime},iconOnly:!0})};m(se,F=>{a.recipe.regime&&F(ae)})}i(O),w(()=>{Me(y,"href",`/icons/sprite.svg#${t(E).iconId}`),z(k,` ${a.recipe.title??""} `)}),s(e,r)};m(j,e=>{ve.isDesktop&&e(q)})}var Q=c(j,2),K=o(Q),ne=o(K);{var re=e=>{var r=Vt(),b=o(r),x=o(b),y=o(x),k=o(y);i(y);var T=c(y);i(x);var N=c(x,2);{var O=F=>{var ue=Yt();s(F,ue)};m(N,F=>{a.recipe.draft&&F(O)})}i(b);var se=c(b,2);{var ae=F=>{Pe(F,{get regimes(){return a.recipe.regime},iconOnly:!0})};m(se,F=>{a.recipe.regime&&F(ae)})}i(r),w(()=>{Me(k,"href",`/icons/sprite.svg#${t(E).iconId}`),z(T,` ${a.recipe.title??""}`)}),s(e,r)};m(ne,e=>{ve.isDesktop||e(re)})}var W=c(ne,2),C=o(W),B=o(C);{var U=e=>{var r=Zt(),b=o(r,!0);i(r),w(()=>z(b,a.recipe.versionLabel)),s(e,r)};m(B,e=>{a.recipe.versionLabel&&e(U)})}var X=c(B,2);{var J=e=>{var r=$t(),b=o(r);i(r),w(()=>{I(r,1,ge(a.recipe.auteur===ve.userName?"text-accent font-semibold":"text-base-content/70 ")),z(b,`de ${a.recipe.auteur??""}`)}),s(e,r)};m(X,e=>{a.recipe.auteur&&e(J)})}i(C);var D=c(C,2),M=o(D);{var Y=e=>{var r=ea(),b=o(r);i(r),w(()=>z(b,`testée pour ${a.recipe.plate??""}
              couverts`)),s(e,r)},v=e=>{var r=ta(),b=o(r);$(),i(r),w(()=>z(b,`théoriquement pour ${a.recipe.plate??""} couverts `)),s(e,r)};m(M,e=>{a.recipe.check?e(Y):e(v,!1)})}i(D),i(W),i(K);var h=c(K,2),l=o(h),g=o(l);{var _=e=>{var r=sa(),b=L(r);{var x=k=>{var T=aa(),N=o(T,!0);i(T),w(()=>z(N,a.recipe.region)),s(k,T)};m(b,k=>{a.recipe.region&&k(x)})}var y=c(b,2);oe(y,17,()=>a.recipe.categories,le,(k,T)=>{var N=ra(),O=o(N,!0);i(N),w(()=>z(O,t(T))),s(k,N)}),s(e,r)};m(g,e=>{a.recipe.categories&&e(_)})}i(l);var p=c(l,2),P=o(p);{var R=e=>{var r=na();s(e,r)},H=e=>{var r=ia();s(e,r)};m(P,e=>{a.recipe.serveHot?e(R):e(H,!1)})}var G=c(P,2);{var V=e=>{var r=oa();s(e,r)},Ce=e=>{var r=la();s(e,r)};m(G,e=>{a.recipe.cuisson?e(V):e(Ce,!1)})}var ke=c(G,2);{var Se=e=>{var r=ee(),b=L(r);oe(b,17,()=>a.recipe.saison,le,(x,y)=>{var k=da(),T=o(k,!0);i(k),w(()=>z(T,t(y))),s(x,k)}),s(e,r)};m(ke,e=>{a.recipe.saison&&e(Se)})}i(p),i(h),i(Q);var fe=c(Q,2);{var me=e=>{var r=va(),b=c(o(r),2);oe(b,17,()=>a.recipe.ingredients,le,(x,y,k)=>{var T=ca();let N;var O=o(T,!0),se=c(O);{var ae=F=>{var ue=Fe(",");s(F,ue)};m(se,F=>{k<a.recipe.ingredients.length-1&&F(ae)})}i(T),w(F=>{N=I(T,1,"me-1",null,N,F),z(O,t(y))},[()=>({"font-bold":n().includes(t(y)),underline:n().includes(t(y))})]),s(x,T)}),i(r),s(e,r)};m(fe,e=>{a.recipe.ingredients&&a.recipe.ingredients.length>0&&e(me)})}var f=c(fe,2);{var A=e=>{var r=ba(),b=c(o(r),2);oe(b,17,()=>a.recipe.materiel,le,(x,y,k)=>{var T=ua(),N=o(T,!0),O=c(N);{var se=ae=>{var F=Fe(",");s(ae,F)};m(O,ae=>{k<a.recipe.materiel.length-1&&ae(se)})}i(T),w(()=>z(N,t(y))),s(x,T)}),i(r),s(e,r)};m(f,e=>{a.recipe.materiel&&a.recipe.materiel.length>0&&e(A)})}i(S),w(()=>I(S,1,`card bg-base-100 cursor-pointer p-4 shadow-sm transition-shadow hover:shadow-md ${a.recipe.auteur===ve.userName&&"border-accent/60 border-l-3"}`)),s(te,S),ye()}we(["click","keydown"]);var fa=u('<fieldset class="fieldset"><legend class="legend label"><!> Filtrer :</legend> <div class="btn-group"><button>Tout</button> <button>Mes recettes</button> <button>Mes brouillons</button></div></fieldset>'),ma=u('<div class="bg-base-300 rounded-box flex flex-wrap items-center justify-between gap-6 px-6 py-6"><fieldset class="fieldset"><legend class="legend label"><!> Trier par :</legend> <div class="btn-group"><button aria-label="Trier par titre">Titre</button> <button aria-label="Trier par date de création"><!> Date de création</button> <button aria-label="Trier par date de modification"><!> Date de modification</button></div></fieldset> <!></div>');function pa(te,a){xe(a,!0);const n=v=>a.sortBy!==v?"inactive":a.sortOrder,d=v=>{v==="title"?a.onSortChange("title",a.sortBy==="title"&&a.sortOrder==="asc"?"desc":"asc"):a.sortBy!==v?a.onSortChange(v,"desc"):a.sortOrder==="desc"?a.onSortChange(v,"asc"):a.onSortChange("title","asc")},E=v=>{const h=n(v),l="btn btn-sm btn-primary btn-outline gap-2";return h==="inactive"?`${l}`:h==="asc"?`${l} btn-active`:`${l} btn-active`},S=v=>{const h=n(v);return h==="inactive"?null:h==="asc"?ot:lt},j=v=>{const h="btn btn-sm btn-secondary";return a.scope===v?`${h}`:`${h} btn-outline`};var q=ma(),Q=o(q),K=o(Q),ne=o(K);it(ne,{class:"inline size-4"}),$(),i(K);var re=c(K,2),W=o(re);W.__click=()=>d("title");var C=c(W,2);C.__click=()=>d("$createdAt");var B=o(C);{var U=v=>{const h=Z(()=>S("$createdAt"));var l=ee(),g=L(l);Te(g,()=>t(h),(_,p)=>{p(_,{size:16})}),s(v,l)};m(B,v=>{S("$createdAt")&&v(U)})}$(),i(C);var X=c(C,2);X.__click=()=>d("$updatedAt");var J=o(X);{var D=v=>{const h=Z(()=>S("$updatedAt"));var l=ee(),g=L(l);Te(g,()=>t(h),(_,p)=>{p(_,{size:16})}),s(v,l)};m(J,v=>{S("$updatedAt")&&v(D)})}$(),i(X),i(re),i(Q);var M=c(Q,2);{var Y=v=>{var h=fa(),l=o(h),g=o(l);dt(g,{class:"inline h-4 w-4"}),$(),i(l);var _=c(l,2),p=o(_);p.__click=()=>Re("/recipe");var P=c(p,2);P.__click=()=>Re("/recipe/my");var R=c(P,2);R.__click=()=>Re("/recipe/my/draft"),i(_),i(h),w((H,G,V)=>{I(p,1,H),I(P,1,G),I(R,1,V)},[()=>ge(j("all")),()=>ge(j("mine")),()=>ge(j("drafts"))]),s(v,h)};m(M,v=>{ve.isAuthenticated&&v(Y)})}i(q),w((v,h,l)=>{I(W,1,v),I(C,1,h),I(X,1,l)},[()=>ge(E("title")),()=>ge(E("$createdAt")),()=>ge(E("$updatedAt"))]),s(te,q),ye()}we(["click"]);const ha=te=>{var a=ee(),n=L(a);{var d=E=>{var S=xa();S.__click=()=>Re("/recipe/new");var j=o(S);ct(j,{size:18}),$(),i(S),s(E,S)};m(n,E=>{ve.isAuthenticated&&E(d)})}s(te,a)};var xa=u('<button class="btn btn-primary btn-sm"><!> Créer une recette</button>'),ya=u('<div class="alert alert-error"><span> </span></div>'),wa=u('<div class="skeleton h-40 w-full rounded-lg"></div>'),Ca=u('<div class="my-8 space-y-10"></div>'),ka=u('<div class="flex justify-center py-12"><div class="text-center"><div class="loading loading-spinner loading-lg text-primary"></div> <p class="text-base-content/60 mt-4 text-sm">Chargement des recettes...</p></div></div>'),Sa=u("<div><!></div>"),Ra=u('<div class="py-8 text-center"><span class="loading loading-spinner loading-md"></span></div>'),Aa=u('<div class="py-12 text-center"><p class="text-base-content/60 text-lg">Aucune recette ne correspond aux critères...</p></div>'),Ia=u('<div class="my-8 space-y-10"></div> <!> <!>',1),Da=u('<!> <div class="p-4 lg:ml-100"><div class="mx-auto max-w-4xl"><div class="mb-10 space-y-6"><div class="tabs tabs-border tabs-lg mb-6 font-bold"><button>Toutes</button> <button>Entrées</button> <button>Plats</button> <button>Desserts</button></div> <div class="mb-4"><!></div> <div class="mb-6"><!></div> <!></div> <!></div></div> ```',1);function Qa(te,a){xe(a,!0);let n=_e(""),d=_e(Ke({categories:[],regimes:[],temperature:"",cuisson:"",saison:"",testedStatus:"all",ingredients:[],typeR:"",scope:"all"})),E=20,S=_e(1),j=_e(void 0),q=_e("title"),Q=_e("asc");const K=Z(()=>ce.isInitialized?ce.getAllRecipes():[]),ne=Z(()=>{const f=new Set;return t(K).forEach(A=>A.categories?.forEach(e=>f.add(e))),Array.from(f).sort()}),re=["vegan","vegetarien","sans-gluten","sans-lactose"],W=Z(()=>Ie.isInitialized?Ie.ingredientNames:[]),C=Z(()=>{if(t(n).length>=2){const f=t(n).toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu,"");return t(K).filter(A=>{const e=A.title.toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu,"").includes(f),r=A.auteur?.toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu,"").includes(f)||!1,b=A.region?.toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu,"").includes(f)||!1,x=!t(d).typeR||A.typeR===t(d).typeR;return(e||r||b)&&x})}return t(K).filter(f=>{const A=!t(d).categories.length||t(d).categories.some(O=>f.categories?.includes(O)),e=!t(d).regimes.length||t(d).regimes.some(O=>f.regime?.includes(O)),r=!t(d).temperature||f.serveHot===(t(d).temperature==="Chaud"),b=!t(d).cuisson||(t(d).cuisson==="Oui"?f.cuisson===!0:f.cuisson===!1),x=!t(d).saison||f.saison?.includes(t(d).saison),y=t(d).testedStatus==="all"||t(d).testedStatus==="tested"&&f.check||t(d).testedStatus==="untested"&&!f.check,k=!t(d).ingredients.length||t(d).ingredients.every(O=>f.ingredients?.includes(O)),T=!t(d).typeR||f.typeR===t(d).typeR;let N=!0;return t(d).scope==="mine"?N=f.createdBy===ve.userId:t(d).scope==="drafts"&&(N=f.createdBy===ve.userId&&f.draft===!0),A&&e&&r&&b&&x&&y&&k&&T&&N})}),B=Z(()=>[...t(C)].sort((A,e)=>{if(t(q)==="title")return t(Q)==="asc"?A.title.localeCompare(e.title,"fr"):e.title.localeCompare(A.title,"fr");if(t(q)==="$createdAt"){const r=new Date(e.$createdAt||0).getTime()-new Date(A.$createdAt||0).getTime();return t(Q)==="asc"?-r:r}else{const r=new Date(e.$updatedAt||0).getTime()-new Date(A.$updatedAt||0).getTime();return t(Q)==="asc"?-r:r}})),U=Z(()=>t(B).slice(0,t(S)*E)),X=Z(()=>t(n).length>=2);function J(){de(n,"")}function D(){de(d,{categories:[],regimes:[],temperature:"",cuisson:"",saison:"",testedStatus:"all",ingredients:[],typeR:"",scope:t(d).scope},!0)}Ae(()=>{if(!t(j))return;const f=new IntersectionObserver(A=>{A[0].isIntersecting&&t(U).length<t(C).length&&Ue(S)},{threshold:.1});return f.observe(t(j)),()=>f.disconnect()}),Ae(()=>{t(C),t(q),t(Q),de(S,1)}),Ae(()=>{const f=Xe.pathname;f==="/recipe/my/draft"?t(d).scope="drafts":f==="/recipe/my"?t(d).scope="mine":t(d).scope="all"}),Ae(()=>{Oe.setConfig({title:t(d).scope==="mine"?"Mes recettes":t(d).scope==="drafts"?"Mes brouillons":"Recettes",actions:ha})}),Ge(()=>{Oe.reset()}),Je(async()=>{Ie.isInitialized||await Ie.initialize()});var M=Da(),Y=L(M);bt(Y,{width:"100",children:(f,A)=>{kt(f,{get disabled(){return t(X)},get availableCategories(){return t(ne)},get availableRegimes(){return re},get availableIngredients(){return t(W)},onReset:D,get filters(){return t(d)},set filters(e){de(d,e,!0)}})},$$slots:{default:!0}});var v=c(Y,2),h=o(v),l=o(h),g=o(l),_=o(g);_.__click=()=>t(d).typeR="";var p=c(_,2);p.__click=()=>t(d).typeR="entree";var P=c(p,2);P.__click=()=>t(d).typeR="plat";var R=c(P,2);R.__click=()=>t(d).typeR="dessert",i(g);var H=c(g,2),G=o(H);gt(G,{onReset:J,get searchQuery(){return t(n)},set searchQuery(f){de(n,f,!0)}}),i(H);var V=c(H,2),Ce=o(V);Gt(Ce,{get searchQuery(){return t(n)},get filters(){return t(d)},get resultCount(){return t(C).length},onResetFilters:D}),i(V);var ke=c(V,2);pa(ke,{get sortBy(){return t(q)},get sortOrder(){return t(Q)},onSortChange:(f,A)=>{de(q,f,!0),de(Q,A,!0)},get scope(){return t(d).scope}}),i(l);var Se=c(l,2);{var fe=f=>{var A=ya(),e=o(A),r=o(e);i(e),i(A),w(()=>z(r,`Erreur : ${ce.error??""}`)),s(f,A)},me=f=>{var A=ee(),e=L(A);{var r=x=>{var y=Ca();oe(y,20,()=>Array(5),le,(k,T)=>{var N=wa();s(k,N)}),i(y),s(x,y)},b=x=>{var y=ee(),k=L(y);{var T=O=>{var se=ka();s(O,se)},N=O=>{var se=Ia(),ae=L(se);oe(ae,21,()=>t(U),ie=>ie.$id,(ie,pe)=>{var he=Sa(),je=o(he);ga(je,{get recipe(){return t(pe)},get highlightedIngredients(){return t(d).ingredients}}),i(he),ze(3,he,()=>Le,()=>({duration:300})),s(ie,he)}),i(ae);var F=c(ae,2);{var ue=ie=>{var pe=Ra();We(pe,he=>de(j,he),()=>t(j)),s(ie,pe)};m(F,ie=>{t(U).length<t(C).length&&ie(ue)})}var Ne=c(F,2);{var Ee=ie=>{var pe=Aa();s(ie,pe)};m(Ne,ie=>{t(C).length===0&&ce.isInitialized&&ie(Ee)})}s(O,se)};m(k,O=>{ce.loading&&t(U).length===0?O(T):O(N,!1)},!0)}s(x,y)};m(e,x=>{!ce.isInitialized&&!ce.loading?x(r):x(b,!1)},!0)}s(f,A)};m(Se,f=>{ce.error?f(fe):f(me,!1)})}i(h),i(v),$(),w(()=>{I(_,1,`tab ${t(d).typeR===""?"tab-active":""}`),I(p,1,`tab ${t(d).typeR==="entree"?"tab-active":""}`),I(P,1,`tab ${t(d).typeR==="plat"?"tab-active":""}`),I(R,1,`tab ${t(d).typeR==="dessert"?"tab-active":""}`)}),ze(1,v,()=>Le),s(te,M),ye()}we(["click"]);export{Qa as default};
