import{p as Xe,j as Q,k as H,K as c,b as n,v as d,h as t,g as v,o as r,w as x,x as g,U as Ze,d as $e,J as ke,m as e,u as W,A as w,y as K,N as ea,Y as aa,P as ra,c as ta,I as O,D as sa,E as we,B as ia,M as na,ad as va,aa as da,G as le,e as ce,i as pe,W as oa}from"./appwrite.js";import{R as la}from"./RecipeRegimeBadges.js";import{R as ca,a as pa}from"./RecipePreparation.js";import{x as ua,y as _a,z as ga,D as fa,U as ma}from"./icons.js";import{R as ba,a as xa}from"./RecipeMetadata.js";import{n as Re,a as ha}from"./index.js";import"./products-display.js";import"./Fieldset.js";import"./SvelteMarkdown.js";import"./legacy.js";var ya=d('<div class="text-base-content/70 text-sm"> <!></div>'),ka=d(`<div class="alert alert-error alert-soft max-md:alert-vertical"><!> <div class="text-sm">Les auteur·ices de la recette ne l'ont <strong>pas testé</strong> </div></div>`);function wa(T,B){let V=Xe(B,"isChecked",3,!1);var D=Q(),U=H(D);{var I=_=>{var h=ya(),E=t(h),q=v(E);{var L=S=>{var M=Ze();x(()=>g(M,`et pour ${B.checkedFor??""} couverts`)),n(S,M)};c(q,S=>{B.checkedFor&&S(L)})}r(h),x(()=>g(E,`Cette recette a été testée pour ${B.defaultServings??""} couverts `)),n(_,h)},a=_=>{var h=ka(),E=t(h);ua(E,{class:"h-5 w-5"});var q=v(E,2),L=v(t(q),2);r(q),r(h),x(()=>g(L,` pour le
      nombre de couverts indiqué par défaut (${B.defaultServings??""}).`)),n(_,h)};c(U,_=>{V()?_(I):_(a,!1)})}n(T,D)}var Ra=d('<button class="btn btn-primary btn-sm"><!> <span class="hidden sm:block">Éditer</span></button>'),Aa=d('<div class="flex items-center gap-4"><button class="btn btn-circle btn-primary max-sm:hidden"><!></button> <button class="btn btn-secondary btn-sm"><!> <span class="hidden sm:block">Créer une version alternative</span></button> <!></div>'),Ia=d('<div class="flex items-center justify-center py-20"><div class="loading loading-spinner loading-lg"></div></div>'),Sa=d('<div class="alert alert-error"><div><h3 class="font-bold">Erreur</h3> <div> </div></div></div>'),Ca=d('<div class="text-primary text-lg font-medium print:text-sm"> </div>'),Ba=d("<div><!></div>"),Da=d('<div class="mb-2"><span class="badge badge-primary badge-soft"> </span></div>'),Ea=d('<div class="mb-2 flex flex-wrap gap-2 print:hidden"><!> <p class="text-base-content/70 text-base italic"> </p></div>'),ja=d('<span class="badge badge-warning">Servir Chaud</span>'),Ua=d('<span class="badge badge-info">Servir Froid</span>'),qa=d('<div class="mb-2"><!></div>'),za=d('<span class="badge badge-warning">Avec Cuisson</span>'),Pa=d('<span class="badge badge-info">Sans Cuisson</span>'),La=d('<div class="mb-2"><!></div>'),Na=d('<span class="badge badge-error"> </span>'),Fa=d('<div class="flex w-fit flex-wrap items-center gap-2"><span class="text-base-content/70 font-semibold">Allergenes :</span> <!></div>'),Wa=d('<span class="badge"> </span>'),Ha=d('<div class="flex flex-wrap gap-2"></div>'),Ma=d('<p class="text-end text-base"> </p>'),Ga=d('<div class="mt-8 print:hidden"><!></div>'),Ja=d('<div class="card bg-base-100"><div class="card-body not-md:px-1"><div class="mb-4 print:mb-2"><div class="flex items-center justify-between gap-x-10 gap-y-4"><div class="flex flex-wrap items-center gap-4"><h1 class="text-primary flex items-center gap-3 print:text-xl print:text-black"><svg class="me-2 size-9 shrink-0 stroke-3 print:stroke-black"><use></use></svg> </h1> <!></div> <!></div></div> <!> <div class="border-base-300 mb-6 border-b pb-4 print:mb-1 print:pb-2"><div class="flex flex-wrap items-center justify-between gap-4"><div class="flex gap-2"><!> <!></div> <!> <!></div></div> <div class="mb-6 flex flex-wrap items-center justify-between gap-6 print:hidden"><div class="flex items-center gap-4"><label for="servings-input" class="flex items-center gap-2 font-medium"><!> Nombre de couverts à servir :</label> <input id="servings-input" type="number" min="1" class="input input-bordered input-primary w-24"/></div> <!></div> <div class="flex justify-between"><p class="print-only font-medium"> </p> <!></div> <div class="mt-8 grid grid-cols-1 gap-8 lg:grid-cols-3 print:mt-2 print:grid-cols-10 print:gap-4" style="break-before: avoid;"><div class=" lg:col-span-1 print:col-span-3"><div class="sticky top-4 print:static"><!></div></div> <div class="lg:col-span-2 print:col-span-7"><!></div></div></div></div> <!> <!>',1),Ka=d('<div class="mx-auto max-w-7xl px-4 py-8"><!></div>');function rr(T,B){$e(B,!0);const V=u=>{var o=Q(),R=H(o);{var Y=N=>{var y=Aa(),f=t(y);f.__click=()=>window.print();var z=t(f);_a(z,{size:18}),r(f);var A=v(f,2);A.__click=()=>we(`/recipe/${e(a)?.$id}/duplicate`);var j=t(A);ga(j,{size:18}),le(2),r(A);var G=v(A,2);{var F=P=>{var C=Ra();C.__click=()=>we(`/recipe/${e(a)?.$id}/edit`);var J=t(C);fa(J,{size:18}),le(2),r(C),n(P,C)};c(G,P=>{(e(a).permissionWrite&&O.userId&&e(a).permissionWrite.includes(O.userId)||e(a).createdBy&&e(a).createdBy===O.userId)&&P(F)})}r(y),n(N,y)};c(R,N=>{O.isAuthenticated&&e(a)&&N(Y)})}n(u,o)};let D=W(()=>sa.params.uuid),U=K(!0),I=K(null),a=K(null),_=K(4);ke(()=>{e(D)?E(e(D)):(w(I,"UUID de recette manquant"),w(U,!1))});const h=W(()=>{if(!e(a)?.ingredients)return[];const u=new Set;return e(a).ingredients.forEach(o=>{o.allergens&&Array.isArray(o.allergens)&&o.allergens.forEach(R=>u.add(R))}),Array.from(u).sort()});async function E(u){w(U,!0),w(I,null);try{const o=await ea.getRecipeByUuid(u);if(!o){w(I,"Impossible de charger les détails de la recette");return}w(a,o,!0),w(_,o.plate,!0)}catch(o){console.error("Erreur lors du chargement de la recette:",o),w(I,o instanceof Error?o.message:"Erreur lors du chargement",!0)}finally{w(U,!1)}}function q(u){const o=u.target,R=parseInt(o.value);!isNaN(R)&&R>0&&w(_,R,!0)}ke(()=>{Re.setConfig({title:e(a)?.title||"Recette",actions:V})}),aa(()=>{Re.reset()});const L=W(()=>e(a)?da(e(a).typeR,e(a).categories||void 0):{label:"",iconId:"no-cat"});var S=Ka(),M=t(S);{var Ae=u=>{var o=Ia();n(u,o)},Ie=u=>{var o=Q(),R=H(o);{var Y=y=>{var f=Sa(),z=t(f),A=v(t(z),2),j=t(A,!0);r(A),r(z),r(f),x(()=>g(j,e(I))),n(y,f)},N=y=>{var f=Q(),z=H(f);{var A=j=>{var G=Ja(),F=H(G),P=t(F),C=t(P),J=t(C),X=t(J),Z=t(X),$=t(Z),Se=t($);r($);var Ce=v($);r(Z);var Be=v(Z,2);{var De=s=>{var i=Ca(),p=t(i,!0);r(i),x(()=>g(p,e(a).versionLabel)),n(s,i)};c(Be,s=>{e(a).versionLabel&&s(De)})}r(X);var Ee=v(X,2);{var je=s=>{var i=Ba(),p=t(i);la(p,{get regimes(){return e(a).regime},iconOnly:!1}),r(i),n(s,i)};c(Ee,s=>{e(a)?.regime&&e(a).regime.length>0&&s(je)})}r(J),r(C);var ue=v(C,2);{var Ue=s=>{var i=Ea(),p=t(i);ce(p,17,()=>e(a).categories,pe,(l,b)=>{var oe=Da(),ye=t(oe),Ye=t(ye,!0);r(ye),r(oe),x(()=>g(Ye,e(b))),n(l,oe)});var k=v(p,2),m=t(k,!0);r(k),r(i),x(()=>g(m,e(a).description)),n(s,i)};c(ue,s=>{(e(a).description||e(a).categories&&e(a).categories.length>0)&&s(Ue)})}var ee=v(ue,2),_e=t(ee),ae=t(_e),ge=t(ae);{var qe=s=>{var i=qa(),p=t(i);{var k=l=>{var b=ja();n(l,b)},m=l=>{var b=Ua();n(l,b)};c(p,l=>{e(a).serveHot?l(k):l(m,!1)})}r(i),n(s,i)};c(ge,s=>{e(a)?.serveHot!==void 0&&s(qe)})}var ze=v(ge,2);{var Pe=s=>{var i=La(),p=t(i);{var k=l=>{var b=za();n(l,b)},m=l=>{var b=Pa();n(l,b)};c(p,l=>{e(a).cuisson?l(k):l(m,!1)})}r(i),n(s,i)};c(ze,s=>{e(a)?.cuisson!==void 0&&s(Pe)})}r(ae);var fe=v(ae,2);{var Le=s=>{var i=Fa(),p=v(t(i),2);ce(p,17,()=>e(h),pe,(k,m)=>{var l=Na(),b=t(l,!0);r(l),x(()=>g(b,e(m))),n(k,l)}),r(i),n(s,i)};c(fe,s=>{e(h).length>0&&s(Le)})}var Ne=v(fe,2);{var Fe=s=>{var i=Ha();ce(i,21,()=>e(a).materiel,pe,(p,k)=>{var m=Wa(),l=t(m,!0);r(m),x(()=>g(l,e(k))),n(p,m)}),r(i),n(s,i)};c(Ne,s=>{e(a)?.materiel&&e(a).materiel.length>0&&s(Fe)})}r(_e),r(ee);var re=v(ee,2),te=t(re),se=t(te),We=t(se);ma(We,{class:"h-5 w-5"}),le(),r(se);var ie=v(se,2);oa(ie),ie.__input=q,r(te);var He=v(te,2);{var Me=s=>{wa(s,{get isChecked(){return e(a).check},get defaultServings(){return e(a).plate}})};c(He,s=>{e(a).check!==void 0&&s(Me)})}r(re);var ne=v(re,2),ve=t(ne),Ge=t(ve);r(ve);var Je=v(ve,2);{var Ke=s=>{var i=Ma(),p=t(i,!0);r(i),x(()=>g(p,e(a).quantite_desc)),n(s,i)};c(Je,s=>{e(a).quantite_desc&&s(Ke)})}r(ne);var me=v(ne,2),de=t(me),be=t(de),Oe=t(be);ca(Oe,{get ingredients(){return e(a).ingredients},get servings(){return e(_)},get defaultServings(){return e(a).plate}}),r(be),r(de);var xe=v(de,2),Qe=t(xe);{let s=W(()=>e(a).preparation24h||void 0),i=W(()=>e(a).astuces||[]);pa(Qe,{get preparation(){return e(a).preparation},get preparation24h(){return e(s)},get astuces(){return e(i)}})}r(xe),r(me),r(P),r(F);var he=v(F,2);{var Te=s=>{var i=Ga(),p=t(i);xa(p,{get recipeId(){return e(D)}}),r(i),n(s,i)};c(he,s=>{e(D)&&s(Te)})}var Ve=v(he,2);ba(Ve,{get auteur(){return e(a).auteur},get createdBy(){return e(a).createdBy},get id(){return e(a).$id},get createdAt(){return e(a).$createdAt},get updatedAt(){return e(a).$updatedAt}}),x(()=>{na(Se,"href",`/icons/sprite.svg#${e(L).iconId}`),g(Ce,` ${e(a).title??""}`),va(ie,e(_)),g(Ge,`Quantité pour ${e(_)??""} couverts`)}),n(j,G)};c(z,j=>{e(a)&&j(A)},!0)}n(y,f)};c(R,y=>{e(I)?y(Y):y(N,!1)},!0)}n(u,o)};c(M,u=>{e(U)?u(Ae):u(Ie,!1)})}r(S),ra(1,S,()=>ha),n(T,S),ta()}ia(["click","input"]);export{rr as default};
