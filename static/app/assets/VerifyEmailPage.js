import{d as K,X as O,D as A,A as c,y as I,a8 as X,I as F,E as y,v as x,K as E,m,h as r,P as H,b as l,c as J,j as L,k as T,g as b,w as D,x as R,B as N,G as Q,o as s}from"./appwrite.js";import{a as W}from"./index.js";import{f as Y,n as Z,C as $}from"./icons.js";var ee=x('<div class="flex flex-col items-center gap-4 text-center"><!> <h2 class="text-2xl font-bold">Vérification en cours...</h2> <p class="text-base-content/70">Veuillez patienter pendant que nous vérifions votre email.</p></div>'),te=x('<div class="flex flex-col items-center gap-4 text-center"><!> <h2 class="text-success text-2xl font-bold">Email vérifié !</h2> <p class="text-base-content/70"> </p> <button class="btn btn-primary">Aller au tableau de bord</button></div>'),ae=x(`<div class="flex flex-col items-center gap-4 text-center"><!> <h2 class="text-error text-2xl font-bold">Erreur de vérification</h2> <p class="text-base-content/70"> </p> <div class="flex gap-2"><button class="btn btn-outline">Retour à l'accueil</button> <button class="btn btn-primary">Tableau de bord</button></div></div>`),re=x('<div class="bg-base-200 flex min-h-screen items-center justify-center p-4"><div class="bg-base-100 max-w-md rounded-xl p-8 shadow-lg"><!></div></div>');function ne(j,q){K(q,!0);let i=I("loading"),d=I("");O(async()=>{let t=A.search.userId,a=A.search.secret;if(!t||!a){const e=new URLSearchParams(window.location.search);t=e.get("userId"),a=e.get("secret")}if(!t||!a){c(i,"error"),c(d,"Paramètres de vérification manquants. Vérifiez le lien dans l'email.");return}try{const{account:e}=await X(()=>import("./appwrite.js").then(v=>v.b7),[]).then(v=>v.getAppwriteInstances());await(await e).updateVerification(t,a),await F.refreshAuthAfterLogin(),c(i,"success"),c(d,"Votre email a été vérifié avec succès ! Vous allez être redirigé..."),setTimeout(()=>{y("/dashboard")},2e3)}catch(e){console.error("Erreur lors de la vérification:",e),c(i,"error"),c(d,e instanceof Error?e.message:"Une erreur est survenue lors de la vérification. Le lien a peut-être expiré.",!0)}});function V(){y("/dashboard")}var g=re(),h=r(g),C=r(h);{var M=t=>{var a=ee(),e=r(a);Y(e,{class:"text-primary size-16 animate-spin"}),Q(4),s(a),l(t,a)},S=t=>{var a=L(),e=T(a);{var v=o=>{var n=te(),p=r(n);Z(p,{class:"text-success size-16"});var u=b(p,4),f=r(u,!0);s(u);var _=b(u,2);_.__click=V,s(n),D(()=>R(f,m(d))),l(o,n)},U=o=>{var n=L(),p=T(n);{var u=f=>{var _=ae(),k=r(_);$(k,{class:"text-error size-16"});var w=b(k,4),B=r(w,!0);s(w);var P=b(w,2),z=r(P);z.__click=()=>y("/");var G=b(z,2);G.__click=V,s(P),s(_),D(()=>R(B,m(d))),l(f,_)};E(p,f=>{m(i)==="error"&&f(u)},!0)}l(o,n)};E(e,o=>{m(i)==="success"?o(v):o(U,!1)},!0)}l(t,a)};E(C,t=>{m(i)==="loading"?t(M):t(S,!1)})}s(h),s(g),H(1,h,()=>W),l(j,g),J()}N(["click"]);export{ne as default};
