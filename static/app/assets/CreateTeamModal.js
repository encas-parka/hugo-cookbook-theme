import{d as Re,y as p,z as Le,v as u,k as P,K as w,h as r,g as n,A as t,m as e,b as i,c as Ae,F as ce,u as le,e as Ge,I as qe,B as Oe,G as _e,o as a,ab as et,w as Y,C as Ce,x as ne,j as be,p as de,M as Qe,T as Me,W as De,af as He,ag as tt,J as We,ah as at,U as je,O as Je,S as rt}from"./appwrite.js";import{C as ze}from"./ConfirmModal.js";import{U as Fe,_ as Ve,d as nt,$ as st,a0 as it,W as lt,a1 as ot,M as Ne,a2 as dt,C as vt,X as ct,O as ut,c as mt}from"./icons.js";import{M as Xe,b as Ue,c as Be,d as Ke}from"./index.js";import"./InfoCollapse.js";var ft=u('<div class="py-8 text-center opacity-50"><!> <p class="text-sm">Aucun membre</p></div>'),bt=u('<span class="text-xs opacity-50">(vous)</span>'),_t=u(`<button class="btn btn-error btn-sm" title="Quitter l'équipe"><!></button>`),gt=u('<button class="btn btn-error btn-sm" title="Retirer ce membre"><!></button>'),pt=u('<div class="card bg-base-100 border-base-200 border p-4 transition-shadow hover:shadow-md"><div class="flex items-center justify-between gap-4"><div class="flex flex-1 items-center gap-3"><div class="avatar avatar-placeholder"><div><span class="text-lg"> </span></div></div> <div class="flex-1"><div class="font-medium"> <!></div> <div class="text-sm opacity-70"> </div></div></div> <div><!> </div> <div class="flex gap-2"><!></div></div></div>'),ht=u(`<div class="alert"><!> Seul les admins peuvent modifier les parametre
      de l'équipe</div> <div class="space-y-2"></div>`,1),xt=u('<div class="space-y-4"><!></div> <!> <!>',1);function yt(ue,s){Re(s,!0);let _=p(Le({isOpen:!1,memberId:null,memberName:null})),g=p(!1),q=p(!1);const R=le(()=>qe.userId),M=le(()=>()=>e(R)&&s.team.members.find(C=>C.id===e(R))?.roles?.[0]||null),x=le(()=>e(M)()==="owner");function z(d){return new Date(d).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"})}function o(d,C){t(_,{isOpen:!0,memberId:d,memberName:C},!0)}async function ae(){if(e(_).memberId){t(q,!0);try{await ce.removeMember(s.team.$id,e(_).memberId),t(_,{isOpen:!1,memberId:null,memberName:null},!0),s.onMemberRemoved?.()}catch(d){console.error("[TeamMembersList] Erreur suppression:",d),alert("Erreur lors de la suppression du membre")}finally{t(q,!1)}}}async function V(){if(!e(R))return;const d=s.team.members.find(C=>C.id===e(R));if(d){t(q,!0);try{await ce.removeMember(s.team.$id,d.$id),t(g,!1),s.onMemberRemoved?.()}catch(C){console.error("[TeamMembersList] Erreur désinscription:",C),alert("Erreur lors de la désinscription")}finally{t(q,!1)}}}function U(d){return d==="owner"?st:Fe}function Q(d){return d==="owner"?"badge-primary badge-soft":"badge-ghost"}function te(d){return d==="owner"?"Admin":"Membre"}var W=xt(),S=P(W),me=r(S);{var se=d=>{var C=ft(),F=r(C);Fe(F,{class:"mx-auto mb-2 h-8 w-8"}),_e(2),a(C),i(d,C)},oe=d=>{var C=ht(),F=P(C),N=r(F);Ve(N,{class:"size-4 shrink-0"}),_e(),a(F);var k=n(F,2);Ge(k,21,()=>s.team.members.filter(A=>A.confirmed),A=>A.id,(A,E)=>{const ie=le(()=>e(E).roles[0]),Z=le(()=>U(e(ie))),T=le(()=>e(E).id===e(R)),re=le(()=>e(x)&&!e(T));var O=pt(),l=r(O),c=r(l),f=r(c),v=r(f),y=r(v),h=r(y,!0);a(y),a(v),a(f);var H=n(f,2),B=r(H),K=r(B),D=n(K);{var I=L=>{var j=bt();i(L,j)};w(D,L=>{e(T)&&L(I)})}a(B);var J=n(B,2),$=r(J);a(J),a(H),a(c);var X=n(c,2),b=r(X);et(b,()=>e(Z),(L,j)=>{j(L,{class:"h-3 w-3"})});var ee=n(b);a(X);var fe=n(X,2),ge=r(fe);{var ke=L=>{var j=_t();j.__click=()=>t(g,!0);var pe=r(j);nt(pe,{class:"h-4 w-4"}),a(j),Y(()=>j.disabled=e(q)),i(L,j)},ve=L=>{var j=be(),pe=P(j);{var Ee=Te=>{var xe=gt();xe.__click=()=>o(e(E).$id,e(E).name);var he=r(xe);it(he,{class:"h-4 w-4"}),a(xe),Y(()=>xe.disabled=e(q)),i(Te,xe)};w(pe,Te=>{e(re)&&Te(Ee)},!0)}i(L,j)};w(ge,L=>{e(T)&&e(E).roles?.[0]!=="owner"?L(ke):L(ve,!1)})}a(fe),a(l),a(O),Y((L,j,pe,Ee)=>{Ce(v,1,`${e(E).name===qe.userName?"bg-accent":"bg-neutral"} text-neutral-content w-12 rounded-full`),ne(h,L),ne(K,`${e(E).name??""} `),ne($,`Membre depuis ${j??""}`),Ce(X,1,`badge ${pe??""} gap-1`),ne(ee,` ${Ee??""}`)},[()=>e(E).name.split(" ").map(L=>L[0]).join("").toUpperCase().slice(0,2),()=>z(e(E).joinedAt),()=>Q(e(ie)),()=>te(e(ie))]),i(A,O)}),a(k),i(d,C)};w(me,d=>{s.team.members.length===0?d(se):d(oe,!1)})}a(S);var m=n(S,2);ze(m,{get isOpen(){return e(_).isOpen},title:"Retirer un membre",get message(){return`Êtes-vous sûr de vouloir retirer ${e(_).memberName??""} de l'équipe ? Cette action est irréversible.`},variant:"warning",confirmLabel:"Retirer",cancelLabel:"Annuler",onConfirm:ae,onCancel:()=>t(_,{isOpen:!1,memberId:null,memberName:null},!0)});var G=n(m,2);ze(G,{get isOpen(){return e(g)},title:"Quitter l'équipe",message:"Êtes-vous sûr de vouloir quitter cette équipe ? Vous devrez être réinvité pour y revenir.",variant:"warning",confirmLabel:"Quitter",cancelLabel:"Annuler",onConfirm:V,onCancel:()=>t(g,!1)}),i(ue,W),Ae()}Oe(["click"]);var wt=u(`<div class="alert alert-soft alert-warning @max-lg:alert-vertical"><!> Seul·es les admins peuvent modifier
      les paramètres de l'équipe.</div>`),Mt=u('<div class="grid grid-cols-2 gap-4"><fieldset class="fieldset"><legend class="fieldset-legend flex items-center gap-1"><!> Département</legend> <label class="input"><input type="text" placeholder="Ex: Île-de-France" maxlength="50"/></label></fieldset> <fieldset class="fieldset"><legend class="fieldset-legend flex items-center gap-1"><!> Ville</legend> <label class="input"><input type="text" placeholder="Ex: Paris" maxlength="50"/></label></fieldset></div>'),Ct=u(`<div class="@container space-y-4"><!> <fieldset class="fieldset"><legend class="fieldset-legend required">Nom de l'équipe</legend> <label class="input"><input type="text" placeholder="Ex: Équipe Marketing" required aria-required="true"/></label> <span class="fieldset-label text-xs"> </span></fieldset> <fieldset class="fieldset"><legend class="fieldset-legend">Description</legend> <textarea class="textarea w-full" rows="3"></textarea> <span class="fieldset-label text-xs"> </span></fieldset> <!></div>`);function Ye(ue,s){Re(s,!0);let _=de(s,"name",15),g=de(s,"description",15),q=de(s,"location",15,""),R=de(s,"city",15,""),M=de(s,"showLocation",3,!1),x=de(s,"disabled",3,!1),z=de(s,"nameMaxLength",3,50),o=de(s,"descriptionMaxLength",3,350),ae=_()!=="";var V=Ct(),U=r(V);{var Q=N=>{var k=wt(),A=r(k);Ve(A,{class:"size-5 shrink-0 self-baseline"}),_e(),a(k),i(N,k)};w(U,N=>{ae&&N(Q)})}var te=n(U,2),W=n(r(te),2),S=r(W);De(S),S.__keydown=N=>s.onNameKeydown?.(N),a(W);var me=n(W,2),se=r(me);a(me),a(te);var oe=n(te,2),m=n(r(oe),2);He(m);var G=n(m,2),d=r(G);a(G),a(oe);var C=n(oe,2);{var F=N=>{var k=Mt(),A=r(k),E=r(A),ie=r(E);lt(ie,{class:"h-4 w-4"}),_e(),a(E);var Z=n(E,2),T=r(Z);De(T),a(Z),a(A);var re=n(A,2),O=r(re),l=r(O);ot(l,{class:"h-4 w-4"}),_e(),a(O);var c=n(O,2),f=r(c);De(f),a(c),a(re),a(k),Y(()=>{T.disabled=x(),f.disabled=x()}),Me(T,q),Me(f,R),i(N,k)};w(C,N=>{M()&&N(F)})}a(V),Y(()=>{Qe(S,"maxlength",z()),S.disabled=x(),ne(se,`${_().length??""}/${z()??""} caractères`),Qe(m,"maxlength",o()),m.disabled=x(),ne(d,`${g().length??""}/${o()??""} caractères`)}),Me(S,_),Me(m,g),i(ue,V),Ae()}Oe(["keydown"]);function kt(ue){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(ue)}var Et=u('<div class="alert alert-error"><!> <span> </span></div>'),Tt=u('<label for="" class="select"><span class="label">Rôle</span> <select class="select"><option class="flex" selected>Membre</option><option>Administrateur</option></select></label>'),It=u('<div class="badge badge-primary badge-lg gap-2"><!> <button class="btn btn-circle btn-ghost btn-xs" title="Retirer"><!></button></div>'),Lt=u('<div><div class="mb-2 text-sm font-medium opacity-70"> </div> <div class="flex flex-wrap gap-2"></div></div>'),qt=u(`<div class="@container space-y-4"><div class="alert alert-soft alert-info @max-lg:alert-vertical"><!> <div><p>Envoyez des invitations aux personnes qui font partie de votre cantine.
        Si elles possèdent déjà un compte enka-cookbook, elles pourront
        directement acceder aux événements de l'équipe, sinon, elles recevrons
        un lien pour créer leur compte.</p> <p>Il est aussi possible d'inviter des personnes individuellement à
        participer aux évenements (depuis les pages d'évenements), même si elles
        ne font pas partie de vos équipes.</p></div></div> <!> <!> <div class="rounded-box bg-base-200 flex flex-col gap-2 p-4"><div class="flex flex-wrap gap-2"><label class="input min-w-56 flex-1 gap-2"><!> <input type="email" placeholder="email@example.com"/></label> <!></div> <div>Les administrateur·ices sont seul·es autorisé·es à modifier les
      informations concernant l'équipe et à supprimer des membres.</div> <button class="btn btn-primary btn-sm ml-auto w-fit" title="Ajouter à la liste"><!> Ajouter</button></div> <!> <div><label class="label" for="invite-message"><span class="label-text">Message personnalisé (optionnel)</span></label> <textarea id="invite-message" class="textarea textarea-bordered w-full" placeholder="Ajoutez un message pour les personnes invitées..." rows="3" maxlength="200"></textarea> <span class="label label-text-alt opacity-50"> </span></div></div>`);function Ze(ue,s){Re(s,!0);let _=de(s,"invitedEmails",31,()=>Le([])),g=de(s,"customMessage",15,""),q=de(s,"loading",3,!1),R=de(s,"role",15,"member"),M=p(""),x=p(null);const z=le(()=>qe.isTeamOwner(s.team.$id));function o(){const l=e(M).trim().toLowerCase();if(!l){t(x,"Veuillez entrer une adresse email");return}if(!kt(l)){t(x,"Adresse email invalide");return}if(_().includes(l)){t(x,"Cet email est déjà dans la liste");return}if(s.team.members.some(f=>f.name.toLowerCase()===l||f.userEmail.toLowerCase()===l)){t(x,"Cette personne est déjà membre ou invitée dans l'équipe");return}_().push(l),t(M,""),t(x,null)}function ae(l){_(_().filter(c=>c!==l))}function V(l){l.key==="Enter"&&(l.preventDefault(),o())}var U=qt(),Q=r(U),te=r(Q);Ve(te,{class:"h-6 w-6 shrink-0 self-baseline"}),_e(2),a(Q);var W=n(Q,2);w(W,l=>{});var S=n(W,2);{var me=l=>{var c=Et(),f=r(c);vt(f,{class:"h-6 w-6 shrink-0"});var v=n(f,2),y=r(v,!0);a(v),a(c),Y(()=>ne(y,e(x))),i(l,c)};w(S,l=>{e(x)&&l(me)})}var se=n(S,2),oe=r(se),m=r(oe),G=r(m);Ne(G,{class:"h-4 w-4 opacity-50"});var d=n(G,2);De(d),d.__keydown=V,a(m);var C=n(m,2);{var F=l=>{var c=Tt(),f=n(r(c),2),v=r(f);v.value=v.__value="member";var y=n(v);y.value=y.__value="owner",a(f),a(c),tt(f,R),i(l,c)};w(C,l=>{e(z)&&l(F)})}a(oe);var N=n(oe,2),k=n(N,2);k.__click=o;var A=r(k);dt(A,{class:" h-5 w-5"}),_e(),a(k),a(se);var E=n(se,2);{var ie=l=>{var c=Lt(),f=r(c),v=r(f);a(f);var y=n(f,2);Ge(y,20,_,h=>h,(h,H)=>{var B=It(),K=r(B);Ne(K,{class:"h-3 w-3"});var D=n(K),I=n(D);I.__click=()=>ae(H);var J=r(I);ct(J,{class:"h-3 w-3"}),a(I),a(B),Y(()=>{ne(D,` ${H??""} `),I.disabled=q()}),i(h,B)}),a(y),a(c),Y(()=>ne(v,`Personnes à inviter (${_().length??""})`)),i(l,c)};w(E,l=>{_().length>0&&l(ie)})}var Z=n(E,2),T=n(r(Z),2);He(T);var re=n(T,2),O=r(re);a(re),a(Z),a(U),Y(l=>{d.disabled=q(),Ce(N,1,`fieldset-label text-xs ${!e(z)&&"hidden"}`),k.disabled=l,T.disabled=q(),ne(O,`${g().length??""}/200 caractères`)},[()=>q()||!e(M).trim()]),Me(d,()=>e(M),l=>t(M,l)),Me(T,g),i(ue,U),Ae()}Oe(["keydown","click"]);var Rt=u('<div class="bg-warning ml-1 h-2 w-2 rounded-full"></div>'),At=u('<div><h4 class=" text-sm font-medium opacity-70">Inviter de nouveaux membres</h4> <!></div>'),Ot=u('<div class="tabs tabs-border mb-6 flex-none" role="tablist"><button role="tab"><!> Membres <span class="badge badge-sm badge-secondary ml-1"> </span></button> <button role="tab"><!> Invitations</button> <button role="tab"><!> Paramètres <!></button></div> <!>',1),Dt=u('<span class="loading loading-spinner loading-sm"></span>'),Pt=u('<button class="btn btn-ghost">Annuler</button> <button class="btn btn-primary"><!></button>',1),St=u('<span class="loading loading-spinner loading-sm"></span>'),jt=u('<button class="btn btn-ghost">Fermer</button> <button class="btn btn-primary"><!></button>',1),zt=u('<button class="btn btn-ghost">Fermer</button>'),Ft=u("<!> <!> <!>",1),Nt=u("<!> <!>",1);function ta(ue,s){Re(s,!0);let _=de(s,"initialTab",3,"members"),g=p(Le(_())),q=p(!1),R=p(!1),M=p(Le([])),x=p(""),z=p(!1);const o=le(()=>s.teamId?ce.getTeamById(s.teamId):null),ae=le(()=>!e(o)||!qe.userId?null:e(o).members.find(N=>N.id===qe.userId)?.roles?.[0]||null),V=le(()=>e(ae)==="owner");let U=p(""),Q=p(""),te=p(""),W=p(""),S=p(!1);We(()=>{e(o)&&(t(U,e(o).name,!0),t(Q,e(o).prefs?.description||"",!0),t(te,e(o).prefs?.location||"",!0),t(W,e(o).prefs?.city||"",!0),t(S,!1))}),We(()=>{e(o)&&t(S,e(U)!==e(o).name||e(Q)!==(e(o).prefs?.description||"")||e(te)!==(e(o).prefs?.location||"")||e(W)!==(e(o).prefs?.city||""),!0)});async function me(){if(!(!e(o)||!e(S))){t(R,!0);try{await ce.updateTeam(e(o).$id,e(U).trim()||void 0,{description:e(Q).trim()||void 0,location:e(te).trim()||void 0,city:e(W).trim()||void 0}),t(S,!1)}catch(F){console.error("[TeamDetailModal] Erreur sauvegarde:",F),alert("Erreur lors de la sauvegarde")}finally{t(R,!1)}}}async function se(){if(e(o)){t(R,!0);try{await ce.deleteTeam(e(o).$id),t(q,!1),s.onClose()}catch(F){console.error("[TeamDetailModal] Erreur suppression:",F),alert("Erreur lors de la suppression de l'équipe")}finally{t(R,!1)}}}async function oe(){s.teamId&&await ce.fetchTeam(s.teamId)}async function m(){if(!(!e(o)||e(M).length===0)){t(z,!0);try{await Je.track(ce.inviteTeamMember(e(o).$id,e(M),e(x)||void 0),{loading:"Envoi des invitations en cours...",success:`${e(M).length} invitation${e(M).length>1?"s":""} envoyée${e(M).length>1?"s":""} avec succès`,error:"Erreur lors de l'envoi des invitations"}),t(M,[],!0),t(x,""),s.teamId&&await ce.fetchTeam(s.teamId)}catch(F){console.error("[TeamDetailModal] Erreur envoi invitations:",F)}finally{t(z,!1)}}}var G=Nt(),d=P(G);{let F=le(()=>s.teamId!==null);Xe(d,{get isOpen(){return e(F)},get onClose(){return s.onClose},children:(N,k)=>{var A=be(),E=P(A);{var ie=Z=>{var T=Ft(),re=P(T);Ue(re,{get title(){return e(o).name},get subtitle(){return e(o).description},get onClose(){return s.onClose}});var O=n(re,2);Be(O,{children:(c,f)=>{var v=Ot(),y=P(v),h=r(y);h.__click=()=>t(g,"members");var H=r(h);Fe(H,{class:"mr-1 h-5 w-5"});var B=n(H,2),K=r(B,!0);a(B),a(h);var D=n(h,2);D.__click=()=>t(g,"invitations");var I=r(D);Ne(I,{class:"mr-1 h-5 w-5"}),_e(),a(D);var J=n(D,2);J.__click=()=>t(g,"settings");var $=r(J);ut($,{class:"mr-1 h-5 w-5"});var X=n($,2);{var b=fe=>{var ge=Rt();i(fe,ge)};w(X,fe=>{e(S)&&fe(b)})}a(J),a(y);var ee=n(y,2);at(ee,()=>e(g),fe=>{var ge=be(),ke=P(ge);{var ve=j=>{yt(j,{get team(){return e(o)},onMemberRemoved:oe})},L=j=>{var pe=be(),Ee=P(pe);{var Te=he=>{var we=At(),Pe=n(r(we),2);Ze(Pe,{get team(){return e(o)},get loading(){return e(z)},get invitedEmails(){return e(M)},set invitedEmails(Ie){t(M,Ie,!0)},get customMessage(){return e(x)},set customMessage(Ie){t(x,Ie,!0)}}),a(we),i(he,we)},xe=he=>{var we=be(),Pe=P(we);{var Ie=Se=>{{let $e=le(()=>e(R)||!e(V));Ye(Se,{showLocation:!0,get disabled(){return e($e)},get name(){return e(U)},set name(ye){t(U,ye,!0)},get description(){return e(Q)},set description(ye){t(Q,ye,!0)},get location(){return e(te)},set location(ye){t(te,ye,!0)},get city(){return e(W)},set city(ye){t(W,ye,!0)}})}};w(Pe,Se=>{e(g)==="settings"&&Se(Ie)},!0)}i(he,we)};w(Ee,he=>{e(g)==="invitations"?he(Te):he(xe,!1)},!0)}i(j,pe)};w(ke,j=>{e(g)==="members"?j(ve):j(L,!1)})}i(fe,ge)}),Y(()=>{Ce(h,1,`tab ${e(g)==="members"?"tab-active":""}`),ne(K,e(o).members.length),Ce(D,1,`tab ${e(g)==="invitations"?"tab-active":""}`),Ce(J,1,`tab ${e(g)==="settings"?"tab-active":""}`)}),i(c,v)}});var l=n(O,2);Ke(l,{children:(c,f)=>{var v=be(),y=P(v);{var h=B=>{var K=Pt(),D=P(K);D.__click=function(...b){s.onClose?.apply(this,b)};var I=n(D,2);I.__click=me;var J=r(I);{var $=b=>{var ee=Dt();i(b,ee)},X=b=>{var ee=je("Enregistrer");i(b,ee)};w(J,b=>{e(R)?b($):b(X,!1)})}a(I),Y(()=>I.disabled=e(R)||!e(S)),i(B,K)},H=B=>{var K=be(),D=P(K);{var I=$=>{var X=jt(),b=P(X);b.__click=function(...ve){s.onClose?.apply(this,ve)};var ee=n(b,2);ee.__click=m;var fe=r(ee);{var ge=ve=>{var L=St();i(ve,L)},ke=ve=>{var L=je();Y(()=>ne(L,`Envoyer ${e(M).length??""} invitation${e(M).length>1?"s":""}`)),i(ve,L)};w(fe,ve=>{e(z)?ve(ge):ve(ke,!1)})}a(ee),Y(()=>ee.disabled=e(z)||e(M).length===0),i($,X)},J=$=>{var X=zt();X.__click=function(...b){s.onClose?.apply(this,b)},i($,X)};w(D,$=>{e(g)==="invitations"?$(I):$(J,!1)},!0)}i(B,K)};w(y,B=>{e(g)==="settings"?B(h):B(H,!1)})}i(c,v)}}),i(Z,T)};w(E,Z=>{e(o)&&Z(ie)})}i(N,A)},$$slots:{default:!0}})}var C=n(d,2);ze(C,{get isOpen(){return e(q)},title:"Supprimer l'équipe",message:"Êtes-vous sûr de vouloir supprimer définitivement cette équipe ? Tous les membres seront retirés et cette action est irréversible.",variant:"danger",confirmLabel:"Supprimer définitivement",cancelLabel:"Annuler",onConfirm:se,onCancel:()=>t(q,!1)}),i(ue,G),Ae()}Oe(["click"]);var Ut=u('<div class="alert alert-error"><span class="text-sm"> </span></div>'),Bt=u('<form class="space-y-4"><!> <!></form>'),Kt=u('<span class="loading loading-spinner loading-sm"></span>'),Vt=u(`<button class="btn btn-ghost">Annuler</button> <button class="btn btn-primary"><!> Créer l'équipe</button>`,1),Qt=u("<!> <!> <!>",1),Wt=u('<div class="mb-4"><div class="alert alert-success alert-soft flex flex-col"><p> </p> <p>Ajoutez les email des personnes que vous souhaitez inviter</p></div></div> <!>',1),Gt=u('<span class="loading loading-spinner loading-sm"></span>'),Ht=u('<button class="btn btn-ghost">Passer cette étape</button> <button class="btn btn-primary"><!></button>',1),Jt=u("<!> <!> <!>",1);function aa(ue,s){Re(s,!0);let _=p(""),g=p(""),q=p(""),R=p(""),M=p(!1),x=p(!1),z=p(null),o=p("create"),ae=p(null),V=p(Le([])),U=p(""),Q=p(!1);function te(){t(_,""),t(g,""),t(q,""),t(R,""),t(M,!1),t(z,null),t(o,"create"),t(ae,null),t(V,[],!0),t(U,""),t(Q,!1)}async function W(){if(!e(_).trim()){t(z,"Le nom de l'équipe est requis");return}t(x,!0),t(z,null);try{const m={description:e(g).trim()||void 0,location:e(q).trim()||void 0,city:e(R).trim()||void 0,isPublic:e(M)},G=await ce.createTeam(e(_).trim(),m);t(ae,G.$id,!0),t(o,"invite")}catch(m){t(z,m.message||"Erreur lors de la création de l'équipe",!0),console.error("[CreateTeamModal] Erreur:",m)}finally{t(x,!1)}}async function S(){if(!e(ae)||e(V).length===0)return;const m=e(ae),G=[...e(V)],d=e(U)||void 0;me();try{await Je.track(ce.inviteTeamMember(m,G,d),{loading:"Envoi des invitations en cours...",success:`${G.length} invitation${G.length>1?"s":""} envoyée${G.length>1?"s":""} avec succès`,error:"Erreur lors de l'envoi des invitations"}),await ce.fetchTeam(m)}catch(C){console.error("[CreateTeamModal] Erreur envoi invitations:",C)}}function me(){const m=e(ae);m&&s.onSuccess?.(m),te(),s.onClose()}function se(){te(),s.onClose()}function oe(m){m.key==="Enter"&&e(o)==="create"&&(m.preventDefault(),W())}Xe(ue,{get isOpen(){return s.isOpen},onClose:se,children:(m,G)=>{var d=be(),C=P(d);{var F=k=>{var A=Qt(),E=P(A);Ue(E,{title:"Créer une équipe",onClose:se});var ie=n(E,2);Be(ie,{children:(T,re)=>{var O=Bt(),l=r(O);Ye(l,{showLocation:!0,get disabled(){return e(x)},onNameKeydown:oe,get name(){return e(_)},set name(v){t(_,v,!0)},get description(){return e(g)},set description(v){t(g,v,!0)},get location(){return e(q)},set location(v){t(q,v,!0)},get city(){return e(R)},set city(v){t(R,v,!0)}});var c=n(l,2);{var f=v=>{var y=Ut(),h=r(y),H=r(h,!0);a(h),a(y),Y(()=>ne(H,e(z))),i(v,y)};w(c,v=>{e(z)&&v(f)})}a(O),rt("submit",O,v=>v.preventDefault()),i(T,O)}});var Z=n(ie,2);Ke(Z,{children:(T,re)=>{var O=Vt(),l=P(O);l.__click=se;var c=n(l,2);c.__click=W;var f=r(c);{var v=h=>{var H=Kt();i(h,H)},y=h=>{mt(h,{class:"h-5 w-5"})};w(f,h=>{e(x)?h(v):h(y,!1)})}_e(),a(c),Y(h=>{l.disabled=e(x),c.disabled=h},[()=>e(x)||!e(_).trim()]),i(T,O)}}),i(k,A)},N=k=>{var A=be(),E=P(A);{var ie=Z=>{const T=le(()=>ce.getTeamById(e(ae)));var re=be(),O=P(re);{var l=c=>{var f=Jt(),v=P(f);Ue(v,{title:"Inviter des membres",onClose:se});var y=n(v,2);Be(y,{children:(H,B)=>{var K=Wt(),D=P(K),I=r(D),J=r(I),$=r(J);a(J),_e(2),a(I),a(D);var X=n(D,2);Ze(X,{get team(){return e(T)},get loading(){return e(Q)},get invitedEmails(){return e(V)},set invitedEmails(b){t(V,b,!0)},get customMessage(){return e(U)},set customMessage(b){t(U,b,!0)}}),Y(()=>ne($,`Équipe "${e(T).name??""}" créée avec succès !`)),i(H,K)}});var h=n(y,2);Ke(h,{children:(H,B)=>{var K=Ht(),D=P(K);D.__click=me;var I=n(D,2);I.__click=S;var J=r(I);{var $=b=>{var ee=Gt();i(b,ee)},X=b=>{var ee=je();Y(()=>ne(ee,`Envoyer ${e(V).length??""} invitation${e(V).length>1?"s":""}`)),i(b,ee)};w(J,b=>{e(Q)?b($):b(X,!1)})}a(I),Y(()=>I.disabled=e(Q)||e(V).length===0),i(H,K)}}),i(c,f)};w(O,c=>{e(T)&&c(l)})}i(Z,re)};w(E,Z=>{e(o)==="invite"&&e(ae)&&Z(ie)},!0)}i(k,A)};w(C,k=>{e(o)==="create"?k(F):k(N,!1)})}i(m,d)},$$slots:{default:!0}}),Ae()}Oe(["click"]);export{aa as C,ta as T};
