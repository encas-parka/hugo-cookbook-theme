import{d as Xt,p as bt,X as Yt,m as t,y as T,A as _,ac as vt,Y as Jt,v as G,K as f,h as a,g as o,R as Nt,w as D,C as v,M as ht,b as m,c as Qt,x as gt,u as Vt,j as _t,k as ft,B as Wt,o as n,G as F}from"./appwrite.js";import{a as Zt,m as $t,b as te,c as ee,E as ae,i as ne,d as re,e as se,M as ie}from"./tiptap-markdown.es.js";import{aB as mt,aC as pt,aD as kt,aE as wt,aq as oe,ar as le,aF as ue,aG as de,as as ce,at as be,aH as ve,al as he,au as ge}from"./icons.js";var _e=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))$/,fe=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))/g,me=Zt.create({name:"highlight",addOptions(){return{multicolor:!1,HTMLAttributes:{}}},addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:r=>r.getAttribute("data-color")||r.style.backgroundColor,renderHTML:r=>r.color?{"data-color":r.color,style:`background-color: ${r.color}; color: inherit`}:{}}}:{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:r}){return["mark",ee(this.options.HTMLAttributes,r),0]},renderMarkdown:(r,s)=>`==${s.renderChildren(r)}==`,parseMarkdown:(r,s)=>s.applyMark("highlight",s.parseInline(r.tokens||[])),markdownTokenizer:{name:"highlight",level:"inline",start:r=>r.indexOf("=="),tokenize(r,s,p){const e=/^(==)([^=]+)(==)/.exec(r);if(e){const u=e[2].trim(),q=p.inlineTokens(u);return{type:"highlight",raw:e[0],text:u,tokens:q}}}},addCommands(){return{setHighlight:r=>({commands:s})=>s.setMark(this.name,r),toggleHighlight:r=>({commands:s})=>s.toggleMark(this.name,r),unsetHighlight:()=>({commands:r})=>r.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight()}},addInputRules(){return[te({find:_e,type:this.type})]},addPasteRules(){return[$t({find:fe,type:this.type})]}}),pe=me,ke=G('<label class="label"><span class="label-text font-medium"> </span></label>'),we=G('<div class="border-base-200 bg-base-100 flex flex-wrap items-center gap-1 border-b p-1"><div><button type="button" tabindex="0" class="btn btn-ghost btn-sm gap-1" title="Titre"><!></button> <ul tabindex="-1" class="menu dropdown-content bg-base-100 rounded-box z-50 w-52 shadow-xl"><li><button type="button"><!> Paragraphe</button></li> <li><button type="button"><!> Titre 1</button></li> <li><button type="button"><!> Titre 2</button></li> <li><button type="button"><!> Titre 3</button></li></ul></div> <div class="divider divider-horizontal mx-0 h-6"></div> <button type="button" title="Gras"><!></button> <button type="button" title="Italique"><!></button> <button type="button" title="Barré"><!></button> <button type="button" title="Surlignage"><!></button> <div class="divider divider-horizontal mx-0 h-6"></div> <button type="button" title="Liste à puces"><!></button> <button type="button" title="Liste ordonnée"><!></button> <div class="divider divider-horizontal mx-0 h-6"></div> <button type="button" class="btn btn-ghost btn-square btn-sm" title="Ligne horizontale"><!></button> <div class="divider divider-horizontal mx-0 h-6"></div> <button type="button" class="btn btn-ghost btn-square btn-sm" title="Annuler"><!></button> <button type="button" class="btn btn-ghost btn-square btn-sm" title="Rétablir"><!></button></div>'),xe=G('<div class="label"><span class="text-error"> </span></div>'),ye=G('<div class="form-control w-full"><!> <div><!> <div></div></div> <!></div>');function Le(r,s){Xt(s,!0);let p=bt(s,"value",15);bt(s,"placeholder",3,"Commencez à rédiger...");let k=T(null),e=T(null),u=T(0),q=T(!1),R=T(!1);const O=Vt(()=>t(e)?(t(u),t(e).isActive("heading",{level:1})?1:t(e).isActive("heading",{level:2})?2:t(e).isActive("heading",{level:3})?3:t(e).isActive("heading",{level:4})?4:t(e).isActive("heading",{level:5})?5:t(e).isActive("heading",{level:6})?6:0):0);Yt(()=>{t(k)&&_(e,new ae({element:t(k),extensions:[ne.configure({codeBlock:!1,blockquote:!1,heading:!1}),re.configure({levels:[1,2,3,4,5,6]}),pe.configure({multicolor:!1}),se,ie.configure({html:!1,tightLists:!0})],content:p(),editorProps:{attributes:{class:"prose prose-sm max-w-none focus:outline-none h-[80dvh] p-4 prose-li:marker:text-base-content/50 overflow-auto"}},onUpdate:({editor:i})=>{const l=i.storage.markdown.getMarkdown();p()!==l&&p(l)},onSelectionUpdate:()=>{vt(u)},onTransaction:()=>{vt(u)},onFocus:()=>_(q,!0),onBlur:()=>_(q,!1)}),!0)}),Jt(()=>{t(e)&&t(e).destroy()});function z(i){i===0?t(e).chain().focus().setParagraph().run():t(e).chain().focus().setHeading({level:i}).run(),_(R,!1)}function xt(){t(e).chain().focus().setHorizontalRule().run()}var K=ye(),tt=a(K);{var yt=i=>{var l=ke(),d=a(l),h=a(d,!0);n(d),n(l),D(()=>{ht(l,"for",s.id),gt(h,s.label)}),m(i,l)};f(tt,i=>{s.label&&i(yt)})}var B=o(tt,2);let et;var at=a(B);{var Ht=i=>{var l=we(),d=a(l);let h;var C=a(d);C.__click=()=>_(R,!t(R));var Lt=a(C);{var Tt=c=>{pt(c,{class:"h-4 w-4"})},qt=c=>{var P=_t(),V=ft(P);{var W=b=>{kt(b,{class:"h-4 w-4"})},Z=b=>{var E=_t(),$=ft(E);{var Ut=g=>{wt(g,{class:"h-4 w-4"})},jt=g=>{mt(g,{class:"h-4 w-4"})};f($,g=>{t(O)===3?g(Ut):g(jt,!1)},!0)}m(b,E)};f(V,b=>{t(O)===2?b(W):b(Z,!1)},!0)}m(c,P)};f(Lt,c=>{t(O)===1?c(Tt):c(qt,!1)})}n(C);var rt=o(C,2),U=a(rt),j=a(U);j.__click=()=>z(0);var Rt=a(j);mt(Rt,{class:"h-4 w-4"}),F(),n(j),n(U);var X=o(U,2),Y=a(X);Y.__click=()=>z(1);var zt=a(Y);pt(zt,{class:"h-4 w-4"}),F(),n(Y),n(X);var J=o(X,2),N=a(J);N.__click=()=>z(2);var Bt=a(N);kt(Bt,{class:"h-4 w-4"}),F(),n(N),n(J);var st=o(J,2),Q=a(st);Q.__click=()=>z(3);var Ct=a(Q);wt(Ct,{class:"h-4 w-4"}),F(),n(Q),n(st),n(rt),n(d);var w=o(d,4);let it;w.__click=()=>t(e).chain().focus().toggleBold().run();var It=a(w);oe(It,{class:"h-4 w-4"}),n(w);var x=o(w,2);let ot;x.__click=()=>t(e).chain().focus().toggleItalic().run();var St=a(x);le(St,{class:"h-4 w-4"}),n(x);var y=o(x,2);let lt;y.__click=()=>t(e).chain().focus().toggleStrike().run();var Pt=a(y);ue(Pt,{class:"h-4 w-4"}),n(y);var H=o(y,2);let ut;H.__click=()=>t(e).chain().focus().toggleHighlight().run();var Et=a(H);de(Et,{class:"h-4 w-4"}),n(H);var M=o(H,4);let dt;M.__click=()=>t(e).chain().focus().toggleBulletList().run();var Dt=a(M);ce(Dt,{class:"h-4 w-4"}),n(M);var A=o(M,2);let ct;A.__click=()=>t(e).chain().focus().toggleOrderedList().run();var Ft=a(A);be(Ft,{class:"h-4 w-4"}),n(A);var I=o(A,4);I.__click=xt;var Gt=a(I);ve(Gt,{class:"h-4 w-4"}),n(I);var L=o(I,4);L.__click=()=>t(e).chain().focus().undo().run();var Ot=a(L);he(Ot,{class:"h-4 w-4"}),n(L);var S=o(L,2);S.__click=()=>t(e).chain().focus().redo().run();var Kt=a(S);ge(Kt,{class:"h-4 w-4"}),n(S),n(l),D((c,P,V,W,Z,b,E,$)=>{h=v(d,1,"dropdown",null,h,{"dropdown-open":t(R)}),it=v(w,1,"btn btn-ghost btn-square btn-sm",null,it,c),ot=v(x,1,"btn btn-ghost btn-square btn-sm",null,ot,P),lt=v(y,1,"btn btn-ghost btn-square btn-sm",null,lt,V),ut=v(H,1,"btn btn-ghost btn-square btn-sm",null,ut,W),dt=v(M,1,"btn btn-ghost btn-square btn-sm",null,dt,Z),ct=v(A,1,"btn btn-ghost btn-square btn-sm",null,ct,b),L.disabled=E,S.disabled=$},[()=>({"btn-active":t(u)>=0&&t(e).isActive("bold")}),()=>({"btn-active":t(u)>=0&&t(e).isActive("italic")}),()=>({"btn-active":t(u)>=0&&t(e).isActive("strike")}),()=>({"btn-active":t(u)>=0&&t(e).isActive("highlight")}),()=>({"btn-active":t(u)>=0&&t(e).isActive("bulletList")}),()=>({"btn-active":t(u)>=0&&t(e).isActive("orderedList")}),()=>!(t(u)>=0&&t(e).can().undo()),()=>!(t(u)>=0&&t(e).can().redo())]),m(i,l)};f(at,i=>{t(e)&&i(Ht)})}var nt=o(at,2);Nt(nt,i=>_(k,i),()=>t(k)),n(B);var Mt=o(B,2);{var At=i=>{var l=xe(),d=a(l),h=a(d,!0);n(d),n(l),D(()=>gt(h,s.error)),m(i,l)};f(Mt,i=>{s.error&&i(At)})}n(K),D(()=>{et=v(B,1,"bg-base-100 border-base-300 overflow-hidden rounded-lg border shadow-lg transition-all",null,et,{"border-error":s.error}),ht(nt,"id",s.id)}),m(r,K),Qt()}Wt(["click"]);export{Le as M};
