import{b5 as bt,b6 as vt,b7 as ht,b8 as gt,V as Gt,W as Vt,b9 as Wt,ba as Yt,Y as Jt,Z as Nt,an as Qt,_ as Xt,$ as $t}from"./icons.js";import{p as _t,Z as te,$ as ee,v as F,I as _,P as ae,w as O,b as f,c as ne,d as re,m as t,y as T,A as m,ab as ft,h as o,g as a,B as se,C as v,L as mt,x as pt,u as ie,j as kt,k as wt,o as n,K as D}from"./appwrite.js";import{a as oe,m as le,b as ue,c as de,E as ce,i as be,d as ve,e as he,M as ge}from"./tiptap-markdown.es.js";var _e=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))$/,fe=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))/g,me=oe.create({name:"highlight",addOptions(){return{multicolor:!1,HTMLAttributes:{}}},addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:r=>r.getAttribute("data-color")||r.style.backgroundColor,renderHTML:r=>r.color?{"data-color":r.color,style:`background-color: ${r.color}; color: inherit`}:{}}}:{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:r}){return["mark",de(this.options.HTMLAttributes,r),0]},renderMarkdown:(r,s)=>`==${s.renderChildren(r)}==`,parseMarkdown:(r,s)=>s.applyMark("highlight",s.parseInline(r.tokens||[])),markdownTokenizer:{name:"highlight",level:"inline",start:r=>r.indexOf("=="),tokenize(r,s,p){const e=/^(==)([^=]+)(==)/.exec(r);if(e){const u=e[2].trim(),q=p.inlineTokens(u);return{type:"highlight",raw:e[0],text:u,tokens:q}}}},addCommands(){return{setHighlight:r=>({commands:s})=>s.setMark(this.name,r),toggleHighlight:r=>({commands:s})=>s.toggleMark(this.name,r),unsetHighlight:()=>({commands:r})=>r.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight()}},addInputRules(){return[ue({find:_e,type:this.type})]},addPasteRules(){return[le({find:fe,type:this.type})]}}),pe=me,ke=F('<label class="label"><span class="label-text font-medium"> </span></label>'),we=F('<div class="border-base-200 bg-base-100 flex flex-wrap items-center gap-1 border-b p-1"><div><button type="button" tabindex="0" class="btn btn-ghost btn-sm gap-1" title="Titre"><!></button> <ul tabindex="-1" class="menu dropdown-content bg-base-100 rounded-box z-50 w-52 shadow-xl"><li><button type="button"><!> Paragraphe</button></li> <li><button type="button"><!> Titre 1</button></li> <li><button type="button"><!> Titre 2</button></li> <li><button type="button"><!> Titre 3</button></li></ul></div> <div class="divider divider-horizontal mx-0 h-6"></div> <button type="button" title="Gras"><!></button> <button type="button" title="Italique"><!></button> <button type="button" title="Barré"><!></button> <button type="button" title="Surlignage"><!></button> <div class="divider divider-horizontal mx-0 h-6"></div> <button type="button" title="Liste à puces"><!></button> <button type="button" title="Liste ordonnée"><!></button> <div class="divider divider-horizontal mx-0 h-6"></div> <button type="button" class="btn btn-ghost btn-square btn-sm" title="Ligne horizontale"><!></button> <div class="divider divider-horizontal mx-0 h-6"></div> <button type="button" class="btn btn-ghost btn-square btn-sm" title="Annuler"><!></button> <button type="button" class="btn btn-ghost btn-square btn-sm" title="Rétablir"><!></button></div>'),xe=F('<div class="label"><span class="text-error"> </span></div>'),ye=F('<div class="form-control w-full"><!> <div><!> <div></div></div> <!></div>');function Le(r,s){re(s,!0);let p=_t(s,"value",15);_t(s,"placeholder",3,"Commencez à rédiger...");let k=T(null),e=T(null),u=T(0),q=T(!1),z=T(!1);const K=ie(()=>t(e)?(t(u),t(e).isActive("heading",{level:1})?1:t(e).isActive("heading",{level:2})?2:t(e).isActive("heading",{level:3})?3:t(e).isActive("heading",{level:4})?4:t(e).isActive("heading",{level:5})?5:t(e).isActive("heading",{level:6})?6:0):0);te(()=>{t(k)&&m(e,new ce({element:t(k),extensions:[be.configure({codeBlock:!1,blockquote:!1,heading:!1}),ve.configure({levels:[1,2,3,4,5,6]}),pe.configure({multicolor:!1}),he,ge.configure({html:!1,tightLists:!0})],content:p(),editorProps:{attributes:{class:"prose prose-sm max-w-none focus:outline-none h-[80dvh] p-4 prose-li:marker:text-base-content/50 overflow-auto"}},onUpdate:({editor:i})=>{const l=i.storage.markdown.getMarkdown();p()!==l&&p(l)},onSelectionUpdate:()=>{ft(u)},onTransaction:()=>{ft(u)},onFocus:()=>m(q,!0),onBlur:()=>m(q,!1)}),!0)}),ee(()=>{t(e)&&t(e).destroy()});function R(i){i===0?t(e).chain().focus().setParagraph().run():t(e).chain().focus().setHeading({level:i}).run(),m(z,!1)}function xt(){t(e).chain().focus().setHorizontalRule().run()}var U=ye(),tt=a(U);{var yt=i=>{var l=ke(),d=a(l),h=a(d,!0);n(d),n(l),O(()=>{mt(l,"for",s.id),pt(h,s.label)}),f(i,l)};_(tt,i=>{s.label&&i(yt)})}var B=o(tt,2);let et;var at=a(B);{var Ht=i=>{var l=we(),d=a(l);let h;var I=a(d);I.__click=()=>m(z,!t(z));var Lt=a(I);{var Tt=c=>{vt(c,{class:"h-4 w-4"})},qt=c=>{var S=kt(),N=wt(S);{var Q=b=>{ht(b,{class:"h-4 w-4"})},X=b=>{var E=kt(),$=wt(E);{var Zt=g=>{gt(g,{class:"h-4 w-4"})},jt=g=>{bt(g,{class:"h-4 w-4"})};_($,g=>{t(K)===3?g(Zt):g(jt,!1)},!0)}f(b,E)};_(N,b=>{t(K)===2?b(Q):b(X,!1)},!0)}f(c,S)};_(Lt,c=>{t(K)===1?c(Tt):c(qt,!1)})}n(I);var rt=o(I,2),Z=a(rt),j=a(Z);j.__click=()=>R(0);var zt=a(j);bt(zt,{class:"h-4 w-4"}),D(),n(j),n(Z);var G=o(Z,2),V=a(G);V.__click=()=>R(1);var Rt=a(V);vt(Rt,{class:"h-4 w-4"}),D(),n(V),n(G);var W=o(G,2),Y=a(W);Y.__click=()=>R(2);var Bt=a(Y);ht(Bt,{class:"h-4 w-4"}),D(),n(Y),n(W);var st=o(W,2),J=a(st);J.__click=()=>R(3);var It=a(J);gt(It,{class:"h-4 w-4"}),D(),n(J),n(st),n(rt),n(d);var w=o(d,4);let it;w.__click=()=>t(e).chain().focus().toggleBold().run();var Ct=a(w);Gt(Ct,{class:"h-4 w-4"}),n(w);var x=o(w,2);let ot;x.__click=()=>t(e).chain().focus().toggleItalic().run();var Pt=a(x);Vt(Pt,{class:"h-4 w-4"}),n(x);var y=o(x,2);let lt;y.__click=()=>t(e).chain().focus().toggleStrike().run();var St=a(y);Wt(St,{class:"h-4 w-4"}),n(y);var H=o(y,2);let ut;H.__click=()=>t(e).chain().focus().toggleHighlight().run();var Et=a(H);Yt(Et,{class:"h-4 w-4"}),n(H);var M=o(H,4);let dt;M.__click=()=>t(e).chain().focus().toggleBulletList().run();var Ot=a(M);Jt(Ot,{class:"h-4 w-4"}),n(M);var A=o(M,2);let ct;A.__click=()=>t(e).chain().focus().toggleOrderedList().run();var Dt=a(A);Nt(Dt,{class:"h-4 w-4"}),n(A);var C=o(A,4);C.__click=xt;var Ft=a(C);Qt(Ft,{class:"h-4 w-4"}),n(C);var L=o(C,4);L.__click=()=>t(e).chain().focus().undo().run();var Kt=a(L);Xt(Kt,{class:"h-4 w-4"}),n(L);var P=o(L,2);P.__click=()=>t(e).chain().focus().redo().run();var Ut=a(P);$t(Ut,{class:"h-4 w-4"}),n(P),n(l),O((c,S,N,Q,X,b,E,$)=>{h=v(d,1,"dropdown",null,h,{"dropdown-open":t(z)}),it=v(w,1,"btn btn-ghost btn-square btn-sm",null,it,c),ot=v(x,1,"btn btn-ghost btn-square btn-sm",null,ot,S),lt=v(y,1,"btn btn-ghost btn-square btn-sm",null,lt,N),ut=v(H,1,"btn btn-ghost btn-square btn-sm",null,ut,Q),dt=v(M,1,"btn btn-ghost btn-square btn-sm",null,dt,X),ct=v(A,1,"btn btn-ghost btn-square btn-sm",null,ct,b),L.disabled=E,P.disabled=$},[()=>({"btn-active":t(u)>=0&&t(e).isActive("bold")}),()=>({"btn-active":t(u)>=0&&t(e).isActive("italic")}),()=>({"btn-active":t(u)>=0&&t(e).isActive("strike")}),()=>({"btn-active":t(u)>=0&&t(e).isActive("highlight")}),()=>({"btn-active":t(u)>=0&&t(e).isActive("bulletList")}),()=>({"btn-active":t(u)>=0&&t(e).isActive("orderedList")}),()=>!(t(u)>=0&&t(e).can().undo()),()=>!(t(u)>=0&&t(e).can().redo())]),f(i,l)};_(at,i=>{t(e)&&i(Ht)})}var nt=o(at,2);ae(nt,i=>m(k,i),()=>t(k)),n(B);var Mt=o(B,2);{var At=i=>{var l=xe(),d=a(l),h=a(d,!0);n(d),n(l),O(()=>pt(h,s.error)),f(i,l)};_(Mt,i=>{s.error&&i(At)})}n(U),O(()=>{et=v(B,1,"bg-base-100 border-base-300 overflow-hidden rounded-lg border shadow-lg transition-all",null,et,{"border-error":s.error}),mt(nt,"id",s.id)}),f(r,U),ne()}se(["click"]);export{Le as M};
