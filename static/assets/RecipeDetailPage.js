import{n as Xe,a4 as Ye,y as Ze,a5 as $e,U as ea}from"./icons.js";import{p as aa,j as Q,k as W,I as c,b as n,v as d,g as t,h as v,o as r,w as x,x as g,S as ra,H as ye,$ as ta,O as sa,c as ia,d as na,m as e,u as O,A as k,J as va,y as K,B as da,G as M,E as we,L as oa,an as la,a9 as ca,K as oe,e as le,i as ce,U as pa}from"./appwrite.js";import{R as ua}from"./RecipeRegimeBadges.js";import{R as _a,a as ga}from"./RecipePreparation.js";import{R as fa,a as ma}from"./RecipeVariants.js";import{n as ke,f as ba}from"./index.js";import"./products-display.js";import"./Fieldset.js";import"./SvelteMarkdown.js";var xa=d('<div class="text-base-content/70 text-sm"> <!></div>'),ha=d(`<div class="alert alert-error alert-soft max-md:alert-vertical"><!> <div class="text-sm">Les auteur·ices de la recette ne l'ont <strong>pas testé</strong> </div></div>`);function ya(T,S){let V=aa(S,"isChecked",3,!1);var E=Q(),U=W(E);{var I=_=>{var h=xa(),j=t(h),q=v(j);{var F=C=>{var G=ra();x(()=>g(G,`et pour ${S.checkedFor??""} couverts`)),n(C,G)};c(q,C=>{S.checkedFor&&C(F)})}r(h),x(()=>g(j,`Cette recette a été testée pour ${S.defaultServings??""} couverts `)),n(_,h)},a=_=>{var h=ha(),j=t(h);Xe(j,{class:"h-5 w-5"});var q=v(j,2),F=v(t(q),2);r(q),r(h),x(()=>g(F,` pour le
      nombre de couverts indiqué par défaut (${S.defaultServings??""}).`)),n(_,h)};c(U,_=>{V()?_(I):_(a,!1)})}n(T,E)}var wa=d('<button class="btn btn-primary"><!> Éditer</button>'),ka=d('<div class="flex items-center gap-4"><button class="btn btn-circle btn-primary"><!></button> <button class="btn btn-secondary"><!> Créer une version alternative</button> <!></div>'),Ra=d('<div class="flex items-center justify-center py-20"><div class="loading loading-spinner loading-lg"></div></div>'),Aa=d('<div class="alert alert-error"><div><h3 class="font-bold">Erreur</h3> <div> </div></div></div>'),Sa=d("<div><!></div>"),Ia=d('<p class="text-base-content/60 text-lg print:text-sm"> </p>'),Ca=d('<div class="mb-2"><span class="badge badge-primary badge-soft"> </span></div>'),Ba=d('<div class="mb-2 flex flex-wrap gap-2 print:hidden"><!> <p class="text-base-content/70 text-base italic"> </p></div>'),Ea=d('<span class="badge badge-warning">Servir Chaud</span>'),ja=d('<span class="badge badge-info">Servir Froid</span>'),Da=d('<div class="mb-2"><!></div>'),Ua=d('<span class="badge badge-warning">Avec Cuisson</span>'),qa=d('<span class="badge badge-info">Sans Cuisson</span>'),za=d('<div class="mb-2"><!></div>'),Pa=d('<span class="badge badge-error"> </span>'),Fa=d('<div class="flex w-fit flex-wrap items-center gap-2"><span class="text-base-content/70 font-semibold">Allergenes :</span> <!></div>'),Ha=d('<span class="badge"> </span>'),La=d('<div class="flex flex-wrap gap-2"></div>'),Na=d('<p class="text-end text-base"> </p>'),Oa=d('<div class="mt-8 print:hidden"><!></div>'),Wa=d('<div class="card bg-base-100"><div class="card-body not-md:px-1"><div class="mb-4 print:mb-2"><div class="flex items-center justify-between gap-x-10 gap-y-4"><h1 class="text-primary flex items-center gap-3 print:text-xl print:text-black"><svg class="me-2 size-9 shrink-0 stroke-3 print:stroke-black"><use></use></svg> </h1> <!></div> <!></div> <!> <div class="border-base-300 mb-6 border-b pb-4 print:mb-1 print:pb-2"><div class="flex flex-wrap items-center justify-between gap-4"><div class="flex gap-2"><!> <!></div> <!> <!></div></div> <div class="mb-6 flex flex-wrap items-center justify-between gap-6 print:hidden"><div class="flex items-center gap-4"><label for="servings-input" class="flex items-center gap-2 font-medium"><!> Nombre de couverts à servir :</label> <input id="servings-input" type="number" min="1" class="input input-bordered input-primary w-24"/></div> <!></div> <div class="flex justify-between"><p class="print-only font-medium"> </p> <!></div> <div class="mt-8 grid grid-cols-1 gap-8 lg:grid-cols-3 print:mt-2 print:grid-cols-10 print:gap-4" style="break-before: avoid;"><div class=" lg:col-span-1 print:col-span-3"><div class="sticky top-4 print:static"><!></div></div> <div class="lg:col-span-2 print:col-span-7"><!></div></div></div></div> <!> <!>',1),Ga=d('<div class="mx-auto max-w-7xl px-4 py-8"><!></div>');function $a(T,S){na(S,!0);const V=u=>{var o=Q(),R=W(o);{var X=H=>{var y=ka(),f=t(y);f.__click=()=>window.print();var z=t(f);Ye(z,{size:18}),r(f);var A=v(f,2);A.__click=()=>we(`/recipe/${e(a)?.$id}/duplicate`);var D=t(A);Ze(D,{size:18}),oe(),r(A);var J=v(A,2);{var L=P=>{var B=wa();B.__click=()=>we(`/recipe/${e(a)?.$id}/edit`);var N=t(B);$e(N,{size:18}),oe(),r(B),n(P,B)};c(J,P=>{(e(a).permissionWrite&&M.userId&&e(a).permissionWrite.includes(M.userId)||e(a).createdBy&&e(a).createdBy===M.userId)&&P(L)})}r(y),n(H,y)};c(R,H=>{M.isAuthenticated&&e(a)&&H(X)})}n(u,o)};let E=O(()=>S.params?.uuid),U=K(!0),I=K(null),a=K(null),_=K(4);ye(()=>{e(E)?j(e(E)):(k(I,"UUID de recette manquant"),k(U,!1))});const h=O(()=>{if(!e(a)?.ingredients)return[];const u=new Set;return e(a).ingredients.forEach(o=>{o.allergens&&Array.isArray(o.allergens)&&o.allergens.forEach(R=>u.add(R))}),Array.from(u).sort()});async function j(u){k(U,!0),k(I,null);try{const o=await va.getRecipeByUuid(u);if(!o){k(I,"Impossible de charger les détails de la recette");return}k(a,o,!0),k(_,o.plate,!0)}catch(o){console.error("Erreur lors du chargement de la recette:",o),k(I,o instanceof Error?o.message:"Erreur lors du chargement",!0)}finally{k(U,!1)}}function q(u){const o=u.target,R=parseInt(o.value);!isNaN(R)&&R>0&&k(_,R,!0)}ye(()=>{ke.setConfig({title:e(a)?.title||"Recette",actions:V})}),ta(()=>{ke.reset()});const F=O(()=>e(a)?ca(e(a).typeR,e(a).categories||void 0):{label:"",iconId:"no-cat"});var C=Ga(),G=t(C);{var Re=u=>{var o=Ra();n(u,o)},Ae=u=>{var o=Q(),R=W(o);{var X=y=>{var f=Aa(),z=t(f),A=v(t(z),2),D=t(A,!0);r(A),r(z),r(f),x(()=>g(D,e(I))),n(y,f)},H=y=>{var f=Q(),z=W(f);{var A=D=>{var J=Wa(),L=W(J),P=t(L),B=t(P),N=t(B),Y=t(N),Z=t(Y),Se=t(Z);r(Z);var Ie=v(Z);r(Y);var Ce=v(Y,2);{var Be=s=>{var i=Sa(),p=t(i);ua(p,{get regimes(){return e(a).regime},iconOnly:!1}),r(i),n(s,i)};c(Ce,s=>{e(a)?.regime&&e(a).regime.length>0&&s(Be)})}r(N);var Ee=v(N,2);{var je=s=>{var i=Ia(),p=t(i);r(i),x(()=>g(p,`une recette de ${e(a).auteur??""}`)),n(s,i)};c(Ee,s=>{e(a).auteur&&s(je)})}r(B);var pe=v(B,2);{var De=s=>{var i=Ba(),p=t(i);le(p,17,()=>e(a).categories,ce,(l,b)=>{var de=Ca(),he=t(de),Ve=t(he,!0);r(he),r(de),x(()=>g(Ve,e(b))),n(l,de)});var w=v(p,2),m=t(w,!0);r(w),r(i),x(()=>g(m,e(a).description)),n(s,i)};c(pe,s=>{(e(a).description||e(a).categories&&e(a).categories.length>0)&&s(De)})}var $=v(pe,2),ue=t($),ee=t(ue),_e=t(ee);{var Ue=s=>{var i=Da(),p=t(i);{var w=l=>{var b=Ea();n(l,b)},m=l=>{var b=ja();n(l,b)};c(p,l=>{e(a).serveHot?l(w):l(m,!1)})}r(i),n(s,i)};c(_e,s=>{e(a)?.serveHot!==void 0&&s(Ue)})}var qe=v(_e,2);{var ze=s=>{var i=za(),p=t(i);{var w=l=>{var b=Ua();n(l,b)},m=l=>{var b=qa();n(l,b)};c(p,l=>{e(a).cuisson?l(w):l(m,!1)})}r(i),n(s,i)};c(qe,s=>{e(a)?.cuisson!==void 0&&s(ze)})}r(ee);var ge=v(ee,2);{var Pe=s=>{var i=Fa(),p=v(t(i),2);le(p,17,()=>e(h),ce,(w,m)=>{var l=Pa(),b=t(l,!0);r(l),x(()=>g(b,e(m))),n(w,l)}),r(i),n(s,i)};c(ge,s=>{e(h).length>0&&s(Pe)})}var Fe=v(ge,2);{var He=s=>{var i=La();le(i,21,()=>e(a).materiel,ce,(p,w)=>{var m=Ha(),l=t(m,!0);r(m),x(()=>g(l,e(w))),n(p,m)}),r(i),n(s,i)};c(Fe,s=>{e(a)?.materiel&&e(a).materiel.length>0&&s(He)})}r(ue),r($);var ae=v($,2),re=t(ae),te=t(re),Le=t(te);ea(Le,{class:"h-5 w-5"}),oe(),r(te);var se=v(te,2);pa(se),se.__input=q,r(re);var Ne=v(re,2);{var Oe=s=>{ya(s,{get isChecked(){return e(a).check},get defaultServings(){return e(a).plate}})};c(Ne,s=>{e(a).check!==void 0&&s(Oe)})}r(ae);var ie=v(ae,2),ne=t(ie),We=t(ne);r(ne);var Ge=v(ne,2);{var Je=s=>{var i=Na(),p=t(i,!0);r(i),x(()=>g(p,e(a).quantite_desc)),n(s,i)};c(Ge,s=>{e(a).quantite_desc&&s(Je)})}r(ie);var fe=v(ie,2),ve=t(fe),me=t(ve),Ke=t(me);_a(Ke,{get ingredients(){return e(a).ingredients},get servings(){return e(_)},get defaultServings(){return e(a).plate}}),r(me),r(ve);var be=v(ve,2),Me=t(be);{let s=O(()=>e(a).preparation24h||void 0),i=O(()=>e(a).astuces||[]);ga(Me,{get preparation(){return e(a).preparation},get preparation24h(){return e(s)},get astuces(){return e(i)}})}r(be),r(fe),r(P),r(L);var xe=v(L,2);{var Qe=s=>{var i=Oa(),p=t(i);ma(p,{get recipeId(){return e(E)}}),r(i),n(s,i)};c(xe,s=>{e(E)&&s(Qe)})}var Te=v(xe,2);fa(Te,{get auteur(){return e(a).auteur},get createdBy(){return e(a).createdBy},get id(){return e(a).$id},get createdAt(){return e(a).$createdAt},get updatedAt(){return e(a).$updatedAt}}),x(()=>{oa(Se,"href",`/icons/sprite.svg#${e(F).iconId}`),g(Ie,` ${e(a).title??""}`),la(se,e(_)),g(We,`Quantité pour ${e(_)??""} couverts`)}),n(D,J)};c(z,D=>{e(a)&&D(A)},!0)}n(y,f)};c(R,y=>{e(I)?y(X):y(H,!1)},!0)}n(u,o)};c(G,u=>{e(U)?u(Re):u(Ae,!1)})}r(C),sa(1,C,()=>ba),n(T,C),ia()}da(["click","input"]);export{$a as default};
