{{ define "main" }}
<div class="container my-5">
  <div class="row justify-content-center">
    <div class="col-lg-6">
      
      <!-- État de chargement initial -->
      <div id="loading-state" class="text-center p-5">
        <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem">
          <span class="visually-hidden">Vérification...</span>
        </div>
        <p class="mt-3">Vérification de votre email en cours...</p>
      </div>

      <!-- État de configuration du compte -->
      <div id="config-state" style="display: none;">
        <div class="card">
          <div class="card-body p-4 text-center">
            <div class="mb-4">
              <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;">
                <span class="visually-hidden">Configuration...</span>
              </div>
            </div>
            <h4 class="text-primary">Configuration du compte en cours...</h4>
            <p class="text-muted">
              Email vérifié avec succès ! Configuration de votre accès à l'interface d'édition...
            </p>
          </div>
        </div>
      </div>

      <!-- État de succès -->
      <div id="success-state" style="display: none;">
        <div class="card">
          <div class="card-body p-4 text-center">
            <div class="mb-4">
              <i class="fas fa-check-circle text-success" style="font-size: 4rem;"></i>
            </div>
            <h4 class="text-success">Email vérifié avec succès !</h4>
            <p class="text-muted">
              Votre adresse email a été confirmée et votre compte est configuré. Vous pouvez maintenant accéder à toutes les fonctionnalités du site.
            </p>
            <div class="d-grid gap-2">
              <button id="edit-button" class="btn btn-primary" onclick="window.location.href='/sveltia/'">
                Accéder à l'interface d'édition
              </button>
              <a href="/" class="btn btn-outline-secondary">Retour à l'accueil</a>
            </div>
          </div>
        </div>
      </div>

      <!-- État d'erreur -->
      <div id="error-state" style="display: none;">
        <div class="card">
          <div class="card-body p-4 text-center">
            <div class="mb-4">
              <i class="fas fa-exclamation-triangle text-danger" style="font-size: 4rem;"></i>
            </div>
            <h4 class="text-danger">Erreur de vérification</h4>
            <div id="error-message" class="text-muted mb-4">
              Une erreur est survenue lors de la vérification de votre email.
            </div>
            <div class="d-grid gap-2">
              <button id="retry-button" class="btn btn-primary">
                <span class="spinner-border spinner-border-sm me-2" style="display: none;" role="status" aria-hidden="true"></span>
                Réessayer
              </button>
              <a href="/login" class="btn btn-outline-secondary">Retour à la connexion</a>
            </div>
          </div>
        </div>
      </div>

      <!-- État de lien expiré -->
      <div id="expired-state" style="display: none;">
        <div class="card">
          <div class="card-body p-4 text-center">
            <div class="mb-4">
              <i class="fas fa-clock text-warning" style="font-size: 4rem;"></i>
            </div>
            <h4 class="text-warning">Lien de vérification expiré</h4>
            <p class="text-muted mb-4">
              Ce lien de vérification a expiré ou a déjà été utilisé. 
              Vous pouvez demander un nouveau lien depuis votre compte.
            </p>
            <div class="d-grid gap-2">
              <a href="/login" class="btn btn-primary">Se connecter pour renvoyer l'email</a>
              <a href="/" class="btn btn-outline-secondary">Retour à l'accueil</a>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>

<!-- Script de vérification d'email -->
{{ partial "footer/esbuild" (dict "src" "js/verify-email.js" "targetPath" "verify-email.js" "load" "defer" "transpile" false) -}}

{{ end }}