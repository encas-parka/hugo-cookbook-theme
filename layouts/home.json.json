{{/* Nouveau template simplifié - toutes les données sont déjà dans le frontmatter */}}
{{- $recipes := slice -}}
{{- range where .Site.RegularPages "Section" "recettes" -}}
  {{- if .Title -}}

    {{/* Extraire les noms des ingrédients directement depuis le frontmatter */}}
    {{- $ingredientNames := slice -}}
    {{- range .Params.ingredients -}}
      {{- $ingredientNames = $ingredientNames | append .name -}}
    {{- end -}}

    {{/* Build recipe object with abbreviated keys - métadonnées essentielles pour l'index */}}
    {{- $recipe := dict
      "u" .Params.uuid
      "s" .Params.slug
      "n" .Title
      "t" .Params.typeR
      "c" .Params.categories
      "r" .Params.regime
      "cu" .Params.cuisson
      "a" .Params.auteur
      "d" .Draft
      "serveHot" .Params.serveHot
      "plates" .Params.plate
      "q" .Params.quantite_desc
      "ch" .Params.check
      "checkfor" .Params.checkfor
      "pd" .Params.PublishDate
      "materiel" .Params.materiel
      "saison" .Params.saison
      "region" .Params.region
      "ingredients" $ingredientNames
    -}}
    {{- $recipes = $recipes | append $recipe -}}
  {{- end -}}
{{- end -}}

{{/* Generate unified JSON output */}}
{{- dict "recipes" $recipes | jsonify -}}
