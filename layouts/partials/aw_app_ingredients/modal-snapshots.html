<!-- Modal de gestion des sauvegardes -->
<div class="modal fade" id="snapshotsModal" tabindex="-1" aria-labelledby="snapshotsModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="snapshotsModalLabel">
          ğŸ’¾ Gestion des sauvegardes
        </h5>
        <button type="button" class="btn-close" @click="showSnapshotsModal = false" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <!-- Actions rapides -->
        <div class="row mb-4">
          <div class="col-md-6">
            <button 
              class="btn btn-primary w-100" 
              @click="createSnapshot"
              :disabled="isCreatingSnapshot"
            >
              <span v-if="isCreatingSnapshot" class="spinner-border spinner-border-sm me-2"></span>
              ğŸ’¾ CrÃ©er un point de sauvegarde
            </button>
          </div>
          <div class="col-md-6">
            <button class="btn btn-outline-secondary w-100" @click="refreshSnapshots">
              ğŸ”„ Actualiser la liste
            </button>
          </div>
        </div>

        <!-- Liste des snapshots -->
        <div v-if="isLoadingSnapshots" class="text-center py-4">
          <div class="spinner-border" role="status"></div>
          <p class="mt-2">Chargement des sauvegardes...</p>
        </div>

        <div v-else-if="snapshots.length === 0" class="alert alert-info">
          <h6>Aucune sauvegarde trouvÃ©e</h6>
          <p class="mb-0">CrÃ©ez votre premiÃ¨re sauvegarde pour pouvoir restaurer votre liste plus tard.</p>
        </div>

        <div v-else>
          <h6>Sauvegardes disponibles ([[ snapshots.length ]])</h6>
          <div class="table-responsive">
            <table class="table table-hover">
              <thead>
                <tr>
                  <th>Date de crÃ©ation</th>
                  <th>Description</th>
                  <th>CrÃ©Ã© par</th>
                  <th>IngrÃ©dients</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr v-for="snapshot in snapshots" :key="snapshot.$id">
                  <td>
                    <strong>[[ formatDate(snapshot.$createdAt) ]]</strong>
                    <br><small class="text-muted">[[ formatTime(snapshot.$createdAt) ]]</small>
                  </td>
                  <td>[[ snapshot.description ]]</td>
                  <td>[[ snapshot.createdBy ]]</td>
                  <td>
                    <span class="badge bg-info">[[ getSnapshotIngredientCount(snapshot) ]]</span>
                  </td>
                  <td>
                    <div class="btn-group btn-group-sm" role="group">
                      <button 
                        class="btn btn-outline-primary" 
                        @click="previewSnapshot(snapshot)"
                        title="PrÃ©visualiser"
                      >
                        ğŸ‘ï¸
                      </button>
                      <button 
                        class="btn btn-outline-success" 
                        @click="restoreSnapshot(snapshot)"
                        :disabled="isRestoring === snapshot.$id"
                        title="Restaurer"
                      >
                        <span v-if="isRestoring === snapshot.$id" class="spinner-border spinner-border-sm"></span>
                        <span v-else>ğŸ“¥</span>
                      </button>
                      <button 
                        class="btn btn-outline-danger" 
                        @click="deleteSnapshot(snapshot)"
                        :disabled="isDeleting === snapshot.$id"
                        title="Supprimer"
                      >
                        <span v-if="isDeleting === snapshot.$id" class="spinner-border spinner-border-sm"></span>
                        <span v-else>ğŸ—‘ï¸</span>
                      </button>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Information sur la politique de rÃ©tention -->
        <div class="alert alert-light mt-4">
          <small>
            <strong>â„¹ï¸ Politique de rÃ©tention:</strong>
            Les sauvegardes sont conservÃ©es pendant 90 jours maximum.
            Seules les 15 derniÃ¨res sauvegardes sont conservÃ©es par liste.
            CrÃ©ez rÃ©guliÃ¨rement des sauvegardes avant les modifications importantes.
          </small>
        </div>
      </div>
    </div>
  </div>
</div>