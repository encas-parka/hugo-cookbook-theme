{{ define "main" }}
<div class="container my-5">
  <div class="row justify-content-center">
    <div class="col-lg-6">
      <!-- =============================================== -->
      <!--   Section affichée si l'utilisateur est connecté -->
      <!-- =============================================== -->
      <div id="user-logged-in" style="display: none">
        <div class="card text-center">
          <div class="card-body">
            <img src="/cover.png" alt="logo" class="mb-3" width="150px" />
            <h5 class="card-title">Bienvenue !</h5>
            <p class="card-text">
              Vous êtes déjà connecté<span id="user-email-display"></span>.
            </p>
            <a href="/adminsupa/" class="btn btn-primary"
              >Aller à l'administration</a
            >
            <button id="logout-button" class="btn btn-secondary">
              Se déconnecter
            </button>
          </div>
        </div>
      </div>

      <!-- =============================================== -->
      <!-- Section affichée si l'utilisateur n'est PAS connecté -->
      <!-- =============================================== -->
      <div id="user-logged-out">
        <div class="card">
          <div class="card-body p-4">
            <div class="text-center mb-4">
              <img src="/cover.png" alt="logo" class="m-auto" width="150px" />
              <h4 class="mt-3">Accès à l'interface d'édition</h4>
            </div>

            <form id="login-form">
              <!-- Placeholder pour les messages d'erreur -->
              <div
                id="error-message"
                class="alert alert-danger"
                style="display: none"
                role="alert"
              ></div>

              <div class="mb-3">
                <label for="login-email" class="form-label">Email</label>
                <input
                  type="email"
                  class="form-control"
                  id="login-email"
                  required
                  autocomplete="email"
                />
              </div>
              <div class="mb-3">
                <label for="login-password" class="form-label"
                  >Mot de passe</label
                >
                <input
                  type="password"
                  class="form-control"
                  id="login-password"
                  required
                  autocomplete="current-password"
                />
              </div>
              <div class="d-grid">
                <button
                  type="submit"
                  id="login-button"
                  class="btn btn-primary btn-lg"
                >
                  <span
                    class="spinner-border spinner-border-sm"
                    role="status"
                    aria-hidden="true"
                    style="display: none"
                  ></span>
                  Se connecter
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Section "Demander un accès" que nous conservons -->
  <div class="row justify-content-center mt-5">
    <div class="col-lg-8">
      <div class="card">
        <div class="card-header fw-bold">Demander un accès</div>
        <div class="card-body small">
          <p>
            Si vous souhaitez participer au site, remplissez ce formulaire pour
            recevoir une invitation.
          </p>
          <form
            name="contact"
            class="contact-form"
            action="/contact-thank-you/"
            method="POST"
            data-netlify="true"
            netlify-honeypot="contact"
          >
            <input type="hidden" name="form-name" value="contact" />
            <div class="form-group">
              <label for="contact-form-email" class="visually-hidden"
                >Email</label
              >
              <input
                id="contact-form-email"
                name="Email"
                type="email"
                placeholder="Votre email"
                class="form-control mb-3"
                required
                autocomplete="off"
                maxlength="100"
              />

              <label for="contact-form-message" class="visually-hidden"
                >Message</label
              >
              <textarea
                class="form-control"
                id="contact-form-message"
                name="Message"
                placeholder="Quelques mots de présentation (qui vous a parlé du site ? etc.)"
                rows="4"
              ></textarea>

              <div class="d-flex justify-content-end mt-3">
                <button
                  class="btn btn-info"
                  type="submit"
                  value="Submit"
                  id="Form-submit"
                >
                  Envoyer la demande
                </button>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>


<!-- USELESS ? -->
<!-- On charge le script d'authentification à la fin -->
{{ $script := resources.Get "js/authAppwrite.js" | fingerprint }}
<script type="module" src="{{ $script.RelPermalink }}"></script>

{{ end }}
