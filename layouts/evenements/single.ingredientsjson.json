{{- /*
  single.ingredientsjson.json
  Émet un JSON équivalent à l'ancienne version.
  Utilise le partial mis en cache "event-data-processor.html" pour obtenir les données.
*/}}

{{- $eventData := partialCached "functions/event-data-processor.html" . .File.UniqueID -}}

{{- /* La clé toPrint est la seule qui doit être calculée ici */}}
{{- $toPrint := dict "ingredients" true "LegumesRanges" true "FraisRanges" true "AnimauxRanges" true -}}
{{- range $eventData.types -}}
  {{- $toPrint = merge $toPrint (dict . true) -}}
{{- end -}}

{{- (dict
  "datesRepas" $eventData.datesRepas
  "datesTimeRepas" $eventData.datesTimeRepas
  "startDate" $eventData.startDate
  "endDate" $eventData.endDate
  "ingByTypeList" $eventData.ingByTypeList
  "types" $eventData.types
  "toPrint" $toPrint
  "recettesLength" $eventData.recettesLength
  "nbDate" $eventData.nbDate
  "uniqueIngCount" $eventData.uniqueIngCount
  "missingRecipes" $eventData.missingRecipes
) | jsonify -}}